var $jscomp=$jscomp||{},$jscomp$lookupPolyfilledValue=($jscomp.scope={},$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a},$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){return a.raw=b,a},$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}},$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}},$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)},$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.SIMPLE_FROUND_POLYFILL=!1,$jscomp.ISOLATE_POLYFILLS=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){return a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value),a},$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object")},$jscomp.global=$jscomp.getGlobal(this),$jscomp.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE,$jscomp.polyfills={},$jscomp.propertyToPolyfillSymbol={},$jscomp.POLYFILL_PREFIX="$jscp$",function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];return null!=c&&void 0!==(c=a[c])?c:a[b]}),COMPILED=($jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))},$jscomp.polyfillUnisolated=function(a,b,c,d){for(c=$jscomp.global,a=a.split("."),d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}(b=b(d=c[a=a[a.length-1]]))!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})},$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length,d=e[0],d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1],null!=(b=b(c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null))&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=$jscomp.propertyToPolyfillSymbol[e],$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:b})))},$jscomp.initSymbol=function(){},$jscomp.polyfill("Symbol",function(a){var b,c,d;return a||((b=function(e,f){this.$jscomp$symbol$id_=e,$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:f})}).prototype.toString=function(){return this.$jscomp$symbol$id_},c=0,d=function(e){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(e||"")+"_"+c++,e)})},"es6","es3"),$jscomp.initSymbolIterator=function(){},$jscomp.polyfill("Symbol.iterator",function(a){if(!a){a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"==typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}}return a},"es6","es3"),$jscomp.initSymbolAsyncIterator=function(){},$jscomp.iteratorPrototype=function(a){return(a={next:a})[Symbol.iterator]=function(){return this},a},$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d={next:function(){var e;return c<a.length?(e=c++,{value:b(e,a[e]),done:!1}):(d.next=function(){return{done:!0,value:void 0}},d.next())}};return d[Symbol.iterator]=function(){return d},d},$jscomp.polyfill("Array.prototype.keys",function(a){return a||function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3"),$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)$jscomp.owns(d,e)&&(a[e]=d[e])}return a},$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3"),$jscomp.findInternal=function(a,b,c){for(var d=(a=a instanceof String?String(a):a).length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}},$jscomp.polyfill("Array.prototype.find",function(a){return a||function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3"),$jscomp.polyfill("Array.from",function(a){return a||function(b,c,d){c=null!=c?c:function(h){return h};var e=[],f="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];if("function"==typeof f){b=f.call(b);for(var g=0;!(f=b.next()).done;)e.push(c.call(d,f.value,g++))}else for(f=b.length,g=0;g<f;g++)e.push(c.call(d,b[g],g));return e}},"es6","es3"),$jscomp.polyfill("Object.entries",function(a){return a||function(b){var d,c=[];for(d in b)$jscomp.owns(b,d)&&c.push([d,b[d]]);return c}},"es8","es3"),$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""},$jscomp.polyfill("String.prototype.repeat",function(a){return a||function(b){var c=$jscomp.checkStringArgs(this,null,"repeat");if(b<0||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)1&b&&(d+=c),(b>>>=1)&&(c+=c);return d}},"es6","es3"),!0),goog=goog||{},sre=(goog.global=this||self,goog.exportPath_=function(a,b,c){a=a.split("."),c=c||goog.global,a[0]in c||void 0===c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c=c[d]&&c[d]!==Object.prototype[d]?c[d]:c[d]={}:c[d]=b},goog.define=function(a,b){var c,d;return COMPILED||(c=goog.global.CLOSURE_UNCOMPILED_DEFINES,d=goog.global.CLOSURE_DEFINES,c&&void 0===c.nodeType&&Object.prototype.hasOwnProperty.call(c,a)?b=c[a]:d&&void 0===d.nodeType&&Object.prototype.hasOwnProperty.call(d,a)&&(b=d[a])),b},goog.FEATURESET_YEAR=2012,goog.DEBUG=!0,goog.LOCALE="en",goog.TRUSTED_SITE=!0,goog.STRICT_MODE_COMPATIBLE=!1,goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(a){if(goog.isInModuleLoader_())throw Error("goog.provide cannot be used within a module.");if(!COMPILED&&goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');goog.constructNamespace_(a)},goog.constructNamespace_=function(a,b){if(!COMPILED){delete goog.implicitNamespaces_[a];for(var c=a;(c=c.substring(0,c.lastIndexOf(".")))&&!goog.getObjectByName(c);)goog.implicitNamespaces_[c]=!0}goog.exportPath_(a,b)},goog.getScriptNonce=function(a){return a&&a!=goog.global?goog.getScriptNonce_(a.document):(null===goog.cspNonce_&&(goog.cspNonce_=goog.getScriptNonce_(goog.global.document)),goog.cspNonce_)},goog.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/,goog.cspNonce_=null,goog.getScriptNonce_=function(a){return(a=(a=a.querySelector&&a.querySelector("script[nonce]"))&&(a.nonce||a.getAttribute("nonce")))&&goog.NONCE_PATTERN_.test(a)?a:""},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(a){if("string"!=typeof a||!a||-1==a.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw Error("Module "+a+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");if(goog.moduleLoaderState_.moduleName=a,!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a]}},goog.module.get=function(a){return goog.module.getInternal_(a)},goog.module.getInternal_=function(a){if(!COMPILED){if(a in goog.loadedModules_)return goog.loadedModules_[a].exports;if(!goog.implicitNamespaces_[a])return null!=(a=goog.getObjectByName(a))?a:null}return null},goog.ModuleType={ES6:"es6",GOOG:"goog"},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()},goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG},goog.isInEs6ModuleLoader_=function(){var a;return!(!goog.moduleLoaderState_||goog.moduleLoaderState_.type!=goog.ModuleType.ES6)||!!(a=goog.global.$jscomp)&&"function"==typeof a.getCurrentModulePath&&!!a.getCurrentModulePath()},goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInGoogModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.declareModuleId=function(a){if(!COMPILED){if(!goog.isInEs6ModuleLoader_())throw Error("goog.declareModuleId may only be called from within an ES6 module");if(goog.moduleLoaderState_&&goog.moduleLoaderState_.moduleName)throw Error("goog.declareModuleId may only be called once per module.");if(a in goog.loadedModules_)throw Error('Module with namespace "'+a+'" already exists.')}if(goog.moduleLoaderState_)goog.moduleLoaderState_.moduleName=a;else{var b=goog.global.$jscomp;if(!b||"function"!=typeof b.getCurrentModulePath)throw Error('Module with namespace "'+a+'" has been loaded incorrectly.');b=b.require(b.getCurrentModulePath()),goog.loadedModules_[a]={exports:b,type:goog.ModuleType.ES6,moduleId:a}}},goog.setTestOnly=function(a){if(goog.DISALLOW_TEST_ONLY_CODE)throw a=a||"",Error("Importing test-only code into non-debug environment"+(a?": "+a:"."))},goog.forwardDeclare=function(a){},COMPILED||(goog.isProvided_=function(a){return a in goog.loadedModules_||!goog.implicitNamespaces_[a]&&null!=goog.getObjectByName(a)},goog.implicitNamespaces_={"goog.module":!0}),goog.getObjectByName=function(a,b){a=a.split("."),b=b||goog.global;for(var c=0;c<a.length;c++)if(null==(b=b[a[c]]))return null;return b},goog.globalize=function(a,b){for(var c in b=b||goog.global,a)b[c]=a[c]},goog.addDependency=function(a,b,c,d){!COMPILED&&goog.DEPENDENCIES_ENABLED&&goog.debugLoader_.addDependency(a,b,c,d)},goog.ENABLE_DEBUG_LOADER=!0,goog.logToConsole_=function(a){goog.global.console&&goog.global.console.error(a)},goog.require=function(a){if(!COMPILED){if(goog.ENABLE_DEBUG_LOADER&&goog.debugLoader_.requested(a),goog.isProvided_(a)){if(goog.isInModuleLoader_())return goog.module.getInternal_(a)}else if(goog.ENABLE_DEBUG_LOADER){var b=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{goog.debugLoader_.load_(a)}finally{goog.moduleLoaderState_=b}}return null}},goog.requireType=function(a){return{}},goog.basePath="",goog.nullFunction=function(){},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(a){a.instance_=void 0,a.getInstance=function(){return a.instance_||(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a),a.instance_=new a)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER,goog.TRANSPILE="detect",goog.ASSUME_ES_MODULES_TRANSPILED=!1,goog.TRANSPILE_TO_LANGUAGE="",goog.TRANSPILER="transpile.js",goog.hasBadLetScoping=null,goog.useSafari10Workaround=function(){if(null==goog.hasBadLetScoping){try{var a=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(b){a=!1}goog.hasBadLetScoping=a}return goog.hasBadLetScoping},goog.workaroundSafari10EvalBug=function(a){return"(function(){"+a+"\n;})();\n"},goog.loadModule=function(a){var b=goog.moduleLoaderState_;try{if(goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1,type:goog.ModuleType.GOOG},goog.isFunction(a))var c=a.call(void 0,{});else{if("string"!=typeof a)throw Error("Invalid module definition");goog.useSafari10Workaround()&&(a=goog.workaroundSafari10EvalBug(a)),c=goog.loadModuleFromSource_.call(void 0,a)}var d=goog.moduleLoaderState_.moduleName;if("string"!=typeof d||!d)throw Error('Invalid module name "'+d+'"');goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(d,c):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof c&&null!=c&&Object.seal(c),goog.loadedModules_[d]={exports:c,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName}}finally{goog.moduleLoaderState_=b}},goog.loadModuleFromSource_=function(a){return eval(a),{}},goog.normalizePath_=function(a){a=a.split("/");for(var b=0;b<a.length;)"."==a[b]?a.splice(b,1):b&&".."==a[b]&&a[b-1]&&".."!=a[b-1]?a.splice(--b,2):b++;return a.join("/")},goog.loadFileSync_=function(a){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(a);try{var b=new goog.global.XMLHttpRequest;return b.open("get",a,!1),b.send(),0==b.status||200==b.status?b.responseText:null}catch(c){return null}},goog.transpile_=function(a,b,c){var d=goog.global.$jscomp,e=(d||(goog.global.$jscomp=d={}),d.transpile);if(!e){var f=goog.basePath+goog.TRANSPILER,g=goog.loadFileSync_(f);if(g){if(!(function(){(0,eval)(g+"\n//# sourceURL="+f)}).call(goog.global),goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile,e=(d=goog.global.$jscomp).transpile}}return(e=e||(d.transpile=function(h,k){return goog.logToConsole_(k+" requires transpilation but no transpiler was found."),h}))(a,b,c)},goog.typeOf=function(a){var b=typeof a;if("object"==b){if(!a)return"null";if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&void 0!==a.splice&&void 0!==a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||void 0!==a.call&&void 0!==a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else if("function"==b&&void 0===a.call)return"object";return b},goog.isArray=function(a){return Array.isArray(a)},goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length},goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear},goog.isFunction=function(a){return"function"==goog.typeOf(a)},goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b},goog.getUid=function(a){return Object.prototype.hasOwnProperty.call(a,goog.UID_PROPERTY_)&&a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(a){return!!a[goog.UID_PROPERTY_]},goog.removeUid=function(a){null!==a&&"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(a){var c,b=goog.typeOf(a);if("object"!=b&&"array"!=b)return a;if("function"==typeof a.clone)return a.clone();for(c in b="array"==b?[]:{},a)b[c]=goog.cloneObject(a[c]);return b},goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)},goog.bindJs_=function(a,b,c){var d;if(a)return 2<arguments.length?(d=Array.prototype.slice.call(arguments,2),function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,d),a.apply(b,e)}):function(){return a.apply(b,arguments)};throw Error()},goog.bind=function(a,b,c){return Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();return d.push.apply(d,arguments),a.apply(this,d)}},goog.mixin=function(a,b){for(var c in b)a[c]=b[c]},goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date},goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorks_)try{goog.global.eval(""),goog.evalWorks_=!0}catch(d){goog.evalWorks_=!1}var b,c;goog.evalWorks_?goog.global.eval(a):((c=(b=goog.global.document).createElement("script")).type="text/javascript",c.defer=!1,c.appendChild(b.createTextNode(a)),b.head.appendChild(c),b.head.removeChild(c))}},goog.evalWorks_=null,goog.getCssName=function(a,b){if("."==String(a).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+a);function c(e){return goog.cssNameMapping_[e]||e}var d=function(e){e=e.split("-");for(var f=[],g=0;g<e.length;g++)f.push(c(e[g]));return f.join("-")},d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(e){return e};return a=b?a+"-"+d(b):d(a),goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(a):a},goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a,goog.cssNameMappingStyle_=b},!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.getMsg=function(a,b,c){return c&&c.html&&(a=a.replace(/</g,"&lt;")),a=b?a.replace(/\{\$([^}]+)}/g,function(d,e){return null!=b&&e in b?b[e]:d}):a},goog.getMsgWithFallback=function(a,b){return a},goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)},goog.exportProperty=function(a,b,c){a[b]=c},goog.inherits=function(a,b){function c(){}c.prototype=b.prototype,a.superClass_=b.prototype,a.prototype=new c,(a.prototype.constructor=a).base=function(d,e,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[e].apply(d,g)}},goog.scope=function(a){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a module.");a.call(goog.global)},COMPILED||(goog.global.COMPILED=COMPILED),goog.defineClass=function(a,b){var c=b.constructor,d=b.statics;return c&&c!=Object.prototype.constructor||(c=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),c=goog.defineClass.createSealingConstructor_(c,a),a&&goog.inherits(c,a),delete b.constructor,delete b.statics,goog.defineClass.applyProperties_(c.prototype,b),null!=d&&(d instanceof Function?d(c):goog.defineClass.applyProperties_(c,d)),c},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(a,b){return goog.defineClass.SEAL_CLASS_INSTANCES?function(){var c=a.apply(this,arguments)||this;return c[goog.UID_PROPERTY_]=c[goog.UID_PROPERTY_],c}:a},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);for(var d=0;d<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;d++)c=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[d],Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])},!COMPILED&&goog.DEPENDENCIES_ENABLED&&(goog.inHtmlDocument_=function(){var a=goog.global.document;return null!=a&&"write"in a},goog.isDocumentLoading_=function(){var a=goog.global.document;return a.attachEvent?"complete"!=a.readyState:"loading"==a.readyState},goog.findBasePath_=function(){if(null!=goog.global.CLOSURE_BASE_PATH&&"string"==typeof goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document,b=(a=(b=a.currentScript)?[b]:a.getElementsByTagName("SCRIPT")).length-1;0<=b;--b){var c=a[b].src,d=-1==(d=c.lastIndexOf("?"))?c.length:d;if("base.js"==c.substr(d-7,7)){goog.basePath=c.substr(0,d-7);break}}},goog.findBasePath_(),goog.Transpiler=function(){this.requiresTranspilation_=null,this.transpilationTarget_=goog.TRANSPILE_TO_LANGUAGE},goog.Transpiler.prototype.createRequiresTranspilation_=function(){function a(g,h){e?d[g]=!0:h()?d[c=g]=!1:e=d[g]=!0}function b(g){try{return!!eval(g)}catch(h){return!1}}var c="es3",d={es3:!1},e=!1,f=goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"";return a("es5",function(){return b("[1,].length==1")}),a("es6",function(){return!f.match(/Edge\/(\d+)(\.\d)*/i)&&b('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')}),a("es7",function(){return b("2 ** 2 == 4")}),a("es8",function(){return b("async () => 1, true")}),a("es9",function(){return b("({...rest} = {}), true")}),a("es_next",function(){return!1}),{target:c,map:d}},goog.Transpiler.prototype.needsTranspile=function(a,b){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;var c;if(this.requiresTranspilation_||(c=this.createRequiresTranspilation_(),this.requiresTranspilation_=c.map,this.transpilationTarget_=this.transpilationTarget_||c.target),a in this.requiresTranspilation_)return!!this.requiresTranspilation_[a]||!(!goog.inHtmlDocument_()||"es6"!=b||"noModule"in goog.global.document.createElement("script"));throw Error("Unknown language mode: "+a)},goog.Transpiler.prototype.transpile=function(a,b){return goog.transpile_(a,b,this.transpilationTarget_)},goog.transpiler_=new goog.Transpiler,goog.protectScriptTag_=function(a){return a.replace(/<\/(SCRIPT)/gi,"\\x3c/$1")},goog.DebugLoader_=function(){this.dependencies_={},this.idToPath_={},this.written_={},this.loadingDeps_=[],this.depsToLoad_=[],this.paused_=!1,this.factory_=new goog.DependencyFactory(goog.transpiler_),this.deferredCallbacks_={},this.deferredQueue_=[]},goog.DebugLoader_.prototype.bootstrap=function(a,b){function c(){d&&(goog.global.setTimeout(d,0),d=null)}var d=b;if(a.length){b=[];for(var e=0;e<a.length;e++){var f=this.getPathFromDeps_(a[e]);if(!f)throw Error("Unregonized namespace: "+a[e]);b.push(this.dependencies_[f])}for(var f=goog.require,g=0,e=0;e<a.length;e++)f(a[e]),b[e].onLoad(function(){++g==a.length&&c()})}else c()},goog.DebugLoader_.prototype.loadClosureDeps=function(){this.depsToLoad_.push(this.factory_.createDependency(goog.normalizePath_(goog.basePath+"deps.js"),"deps.js",[],[],{},!1)),this.loadDeps_()},goog.DebugLoader_.prototype.requested=function(a,b){(a=this.getPathFromDeps_(a))&&(b||this.areDepsLoaded_(this.dependencies_[a].requires))&&(b=this.deferredCallbacks_[a])&&(delete this.deferredCallbacks_[a],b())},goog.DebugLoader_.prototype.setDependencyFactory=function(a){this.factory_=a},goog.DebugLoader_.prototype.load_=function(a){if(!this.getPathFromDeps_(a))throw goog.logToConsole_(a="goog.require could not find: "+a),Error(a);var b=this,c=[],d=function(e){var f=b.getPathFromDeps_(e);if(!f)throw Error("Bad dependency path or symbol: "+e);if(!b.written_[f]){for(b.written_[f]=!0,e=b.dependencies_[f],f=0;f<e.requires.length;f++)goog.isProvided_(e.requires[f])||d(e.requires[f]);c.push(e)}};d(a),a=!!this.depsToLoad_.length,this.depsToLoad_=this.depsToLoad_.concat(c),this.paused_||a||this.loadDeps_()},goog.DebugLoader_.prototype.loadDeps_=function(){for(var a=this,b=this.paused_;this.depsToLoad_.length&&!b;)!function(){var c=!1,d=a.depsToLoad_.shift(),e=!1,f=(a.loading_(d),{pause:function(){if(c)throw Error("Cannot call pause after the call to load.");b=!0},resume:function(){c?a.resume_():b=!1},loaded:function(){if(e)throw Error("Double call to loaded.");e=!0,a.loaded_(d)},pending:function(){for(var g=[],h=0;h<a.loadingDeps_.length;h++)g.push(a.loadingDeps_[h]);return g},setModuleState:function(g){goog.moduleLoaderState_={type:g,moduleName:"",declareLegacyNamespace:!1}},registerEs6ModuleExports:function(g,h,k){k&&(goog.loadedModules_[k]={exports:h,type:goog.ModuleType.ES6,moduleId:k||""})},registerGoogModuleExports:function(g,h){goog.loadedModules_[g]={exports:h,type:goog.ModuleType.GOOG,moduleId:g}},clearModuleState:function(){goog.moduleLoaderState_=null},defer:function(g){if(c)throw Error("Cannot register with defer after the call to load.");a.defer_(d,g)},areDepsLoaded:function(){return a.areDepsLoaded_(d.requires)}});try{d.load(f)}finally{c=!0}}();b&&this.pause_()},goog.DebugLoader_.prototype.pause_=function(){this.paused_=!0},goog.DebugLoader_.prototype.resume_=function(){this.paused_&&(this.paused_=!1,this.loadDeps_())},goog.DebugLoader_.prototype.loading_=function(a){this.loadingDeps_.push(a)},goog.DebugLoader_.prototype.loaded_=function(a){for(var b=0;b<this.loadingDeps_.length;b++)if(this.loadingDeps_[b]==a){this.loadingDeps_.splice(b,1);break}for(b=0;b<this.deferredQueue_.length;b++)if(this.deferredQueue_[b]==a.path){this.deferredQueue_.splice(b,1);break}if(this.loadingDeps_.length==this.deferredQueue_.length&&!this.depsToLoad_.length)for(;this.deferredQueue_.length;)this.requested(this.deferredQueue_.shift(),!0);a.loaded()},goog.DebugLoader_.prototype.areDepsLoaded_=function(a){for(var b=0;b<a.length;b++){var c=this.getPathFromDeps_(a[b]);if(!c||!(c in this.deferredCallbacks_||goog.isProvided_(a[b])))return!1}return!0},goog.DebugLoader_.prototype.getPathFromDeps_=function(a){return a in this.idToPath_?this.idToPath_[a]:a in this.dependencies_?a:null},goog.DebugLoader_.prototype.defer_=function(a,b){this.deferredCallbacks_[a.path]=b,this.deferredQueue_.push(a.path)},goog.LoadController=function(){},goog.LoadController.prototype.pause=function(){},goog.LoadController.prototype.resume=function(){},goog.LoadController.prototype.loaded=function(){},goog.LoadController.prototype.pending=function(){},goog.LoadController.prototype.registerEs6ModuleExports=function(a,b,c){},goog.LoadController.prototype.setModuleState=function(a){},goog.LoadController.prototype.clearModuleState=function(){},goog.LoadController.prototype.defer=function(a){},goog.LoadController.prototype.areDepsLoaded=function(){},goog.Dependency=function(a,b,c,d,e){this.path=a,this.relativePath=b,this.provides=c,this.requires=d,this.loadFlags=e,this.loaded_=!1,this.loadCallbacks_=[]},goog.Dependency.prototype.getPathName=function(){var a=this.path,b=a.indexOf("://");return a=0<=b&&0<=(b=(a=a.substring(b+3)).indexOf("/"))?a.substring(b+1):a},goog.Dependency.prototype.onLoad=function(a){this.loaded_?a():this.loadCallbacks_.push(a)},goog.Dependency.prototype.loaded=function(){this.loaded_=!0;var a=this.loadCallbacks_;this.loadCallbacks_=[];for(var b=0;b<a.length;b++)a[b]()},goog.Dependency.defer_=!1,goog.Dependency.callbackMap_={},goog.Dependency.registerCallback_=function(a){var b=Math.random().toString(32);return goog.Dependency.callbackMap_[b]=a,b},goog.Dependency.unregisterCallback_=function(a){delete goog.Dependency.callbackMap_[a]},goog.Dependency.callback_=function(a,b){if(!(a in goog.Dependency.callbackMap_))throw Error("Callback key "+a+" does not exist (was base.js loaded more than once?).");for(var c=goog.Dependency.callbackMap_[a],d=[],e=1;e<arguments.length;e++)d.push(arguments[e]);c.apply(void 0,d)},goog.Dependency.prototype.load=function(a){if(goog.global.CLOSURE_IMPORT_SCRIPT)goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?a.loaded():a.pause();else if(goog.inHtmlDocument_()){var c,d,e,b=goog.global.document;if("complete"==b.readyState&&!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING){if(/\bdeps.js$/.test(this.path))return void a.loaded();throw Error('Cannot write "'+this.path+'" after document load')}!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&goog.isDocumentLoading_()?(c=goog.Dependency.registerCallback_(function(f){goog.DebugLoader_.IS_OLD_IE_&&"complete"!=f.readyState||(goog.Dependency.unregisterCallback_(c),a.loaded())}),d=!goog.DebugLoader_.IS_OLD_IE_&&goog.getScriptNonce()?' nonce="'+goog.getScriptNonce()+'"':"",d='<script src="'+this.path+'" '+(goog.DebugLoader_.IS_OLD_IE_?"onreadystatechange":"onload")+"=\"goog.Dependency.callback_('"+c+'\', this)" type="text/javascript" '+(goog.Dependency.defer_?"defer":"")+d+"><\/script>",b.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(d):d)):((e=b.createElement("script")).defer=goog.Dependency.defer_,e.async=!1,e.type="text/javascript",(d=goog.getScriptNonce())&&e.setAttribute("nonce",d),goog.DebugLoader_.IS_OLD_IE_?(a.pause(),e.onreadystatechange=function(){"loaded"!=e.readyState&&"complete"!=e.readyState||(a.loaded(),a.resume())}):e.onload=function(){e.onload=null,a.loaded()},e.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(this.path):this.path,b.head.appendChild(e))}else goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),"deps.js"==this.relativePath?(goog.logToConsole_("Consider setting CLOSURE_IMPORT_SCRIPT before loading base.js, or setting CLOSURE_NO_DEPS to true."),a.loaded()):a.pause()},goog.Es6ModuleDependency=function(a,b,c,d,e){goog.Dependency.call(this,a,b,c,d,e)},goog.inherits(goog.Es6ModuleDependency,goog.Dependency),goog.Es6ModuleDependency.prototype.load=function(a){var d,e,f,g,h,k;goog.global.CLOSURE_IMPORT_SCRIPT?goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?a.loaded():a.pause():goog.inHtmlDocument_()?(d=goog.global.document,e=this,goog.isDocumentLoading_()?(f=function(l,m){l=m?'<script type="module" crossorigin>'+m+"<\/script>":'<script type="module" crossorigin src="'+l+'"><\/script>',d.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(l):l)},goog.Dependency.defer_=!0):f=function(l,m){var n=d.createElement("script"),p=(n.defer=!0,n.async=!1,n.type="module",n.setAttribute("crossorigin",!0),goog.getScriptNonce());p&&n.setAttribute("nonce",p),m?n.textContent=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScript(m):m:n.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(l):l,d.head.appendChild(n)},f(void 0,'goog.Dependency.callback_("'+(g=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(g),a.setModuleState(goog.ModuleType.ES6)}))+'")'),f(this.path,void 0),h=goog.Dependency.registerCallback_(function(l){goog.Dependency.unregisterCallback_(h),a.registerEs6ModuleExports(e.path,l,goog.moduleLoaderState_.moduleName)}),f(void 0,'import * as m from "'+this.path+'"; goog.Dependency.callback_("'+h+'", m)'),f(void 0,'goog.Dependency.callback_("'+(k=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(k),a.clearModuleState(),a.loaded()}))+'")')):(goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),a.pause())},goog.TransformedDependency=function(a,b,c,d,e){goog.Dependency.call(this,a,b,c,d,e),this.contents_=null,this.lazyFetch_=!(goog.inHtmlDocument_()&&"noModule"in goog.global.document.createElement("script"))},goog.inherits(goog.TransformedDependency,goog.Dependency),goog.TransformedDependency.prototype.load=function(a){function b(){e.contents_=goog.loadFileSync_(e.path),e.contents_&&(e.contents_=e.transform(e.contents_),e.contents_)&&(e.contents_+="\n//# sourceURL="+e.path)}function c(){if(e.lazyFetch_&&b(),e.contents_){f&&a.setModuleState(goog.ModuleType.ES6);try{var n,m=e.contents_;e.contents_=null,goog.globalEval(m),f&&(n=goog.moduleLoaderState_.moduleName)}finally{f&&a.clearModuleState()}f&&goog.global.$jscomp.require.ensure([e.getPathName()],function(){a.registerEs6ModuleExports(e.path,goog.global.$jscomp.require(e.getPathName()),n)}),a.loaded()}}var f,k,l,g,n,h,e=this;goog.global.CLOSURE_IMPORT_SCRIPT?(b(),this.contents_&&goog.global.CLOSURE_IMPORT_SCRIPT("",this.contents_)?(this.contents_=null,a.loaded()):a.pause()):(f=this.loadFlags.module==goog.ModuleType.ES6,this.lazyFetch_||b(),h=(g=1<a.pending().length)&&goog.DebugLoader_.IS_OLD_IE_,g=goog.Dependency.defer_&&(g||goog.isDocumentLoading_()),h||g?a.defer(function(){c()}):(k=goog.global.document,h=goog.inHtmlDocument_()&&"ActiveXObject"in goog.global,f&&goog.inHtmlDocument_()&&goog.isDocumentLoading_()&&!h?(goog.Dependency.defer_=!0,a.pause(),l=k.onreadystatechange,k.onreadystatechange=function(){"interactive"==k.readyState&&(k.onreadystatechange=l,c(),a.resume()),goog.isFunction(l)&&l.apply(void 0,arguments)}):!goog.DebugLoader_.IS_OLD_IE_&&goog.inHtmlDocument_()&&goog.isDocumentLoading_()?(g=goog.global.document,n=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(n),c()}),h='<script type="text/javascript">'+goog.protectScriptTag_('goog.Dependency.callback_("'+n+'");')+"<\/script>",g.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(h):h)):c()))},goog.TransformedDependency.prototype.transform=function(a){},goog.TranspiledDependency=function(a,b,c,d,e,f){goog.TransformedDependency.call(this,a,b,c,d,e),this.transpiler=f},goog.inherits(goog.TranspiledDependency,goog.TransformedDependency),goog.TranspiledDependency.prototype.transform=function(a){return this.transpiler.transpile(a,this.getPathName())},goog.PreTranspiledEs6ModuleDependency=function(a,b,c,d,e){goog.TransformedDependency.call(this,a,b,c,d,e)},goog.inherits(goog.PreTranspiledEs6ModuleDependency,goog.TransformedDependency),goog.PreTranspiledEs6ModuleDependency.prototype.transform=function(a){return a},goog.GoogModuleDependency=function(a,b,c,d,e,f,g){goog.TransformedDependency.call(this,a,b,c,d,e),this.needsTranspile_=f,this.transpiler_=g},goog.inherits(goog.GoogModuleDependency,goog.TransformedDependency),goog.GoogModuleDependency.prototype.transform=function(a){return this.needsTranspile_&&(a=this.transpiler_.transpile(a,this.getPathName())),goog.LOAD_MODULE_USING_EVAL&&void 0!==goog.global.JSON?"goog.loadModule("+goog.global.JSON.stringify(a+"\n//# sourceURL="+this.path+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+a+"\n;return exports});\n//# sourceURL="+this.path+"\n"},goog.DebugLoader_.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.DebugLoader_.prototype.addDependency=function(a,b,c,d){b=b||[],a=a.replace(/\\/g,"/");var e=goog.normalizePath_(goog.basePath+a);for(d&&"boolean"!=typeof d||(d=d?{module:goog.ModuleType.GOOG}:{}),c=this.factory_.createDependency(e,a,b,c,d,goog.transpiler_.needsTranspile(d.lang||"es3",d.module)),this.dependencies_[e]=c,c=0;c<b.length;c++)this.idToPath_[b[c]]=e;this.idToPath_[a]=e},goog.DependencyFactory=function(a){this.transpiler=a},goog.DependencyFactory.prototype.createDependency=function(a,b,c,d,e,f){return e.module==goog.ModuleType.GOOG?new goog.GoogModuleDependency(a,b,c,d,e,f,this.transpiler):f?new goog.TranspiledDependency(a,b,c,d,e,this.transpiler):new(e.module==goog.ModuleType.ES6?"never"==goog.TRANSPILE&&goog.ASSUME_ES_MODULES_TRANSPILED?goog.PreTranspiledEs6ModuleDependency:goog.Es6ModuleDependency:goog.Dependency)(a,b,c,d,e)},goog.debugLoader_=new goog.DebugLoader_,goog.loadClosureDeps=function(){goog.debugLoader_.loadClosureDeps()},goog.setDependencyFactory=function(a){goog.debugLoader_.setDependencyFactory(a)},goog.TRUSTED_TYPES_POLICY_=goog.TRUSTED_TYPES_POLICY_NAME?goog.createTrustedTypesPolicy(goog.TRUSTED_TYPES_POLICY_NAME+"#base"):null,goog.global.CLOSURE_NO_DEPS||goog.debugLoader_.loadClosureDeps(),goog.bootstrap=function(a,b){goog.debugLoader_.bootstrap(a,b)}),goog.TRUSTED_TYPES_POLICY_NAME="",goog.identity_=function(a){return a},goog.createTrustedTypesPolicy=function(a){var b=null,c=goog.global.trustedTypes;if(c&&c.createPolicy)try{b=c.createPolicy(a,{createHTML:goog.identity_,createScript:goog.identity_,createScriptURL:goog.identity_})}catch(d){goog.logToConsole_(d.message)}return b},{Variables:function(){}}),germanPrefixCombiner=(sre.Variables.VERSION="3.3.3",sre.Variables.LOCALES="en de fr es hi it nemeth".split(" "),sre.Variables.mathjaxVersion="3.0.0",sre.Variables.url="https://cdn.jsdelivr.net/npm/speech-rule-engine@"+sre.Variables.VERSION+"/lib/mathmaps",sre.Variables.WGXpath="https://cdn.jsdelivr.net/npm/wicked-good-xpath@1.3.0/dist/wgxpath.install.js",sre.SystemExternal=function(){},sre.SystemExternal.require=function(a){return"undefined"!=typeof process&&"undefined"!=typeof require?require(a):null},sre.SystemExternal.documentSupported=function(){return"undefined"!=typeof document},sre.SystemExternal.process=sre.SystemExternal.require("process"),sre.SystemExternal.xmldom=sre.SystemExternal.documentSupported()?window:sre.SystemExternal.require("xmldom-sre"),sre.SystemExternal.document=sre.SystemExternal.documentSupported()?document:(new sre.SystemExternal.xmldom.DOMImplementation).createDocument("","",0),sre.SystemExternal.xpath=sre.SystemExternal.documentSupported()?document:function(){var a={document:{},XPathResult:{}};return sre.SystemExternal.require("wicked-good-xpath").install(a),a.document.XPathResult=a.XPathResult,a.document}(),sre.SystemExternal.mathmapsIePath="https://cdn.jsdelivr.net/npm/sre-mathmaps-ie@"+sre.Variables.VERSION+"mathmaps_ie.js",sre.SystemExternal.commander=sre.SystemExternal.documentSupported()?null:sre.SystemExternal.require("commander"),sre.SystemExternal.fs=sre.SystemExternal.documentSupported()?null:sre.SystemExternal.require("fs"),sre.SystemExternal.url=sre.Variables.url,sre.SystemExternal.jsonPath=(sre.SystemExternal.process&&"undefined"!=typeof global?sre.SystemExternal.process.env.SRE_JSON_PATH||global.SRE_JSON_PATH||sre.SystemExternal.process.cwd():sre.SystemExternal.url)+"/",sre.SystemExternal.WGXpath=sre.Variables.WGXpath,sre.SystemExternal.wgxpath=null,sre.BrowserUtil={},sre.BrowserUtil.detectIE=function(){return"undefined"!=typeof window&&"ActiveXObject"in window&&"clipboardData"in window&&(sre.BrowserUtil.loadMapsForIE_(),sre.BrowserUtil.loadWGXpath_(),!0)},sre.BrowserUtil.detectEdge=function(){return"undefined"!=typeof window&&"MSGestureEvent"in window&&"chrome"in window&&null==window.chrome.loadTimes&&(document.evaluate=null,sre.BrowserUtil.loadWGXpath_(!0),!0)},sre.BrowserUtil.mapsForIE=null,sre.BrowserUtil.loadWGXpath_=function(a){sre.BrowserUtil.loadScript(sre.SystemExternal.WGXpath),sre.BrowserUtil.installWGXpath_(a)},sre.BrowserUtil.installWGXpath_=function(a,b){var c=b||1;"undefined"==typeof wgxpath&&c<10?setTimeout(function(){sre.BrowserUtil.installWGXpath_(a,c++)},200):10<=c||(sre.SystemExternal.wgxpath=wgxpath,a?sre.SystemExternal.wgxpath.install({document:document}):sre.SystemExternal.wgxpath.install(),sre.XpathUtil.xpathEvaluate=document.evaluate,sre.XpathUtil.xpathResult=XPathResult,sre.XpathUtil.createNSResolver=document.createNSResolver)},sre.BrowserUtil.loadMapsForIE_=function(){sre.BrowserUtil.loadScript(sre.SystemExternal.mathmapsIePath)},sre.BrowserUtil.loadScript=function(a){var b=sre.SystemExternal.document.createElement("script");b.type="text/javascript",b.src=a,(sre.SystemExternal.document.head||sre.SystemExternal.document.body).appendChild(b)},sre.DynamicProperties=function(a,b){this.properties_=a,this.order_=b||Object.keys(a)},sre.DynamicProperties.prototype.getProperties=function(){return this.properties_},sre.DynamicProperties.prototype.getOrder=function(){return this.order_},sre.DynamicProperties.prototype.getAxes=function(){return this.order_},sre.DynamicProperties.prototype.getProperty=function(a){return this.properties_[a]},sre.DynamicProperties.prototype.updateProperties=function(a){this.properties_=a},sre.DynamicProperties.prototype.allProperties=function(){var a=[];return this.order_.forEach(goog.bind(function(b){a.push(this.getProperty(b).slice())},this)),a},sre.DynamicProperties.prototype.toString=function(){var a=[];return this.order_.forEach(goog.bind(function(b){a.push(b+": "+this.getProperty(b).toString())},this)),a.join("\n")},sre.DynamicCstr=function(a,b){var d,c={};for(d in this.components_=a){var e=a[d];c[d]=[e],sre.DynamicCstr.Values_.getInstance().add(d,e)}sre.DynamicProperties.call(this,c,b)},goog.inherits(sre.DynamicCstr,sre.DynamicProperties),sre.DynamicCstr.prototype.getComponents=function(){return this.components_},sre.DynamicCstr.prototype.getValue=function(a){return this.components_[a]},sre.DynamicCstr.prototype.getValues=function(){var a=[];return this.order_.forEach(goog.bind(function(b){a.push(this.getValue(b))},this)),a},sre.DynamicCstr.prototype.allProperties=function(){for(var c,d,a=sre.DynamicCstr.superClass_.allProperties.call(this),b=0;c=a[b],d=this.order_[b];b++)d=this.getValue(d),-1===c.indexOf(d)&&c.unshift(d);return a},sre.DynamicCstr.prototype.toString=function(){return this.getValues().join(".")},sre.DynamicCstr.prototype.equal=function(a){var b=a.getAxes();if(this.order_.length!==b.length)return!1;for(var d,c=0;d=b[c];c++){var e=this.getValue(d);if(!e||a.getValue(d)!==e)return!1}return!0},sre.DynamicCstr.Axis={DOMAIN:"domain",STYLE:"style",LOCALE:"locale",TOPIC:"topic",MODALITY:"modality"},sre.DynamicCstr.Values_=function(){this.axisToValues=sre.DynamicCstr.Values_.makeAxisValueObject_()},goog.addSingletonGetter(sre.DynamicCstr.Values_),sre.DynamicCstr.Values_.prototype.add=function(a,b){this.axisToValues[a][b]=!0},sre.DynamicCstr.Values_.prototype.get=function(){var c,a={},b=sre.DynamicCstr.Values_.getInstance().axisToValues;for(c in b)a[c]=Object.keys(b[c]);return a},sre.DynamicCstr.Values_.makeAxisValueObject_=function(){var b,a={};for(b in sre.DynamicCstr.Axis)a[sre.DynamicCstr.Axis[b]]={};return a},sre.DynamicCstr.getAxisValues=function(){return sre.DynamicCstr.Values_.getInstance().get()},sre.DynamicCstr.DEFAULT_ORDER=[sre.DynamicCstr.Axis.LOCALE,sre.DynamicCstr.Axis.MODALITY,sre.DynamicCstr.Axis.DOMAIN,sre.DynamicCstr.Axis.STYLE,sre.DynamicCstr.Axis.TOPIC],sre.DynamicCstr.DEFAULT_VALUE="default",sre.DynamicCstr.DEFAULT_VALUES={},sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE]="en",sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.DOMAIN]=sre.DynamicCstr.DEFAULT_VALUE,sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.STYLE]=sre.DynamicCstr.DEFAULT_VALUE,sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.TOPIC]=sre.DynamicCstr.DEFAULT_VALUE,sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.MODALITY]="speech",sre.DynamicCstr.Parser=function(a){this.order_=a},sre.DynamicCstr.Parser.prototype.parse=function(a){var b={};if((a=a.split(".")).length>this.order_.length)throw Error("Invalid dynamic constraint: "+b);for(var d,c=0;d=this.order_[c],a.length;c++){var e=a.shift();b[d]=e}return new sre.DynamicCstr(b,this.order_.slice(0,c))},sre.DynamicCstr.Comparator=function(){},sre.DynamicCstr.Comparator.prototype.getReference=function(){},sre.DynamicCstr.Comparator.prototype.setReference=function(a,b){},sre.DynamicCstr.Comparator.prototype.match=function(a){},sre.DynamicCstr.Comparator.prototype.compare=function(a,b){},sre.DynamicCstr.DefaultComparator=function(a,b){this.reference_=a,this.fallback_=b||new sre.DynamicProperties(a.getProperties(),a.getOrder()),this.order_=this.reference_.getOrder()},sre.DynamicCstr.DefaultComparator.prototype.getReference=function(){return this.reference_},sre.DynamicCstr.DefaultComparator.prototype.setReference=function(a,b){this.reference_=a,this.fallback_=b||new sre.DynamicProperties(a.getProperties(),a.getOrder()),this.order_=this.reference_.getOrder()},sre.DynamicCstr.DefaultComparator.prototype.match=function(a){var b=a.getAxes();return b.length===this.reference_.getAxes().length&&b.every(goog.bind(function(c){var d=a.getValue(c);return d===this.reference_.getValue(c)||-1!==this.fallback_.getProperty(c).indexOf(d)},this))},sre.DynamicCstr.DefaultComparator.prototype.compare=function(a,b){for(var e,c=!1,d=0;e=this.order_[d];d++){var f=a.getValue(e),g=b.getValue(e);if(!c){var h=this.reference_.getValue(e);if(h===f&&h!==g)return-1;if(h===g&&h!==f)return 1;if(h===f&&h===g)continue;h!==f&&h!==g&&(c=!0)}if((f=(e=this.fallback_.getProperty(e)).indexOf(f))<(g=e.indexOf(g)))return-1;if(g<f)return 1}return 0},sre.DynamicCstr.DefaultComparator.prototype.toString=function(){return this.reference_.toString()+"\n"+this.fallback_.toString()},sre.DynamicProperties.create=function(a){for(var b=sre.DynamicCstr.DEFAULT_ORDER,c={},d=Array.prototype.slice.call(arguments,0),e=0,f=d.length,g=b.length;e<f&&e<g;e++)c[b[e]]=d[e];return new sre.DynamicProperties(c)},sre.DynamicCstr.create=function(a){for(var b=sre.DynamicCstr.DEFAULT_ORDER,c={},d=Array.prototype.slice.call(arguments,0),e=0,f=d.length,g=b.length;e<f&&e<g;e++)c[b[e]]=d[e];return new sre.DynamicCstr(c)},sre.DynamicCstr.defaultCstr=function(){return sre.DynamicCstr.create.apply(null,sre.DynamicCstr.DEFAULT_ORDER.map(function(a){return sre.DynamicCstr.DEFAULT_VALUES[a]}))},sre.DynamicCstr.validOrder=function(a){var b=sre.DynamicCstr.DEFAULT_ORDER.slice();return a.every(function(c){return-1!==(c=b.indexOf(c))&&b.splice(c,1)})},sre.Engine=function(){this.evaluator=sre.Engine.defaultEvaluator,this.parser=this.defaultParser=new sre.DynamicCstr.Parser(sre.DynamicCstr.DEFAULT_ORDER),this.parsers={},this.dynamicCstr=sre.DynamicCstr.defaultCstr(),this.comparator=null,this.comparators={},this.domain="mathspeak",this.style=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.STYLE],this.locale=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE],this.modality=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.MODALITY],this.walker="Table",this.mode=sre.Engine.Mode.SYNC,this.speech=sre.Engine.Speech.NONE,this.structure=!1,this.ruleSets=[],this.markup=sre.Engine.Markup.NONE,this.isEdge=this.isIE=this.strict=!1,this.rate="100",this.pprint=!1,this.setupTests_=[],this.config=!1,this.prune=this.rules=""},goog.addSingletonGetter(sre.Engine),sre.Engine.personalityProps={PITCH:"pitch",RATE:"rate",VOLUME:"volume",PAUSE:"pause",JOIN:"join"},sre.Engine.Mode={SYNC:"sync",ASYNC:"async",HTTP:"http"},sre.Engine.Speech={NONE:"none",SHALLOW:"shallow",DEEP:"deep"},sre.Engine.Markup={NONE:"none",PUNCTUATION:"punctuation",SSML:"ssml",SSML_STEP:"ssml_step",ACSS:"acss",SABLE:"sable",VOICEXML:"voicexml"},sre.Engine.registerTest=function(a){sre.Engine.getInstance().setupTests_.push(a)},sre.Engine.isReady=function(){return sre.Engine.getInstance().setupTests_.every(function(a){return a()})},sre.Engine.prototype.setupBrowsers=function(){this.isIE=sre.BrowserUtil.detectIE(),this.isEdge=sre.BrowserUtil.detectEdge()},sre.Engine.prototype.getAxisValues=function(){return sre.DynamicCstr.getAxisValues()},sre.Engine.defaultEvaluator=function(a,b){return a},sre.Engine.prototype.getRate=function(){var a=parseInt(this.rate,10);return isNaN(a)?100:a},sre.Engine.Error=function(a){Error.call(this),this.message=a||"",this.name="SRE Error"},goog.inherits(sre.Engine.Error,Error),sre.Engine.BINARY_FEATURES=["strict","structure","pprint"],sre.Engine.STRING_FEATURES="markup style domain speech walker locale modality rate rules prune".split(" "),sre.Engine.prototype.setDynamicCstr=function(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;c++){var d=b[c];-1!==sre.DynamicCstr.DEFAULT_ORDER.indexOf(d)&&(this[d]=a[d])}sre.Engine.DOMAIN_TO_STYLES[this.domain]=this.style,a=[this.locale,this.modality,this.domain,this.style].join("."),b=sre.DynamicProperties.create([sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE]],[sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.MODALITY]],[sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.DOMAIN]],[sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.STYLE]]),c=this.comparators[this.domain],this.parser=(d=this.parsers[this.domain])||this.defaultParser,this.dynamicCstr=this.parser.parse(a),this.dynamicCstr.updateProperties(b.getProperties()),this.comparator=c?c():new sre.DynamicCstr.DefaultComparator(this.dynamicCstr)},sre.Engine.DOMAIN_TO_STYLES={mathspeak:"default",clearspeak:"default"},sre.BaseUtil={},sre.BaseUtil.removeEmpty=function(a){return a.filter(function(b){return b})},sre.BaseUtil.interleaveLists=function(a,b){for(var c=[];a.length||b.length;)a.length&&c.push(a.shift()),b.length&&c.push(b.shift());return c},sre.BaseUtil.setdifference=function(a,b){return a?b?a.filter(function(c){return b.indexOf(c)<0}):a:[]},sre.BaseUtil.union=function(a,b){return a&&b?a.concat(sre.BaseUtil.setdifference(b,a)):a||b||[]},sre.BaseUtil.makePath=function(a){return a.match("/$")?a:a+"/"},sre.Debugger=function(){this.isActive_=!1,this.outputFunction_=console.info,this.stream_=null},goog.addSingletonGetter(sre.Debugger),sre.Debugger.prototype.init=function(a){a&&this.startDebugFile_(a),this.isActive_=!0},sre.Debugger.prototype.startDebugFile_=function(a){this.stream_=sre.SystemExternal.fs.createWriteStream(a),this.outputFunction_=goog.bind(function(b){var c=Array.prototype.slice.call(arguments,0);this.stream_.write(c.join(" ")),this.stream_.write("\n")},this),this.stream_.on("error",goog.bind(function(b){console.info("Invalid log file. Debug information sent to console."),this.outputFunction_=console.info},this)),this.stream_.on("finish",function(){console.info("Finalizing debug file.")})},sre.Debugger.prototype.output_=function(a){this.outputFunction_.apply(console.info===this.outputFunction_?console:this.outputFunction_,["Speech Rule Engine Debugger:"].concat(a))},sre.Debugger.prototype.output=function(a){this.isActive_&&this.output_(Array.prototype.slice.call(arguments,0))},sre.Debugger.prototype.generateOutput=function(a){this.isActive_&&this.output_(a.apply(a,[]))},sre.Debugger.prototype.exit=function(a){this.isActive_&&this.stream_&&this.stream_.end("","",a||function(){})},sre.Grammar=function(){this.parameters_={},this.corrections_={},this.preprocessors_={},this.stateStack_=[],this.currentFlags={}},goog.addSingletonGetter(sre.Grammar),sre.Grammar.ATTRIBUTE="grammar",sre.Grammar.prototype.clear=function(){this.parameters_={},this.stateStack_=[]},sre.Grammar.prototype.setParameter=function(a,b){var c=this.parameters_[a];return b?this.parameters_[a]=b:delete this.parameters_[a],c},sre.Grammar.prototype.getParameter=function(a){return this.parameters_[a]},sre.Grammar.prototype.setCorrection=function(a,b){this.corrections_[a]=b},sre.Grammar.prototype.setPreprocessor=function(a,b){this.preprocessors_[a]=b},sre.Grammar.prototype.getCorrection=function(a){return this.corrections_[a]},sre.Grammar.prototype.getState=function(){var b,a=[];for(b in this.parameters_){var c=this.parameters_[b];a.push("string"==typeof c?b+":"+c:b)}return a.join(" ")},sre.Grammar.prototype.pushState=function(a){for(var b in a)a[b]=this.setParameter(b,a[b]);this.stateStack_.push(a)},sre.Grammar.prototype.popState=function(){var b,a=this.stateStack_.pop();for(b in a)this.setParameter(b,a[b])},sre.Grammar.prototype.setAttribute=function(a){var b;a&&a.nodeType===sre.DomUtil.NodeType.ELEMENT_NODE&&(b=this.getState())&&a.setAttribute(sre.Grammar.ATTRIBUTE,b)},sre.Grammar.prototype.preprocess=function(a){return this.runProcessors_(a,this.preprocessors_)},sre.Grammar.prototype.correct=function(a){return this.runProcessors_(a,this.corrections_)},sre.Grammar.prototype.runProcessors_=function(a,b){for(var c in this.parameters_){var d=b[c];d&&(a=!0===(c=this.parameters_[c])?d(a):d(a,c))}return a},sre.Grammar.translateString_=function(a){var b;return a.match(/:unit$/)?sre.Grammar.translateUnit_(a):null===(b=(b=sre.Engine.getInstance()).evaluator(a,b.dynamicCstr))?a:b},sre.Grammar.translateUnit_=function(a){a=sre.Grammar.prepareUnit_(a);var f,b=sre.Engine.getInstance(),c=sre.Grammar.getInstance().getParameter("plural"),d=b.strict,e=b.locale+"."+b.modality+".default";if(b.strict=!0,c&&(f=b.defaultParser.parse(e+".plural"),f=b.evaluator(a,f)),f)b.strict=d;else{if(f=b.defaultParser.parse(e+".default"),f=b.evaluator(a,f),b.strict=d,!f)return sre.Grammar.cleanUnit_(a);c&&(f=sre.Messages.PLURAL(f))}return f},sre.Grammar.prepareUnit_=function(a){var b=a.match(/:unit$/);return b?a.slice(0,b.index).replace(/\s+/g," ")+a.slice(b.index):a},sre.Grammar.cleanUnit_=function(a){return a.match(/:unit$/)?a.replace(/:unit$/,""):a},sre.Grammar.prototype.apply=function(a,b){return this.currentFlags=b||{},a=this.currentFlags.adjust||this.currentFlags.preprocess?sre.Grammar.getInstance().preprocess(a):a,(this.parameters_.translate||this.currentFlags.translate)&&(a=sre.Grammar.translateString_(a)),a=this.currentFlags.adjust||this.currentFlags.correct?sre.Grammar.getInstance().correct(a):a,this.currentFlags={},a},sre.Grammar.parseState=function(a){for(var b={},c=0,d=(a=a.split(" ")).length;c<d;c++){var e=a[c].split(":"),f=e[1];b[e[0]]=f||!0}return b},sre.Grammar.parseInput=function(a){for(var b={},c=0,d=(a=a.split(":")).length;c<d;c++){var e=a[c].split("="),f=e[0].trim();e[1]?b[f]=e[1].trim():f.match(/^!/)?b[f.slice(1)]=!1:b[f]=!0}return b},sre.Grammar.correctFont_=function(a,b){return b&&a?(b=sre.Messages.MS_FUNC.FONT_REGEXP(sre.Locale.localFont(b)),a.replace(b,"")):a},sre.Grammar.addAnnotation_=function(a,b){return a+":"+b},sre.Grammar.noTranslateText_=function(a){return a.match(new RegExp("^["+sre.Messages.REGEXP.TEXT+"]+$"))&&(sre.Grammar.getInstance().currentFlags.translate=!1),a},sre.Grammar.getInstance().setCorrection("ignoreFont",sre.Grammar.correctFont_),sre.Grammar.getInstance().setPreprocessor("annotation",sre.Grammar.addAnnotation_),sre.Grammar.getInstance().setPreprocessor("noTranslateText",sre.Grammar.noTranslateText_),sre.Grammar.getInstance().setCorrection("ignoreCaps",sre.Grammar.correctFont_),sre.XpathUtil={},sre.XpathUtil.xpathSupported=function(){return"undefined"!=typeof XPathResult},sre.XpathUtil.currentDocument=null,sre.XpathUtil.xpathEvaluate=(sre.XpathUtil.xpathSupported()?document:sre.SystemExternal.xpath).evaluate,sre.XpathUtil.xpathResult=sre.XpathUtil.xpathSupported()?XPathResult:sre.SystemExternal.xpath.XPathResult,sre.XpathUtil.createNSResolver=(sre.XpathUtil.xpathSupported()?document:sre.SystemExternal.xpath).createNSResolver,sre.XpathUtil.nameSpaces_={xhtml:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",mml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"},sre.XpathUtil.resolveNameSpace=function(a){return sre.XpathUtil.nameSpaces_[a]||null},sre.XpathUtil.resolver_=function(){this.lookupNamespaceURI=sre.XpathUtil.resolveNameSpace},sre.XpathUtil.evaluateXpath_=function(a,b,c){var d=sre.Engine.getInstance();return d.mode!==sre.Engine.Mode.HTTP||d.isIE||d.isEdge?sre.XpathUtil.xpathEvaluate(a,b,new sre.XpathUtil.resolver_,c,null):sre.XpathUtil.currentDocument.evaluate(a,b,sre.XpathUtil.resolveNameSpace,c,null)},sre.XpathUtil.evalXPath=function(a,b){try{var c=sre.XpathUtil.evaluateXpath_(a,b,sre.XpathUtil.xpathResult.ORDERED_NODE_ITERATOR_TYPE)}catch(d){return[]}for(a=[],b=c.iterateNext();b;b=c.iterateNext())a.push(b);return a},sre.XpathUtil.getLeafNodes=function(a){return sre.XpathUtil.evalXPath(".//*[count(*)=0]",a)},sre.XpathUtil.evaluateBoolean=function(a,b){try{var c=sre.XpathUtil.evaluateXpath_(a,b,sre.XpathUtil.xpathResult.BOOLEAN_TYPE)}catch(d){return!1}return c.booleanValue},sre.XpathUtil.evaluateString=function(a,b){try{var c=sre.XpathUtil.evaluateXpath_(a,b,sre.XpathUtil.xpathResult.STRING_TYPE)}catch(d){return""}return c.stringValue},sre.DomUtil={},sre.DomUtil.toArray=function(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b},sre.DomUtil.trimInput_=function(a){return(a=a.replace(/&nbsp;/g," ")).replace(/>[ \f\n\r\t\v\u200b]+</g,"><").trim()},sre.DomUtil.XML_ENTITIES={"&lt;":!0,"&gt;":!0,"&amp;":!0,"&quot;":!0,"&apos;":!0},sre.DomUtil.parseInput=function(a,b){b=b||sre.Engine.Error;var c=new sre.SystemExternal.xmldom.DOMParser,d=!!(a=sre.DomUtil.trimInput_(a)).match(/&(?!lt|gt|amp|quot|apos)\w+;/g);if(!a)throw new b("Empty input!");try{var e=c.parseFromString(a,d?"text/html":"text/xml");return sre.Engine.getInstance().mode===sre.Engine.Mode.HTTP&&(sre.XpathUtil.currentDocument=e,d)?e.body.childNodes[0]:e.documentElement}catch(f){throw new b("Illegal input: "+f.message)}},sre.DomUtil.NodeType={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},sre.DomUtil.replaceNode=function(a,b){a.parentNode&&(a.parentNode.insertBefore(b,a),a.parentNode.removeChild(a))},sre.DomUtil.createElement=function(a){return sre.SystemExternal.document.createElement(a)},sre.DomUtil.createElementNS=function(a,b){return sre.SystemExternal.document.createElementNS(a,b)},sre.DomUtil.createTextNode=function(a){return sre.SystemExternal.document.createTextNode(a)},sre.DomUtil.formatXml=function(a){var c,b="",d=0;for(a=(a=a.replace(/(>)(<)(\/*)/g,"$1\r\n$2$3")).split("\r\n"),c=/(\.)*(<)(\/*)/g,a=a.map(function(h){return h.replace(c,"$1\r\n$2$3").split("\r\n")}).reduce(function(h,k){return h.concat(k)},[]);a.length;){var f,g,e=a.shift();e&&(f=0,e.match(/^<\w[^>\/]*>[^>]+$/)?(g=sre.DomUtil.matchingStartEnd_(e,a[0]))[0]?g[1]?(e+=a.shift().slice(0,-g[1].length),g[1].trim()&&a.unshift(g[1])):e+=a.shift():f=1:e.match(/^<\/\w/)?0!=d&&--d:e.match(/^<\w[^>]*[^\/]>.*$/)?f=1:e.match(/^<\w[^>]*\/>.+$/)?(g=e.indexOf(">")+1,e.slice(g).trim()&&a.unshift(),e=e.slice(0,g)):f=0,b+=Array(d+1).join("  ")+e+"\r\n",d+=f)}return b},sre.DomUtil.matchingStartEnd_=function(a,b){return b&&(a=a.match(/^<([^> ]+).*>/),b=b.match(/^<\/([^>]+)>(.*)/),a)&&b&&a[1]===b[1]?[!0,b[2]]:[!1,""]},sre.DomUtil.dataAttribute=function(a){return(a=a.match(/^data-/)?a.substr(5):a).replace(/-([a-z])/g,function(b,c){return c.toUpperCase()})},sre.DomUtil.getDataAttribute=function(a,b){return a.dataset?a.dataset[sre.DomUtil.dataAttribute(b)]:a.getAttribute(b)},sre.DomUtil.querySelectorAllByAttr=function(a,b){return a.querySelectorAll?sre.DomUtil.toArray(a.querySelectorAll("["+b+"]")):sre.XpathUtil.evalXPath(".//*[@"+b+"]",a)},sre.DomUtil.querySelectorAllByAttrValue=function(a,b,c){return a.querySelectorAll?sre.DomUtil.toArray(a.querySelectorAll("["+b+'="'+c+'"]')):sre.XpathUtil.evalXPath(".//*[@"+b+'="'+c+'"]',a)},sre.DomUtil.querySelectorAll=function(a,b){return a.querySelectorAll?sre.DomUtil.toArray(a.querySelectorAll(b)):sre.XpathUtil.evalXPath(".//"+b,a)},sre.DomUtil.tagName=function(a){return a.tagName.toUpperCase()},sre.Numbers={},sre.Numbers.identityTransformer_=function(a){return a.toString()},sre.Numbers.pluralTransformer_=function(a,b){return a.toString()},sre.Numbers.NUMBERS={wordOrdinal:sre.Numbers.identityTransformer_,simpleOrdinal:sre.Numbers.identityTransformer_,numberToWords:sre.Numbers.identityTransformer_,numberToOrdinal:sre.Numbers.pluralTransformer_,vulgarSep:" ",numSep:" "},sre.Messages={},sre.Messages.MS={START:"",FRAC_V:"",FRAC_B:"",FRAC_S:"",END:"",FRAC_OVER:"",TWICE:"",NEST_FRAC:"",ENDFRAC:"",SUPER:"",SUB:"",SUP:"",SUPERSCRIPT:"",SUBSCRIPT:"",BASELINE:"",BASE:"",NESTED:"",NEST_ROOT:"",STARTROOT:"",ENDROOT:"",ROOTINDEX:"",ROOT:"",INDEX:"",UNDER:"",UNDERSCRIPT:"",OVER:"",OVERSCRIPT:""},sre.Messages.MS_FUNC={FRAC_NEST_DEPTH:function(a){return!1},RADICAL_NEST_DEPTH:function(a){return""},COMBINE_ROOT_INDEX:function(a,b){return a}},sre.Messages.MS_ROOT_INDEX={},sre.Messages.FONT={bold:"","bold-fraktur":"","bold-italic":"","bold-script":"",caligraphic:"","caligraphic-bold":"","double-struck":"","double-struck-italic":"",fraktur:"",italic:"",monospace:"",normal:"",oldstyle:"","oldstyle-bold":"",script:"","sans-serif":"","sans-serif-italic":"","sans-serif-bold":"","sans-serif-bold-italic":"",unknown:""},sre.Messages.EMBELLISH={super:"",sub:"",circled:"",parenthesized:"",period:"","negative-circled":"","double-circled":"","circled-sans-serif":"","negative-circled-sans-serif":"",blackboard:"",comma:"",squared:"","negative-squared":""},sre.Messages.ROLE={addition:"",multiplication:"",subtraction:"",division:"",equality:"",inequality:"",element:"",arrow:"",determinant:"",rowvector:"",binomial:"",squarematrix:"","set empty":"","set extended":"","set singleton":"","set collection":"",label:"",multiline:"",matrix:"",vector:"",cases:"",table:"",unknown:""},sre.Messages.ENCLOSE={longdiv:"",actuarial:"",radical:"",box:"",roundedbox:"",circle:"",left:"",right:"",top:"",bottom:"",updiagonalstrike:"",downdiagonalstrike:"",verticalstrike:"",horizontalstrike:"",madruwb:"",updiagonalarrow:"",phasorangle:"",unknown:""},sre.Messages.NAVIGATE={COLLAPSIBLE:"",EXPANDABLE:"",LEVEL:""},sre.Messages.REGEXP={TEXT:"a-zA-Z",NUMBER:"",DECIMAL_MARK:"",DIGIT_GROUP:"",JOINER_SUBSUPER:" "},sre.Messages.PLURAL_UNIT={},sre.Messages.PLURAL=function(a){return/.*s$/.test(a)?a:a+"s"},sre.Messages.UNIT_TIMES="",sre.Messages.NUMBERS=sre.Numbers.NUMBERS,sre.Messages.ALPHABETS={latinSmall:[],latinCap:[],greekSmall:[],greekCap:[]},sre.Messages.ALPHABET_PREFIXES={capPrefix:{default:""},smallPrefix:{default:""},digitPrefix:{default:""}},sre.Messages.identityTransformer_=function(a){return a.toString()},sre.Messages.ALPHABET_TRANSFORMERS={digit:{default:sre.Messages.identityTransformer_},letter:{default:sre.Messages.identityTransformer_}},sre.Messages.ALPHABET_COMBINER=function(a,b,c){return a},sre.Span=function(a,b){this.string=a,this.attributes=b},sre.NumbersUtil={},sre.NumbersUtil.ordinalCounter=function(a,b){var c=0;return function(){return sre.Messages.NUMBERS.simpleOrdinal(++c)+" "+b}},sre.NumbersUtil.convertVulgarFraction_=function(a){var b,c,d;return!a.childNodes||!a.childNodes[0]||!a.childNodes[0].childNodes||a.childNodes[0].childNodes.length<2||a.childNodes[0].childNodes[0].tagName!==sre.SemanticAttr.Type.NUMBER||a.childNodes[0].childNodes[0].getAttribute("role")!==sre.SemanticAttr.Role.INTEGER||a.childNodes[0].childNodes[1].tagName!==sre.SemanticAttr.Type.NUMBER||a.childNodes[0].childNodes[1].getAttribute("role")!==sre.SemanticAttr.Role.INTEGER?{convertible:!1,content:a.textContent}:(b=a.childNodes[0].childNodes[1].textContent,a=a.childNodes[0].childNodes[0].textContent,c=Number(b),d=Number(a),isNaN(c)||isNaN(d)?{convertible:!1,content:a+" "+sre.Messages.MS.FRAC_OVER+" "+b}:{convertible:!0,enumerator:d,denominator:c})},sre.NumbersUtil.vulgarFraction=function(a){var b=sre.NumbersUtil.convertVulgarFraction_(a);return b.convertible&&b.enumerator&&b.denominator?[new sre.Span(sre.Messages.NUMBERS.numberToWords(b.enumerator),{extid:a.childNodes[0].childNodes[0].getAttribute("extid"),separator:""}),new sre.Span(sre.Messages.NUMBERS.vulgarSep,{separator:""}),new sre.Span(sre.Messages.NUMBERS.numberToOrdinal(b.denominator,1!==b.enumerator),{extid:a.childNodes[0].childNodes[1].getAttribute("extid")})]:[new sre.Span(b.content||"",{extid:a.getAttribute("extid")})]},sre.NumbersUtil.vulgarFractionSmall=function(a,b,c){var d=sre.NumbersUtil.convertVulgarFraction_(a);return!!d.convertible&&(a=d.enumerator,d=d.denominator,0<a)&&a<b&&0<d&&d<c},sre.NumbersUtil.ordinalPosition=function(a){var b=sre.DomUtil.toArray(a.parentNode.childNodes);return sre.Messages.NUMBERS.simpleOrdinal(b.indexOf(a)+1).toString()},sre.SemanticUtil=function(){},sre.SemanticUtil.objectsToKeys=function(a){a=Array.prototype.slice.call(arguments,0);var b=[];return b.concat.apply(b,a.map(Object.keys))},sre.SemanticUtil.objectsToValues=function(a){a=Array.prototype.slice.call(arguments,0);var b=[];return a.forEach(function(c){for(var d in c)b.push(c[d])}),b},sre.SemanticUtil.unicodeToNumber=function(a){var b;return!a||2<a.length?null:2==a.length?(b=a.charCodeAt(0),a=a.charCodeAt(1),55296<=b&&b<=56319&&!isNaN(a)?1024*(b-55296)+(a-56320)+65536:null):a.charCodeAt(0)},sre.SemanticUtil.numberToUnicode=function(a){return a<65536?String.fromCharCode(a):String.fromCharCode((a-65536)/1024+55296,(a-65536)%1024+56320)},sre.SemanticUtil.splitUnicode=function(a){a=a.split("");for(var d,b=[],c=0;d=a[c];c++)"\ud800"<=d&&d<="\udbff"&&a[c+1]?b.push(d+a[++c]):b.push(d);return b},sre.SemanticUtil.LEAFTAGS="MO MI MN MTEXT MS MSPACE".split(" "),sre.SemanticUtil.IGNORETAGS="MERROR MPHANTOM MALIGNGROUP MALIGNMARK MPRESCRIPTS ANNOTATION ANNOTATION-XML".split(" "),sre.SemanticUtil.EMPTYTAGS="MATH MROW MPADDED MACTION NONE MSTYLE SEMANTICS".split(" "),sre.SemanticUtil.DISPLAYTAGS=["MROOT","MSQRT"],sre.SemanticUtil.hasMathTag=function(a){return!!a&&"MATH"===sre.DomUtil.tagName(a)},sre.SemanticUtil.hasLeafTag=function(a){return!!a&&-1!==sre.SemanticUtil.LEAFTAGS.indexOf(sre.DomUtil.tagName(a))},sre.SemanticUtil.hasIgnoreTag=function(a){return!!a&&-1!==sre.SemanticUtil.IGNORETAGS.indexOf(sre.DomUtil.tagName(a))},sre.SemanticUtil.hasEmptyTag=function(a){return!!a&&-1!==sre.SemanticUtil.EMPTYTAGS.indexOf(sre.DomUtil.tagName(a))},sre.SemanticUtil.hasDisplayTag=function(a){return!!a&&-1!==sre.SemanticUtil.DISPLAYTAGS.indexOf(sre.DomUtil.tagName(a))},sre.SemanticUtil.isOrphanedGlyph=function(a){return!!a&&"MGLYPH"===sre.DomUtil.tagName(a)&&!sre.SemanticUtil.hasLeafTag(a.parentNode)},sre.SemanticUtil.purgeNodes=function(a){for(var d,e,b=[],c=0;d=a[c];c++)d.nodeType===sre.DomUtil.NodeType.ELEMENT_NODE&&(e=sre.DomUtil.tagName(d),-1!=sre.SemanticUtil.IGNORETAGS.indexOf(e)||-1!=sre.SemanticUtil.EMPTYTAGS.indexOf(e)&&0==d.childNodes.length||b.push(d));return b},sre.SemanticUtil.isZeroLength=function(a){return!!a&&(-1!=="negativeveryverythinmathspace negativeverythinmathspace negativethinmathspace negativemediummathspace negativethickmathspace negativeverythickmathspace negativeveryverythickmathspace".split(" ").indexOf(a)||!!(a=a.match(/[0-9\.]+/))&&0===parseFloat(a))},sre.SemanticUtil.directSpeechKeys=["aria-label","exact-speech","alt"],sre.SemanticUtil.addAttributes=function(a,b){if(b.hasAttributes())for(var c=(b=b.attributes).length-1;0<=c;c--){var d=b[c].name;d.match(/^ext/)&&(a.attributes[d]=b[c].value,a.nobreaking=!0),-1!==sre.SemanticUtil.directSpeechKeys.indexOf(d)&&(a.attributes["ext-speech"]=b[c].value,a.nobreaking=!0),d.match(/texclass$/)&&(a.attributes.texclass=b[c].value),"href"===d&&(a.attributes.href=b[c].value,a.nobreaking=!0)}},sre.SemanticUtil.getEmbellishedInner=function(a){return a&&a.embellished&&0<a.childNodes.length?sre.SemanticUtil.getEmbellishedInner(a.childNodes[0]):a},sre.SemanticUtil.sliceNodes=function(a,b,c){c&&a.reverse();for(var f,d=[],e=0;f=a[e];e++){if(b(f))return c?{head:a.slice(e+1).reverse(),div:f,tail:d.reverse()}:{head:d,div:f,tail:a.slice(e+1)};d.push(f)}return c?{head:[],div:null,tail:d.reverse()}:{head:d,div:null,tail:[]}},sre.SemanticUtil.partitionNodes=function(a,b){var c=[],d=[];do{var e=sre.SemanticUtil.sliceNodes(a,b)}while(d.push(e.head),c.push(e.div),a=e.tail,e.div);return c.pop(),{rel:c,comp:d}},sre.SemanticAttr=function(){this.generalPunctuations='!"#%&;?@\\¡§¶¿‗†‡•‣․‥‧‰‱‸※‼‽‾⁁⁂⁃⁇⁈⁉⁋⁌⁍⁎⁏⁐⁑⁓⁕⁖⁘⁙⁚⁛⁜⁝⁞︐︔︕︖︰﹅﹆﹉﹊﹋﹌﹔﹖﹗﹟﹠﹡﹨﹪﹫！＂＃％＆＇＊／；？＠＼'.split(""),this.colons=["︓",":","：","﹕"],this.invisibleComma_=sre.SemanticUtil.numberToUnicode(8291),this.commas=["，","﹐",",",this.invisibleComma_],this.ellipses="…⋮⋯⋰⋱︙".split(""),this.fullStops=[".","﹒","．"],this.dashes="‒–—―〜︱︲﹘".split(""),this.primes="'′″‴‵‶‷⁗ʹʺ".split(""),this.degrees=["°"],this.openClosePairs={"(":")","[":"]","{":"}","⁅":"⁆","〈":"〉","❨":"❩","❪":"❫","❬":"❭","❮":"❯","❰":"❱","❲":"❳","❴":"❵","⟅":"⟆","⟦":"⟧","⟨":"⟩","⟪":"⟫","⟬":"⟭","⟮":"⟯","⦃":"⦄","⦅":"⦆","⦇":"⦈","⦉":"⦊","⦋":"⦌","⦍":"⦎","⦏":"⦐","⦑":"⦒","⦓":"⦔","⦕":"⦖","⦗":"⦘","⧘":"⧙","⧚":"⧛","⧼":"⧽","⸢":"⸣","⸤":"⸥","⸦":"⸧","⸨":"⸩","〈":"〉","《":"》","「":"」","『":"』","【":"】","〔":"〕","〖":"〗","〘":"〙","〚":"〛","〝":"〞","﴾":"﴿","︗":"︘","﹙":"﹚","﹛":"﹜","﹝":"﹞","（":"）","［":"］","｛":"｝","｟":"｠","｢":"｣","⌈":"⌉","⌊":"⌋","⌌":"⌍","⌎":"⌏","⌜":"⌝","⌞":"⌟","⎛":"⎞","⎜":"⎟","⎝":"⎠","⎡":"⎤","⎢":"⎥","⎣":"⎦","⎧":"⎫","⎨":"⎬","⎩":"⎭","⎰":"⎱","⎸":"⎹"},this.topBottomPairs={"⎴":"⎵","⏜":"⏝","⏞":"⏟","⏠":"⏡","︵":"︶","︷":"︸","︹":"︺","︻":"︼","︽":"︾","︿":"﹀","﹁":"﹂","﹃":"﹄","﹇":"﹈"},this.leftFences=sre.SemanticUtil.objectsToKeys(this.openClosePairs),this.rightFences=sre.SemanticUtil.objectsToValues(this.openClosePairs),this.rightFences.push("〟"),this.topFences=sre.SemanticUtil.objectsToKeys(this.topBottomPairs),this.bottomFences=sre.SemanticUtil.objectsToValues(this.topBottomPairs),this.neutralFences="|¦‖∣⏐⎸⎹∥❘⦀⫴｜￤".split(""),this.allFences=this.neutralFences.concat(this.leftFences,this.rightFences,this.topFences,this.bottomFences),this.capitalLatin="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),this.smallLatin="abcdefghijklmnopqrstuvwxyzıȷ".split(""),this.capitalLatinFullWidth="ＡＢＣＤＥＦＧＨＩＪＫＬＭＮＯＰＱＲＳＴＵＶＷＸＹＺ".split(""),this.smallLatinFullWidth="ａｂｃｄｅｆｇｈｉｊｋｌｍｎｏｐｑｒｓｔｕｖｗｘｙｚ".split(""),this.capitalLatinBold="𝐀 𝐁 𝐂 𝐃 𝐄 𝐅 𝐆 𝐇 𝐈 𝐉 𝐊 𝐋 𝐌 𝐍 𝐎 𝐏 𝐐 𝐑 𝐒 𝐓 𝐔 𝐕 𝐖 𝐗 𝐘 𝐙".split(" "),this.smallLatinBold="𝐚 𝐛 𝐜 𝐝 𝐞 𝐟 𝐠 𝐡 𝐢 𝐣 𝐤 𝐥 𝐦 𝐧 𝐨 𝐩 𝐪 𝐫 𝐬 𝐭 𝐮 𝐯 𝐰 𝐱 𝐲 𝐳".split(" "),this.capitalLatinItalic="𝐴 𝐵 𝐶 𝐷 𝐸 𝐹 𝐺 𝐻 𝐼 𝐽 𝐾 𝐿 𝑀 𝑁 𝑂 𝑃 𝑄 𝑅 𝑆 𝑇 𝑈 𝑉 𝑊 𝑋 𝑌 𝑍".split(" "),this.smallLatinItalic="𝑎 𝑏 𝑐 𝑑 𝑒 𝑓 𝑔 ℎ 𝑖 𝑗 𝑘 𝑙 𝑚 𝑛 𝑜 𝑝 𝑞 𝑟 𝑠 𝑡 𝑢 𝑣 𝑤 𝑥 𝑦 𝑧 𝚤 𝚥".split(" "),this.capitalLatinBoldItalic="𝑨 𝑩 𝑪 𝑫 𝑬 𝑭 𝑮 𝑯 𝑰 𝑱 𝑲 𝑳 𝑴 𝑵 𝑶 𝑷 𝑸 𝑹 𝑺 𝑻 𝑼 𝑽 𝑾 𝑿 𝒀 𝒁".split(" "),this.smallLatinBoldItalic="𝒂 𝒃 𝒄 𝒅 𝒆 𝒇 𝒈 𝒉 𝒊 𝒋 𝒌 𝒍 𝒎 𝒏 𝒐 𝒑 𝒒 𝒓 𝒔 𝒕 𝒖 𝒗 𝒘 𝒙 𝒚 𝒛".split(" "),this.capitalLatinScript="𝒜 ℬ 𝒞 𝒟 ℰ ℱ 𝒢 ℋ ℐ 𝒥 𝒦 ℒ ℳ 𝒩 𝒪 𝒫 𝒬 ℛ 𝒮 𝒯 𝒰 𝒱 𝒲 𝒳 𝒴 𝒵 ℘".split(" "),this.smallLatinScript="𝒶 𝒷 𝒸 𝒹 ℯ 𝒻 ℊ 𝒽 𝒾 𝒿 𝓀 𝓁 𝓂 𝓃 ℴ 𝓅 𝓆 𝓇 𝓈 𝓉 𝓊 𝓋 𝓌 𝓍 𝓎 𝓏 ℓ".split(" "),this.capitalLatinBoldScript="𝓐 𝓑 𝓒 𝓓 𝓔 𝓕 𝓖 𝓗 𝓘 𝓙 𝓚 𝓛 𝓜 𝓝 𝓞 𝓟 𝓠 𝓡 𝓢 𝓣 𝓤 𝓥 𝓦 𝓧 𝓨 𝓩".split(" "),this.smallLatinBoldScript="𝓪 𝓫 𝓬 𝓭 𝓮 𝓯 𝓰 𝓱 𝓲 𝓳 𝓴 𝓵 𝓶 𝓷 𝓸 𝓹 𝓺 𝓻 𝓼 𝓽 𝓾 𝓿 𝔀 𝔁 𝔂 𝔃".split(" "),this.capitalLatinFraktur="𝔄 𝔅 ℭ 𝔇 𝔈 𝔉 𝔊 ℌ ℑ 𝔍 𝔎 𝔏 𝔐 𝔑 𝔒 𝔓 𝔔 ℜ 𝔖 𝔗 𝔘 𝔙 𝔚 𝔛 𝔜 ℨ".split(" "),this.smallLatinFraktur="𝔞 𝔟 𝔠 𝔡 𝔢 𝔣 𝔤 𝔥 𝔦 𝔧 𝔨 𝔩 𝔪 𝔫 𝔬 𝔭 𝔮 𝔯 𝔰 𝔱 𝔲 𝔳 𝔴 𝔵 𝔶 𝔷".split(" "),this.capitalLatinDoubleStruck="𝔸 𝔹 ℂ 𝔻 𝔼 𝔽 𝔾 ℍ 𝕀 𝕁 𝕂 𝕃 𝕄 ℕ 𝕆 ℙ ℚ ℝ 𝕊 𝕋 𝕌 𝕍 𝕎 𝕏 𝕐 ℤ".split(" "),this.smallLatinDoubleStruck="𝕒 𝕓 𝕔 𝕕 𝕖 𝕗 𝕘 𝕙 𝕚 𝕛 𝕜 𝕝 𝕞 𝕟 𝕠 𝕡 𝕢 𝕣 𝕤 𝕥 𝕦 𝕧 𝕨 𝕩 𝕪 𝕫".split(" "),this.capitalLatinBoldFraktur="𝕬 𝕭 𝕮 𝕯 𝕰 𝕱 𝕲 𝕳 𝕴 𝕵 𝕶 𝕷 𝕸 𝕹 𝕺 𝕻 𝕼 𝕽 𝕾 𝕿 𝖀 𝖁 𝖂 𝖃 𝖄 𝖅".split(" "),this.smallLatinBoldFraktur="𝖆 𝖇 𝖈 𝖉 𝖊 𝖋 𝖌 𝖍 𝖎 𝖏 𝖐 𝖑 𝖒 𝖓 𝖔 𝖕 𝖖 𝖗 𝖘 𝖙 𝖚 𝖛 𝖜 𝖝 𝖞 𝖟".split(" "),this.capitalLatinSansSerif="𝖠 𝖡 𝖢 𝖣 𝖤 𝖥 𝖦 𝖧 𝖨 𝖩 𝖪 𝖫 𝖬 𝖭 𝖮 𝖯 𝖰 𝖱 𝖲 𝖳 𝖴 𝖵 𝖶 𝖷 𝖸 𝖹".split(" "),this.smallLatinSansSerif="𝖺 𝖻 𝖼 𝖽 𝖾 𝖿 𝗀 𝗁 𝗂 𝗃 𝗄 𝗅 𝗆 𝗇 𝗈 𝗉 𝗊 𝗋 𝗌 𝗍 𝗎 𝗏 𝗐 𝗑 𝗒 𝗓".split(" "),this.capitalLatinSansSerifBold="𝗔 𝗕 𝗖 𝗗 𝗘 𝗙 𝗚 𝗛 𝗜 𝗝 𝗞 𝗟 𝗠 𝗡 𝗢 𝗣 𝗤 𝗥 𝗦 𝗧 𝗨 𝗩 𝗪 𝗫 𝗬 𝗭".split(" "),this.smallLatinSansSerifBold="𝗮 𝗯 𝗰 𝗱 𝗲 𝗳 𝗴 𝗵 𝗶 𝗷 𝗸 𝗹 𝗺 𝗻 𝗼 𝗽 𝗾 𝗿 𝘀 𝘁 𝘂 𝘃 𝘄 𝘅 𝘆 𝘇".split(" "),this.capitalLatinSansSerifItalic="𝘈 𝘉 𝘊 𝘋 𝘌 𝘍 𝘎 𝘏 𝘐 𝘑 𝘒 𝘓 𝘔 𝘕 𝘖 𝘗 𝘘 𝘙 𝘚 𝘛 𝘜 𝘝 𝘞 𝘟 𝘠 𝘡".split(" "),this.smallLatinSansSerifItalic="𝘢 𝘣 𝘤 𝘥 𝘦 𝘧 𝘨 𝘩 𝘪 𝘫 𝘬 𝘭 𝘮 𝘯 𝘰 𝘱 𝘲 𝘳 𝘴 𝘵 𝘶 𝘷 𝘸 𝘹 𝘺 𝘻".split(" "),this.capitalLatinSansSerifBoldItalic="𝘼 𝘽 𝘾 𝘿 𝙀 𝙁 𝙂 𝙃 𝙄 𝙅 𝙆 𝙇 𝙈 𝙉 𝙊 𝙋 𝙌 𝙍 𝙎 𝙏 𝙐 𝙑 𝙒 𝙓 𝙔 𝙕".split(" "),this.smallLatinSansSerifBoldItalic="𝙖 𝙗 𝙘 𝙙 𝙚 𝙛 𝙜 𝙝 𝙞 𝙟 𝙠 𝙡 𝙢 𝙣 𝙤 𝙥 𝙦 𝙧 𝙨 𝙩 𝙪 𝙫 𝙬 𝙭 𝙮 𝙯".split(" "),this.capitalLatinMonospace="𝙰 𝙱 𝙲 𝙳 𝙴 𝙵 𝙶 𝙷 𝙸 𝙹 𝙺 𝙻 𝙼 𝙽 𝙾 𝙿 𝚀 𝚁 𝚂 𝚃 𝚄 𝚅 𝚆 𝚇 𝚈 𝚉".split(" "),this.smallLatinMonospace="𝚊 𝚋 𝚌 𝚍 𝚎 𝚏 𝚐 𝚑 𝚒 𝚓 𝚔 𝚕 𝚖 𝚗 𝚘 𝚙 𝚚 𝚛 𝚜 𝚝 𝚞 𝚟 𝚠 𝚡 𝚢 𝚣".split(" "),this.latinDoubleStruckItalic=["ⅅ","ⅆ","ⅇ","ⅈ","ⅉ"],this.capitalGreek="ΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩ".split(""),this.smallGreek="αβγδεζηθικλμνξοπρςστυφχψω".split(""),this.capitalGreekBold="𝚨 𝚩 𝚪 𝚫 𝚬 𝚭 𝚮 𝚯 𝚰 𝚱 𝚲 𝚳 𝚴 𝚵 𝚶 𝚷 𝚸 𝚺 𝚻 𝚼 𝚽 𝚾 𝚿 𝛀".split(" "),this.smallGreekBold="𝛂 𝛃 𝛄 𝛅 𝛆 𝛇 𝛈 𝛉 𝛊 𝛋 𝛌 𝛍 𝛎 𝛏 𝛐 𝛑 𝛒 𝛓 𝛔 𝛕 𝛖 𝛗 𝛘 𝛙 𝛚".split(" "),this.capitalGreekItalic="𝛢 𝛣 𝛤 𝛥 𝛦 𝛧 𝛨 𝛩 𝛪 𝛫 𝛬 𝛭 𝛮 𝛯 𝛰 𝛱 𝛲 𝛴 𝛵 𝛶 𝛷 𝛸 𝛹 𝛺".split(" "),this.smallGreekItalic="𝛼 𝛽 𝛾 𝛿 𝜀 𝜁 𝜂 𝜃 𝜄 𝜅 𝜆 𝜇 𝜈 𝜉 𝜊 𝜋 𝜌 𝜍 𝜎 𝜏 𝜐 𝜑 𝜒 𝜓 𝜔".split(" "),this.capitalGreekBoldItalic="𝜜 𝜝 𝜞 𝜟 𝜠 𝜡 𝜢 𝜣 𝜤 𝜥 𝜦 𝜧 𝜨 𝜩 𝜪 𝜫 𝜬 𝜮 𝜯 𝜰 𝜱 𝜲 𝜳 𝜴".split(" "),this.smallGreekBoldItalic="𝜶 𝜷 𝜸 𝜹 𝜺 𝜻 𝜼 𝜽 𝜾 𝜿 𝝀 𝝁 𝝂 𝝃 𝝄 𝝅 𝝆 𝝇 𝝈 𝝉 𝝊 𝝋 𝝌 𝝍 𝝎".split(" "),this.capitalGreekSansSerifBold="𝝖 𝝗 𝝘 𝝙 𝝚 𝝛 𝝜 𝝝 𝝞 𝝟 𝝠 𝝡 𝝢 𝝣 𝝤 𝝥 𝝦 𝝨 𝝩 𝝪 𝝫 𝝬 𝝭 𝝮".split(" "),this.smallGreekSansSerifBold="𝝰 𝝱 𝝲 𝝳 𝝴 𝝵 𝝶 𝝷 𝝸 𝝹 𝝺 𝝻 𝝼 𝝽 𝝾 𝝿 𝞀 𝞁 𝞂 𝞃 𝞄 𝞅 𝞆 𝞇 𝞈".split(" "),this.capitalGreekSansSerifBoldItalic="𝞐 𝞑 𝞒 𝞓 𝞔 𝞕 𝞖 𝞗 𝞘 𝞙 𝞚 𝞛 𝞜 𝞝 𝞞 𝞟 𝞠 𝞢 𝞣 𝞤 𝞥 𝞦 𝞧 𝞨".split(" "),this.smallGreekSansSerifBoldItalic="𝞪 𝞫 𝞬 𝞭 𝞮 𝞯 𝞰 𝞱 𝞲 𝞳 𝞴 𝞵 𝞶 𝞷 𝞸 𝞹 𝞺 𝞻 𝞼 𝞽 𝞾 𝞿 𝟀 𝟁 𝟂".split(" "),this.greekDoubleStruck=["ℼ","ℽ","ℾ","ℿ"],this.greekSpecial="ϐϑϕϖϗϰϱϵ϶ϴ".split(""),this.greekSpecialBold="𝛜 𝛝 𝛞 𝛟 𝛠 𝛡".split(" "),this.greekSpecialItalic="𝜖 𝜗 𝜘 𝜙 𝜚 𝜛".split(" "),this.greekSpecialSansSerifBold="𝞊 𝞋 𝞌 𝞍 𝞎 𝞏".split(" "),this.hebrewLetters=["ℵ","ℶ","ℷ","ℸ"],this.allLetters=this.capitalLatin.concat(this.smallLatin,this.capitalLatinFullWidth,this.smallLatinFullWidth,this.capitalLatinBold,this.smallLatinBold,this.capitalLatinItalic,this.capitalLatinBoldItalic,this.smallLatinBoldItalic,this.smallLatinItalic,this.capitalLatinScript,this.smallLatinScript,this.capitalLatinBoldScript,this.smallLatinBoldScript,this.capitalLatinFraktur,this.smallLatinFraktur,this.capitalLatinDoubleStruck,this.smallLatinDoubleStruck,this.capitalLatinBoldFraktur,this.smallLatinBoldFraktur,this.capitalLatinSansSerif,this.smallLatinSansSerif,this.capitalLatinSansSerifBold,this.smallLatinSansSerifBold,this.capitalLatinSansSerifItalic,this.smallLatinSansSerifItalic,this.capitalLatinSansSerifBoldItalic,this.smallLatinSansSerifBoldItalic,this.capitalLatinMonospace,this.smallLatinMonospace,this.latinDoubleStruckItalic,this.capitalGreek,this.smallGreek,this.capitalGreekBold,this.smallGreekBold,this.capitalGreekItalic,this.smallGreekItalic,this.capitalGreekBoldItalic,this.smallGreekBoldItalic,this.capitalGreekSansSerifBold,this.smallGreekSansSerifBold,this.greekDoubleStruck,this.greekSpecial,this.capitalGreekSansSerifBoldItalic,this.smallGreekSansSerifBoldItalic,this.greekSpecialBold,this.greekSpecialItalic,this.greekSpecialSansSerifBold,this.hebrewLetters),this.additions="+±∓∔∧∨∩∪⊌⊍⊎⊓⊔⊝⊞⊤⊥⊺⊻⊼⋄⋎⋏⋒⋓⩞⊕⋔".split(""),this.invisiblePlus_=sre.SemanticUtil.numberToUnicode(8292),this.additions.push(this.invisiblePlus_),this.multiplications="†‡∐∗∘∙≀⊚⊛⊠⊡⋅⋆⋇⋈⋉⋊⋋⋌○·*⊗⊙".split(""),this.invisibleTimes_=sre.SemanticUtil.numberToUnicode(8290),this.multiplications.push(this.invisibleTimes_),this.subtractions="-⁒⁻₋−∖∸≂⊖⊟➖⨩⨪⨫⨬⨺⩁﹣－‐‑".split(""),this.divisions="/÷⁄∕⊘⟌⦼⨸".split(""),this.functionApplication_=sre.SemanticUtil.numberToUnicode(8289),this.equalities="=~⁼₌∼∽≃≅≈≊≋≌≍≎≑≒≓≔≕≖≗≘≙≚≛≜≝≞≟≡≣⧤⩦⩮⩯⩰⩱⩲⩳⩴⩵⩶⩷⩸⋕⩭⩪⩫⩬﹦＝⩬⊜∷".split(""),this.inequalities="<>≁≂≄≆≇≉≏≐≠≢≤≥≦≧≨≩≪≫≬≭≮≯≰≱≲≳≴≵≶≷≸≹≺≻≼≽≾≿⊀⊁⋖⋗⋘⋙⋚⋛⋜⋝⋞⋟⋠⋡⋦⋧⋨⋩⩹⩺⩻⩼⩽⩾⩿⪀⪁⪂⪃⪄⪅⪆⪇⪈⪉⪊⪋⪌⪍⪎⪏⪐⪑⪒⪓⪔⪕⪖⪗⪘⪙⪚⪛⪜⪝⪞⪟⪠⪡⪢⪣⪤⪥⪦⪧⪨⪩⪪⪫⪬⪭⪮⪯⪰⪱⪲⪳⪴⪵⪶⪷⪸⪹⪺⪻⪼⫷⫸⫹⫺⧀⧁﹤﹥＜＞".split(""),this.setRelations="⋢⋣⋤⋥⊂⊃⊄⊅⊆⊇⊈⊉⊊⊋⊏⊐⊑⊒⪽⪾⪿⫀⫁⫂⫃⫄⫅⫆⫇⫈⫉⫊⫋⫌⫍⫎⫏⫐⫑⫒⫓⫔⫕⫖⫗⫘⋐⋑⋪⋫⋬⋭⊲⊳⊴⊵".split(""),this.elementRelations="∈∉∊∋∌∍⋲⋳⋴⋵⋶⋷⋸⋹⋺⋻⋼⋽⋾⋿".split(""),this.relations="⊢⊣⊦⊧⊨⊩⊪⊫⊬⊭⊮⊯⫞⫟⫠⫡⫢⫣⫤⫥⫦⫧⫨⫩⫪⫫⫬⫭".split(""),this.arrows="←↑→↓↔↕↖↗↘↙↚↛↜↝↞↟↠↡↢↣↤↥↦↧↨↩↪↫↬↭↮↯↰↱↲↳↴↵↶↷↸↹↺↻⇄⇅⇆⇇⇈⇉⇊⇍⇎⇏⇐⇑⇒⇓⇔⇕⇖⇗⇘⇙⇚⇛⇜⇝⇞⇟⇠⇡⇢⇣⇤⇥⇦⇧⇨⇩⇪⇫⇬⇭⇮⇯⇰⇱⇲⇳⇴⇵⇶⇷⇸⇹⇺⇻⇼⇽⇾⇿⌁⌃⌄⌤⎋➔➘➙➚➛➜➝➞➟➠➡➢➣➤➥➦➧➨➩➪➫➬➭➮➯➱➲➳➴➵➶➷➸➹➺➻➼➽➾⟰⟱⟲⟳⟴⟵⟶⟷⟸⟹⟺⟻⟼⟽⟾⟿⤀⤁⤂⤃⤄⤅⤆⤇⤈⤉⤊⤋⤌⤍⤎⤏⤐⤑⤒⤓⤔⤕⤖⤗⤘⤙⤚⤛⤜⤝⤞⤟⤠⤡⤢⤣⤤⤥⤦⤧⤨⤩⤪⤭⤮⤯⤰⤱⤲⤳⤴⤵⤶⤷⤸⤹⤺⤻⤼⤽⤾⤿⥀⥁⥂⥃⥄⥅⥆⥇⥈⥉⥰⥱⥲⥳⥴⥵⥶⥷⥸⥹⥺⥻⦳⦴⦽⧪⧬⧭⨗⬀⬁⬂⬃⬄⬅⬆⬇⬈⬉⬊⬋⬌⬍⬎⬏⬐⬑⬰⬱⬲⬳⬴⬵⬶⬷⬸⬹⬺⬻⬼⬽⬾⬿⭀⭁⭂⭃⭄⭅⭆⭇⭈⭉⭊⭋⭌￩￪￫￬↼↽↾↿⇀⇁⇂⇃⇋⇌⥊⥋⥌⥍⥎⥏⥐⥑⥒⥓⥔⥕⥖⥗⥘⥙⥚⥛⥜⥝⥞⥟⥠⥡⥢⥣⥤⥥⥦⥧⥨⥩⥪⥫⥬⥭⥮⥯⥼⥽⥾⥿".split(""),this.sumOps="⅀∏∐∑⋀⋁⋂⋃⨀⨁⨂⨃⨄⨅⨆⨇⨈⨉⨊⨋⫼⫿".split(""),this.intOps="∫∬∭∮∯∰∱∲∳⨌⨍⨎⨏⨐⨑⨒⨓⨔⨕⨖⨗⨘⨙⨚⨛⨜".split(""),this.geometryOps="∟∠∡∢⊾⊿△▷▽◁".split(""),this.prefixOps="∀∃∆∇∂∁∄".split(""),this.prefixOpsBold=["𝛁","𝛛","𝟊","𝟋"],this.prefixOpsItalic=["𝛻","𝜕"],this.prefixOpsSansSerifBold=["𝝯","𝞉"],this.operatorBits="⌠⌡⎶⎪⎮⎯⎲⎳⎷".split(""),this.digitsNormal="0123456789".split(""),this.digitsFullWidth="０１２３４５６７８９".split(""),this.digitsBold="𝟎 𝟏 𝟐 𝟑 𝟒 𝟓 𝟔 𝟕 𝟖 𝟗".split(" "),this.digitsDoubleStruck="𝟘 𝟙 𝟚 𝟛 𝟜 𝟝 𝟞 𝟟 𝟠 𝟡".split(" "),this.digitsSansSerif="𝟢 𝟣 𝟤 𝟥 𝟦 𝟧 𝟨 𝟩 𝟪 𝟫".split(" "),this.digitsSansSerifBold="𝟬 𝟭 𝟮 𝟯 𝟰 𝟱 𝟲 𝟳 𝟴 𝟵".split(" "),this.digitsMonospace="𝟶 𝟷 𝟸 𝟹 𝟺 𝟻 𝟼 𝟽 𝟾 𝟿".split(" "),this.digitsSuperscript="²³¹⁰⁴⁵⁶⁷⁸⁹".split(""),this.digitsSubscript="₀₁₂₃₄₅₆₇₈₉".split(""),this.fractions="¼½¾⅐⅑⅒⅓⅔⅕⅖⅗⅘⅙⅚⅛⅜⅝⅞⅟↉".split(""),this.enclosedNumbers="①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳⓪⓫⓬⓭⓮⓯⓰⓱⓲⓳⓴⓵⓶⓷⓸⓹⓺⓻⓼⓽⓾⓿❶❷❸❹❺❻❼❽❾❿➀➁➂➃➄➅➆➇➈➉➊➋➌➍➎➏➐➑➒➓㉈㉉㉊㉋㉌㉍㉎㉏㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲㊳㊴㊵㊶㊷㊸㊹㊺㊻㊼㊽㊾㊿".split(""),this.fencedNumbers="⑴⑵⑶⑷⑸⑹⑺⑻⑼⑽⑾⑿⒀⒁⒂⒃⒄⒅⒆⒇".split(""),this.punctuatedNumbers="⒈ ⒉ ⒊ ⒋ ⒌ ⒍ ⒎ ⒏ ⒐ ⒑ ⒒ ⒓ ⒔ ⒕ ⒖ ⒗ ⒘ ⒙ ⒚ ⒛ 🄀 🄁 🄂 🄃 🄄 🄅 🄆 🄇 🄈 🄉 🄊".split(" "),this.digits=this.digitsNormal.concat(this.digitsFullWidth,this.digitsBold,this.digitsDoubleStruck,this.digitsSansSerif,this.digitsSansSerifBold,this.digitsMonospace),this.numbers=this.fractions,this.otherNumbers=this.digitsSuperscript.concat(this.digitsSubscript,this.enclosedNumbers,this.fencedNumbers,this.punctuatedNumbers),this.allNumbers=this.digits.concat(this.numbers,this.otherNumbers),this.trigonometricFunctions="cos;cot;csc;sec;sin;tan;arccos;arccot;arccsc;arcsec;arcsin;arctan;arc cos;arc cot;arc csc;arc sec;arc sin;arc tan".split(";"),this.hyperbolicFunctions="cosh coth csch sech sinh tanh arcosh arcoth arcsch arsech arsinh artanh arccosh arccoth arccsch arcsech arcsinh arctanh".split(" "),this.algebraicFunctions="deg det dim hom ker Tr tr".split(" "),this.elementaryFunctions="log ln lg exp expt gcd gcd arg im re Pr".split(" "),this.prefixFunctions=this.trigonometricFunctions.concat(this.hyperbolicFunctions,this.algebraicFunctions,this.elementaryFunctions),this.limitFunctions="inf;lim;liminf;limsup;max;min;sup;injlim;projlim;inj lim;proj lim".split(";"),this.infixFunctions=["mod","rem"],this.symbolSetToSemantic_=[{set:this.generalPunctuations,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.UNKNOWN},{set:this.colons,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.COLON},{set:this.commas,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.COMMA},{set:this.ellipses,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.ELLIPSIS},{set:this.fullStops,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.FULLSTOP},{set:this.dashes,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.DASH},{set:this.primes,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.PRIME},{set:this.degrees,type:sre.SemanticAttr.Type.PUNCTUATION,role:sre.SemanticAttr.Role.DEGREE},{set:this.leftFences,type:sre.SemanticAttr.Type.FENCE,role:sre.SemanticAttr.Role.OPEN},{set:this.rightFences,type:sre.SemanticAttr.Type.FENCE,role:sre.SemanticAttr.Role.CLOSE},{set:this.topFences,type:sre.SemanticAttr.Type.FENCE,role:sre.SemanticAttr.Role.TOP},{set:this.bottomFences,type:sre.SemanticAttr.Type.FENCE,role:sre.SemanticAttr.Role.BOTTOM},{set:this.neutralFences,type:sre.SemanticAttr.Type.FENCE,role:sre.SemanticAttr.Role.NEUTRAL},{set:this.smallLatin,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.capitalLatin,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.smallLatinFullWidth,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.capitalLatinFullWidth,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.smallLatinBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLD},{set:this.capitalLatinBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLD},{set:this.smallLatinItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.ITALIC},{set:this.capitalLatinItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.ITALIC},{set:this.smallLatinBoldItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLDITALIC},{set:this.capitalLatinBoldItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLDITALIC},{set:this.smallLatinScript,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SCRIPT},{set:this.capitalLatinScript,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SCRIPT},{set:this.smallLatinBoldScript,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLDSCRIPT},{set:this.capitalLatinBoldScript,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLDSCRIPT},{set:this.smallLatinFraktur,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.FRAKTUR},{set:this.capitalLatinFraktur,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.FRAKTUR},{set:this.smallLatinDoubleStruck,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.DOUBLESTRUCK},{set:this.capitalLatinDoubleStruck,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.DOUBLESTRUCK},{set:this.smallLatinBoldFraktur,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLDFRAKTUR},{set:this.capitalLatinBoldFraktur,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.BOLDFRAKTUR},{set:this.smallLatinSansSerif,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIF},{set:this.capitalLatinSansSerif,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIF},{set:this.smallLatinSansSerifBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.capitalLatinSansSerifBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.smallLatinSansSerifItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIFITALIC},{set:this.capitalLatinSansSerifItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIFITALIC},{set:this.smallLatinSansSerifBoldItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLDITALIC},{set:this.capitalLatinSansSerifBoldItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLDITALIC},{set:this.smallLatinMonospace,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.MONOSPACE},{set:this.capitalLatinMonospace,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.MONOSPACE},{set:this.latinDoubleStruckItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.LATINLETTER,font:sre.SemanticAttr.Font.DOUBLESTRUCKITALIC},{set:this.smallGreek,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.capitalGreek,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.smallGreekBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.BOLD},{set:this.capitalGreekBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.BOLD},{set:this.smallGreekItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.ITALIC},{set:this.capitalGreekItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.ITALIC},{set:this.smallGreekBoldItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.BOLDITALIC},{set:this.capitalGreekBoldItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.BOLDITALIC},{set:this.smallGreekSansSerifBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.capitalGreekSansSerifBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.capitalGreekSansSerifBoldItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLDITALIC},{set:this.smallGreekSansSerifBoldItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLDITALIC},{set:this.greekDoubleStruck,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.DOUBLESTRUCK},{set:this.greekSpecial,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.greekSpecialBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.BOLD},{set:this.greekSpecialItalic,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.ITALIC},{set:this.greekSpecialSansSerifBold,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.GREEKLETTER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.hebrewLetters,type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.OTHERLETTER,font:sre.SemanticAttr.Font.NORMAL},{set:this.digitsNormal,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.NORMAL},{set:this.digitsFullWidth,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.NORMAL},{set:this.digitsBold,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.BOLD},{set:this.digitsDoubleStruck,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.DOUBLESTRUCK},{set:this.digitsSansSerif,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.SANSSERIF},{set:this.digitsSansSerifBold,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.digitsMonospace,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.INTEGER,font:sre.SemanticAttr.Font.MONOSPACE},{set:this.numbers,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.FLOAT},{set:this.otherNumbers,type:sre.SemanticAttr.Type.NUMBER,role:sre.SemanticAttr.Role.OTHERNUMBER},{set:this.additions,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.ADDITION},{set:this.multiplications,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.MULTIPLICATION},{set:this.subtractions,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.SUBTRACTION},{set:this.divisions,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.DIVISION},{set:this.prefixOps,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.PREFIXOP},{set:this.prefixOpsBold,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.PREFIXOP,font:sre.SemanticAttr.Font.BOLD},{set:this.prefixOpsItalic,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.PREFIXOP,font:sre.SemanticAttr.Font.ITALIC},{set:this.prefixOpsSansSerifBold,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.PREFIXOP,font:sre.SemanticAttr.Font.SANSSERIFBOLD},{set:this.equalities,type:sre.SemanticAttr.Type.RELATION,role:sre.SemanticAttr.Role.EQUALITY},{set:this.inequalities,type:sre.SemanticAttr.Type.RELATION,role:sre.SemanticAttr.Role.INEQUALITY},{set:this.setRelations,type:sre.SemanticAttr.Type.RELATION,role:sre.SemanticAttr.Role.SET},{set:this.elementRelations,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.ELEMENT},{set:this.relations,type:sre.SemanticAttr.Type.RELATION,role:sre.SemanticAttr.Role.UNKNOWN},{set:this.arrows,type:sre.SemanticAttr.Type.RELATION,role:sre.SemanticAttr.Role.ARROW},{set:this.sumOps,type:sre.SemanticAttr.Type.LARGEOP,role:sre.SemanticAttr.Role.SUM},{set:this.intOps,type:sre.SemanticAttr.Type.LARGEOP,role:sre.SemanticAttr.Role.INTEGRAL},{set:this.geometryOps,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.GEOMETRY},{set:this.limitFunctions,type:sre.SemanticAttr.Type.FUNCTION,role:sre.SemanticAttr.Role.LIMFUNC},{set:this.prefixFunctions,type:sre.SemanticAttr.Type.FUNCTION,role:sre.SemanticAttr.Role.PREFIXFUNC},{set:this.infixFunctions,type:sre.SemanticAttr.Type.OPERATOR,role:sre.SemanticAttr.Role.PREFIXFUNC}],this.meaning_=this.initMeaning_()},goog.addSingletonGetter(sre.SemanticAttr),sre.SemanticAttr.Type={PUNCTUATION:"punctuation",FENCE:"fence",NUMBER:"number",IDENTIFIER:"identifier",TEXT:"text",OPERATOR:"operator",RELATION:"relation",LARGEOP:"largeop",FUNCTION:"function",ACCENT:"accent",FENCED:"fenced",FRACTION:"fraction",PUNCTUATED:"punctuated",RELSEQ:"relseq",MULTIREL:"multirel",INFIXOP:"infixop",PREFIXOP:"prefixop",POSTFIXOP:"postfixop",APPL:"appl",INTEGRAL:"integral",BIGOP:"bigop",SQRT:"sqrt",ROOT:"root",LIMUPPER:"limupper",LIMLOWER:"limlower",LIMBOTH:"limboth",SUBSCRIPT:"subscript",SUPERSCRIPT:"superscript",UNDERSCORE:"underscore",OVERSCORE:"overscore",TENSOR:"tensor",TABLE:"table",MULTILINE:"multiline",MATRIX:"matrix",VECTOR:"vector",CASES:"cases",ROW:"row",LINE:"line",CELL:"cell",ENCLOSE:"enclose",INFERENCE:"inference",RULELABEL:"rulelabel",CONCLUSION:"conclusion",PREMISES:"premises",UNKNOWN:"unknown",EMPTY:"empty"},sre.SemanticAttr.Role={COMMA:"comma",ELLIPSIS:"ellipsis",FULLSTOP:"fullstop",DASH:"dash",PRIME:"prime",DEGREE:"degree",VBAR:"vbar",COLON:"colon",OPENFENCE:"openfence",CLOSEFENCE:"closefence",APPLICATION:"application",DUMMY:"dummy",UNIT:"unit",LABEL:"label",OPEN:"open",CLOSE:"close",TOP:"top",BOTTOM:"bottom",NEUTRAL:"neutral",LATINLETTER:"latinletter",GREEKLETTER:"greekletter",OTHERLETTER:"otherletter",NUMBERSET:"numbersetletter",INTEGER:"integer",FLOAT:"float",OTHERNUMBER:"othernumber",MIXED:"mixed",MULTIACCENT:"multiaccent",OVERACCENT:"overaccent",UNDERACCENT:"underaccent",UNDEROVER:"underover",SUBSUP:"subsup",LEFTSUB:"leftsub",LEFTSUPER:"leftsuper",RIGHTSUB:"rightsub",RIGHTSUPER:"rightsuper",LEFTRIGHT:"leftright",ABOVEBELOW:"abovebelow",SETEMPTY:"set empty",SETEXT:"set extended",SETSINGLE:"set singleton",SETCOLLECT:"set collection",STRING:"string",SPACE:"space",SEQUENCE:"sequence",ENDPUNCT:"endpunct",STARTPUNCT:"startpunct",TEXT:"text",NEGATIVE:"negative",POSITIVE:"positive",NEGATION:"negation",MULTIOP:"multiop",PREFIXOP:"prefix operator",POSTFIXOP:"postfix operator",LIMFUNC:"limit function",INFIXFUNC:"infix function",PREFIXFUNC:"prefix function",POSTFIXFUNC:"postfix function",SIMPLEFUNC:"simple function",COMPFUNC:"composed function",SUM:"sum",INTEGRAL:"integral",GEOMETRY:"geometry",ADDITION:"addition",MULTIPLICATION:"multiplication",SUBTRACTION:"subtraction",IMPLICIT:"implicit",DIVISION:"division",VULGAR:"vulgar",EQUALITY:"equality",INEQUALITY:"inequality",ELEMENT:"element",ARROW:"arrow",SET:"set",DETERMINANT:"determinant",ROWVECTOR:"rowvector",BINOMIAL:"binomial",SQUAREMATRIX:"squarematrix",CYCLE:"cycle",MULTILINE:"multiline",MATRIX:"matrix",VECTOR:"vector",CASES:"cases",TABLE:"table",PROOF:"proof",LEFT:"left",RIGHT:"right",UP:"up",DOWN:"down",FINAL:"final",SINGLE:"single",HYP:"hyp",AXIOM:"axiom",UNKNOWN:"unknown"},sre.SemanticAttr.Font={BOLD:"bold",BOLDFRAKTUR:"bold-fraktur",BOLDITALIC:"bold-italic",BOLDSCRIPT:"bold-script",CALIGRAPHIC:"caligraphic",CALIGRAPHICBOLD:"caligraphic-bold",DOUBLESTRUCK:"double-struck",DOUBLESTRUCKITALIC:"double-struck-italic",FRAKTUR:"fraktur",ITALIC:"italic",MONOSPACE:"monospace",NORMAL:"normal",OLDSTYLE:"oldstyle",OLDSTYLEBOLD:"oldstyle-bold",SCRIPT:"script",SANSSERIF:"sans-serif",SANSSERIFITALIC:"sans-serif-italic",SANSSERIFBOLD:"sans-serif-bold",SANSSERIFBOLDITALIC:"sans-serif-bold-italic",UNKNOWN:"unknown"},sre.SemanticAttr.equal=function(a,b){return a.type===b.type&&a.role===b.role&&a.font===b.font},sre.SemanticAttr.prototype.lookupType=function(a){return sre.SemanticAttr.Type.UNKNOWN},sre.SemanticAttr.prototype.lookupRole=function(a){return sre.SemanticAttr.Role.UNKNOWN},sre.SemanticAttr.lookupMeaning=function(a){return sre.SemanticAttr.getInstance().lookupMeaning_(a)},sre.SemanticAttr.invisibleTimes=function(){return sre.SemanticAttr.getInstance().invisibleTimes_},sre.SemanticAttr.invisiblePlus=function(){return sre.SemanticAttr.getInstance().invisiblePlus_},sre.SemanticAttr.invisibleComma=function(){return sre.SemanticAttr.getInstance().invisibleComma_},sre.SemanticAttr.functionApplication=function(){return sre.SemanticAttr.getInstance().functionApplication_},sre.SemanticAttr.isMatchingFenceRole=function(a,b){return a==sre.SemanticAttr.Role.OPEN&&b==sre.SemanticAttr.Role.CLOSE||a==sre.SemanticAttr.Role.NEUTRAL&&b==sre.SemanticAttr.Role.NEUTRAL||a==sre.SemanticAttr.Role.TOP&&b==sre.SemanticAttr.Role.BOTTOM},sre.SemanticAttr.isMatchingFence=function(a,b){return sre.SemanticAttr.getInstance().isMatchingFence_(a,b)},sre.SemanticAttr.isOpeningFence=function(a){return a==sre.SemanticAttr.Role.OPEN||a==sre.SemanticAttr.Role.NEUTRAL},sre.SemanticAttr.isClosingFence=function(a){return a==sre.SemanticAttr.Role.CLOSE||a==sre.SemanticAttr.Role.NEUTRAL},sre.SemanticAttr.isEmbellishedType=function(a){return a===sre.SemanticAttr.Type.OPERATOR||a===sre.SemanticAttr.Type.RELATION||a===sre.SemanticAttr.Type.FENCE||a===sre.SemanticAttr.Type.PUNCTUATION},sre.SemanticAttr.isCharacterD=function(a){return-1!="d ⅆ ｄ 𝐝 𝑑 𝒹 𝓭 𝔡 𝕕 𝖉 𝖽 𝗱 𝘥 𝚍".split(" ").indexOf(a)},sre.SemanticAttr.prototype.isMatchingFence_=function(a,b){return-1!=this.neutralFences.indexOf(a)?a==b:this.openClosePairs[a]==b||this.topBottomPairs[a]==b},sre.SemanticAttr.prototype.initMeaning_=function(){for(var c,a={},b=0;c=this.symbolSetToSemantic_[b];b++)c.set.forEach(function(d){a[d]={role:c.role||sre.SemanticAttr.Role.UNKNOWN,type:c.type||sre.SemanticAttr.Type.UNKNOWN,font:c.font||sre.SemanticAttr.Font.UNKNOWN}});return a},sre.SemanticAttr.prototype.lookupMeaning_=function(a){return this.meaning_[a]||{role:sre.SemanticAttr.Role.UNKNOWN,type:sre.SemanticAttr.Type.UNKNOWN,font:sre.SemanticAttr.Font.UNKNOWN}},sre.SemanticNode=function(a){this.id=a,this.mathml=[],this.parent=null,this.type=sre.SemanticAttr.Type.UNKNOWN,this.role=sre.SemanticAttr.Role.UNKNOWN,this.font=sre.SemanticAttr.Font.UNKNOWN,this.embellished=null,this.fencePointer="",this.childNodes=[],this.textContent="",this.mathmlTree=null,this.contentNodes=[],this.annotation={},this.attributes={},this.nobreaking=!1},sre.SemanticNode.prototype.querySelectorAll=function(a){for(var d,b=[],c=0;d=this.childNodes[c];c++)b=b.concat(d.querySelectorAll(a));for(c=0;d=this.contentNodes[c];c++)b=b.concat(d.querySelectorAll(a));return a(this)&&b.unshift(this),b},sre.SemanticNode.Attribute={EMBELLISHED:"embellished",FENCEPOINTER:"fencepointer",FONT:"font",ID:"id",ANNOTATION:"annotation",ROLE:"role",TYPE:"type",CHILDREN:"children",CONTENT:"content",TEXT:"$t"},sre.SemanticNode.prototype.xml=function(a,b){function c(e,f){f=f.map(function(k){return k.xml(a,b)}),e=a.createElementNS("",e);for(var h,g=0;h=f[g];g++)e.appendChild(h);return e}var d=a.createElementNS("",this.type);return b||this.xmlAttributes_(d),d.textContent=this.textContent,0<this.contentNodes.length&&d.appendChild(c(sre.SemanticNode.Attribute.CONTENT,this.contentNodes)),0<this.childNodes.length&&d.appendChild(c(sre.SemanticNode.Attribute.CHILDREN,this.childNodes)),d},sre.SemanticNode.prototype.toString=function(a){var b=new sre.SystemExternal.xmldom.XMLSerializer,c=(new sre.SystemExternal.xmldom.DOMParser).parseFromString("<snode/>","text/xml");return b.serializeToString(this.xml(c,a))},sre.SemanticNode.prototype.xmlAttributes_=function(a){for(var d,b=this.allAttributes(),c=0;d=b[c];c++)a.setAttribute(d[0],d[1]);this.addExternalAttributes_(a)},sre.SemanticNode.prototype.allAttributes=function(){var a=[];return a.push([sre.SemanticNode.Attribute.ROLE,this.role]),this.font!=sre.SemanticAttr.Font.UNKNOWN&&a.push([sre.SemanticNode.Attribute.FONT,this.font]),Object.keys(this.annotation).length&&a.push([sre.SemanticNode.Attribute.ANNOTATION,this.xmlAnnotation()]),this.embellished&&a.push([sre.SemanticNode.Attribute.EMBELLISHED,this.embellished]),this.fencePointer&&a.push([sre.SemanticNode.Attribute.FENCEPOINTER,this.fencePointer]),a.push([sre.SemanticNode.Attribute.ID,this.id]),a},sre.SemanticNode.prototype.addExternalAttributes_=function(a){for(var b in this.attributes)a.setAttribute(b,this.attributes[b])},sre.SemanticNode.prototype.xmlAnnotation=function(){var b,a=[];for(b in this.annotation)this.annotation[b].forEach(function(c){a.push(b+":"+c)});return a.join(";")},sre.SemanticNode.prototype.toJson=function(){var a={};a[sre.SemanticNode.Attribute.TYPE]=this.type;for(var d,b=this.allAttributes(),c=0;d=b[c];c++)a[d[0]]=d[1].toString();return this.textContent&&(a[sre.SemanticNode.Attribute.TEXT]=this.textContent),this.childNodes.length&&(a[sre.SemanticNode.Attribute.CHILDREN]=this.childNodes.map(function(e){return e.toJson()})),this.contentNodes.length&&(a[sre.SemanticNode.Attribute.CONTENT]=this.contentNodes.map(function(e){return e.toJson()})),a},sre.SemanticNode.prototype.updateContent=function(a,b){b=b?a.replace(/^[ \f\n\r\t\v\u200b]*/,"").replace(/[ \f\n\r\t\v\u200b]*$/,""):a.trim(),this.textContent!=(a=a&&!b?a:b)&&(b=sre.SemanticAttr.lookupMeaning(a),this.textContent=a,this.role=b.role,this.type=b.type,this.font=b.font)},sre.SemanticNode.prototype.addMathmlNodes=function(a){for(var c,b=0;c=a[b];b++)-1==this.mathml.indexOf(c)&&this.mathml.push(c)},sre.SemanticNode.prototype.removeMathmlNodes_=function(a){for(var d,b=this.mathml,c=0;d=a[c];c++)-1!=(d=b.indexOf(d))&&b.splice(d,1);this.mathml=b},sre.SemanticNode.prototype.appendChild=function(a){this.childNodes.push(a),this.addMathmlNodes(a.mathml),a.parent=this},sre.SemanticNode.prototype.replaceChild=function(a,b){var d,c=this.childNodes.indexOf(a);-1!=c&&(a.parent=null,(b.parent=this).childNodes[c]=b,c=a.mathml.filter(function(e){return-1==b.mathml.indexOf(e)}),d=b.mathml.filter(function(e){return-1==a.mathml.indexOf(e)}),this.removeMathmlNodes_(c),this.addMathmlNodes(d))},sre.SemanticNode.prototype.appendContentNode=function(a){a&&(this.contentNodes.push(a),this.addMathmlNodes(a.mathml),a.parent=this)},sre.SemanticNode.prototype.removeContentNode=function(a){a&&-1!=(a=this.contentNodes.indexOf(a))&&this.contentNodes.slice(a,1)},sre.SemanticNode.prototype.equals=function(a){if(!a||this.type!==a.type||this.role!==a.role||this.textContent!==a.textContent||this.childNodes.length!==a.childNodes.length||this.contentNodes.length!==a.contentNodes.length)return!1;for(var c,d,b=0;c=this.childNodes[b],d=a.childNodes[b];b++)if(!c.equals(d))return!1;for(b=0;c=this.contentNodes[b],d=a.contentNodes[b];b++)if(!c.equals(d))return!1;return!0},sre.SemanticNode.prototype.displayTree=function(){console.info(this.displayTree_(0))},sre.SemanticNode.prototype.displayTree_=function(a){a++;for(var e,b=Array(a).join("  "),c=(c=(c="")+("\n"+b+this.toString())+("\n"+b+"MathmlTree:"))+("\n"+b+this.mathmlTreeString_())+("\n"+b+"MathML:"),d=0;e=this.mathml[d];d++)c+="\n"+b+e.toString();return c+="\n"+b+"Begin Content",this.contentNodes.forEach(function(f){c+=f.displayTree_(a)}),c=c+("\n"+b+"End Content")+("\n"+b+"Begin Children"),this.childNodes.forEach(function(f){c+=f.displayTree_(a)}),c+="\n"+b+"End Children"},sre.SemanticNode.prototype.mathmlTreeString_=function(){return this.mathmlTree?this.mathmlTree.toString():"EMPTY"},sre.SemanticNode.prototype.addAnnotation=function(a,b){b&&this.addAnnotation_(a,b)},sre.SemanticNode.prototype.addAnnotation_=function(a,b){var c=this.annotation[a];c?c.push(b):this.annotation[a]=[b]},sre.SemanticNode.prototype.getAnnotation=function(a){return(a=this.annotation[a])||[]},sre.SemanticNode.prototype.hasAnnotation=function(a,b){return!!(a=this.annotation[a])&&-1!==a.indexOf(b)},sre.SemanticNode.prototype.parseAnnotation=function(a){for(var b=0,c=(a=a.split(";")).length;b<c;b++){var d=a[b].split(":");this.addAnnotation(d[0],d[1])}},sre.SemanticNode.prototype.meaning=function(){return{type:this.type,role:this.role,font:this.font}},sre.SemanticNode.fromXml=function(a){var b=parseInt(a.getAttribute("id"),10);return(b=new sre.SemanticNode(b)).type=a.tagName,sre.SemanticNode.setAttribute_(b,a,"role"),sre.SemanticNode.setAttribute_(b,a,"font"),sre.SemanticNode.setAttribute_(b,a,"embellished"),sre.SemanticNode.setAttribute_(b,a,"fencepointer","fencePointer"),a.getAttribute("annotation")&&b.parseAnnotation(a.getAttribute("annotation")),sre.SemanticUtil.addAttributes(b,a),sre.SemanticNode.processChildren_(b,a),b},sre.SemanticNode.setAttribute_=function(a,b,c,d){d=d||c,(b=b.getAttribute(c))&&(a[d]=b)},sre.SemanticNode.processChildren_=function(a,b){for(var d,c=(b=$jscomp.makeIterator(sre.DomUtil.toArray(b.childNodes))).next();!c.done;c=b.next())(c=c.value).nodeType===sre.DomUtil.NodeType.TEXT_NODE?a.textContent=c.textContent:((d=sre.DomUtil.toArray(c.childNodes).map(sre.SemanticNode.fromXml)).forEach(function(e){e.parent=a}),"CONTENT"===sre.DomUtil.tagName(c)?a.contentNodes=d:a.childNodes=d)},sre.SemanticAnnotator=function(a,b,c){this.domain=a,this.func=c,this.name=b,this.active=!1},sre.SemanticAnnotator.prototype.annotate=function(a){a.childNodes.forEach(goog.bind(this.annotate,this)),a.addAnnotation(this.domain,this.func(a))},sre.SemanticVisitor=function(a,b,c,d){this.domain=a,this.func=c,this.name=b,this.def=d||{},this.active=!1},sre.SemanticVisitor.prototype.visit=function(a,b){b=this.func(a,b),a.addAnnotation(this.domain,b[0]);for(var d,c=0;d=a.childNodes[c];c++)b=this.visit(d,b[1]);return b},sre.SemanticAnnotations=function(){this.annotators={},this.visitors={}},goog.addSingletonGetter(sre.SemanticAnnotations),sre.SemanticAnnotations.prototype.register=function(a){(a instanceof sre.SemanticAnnotator?this.annotators:this.visitors)[a.domain+":"+a.name]=a},sre.SemanticAnnotations.prototype.activate=function(a,b){(a=this.annotators[a=a+":"+b]||this.visitors[a])&&(a.active=!0)},sre.SemanticAnnotations.prototype.annotate=function(a){for(var b=$jscomp.makeIterator(Object.keys(this.annotators)),c=b.next();!c.done;c=b.next())c=c.value,this.annotators[c].active&&this.annotators[c].annotate(a);for(c=(b=$jscomp.makeIterator(Object.keys(this.visitors))).next();!c.done;c=b.next())c=c.value,this.visitors[c].active&&this.visitors[c].visit(a,Object.assign({},this.visitors[c].def))},sre.SemanticOrdering=function(){this.comparators=[]},goog.addSingletonGetter(sre.SemanticOrdering),sre.SemanticOrdering.prototype.add=function(a){this.comparators.push(a)},sre.SemanticOrdering.prototype.apply=function(a,b){for(var d,c=0;d=this.comparators[c];c++)if(0!==(d=d.compare(a,b)))return d;return 0},sre.SemanticOrdering.prototype.sort=function(a){a.sort(goog.bind(this.apply,this))},sre.SemanticOrdering.prototype.reduce=function(a){if(a.length<=1)return a;a=a.slice(),this.sort(a);var b=[];do{var c=a.pop()}while(b.push(c),c&&a.length&&0===this.apply(a[a.length-1],c));return b},sre.SemanticComparator=function(a,b){this.comparator=a,this.type=b||null,sre.SemanticOrdering.getInstance().add(this)},sre.SemanticComparator.prototype.compare=function(a,b){return this.type&&this.type===a.type&&this.type===b.type?this.comparator(a,b):0},sre.SemanticOrdering.simpleFunction=function(a,b){return a.role===sre.SemanticAttr.Role.SIMPLEFUNC?1:b.role===sre.SemanticAttr.Role.SIMPLEFUNC?-1:0},new sre.SemanticComparator(sre.SemanticOrdering.simpleFunction,sre.SemanticAttr.Type.IDENTIFIER),sre.SemanticDefault=function(){this.map_={}},sre.SemanticDefault.prototype.add=function(a,b){this.map_[sre.SemanticDefault.key_(a,b.font)]=b},sre.SemanticDefault.prototype.addNode=function(a){this.add(a.textContent,a.meaning())},sre.SemanticDefault.prototype.retrieve=function(a,b){return this.map_[sre.SemanticDefault.key_(a,b)]},sre.SemanticDefault.prototype.retrieveNode=function(a){return this.retrieve(a.textContent,a.font)},sre.SemanticDefault.key_=function(a,b){return b?a+":"+b:a},sre.SemanticDefault.prototype.size=function(){return Object.keys(this.map_).length},sre.SemanticCollator_=function(){this.map_={}},sre.SemanticCollator_.prototype.add=function(a,b){a=sre.SemanticDefault.key_(a,b.font);var c=this.map_[a];c?c.push(b):this.map_[a]=[b]},sre.SemanticCollator_.prototype.addNode=function(a){this.add(a.textContent,a)},sre.SemanticCollator_.prototype.retrieve=function(a,b){return this.map_[sre.SemanticDefault.key_(a,b)]},sre.SemanticCollator_.prototype.retrieveNode=function(a){return this.retrieve(a.textContent,a.font)},sre.SemanticCollator_.prototype.copyCollator=goog.abstractMethod,sre.SemanticCollator_.prototype.copy=function(){var b,a=this.copyCollator();for(b in this.map_)a.map_[b]=this.map_[b];return a},sre.SemanticCollator_.prototype.minimize=function(){for(var a in this.map_)1===this.map_[a].length&&delete this.map_[a]},sre.SemanticCollator_.prototype.reduce=function(){for(var a in this.map_)1!==this.map_[a].length&&(this.map_[a]=sre.SemanticOrdering.getInstance().reduce(this.map_[a]))},sre.SemanticCollator_.prototype.minimalCollator=function(){var b,a=this.copy();for(b in a.map_)1===a.map_[b].length&&delete a.map_[b];return a},sre.SemanticCollator_.prototype.isMultiValued=function(){for(var a in this.map_)if(1<this.map_[a].length)return!0;return!1},sre.SemanticCollator_.prototype.isEmpty=function(){return!Object.keys(this.map_).length},sre.SemanticNodeCollator=function(){sre.SemanticCollator_.call(this)},goog.inherits(sre.SemanticNodeCollator,sre.SemanticCollator_),sre.SemanticNodeCollator.prototype.copyCollator=function(){return new sre.SemanticNodeCollator},sre.SemanticNodeCollator.prototype.toString=function(){var b,a=[];for(b in this.map_){for(var g,c=Array(b.length+3).join(" "),d=this.map_[b],e=[],f=0;g=d[f];f++)e.push(g.toString());a.push(b+": "+e.join("\n"+c))}return a.join("\n")},sre.SemanticNodeCollator.prototype.collateMeaning=function(){var b,a=new sre.SemanticMeaningCollator;for(b in this.map_)a.map_[b]=this.map_[b].map(function(c){return c.meaning()});return a},sre.SemanticMeaningCollator=function(){sre.SemanticCollator_.call(this)},goog.inherits(sre.SemanticMeaningCollator,sre.SemanticCollator_),sre.SemanticMeaningCollator.prototype.copyCollator=function(){return new sre.SemanticMeaningCollator},sre.SemanticMeaningCollator.prototype.add=function(a,b){var c=this.retrieve(a,b.font);c&&c.find(function(d){return sre.SemanticAttr.equal(d,b)})||sre.SemanticMeaningCollator.superClass_.add.call(this,a,b)},sre.SemanticMeaningCollator.prototype.addNode=function(a){this.add(a.textContent,a.meaning())},sre.SemanticMeaningCollator.prototype.toString=function(){var b,a=[];for(b in this.map_){for(var g,c=Array(b.length+3).join(" "),d=this.map_[b],e=[],f=0;g=d[f];f++)e.push("{type: "+g.type+", role: "+g.role+", font: "+g.font+"}");a.push(b+": "+e.join("\n"+c))}return a.join("\n")},sre.SemanticMeaningCollator.prototype.default=function(){var b,a=new sre.SemanticDefault;for(b in this.map_)1===this.map_[b].length&&(a.map_[b]=this.map_[b][0]);return a},sre.SemanticMeaningCollator.prototype.newDefault=function(){var a=this.default(),b=(this.reduce(),this.default());return a.size()!==b.size()?b:null},sre.SemanticNodeFactory=function(){this.idCounter_=-1,this.leafMap=new sre.SemanticNodeCollator,this.defaultMap=new sre.SemanticDefault},sre.SemanticNodeFactory.prototype.createNode_=function(a){return void 0!==a?this.idCounter_=Math.max(this.idCounter_,a):a=++this.idCounter_,new sre.SemanticNode(a)},sre.SemanticNodeFactory.prototype.makeNode=function(a){return this.createNode_(a)},sre.SemanticNodeFactory.prototype.makeUnprocessed=function(a){var b=this.createNode_();return b.mathml=[a],b.mathmlTree=a,b},sre.SemanticNodeFactory.prototype.makeEmptyNode=function(){var a=this.createNode_();return a.type=sre.SemanticAttr.Type.EMPTY,a},sre.SemanticNodeFactory.prototype.makeContentNode=function(a){var b=this.createNode_();return b.updateContent(a),b},sre.SemanticNodeFactory.prototype.makeMultipleContentNodes=function(a,b){for(var c=[],d=0;d<a;d++)c.push(this.makeContentNode(b));return c},sre.SemanticNodeFactory.prototype.makeLeafNode=function(a,b){return a?((a=this.makeContentNode(a)).font=b||a.font,(b=this.defaultMap.retrieveNode(a))&&(a.type=b.type,a.role=b.role,a.font=b.font),this.leafMap.addNode(a),a):this.makeEmptyNode()},sre.SemanticNodeFactory.prototype.makeBranchNode=function(a,b,c,d){var e=this.createNode_();return d&&e.updateContent(d),e.type=a,e.childNodes=b,e.contentNodes=c,b.concat(c).forEach(function(f){(f.parent=e).addMathmlNodes(f.mathml)}),e},sre.SemanticParser=function(){},sre.SemanticParser.prototype.parse=function(a){},sre.SemanticParser.prototype.parseList=function(a){},sre.SemanticParser.prototype.getFactory=function(){},sre.SemanticParser.prototype.setFactory=function(a){},sre.SemanticParser.prototype.getType=function(){},sre.SemanticAbstractParser=function(a){this.type_=a,this.factory_=new sre.SemanticNodeFactory},sre.SemanticAbstractParser.prototype.getFactory=function(){return this.factory_},sre.SemanticAbstractParser.prototype.setFactory=function(a){this.factory_=a},sre.SemanticAbstractParser.prototype.getType=function(){return this.type_},sre.SemanticAbstractParser.prototype.parse=goog.abstractMethod,sre.SemanticAbstractParser.prototype.parseList=function(a){for(var d,b=[],c=0;d=a[c];c++)b.push(this.parse(d));return b},sre.SemanticPred={},sre.SemanticPred.isAttribute=function(a,b){return function(c){switch(c=c[a],a){case"role":var d=sre.SemanticAttr.Role[b];break;case"font":d=sre.SemanticAttr.Font[b];break;default:d=sre.SemanticAttr.Type[b]}return c===d}},sre.SemanticPred.isAccent=function(a){return sre.SemanticPred.isAttribute("type","FENCE")(a)||sre.SemanticPred.isAttribute("type","PUNCTUATION")(a)||sre.SemanticPred.isAttribute("type","OPERATOR")(a)&&!a.textContent.match(/\u221e|\u1ab2/)||sre.SemanticPred.isAttribute("type","RELATION")(a)||sre.SemanticPred.isAttribute("type","IDENTIFIER")(a)&&sre.SemanticPred.isAttribute("role","UNKNOWN")(a)&&!a.textContent.match(new RegExp(sre.SemanticAttr.getInstance().allLetters.join("|")+"|∞|᪲"))},sre.SemanticPred.isSimpleFunctionScope=function(a){return 0===(a=a.childNodes).length||!(1<a.length||(a=a[0]).type===sre.SemanticAttr.Type.INFIXOP&&(a.role!==sre.SemanticAttr.Role.IMPLICIT||a.childNodes.some(sre.SemanticPred.isAttribute("type","INFIXOP"))))},sre.SemanticPred.isPrefixFunctionBoundary=function(a){return sre.SemanticPred.isOperator(a)&&!sre.SemanticPred.isAttribute("role","DIVISION")(a)||sre.SemanticPred.isAttribute("type","APPL")(a)||sre.SemanticPred.isGeneralFunctionBoundary(a)},sre.SemanticPred.isBigOpBoundary=function(a){return sre.SemanticPred.isOperator(a)||sre.SemanticPred.isGeneralFunctionBoundary(a)},sre.SemanticPred.isIntegralDxBoundary=function(a,b){return!!b&&sre.SemanticPred.isAttribute("type","IDENTIFIER")(b)&&sre.SemanticAttr.isCharacterD(a.textContent)},sre.SemanticPred.isIntegralDxBoundarySingle=function(a){var b;return!!sre.SemanticPred.isAttribute("type","IDENTIFIER")(a)&&(b=a.textContent[0])&&a.textContent[1]&&sre.SemanticAttr.isCharacterD(b)},sre.SemanticPred.isGeneralFunctionBoundary=function(a){return sre.SemanticPred.isRelation(a)||sre.SemanticPred.isPunctuation(a)},sre.SemanticPred.isEmbellished=function(a){return a.embellished||(sre.SemanticAttr.isEmbellishedType(a.type)?a.type:null)},sre.SemanticPred.isOperator=function(a){return sre.SemanticPred.isAttribute("type","OPERATOR")(a)||sre.SemanticPred.isAttribute("embellished","OPERATOR")(a)},sre.SemanticPred.isRelation=function(a){return sre.SemanticPred.isAttribute("type","RELATION")(a)||sre.SemanticPred.isAttribute("embellished","RELATION")(a)},sre.SemanticPred.isPunctuation=function(a){return sre.SemanticPred.isAttribute("type","PUNCTUATION")(a)||sre.SemanticPred.isAttribute("embellished","PUNCTUATION")(a)},sre.SemanticPred.isFence=function(a){return sre.SemanticPred.isAttribute("type","FENCE")(a)||sre.SemanticPred.isAttribute("embellished","FENCE")(a)},sre.SemanticPred.isElligibleEmbellishedFence=function(a){var b;return!(!a||!sre.SemanticPred.isFence(a))&&(!a.embellished||(b=function(c){return!c.embellished||!(!(!sre.SemanticPred.isAttribute("type","TENSOR")(c)||sre.SemanticPred.isAttribute("type","EMPTY")(c.childNodes[1])&&sre.SemanticPred.isAttribute("type","EMPTY")(c.childNodes[2])||sre.SemanticPred.isAttribute("type","EMPTY")(c.childNodes[3])&&sre.SemanticPred.isAttribute("type","EMPTY")(c.childNodes[4]))||sre.SemanticPred.isAttribute("role","CLOSE")(c)&&sre.SemanticPred.isAttribute("type","TENSOR")(c)||sre.SemanticPred.isAttribute("role","OPEN")(c)&&(sre.SemanticPred.isAttribute("type","SUBSCRIPT")(c)||sre.SemanticPred.isAttribute("type","SUPERSCRIPT")(c)))&&b(c.childNodes[0])})(a))},sre.SemanticPred.isTableOrMultiline=function(a){return!!a&&(sre.SemanticPred.isAttribute("type","TABLE")(a)||sre.SemanticPred.isAttribute("type","MULTILINE")(a))},sre.SemanticPred.tableIsMatrixOrVector=function(a){return!!a&&sre.SemanticPred.isFencedElement(a)&&sre.SemanticPred.isTableOrMultiline(a.childNodes[0])},sre.SemanticPred.isFencedElement=function(a){return!!a&&sre.SemanticPred.isAttribute("type","FENCED")(a)&&(sre.SemanticPred.isAttribute("role","LEFTRIGHT")(a)||sre.SemanticPred.isAttribute("role","NEUTRAL")(a))&&1===a.childNodes.length},sre.SemanticPred.tableIsCases=function(a,b){return 0<b.length&&sre.SemanticPred.isAttribute("role","OPENFENCE")(b[b.length-1])},sre.SemanticPred.tableIsMultiline=function(a){return a.childNodes.every(function(b){return b.childNodes.length<=1})},sre.SemanticPred.isBinomial=function(a){return 2===a.childNodes.length},sre.SemanticPred.isLimitBase=function(a){return sre.SemanticPred.isAttribute("type","LARGEOP")(a)||sre.SemanticPred.isAttribute("type","LIMBOTH")(a)||sre.SemanticPred.isAttribute("type","LIMLOWER")(a)||sre.SemanticPred.isAttribute("type","LIMUPPER")(a)||sre.SemanticPred.isAttribute("type","FUNCTION")(a)&&sre.SemanticPred.isAttribute("role","LIMFUNC")(a)||(sre.SemanticPred.isAttribute("type","OVERSCORE")(a)||sre.SemanticPred.isAttribute("type","UNDERSCORE")(a))&&sre.SemanticPred.isLimitBase(a.childNodes[0])},sre.SemanticPred.isSimpleFunctionHead=function(a){return a.type===sre.SemanticAttr.Type.IDENTIFIER||a.role===sre.SemanticAttr.Role.LATINLETTER||a.role===sre.SemanticAttr.Role.GREEKLETTER||a.role===sre.SemanticAttr.Role.OTHERLETTER},sre.SemanticPred.singlePunctAtPosition=function(a,b,c){return 1===b.length&&(a[c].type===sre.SemanticAttr.Type.PUNCTUATION||a[c].embellished===sre.SemanticAttr.Type.PUNCTUATION)&&a[c]===b[0]},sre.SemanticPred.isSimpleFunction=function(a){return sre.SemanticPred.isAttribute("type","IDENTIFIER")(a)&&sre.SemanticPred.isAttribute("role","SIMPLEFUNC")(a)},sre.SemanticPred.isLeftBrace=function(a){return!!a&&-1!==["{","﹛","｛"].indexOf(a.textContent)},sre.SemanticPred.isRightBrace=function(a){return!!a&&-1!==["}","﹜","｝"].indexOf(a.textContent)},sre.SemanticPred.isSetNode=function(a){return sre.SemanticPred.isLeftBrace(a.contentNodes[0])&&sre.SemanticPred.isRightBrace(a.contentNodes[1])},sre.SemanticPred.illegalSingleton_=[sre.SemanticAttr.Type.PUNCTUATION,sre.SemanticAttr.Type.PUNCTUATED,sre.SemanticAttr.Type.RELSEQ,sre.SemanticAttr.Type.MULTIREL,sre.SemanticAttr.Type.TABLE,sre.SemanticAttr.Type.MULTILINE,sre.SemanticAttr.Type.CASES,sre.SemanticAttr.Type.INFERENCE],sre.SemanticPred.scriptedElement_=[sre.SemanticAttr.Type.LIMUPPER,sre.SemanticAttr.Type.LIMLOWER,sre.SemanticAttr.Type.LIMBOTH,sre.SemanticAttr.Type.SUBSCRIPT,sre.SemanticAttr.Type.SUPERSCRIPT,sre.SemanticAttr.Type.UNDERSCORE,sre.SemanticAttr.Type.OVERSCORE,sre.SemanticAttr.Type.TENSOR],sre.SemanticPred.isSingletonSetContent=function(a){var b=a.type;return-1===sre.SemanticPred.illegalSingleton_.indexOf(b)&&(b!==sre.SemanticAttr.Type.INFIXOP||a.role===sre.SemanticAttr.Role.IMPLICIT)&&(b===sre.SemanticAttr.Type.FENCED?a.role!==sre.SemanticAttr.Role.LEFTRIGHT||sre.SemanticPred.isSingletonSetContent(a.childNodes[0]):-1===sre.SemanticPred.scriptedElement_.indexOf(b)||sre.SemanticPred.isSingletonSetContent(a.childNodes[0]))},sre.SemanticPred.isNumber=function(a){return a.type===sre.SemanticAttr.Type.NUMBER&&(a.role===sre.SemanticAttr.Role.INTEGER||a.role===sre.SemanticAttr.Role.FLOAT)},sre.SemanticPred.isUnitCounter=function(a){return sre.SemanticPred.isNumber(a)||a.role===sre.SemanticAttr.Role.VULGAR||a.role===sre.SemanticAttr.Role.MIXED},sre.SemanticPred.isPureUnit=function(a){var b=a.childNodes;return a.role===sre.SemanticAttr.Role.UNIT&&(!b.length||b[0].role===sre.SemanticAttr.Role.UNIT)},sre.SemanticPred.isImplicit=function(a){return a.role===sre.SemanticAttr.Role.IMPLICIT||a.role===sre.SemanticAttr.Role.UNIT&&!!a.contentNodes.length&&a.contentNodes[0].textContent===sre.SemanticAttr.invisibleTimes()},sre.SemanticPred.isImplicitOp=function(a){return a.type===sre.SemanticAttr.Type.INFIXOP&&a.role===sre.SemanticAttr.Role.IMPLICIT},sre.SemanticPred.compareNeutralFences=function(a,b){return a.role===sre.SemanticAttr.Role.NEUTRAL&&b.role===sre.SemanticAttr.Role.NEUTRAL&&sre.SemanticUtil.getEmbellishedInner(a).textContent==sre.SemanticUtil.getEmbellishedInner(b).textContent},sre.SemanticPred.elligibleLeftNeutral=function(a){return a.role===sre.SemanticAttr.Role.NEUTRAL&&(!a.embellished||a.type!==sre.SemanticAttr.Type.SUPERSCRIPT&&a.type!==sre.SemanticAttr.Type.SUBSCRIPT&&(a.type!==sre.SemanticAttr.Type.TENSOR||a.childNodes[3].type===sre.SemanticAttr.Type.EMPTY&&a.childNodes[4].type===sre.SemanticAttr.Type.EMPTY))},sre.SemanticPred.elligibleRightNeutral=function(a){return a.role===sre.SemanticAttr.Role.NEUTRAL&&(!a.embellished||a.type!==sre.SemanticAttr.Type.TENSOR||a.childNodes[1].type===sre.SemanticAttr.Type.EMPTY&&a.childNodes[2].type===sre.SemanticAttr.Type.EMPTY)},sre.SemanticHeuristics=function(){this.factory=null,this.heuristics={},this.flags={combine_juxtaposition:!0,convert_juxtaposition:!0,multioperator:!0},this.blacklist={}},goog.addSingletonGetter(sre.SemanticHeuristics),sre.SemanticHeuristics.add=function(a,b){sre.SemanticHeuristics.getInstance().heuristics[a]=b,sre.SemanticHeuristics.getInstance().flags[a]||(sre.SemanticHeuristics.getInstance().flags[a]=!1)},sre.SemanticHeuristics.run=function(a,b,c){var d=sre.SemanticHeuristics.lookup(a);return d&&!sre.SemanticHeuristics.getInstance().blacklist[a]&&(sre.SemanticHeuristics.getInstance().flags[a]||d.applicable(b))?d.apply(b):c?c(b):b},sre.SemanticHeuristics.runMulti=function(a,b,c){var d=sre.SemanticHeuristics.lookup(a);return d&&(sre.SemanticHeuristics.getInstance().flags[a]||d.applicable(b))?d.apply(b):c?c(b):b},sre.SemanticHeuristics.lookup=function(a){return sre.SemanticHeuristics.getInstance().heuristics[a]},sre.SemanticHeuristic=function(){},sre.SemanticAbstractHeuristic=function(a){this.apply=a.method,this.applicable=a.predicate||function(b){return!1}},sre.SemanticTreeHeuristic=function(a){sre.SemanticAbstractHeuristic.call(this,a)},goog.inherits(sre.SemanticTreeHeuristic,sre.SemanticAbstractHeuristic),sre.SemanticMultiHeuristic=function(a){sre.SemanticAbstractHeuristic.call(this,a)},goog.inherits(sre.SemanticMultiHeuristic,sre.SemanticAbstractHeuristic),sre.SemanticHeuristics.add("combine_juxtaposition",new sre.SemanticTreeHeuristic({method:function(a){for(var c,b=a.childNodes.length-1;c=a.childNodes[b];b--)sre.SemanticPred.isImplicitOp(c)&&!c.nobreaking&&(a.childNodes.splice.apply(a.childNodes,[b,1].concat(c.childNodes)),a.contentNodes.splice.apply(a.contentNodes,[b,0].concat(c.contentNodes)),c.childNodes.concat(c.contentNodes).forEach(function(d){d.parent=a}),a.addMathmlNodes(c.mathml));return a}})),sre.SemanticHeuristics.add("propagateSimpleFunction",new sre.SemanticTreeHeuristic({predicate:function(a){return"clearspeak"===sre.Engine.getInstance().domain},method:function(a){return a.type!==sre.SemanticAttr.Type.INFIXOP&&a.type!==sre.SemanticAttr.Type.FRACTION||!a.childNodes.every(sre.SemanticPred.isSimpleFunction)||(a.role=sre.SemanticAttr.Role.COMPFUNC),a}})),sre.SemanticHeuristics.add("simpleNamedFunction",new sre.SemanticTreeHeuristic({predicate:function(a){return"clearspeak"===sre.Engine.getInstance().domain},method:function(a){var b="fghFGH".split("");return a.role!==sre.SemanticAttr.Role.UNIT&&-1!==b.indexOf(a.textContent)&&(a.role=sre.SemanticAttr.Role.SIMPLEFUNC),a}})),sre.SemanticHeuristics.add("propagateComposedFunction",new sre.SemanticTreeHeuristic({predicate:function(a){return"clearspeak"===sre.Engine.getInstance().domain},method:function(a){return a.type===sre.SemanticAttr.Type.FENCED&&a.childNodes[0].role===sre.SemanticAttr.Role.COMPFUNC&&(a.role=sre.SemanticAttr.Role.COMPFUNC),a}})),sre.SemanticHeuristics.add("multioperator",new sre.SemanticTreeHeuristic({method:function(a){var b;a.role!==sre.SemanticAttr.Role.UNKNOWN||a.textContent.length<=1||(b=sre.SemanticUtil.splitUnicode(a.textContent).map(sre.SemanticAttr.lookupMeaning).reduce(function(c,d){return c&&d.role&&d.role!==sre.SemanticAttr.Role.UNKNOWN&&d.role!==c?c===sre.SemanticAttr.Role.UNKNOWN?d.role:null:c},sre.SemanticAttr.Role.UNKNOWN))&&(a.role=b)}})),sre.SemanticHeuristics.add("convert_juxtaposition",new sre.SemanticMultiHeuristic({method:function(a){var b=sre.SemanticUtil.partitionNodes(a,function(f){return f.textContent===sre.SemanticAttr.invisibleTimes()&&f.type===sre.SemanticAttr.Type.OPERATOR});a=(b=b.rel.length?sre.SemanticHeuristics.juxtapositionPrePost_(b):b).comp[0];for(var d,e,c=1;d=b.comp[c],e=b.rel[c-1];c++)a.push(e),a=a.concat(d);return(b=sre.SemanticUtil.partitionNodes(a,function(f){return f.textContent===sre.SemanticAttr.invisibleTimes()&&(f.type===sre.SemanticAttr.Type.OPERATOR||f.type===sre.SemanticAttr.Type.INFIXOP)})).rel.length?sre.SemanticHeuristics.recurseJuxtaposition_(b.comp.shift(),b.rel,b.comp):a}})),sre.SemanticHeuristics.juxtapositionPrePost_=function(a){for(var b=[],c=[],d=a.comp.shift(),e=null;a.comp.length;){var f=[];if(d.length)e&&b.push(e),c.push(d),e=a.rel.shift(),d=a.comp.shift();else{for(e&&f.push(e);!d.length&&a.comp.length;)d=a.comp.shift(),f.push(a.rel.shift());e=sre.SemanticHeuristics.convertPrePost_(f,d,c)}}return f.length||d.length?(b.push(e),c.push(d)):(f.push(e),sre.SemanticHeuristics.convertPrePost_(f,d,c)),{rel:b,comp:c}},sre.SemanticHeuristics.convertPrePost_=function(a,b,c){var e,f,g,d=null;return a.length&&(e=(c=c[c.length-1])&&c.length,f=b&&b.length,g=sre.SemanticProcessor.getInstance(),e&&f?b[0].type===sre.SemanticAttr.Type.INFIXOP&&b[0].role===sre.SemanticAttr.Role.IMPLICIT?(d=a.pop(),c.push(g.postfixNode_(c.pop(),a))):(d=a.shift(),b.unshift(g.prefixNode_(b.shift(),a))):e?c.push(g.postfixNode_(c.pop(),a)):f&&b.unshift(g.prefixNode_(b.shift(),a))),d},sre.SemanticHeuristics.recurseJuxtaposition_=function(a,b,c){var d,e,f,g,h;return b.length?(d=a.pop(),e=b.shift(),f=c.shift(),sre.SemanticPred.isImplicitOp(e)?(sre.Debugger.getInstance().output("Juxta Heuristic Case 2"),g=(d?[d,e]:[e]).concat(f),sre.SemanticHeuristics.recurseJuxtaposition_(a.concat(g),b,c)):d?(g=f.shift())?sre.SemanticPred.isOperator(d)||sre.SemanticPred.isOperator(g)?(sre.Debugger.getInstance().output("Juxta Heuristic Case 4"),sre.SemanticHeuristics.recurseJuxtaposition_(a.concat([d,e,g]).concat(f),b,c)):(h=null,sre.SemanticPred.isImplicitOp(d)&&sre.SemanticPred.isImplicitOp(g)?(sre.Debugger.getInstance().output("Juxta Heuristic Case 5"),d.contentNodes.push(e),d.contentNodes=d.contentNodes.concat(g.contentNodes),d.childNodes.push(g),d.childNodes=d.childNodes.concat(g.childNodes),g.childNodes.forEach(function(k){k.parentNode=d}),(e.parentNode=d).addMathmlNodes(e.mathml),d.addMathmlNodes(g.mathml),h=d):sre.SemanticPred.isImplicitOp(d)?(sre.Debugger.getInstance().output("Juxta Heuristic Case 6"),d.contentNodes.push(e),d.childNodes.push(g),g.parentNode=d,(e.parentNode=d).addMathmlNodes(e.mathml),d.addMathmlNodes(g.mathml),h=d):sre.SemanticPred.isImplicitOp(g)?(sre.Debugger.getInstance().output("Juxta Heuristic Case 7"),g.contentNodes.unshift(e),g.childNodes.unshift(d),d.parentNode=g,(e.parentNode=g).addMathmlNodes(e.mathml),g.addMathmlNodes(d.mathml),h=g):(sre.Debugger.getInstance().output("Juxta Heuristic Case 8"),(h=sre.SemanticHeuristics.getInstance().factory.makeBranchNode(sre.SemanticAttr.Type.INFIXOP,[d,g],[e],e.textContent)).role=sre.SemanticAttr.Role.IMPLICIT),a.push(h),sre.SemanticHeuristics.recurseJuxtaposition_(a.concat(f),b,c)):(sre.Debugger.getInstance().output("Juxta Heuristic Case 9"),(e=sre.SemanticHeuristics.getInstance().factory.makeBranchNode(sre.SemanticAttr.Type.INFIXOP,[d,b.shift()],[e],e.textContent)).role=sre.SemanticAttr.Role.IMPLICIT,sre.SemanticHeuristics.run("combine_juxtaposition",e),b.unshift(e),sre.SemanticHeuristics.recurseJuxtaposition_(a,b,c)):(sre.Debugger.getInstance().output("Juxta Heuristic Case 3"),sre.SemanticHeuristics.recurseJuxtaposition_([e].concat(f),b,c))):a},sre.SemanticHeuristics.add("simple2prefix",new sre.SemanticTreeHeuristic({predicate:function(a){return"braille"===sre.Engine.getInstance().modality&&a.type===sre.SemanticAttr.Type.IDENTIFIER},method:function(a){return 1<a.textContent.length&&!a.textContent[0].match(/[A-Z]/)&&(a.role=sre.SemanticAttr.Role.PREFIXFUNC),a}})),sre.SemanticHeuristics.add("detect_cycle",new sre.SemanticTreeHeuristic({predicate:function(a){return"braille"===sre.Engine.getInstance().modality&&a.type===sre.SemanticAttr.Type.FENCED&&a.childNodes[0].type===sre.SemanticAttr.Type.INFIXOP&&a.childNodes[0].role===sre.SemanticAttr.Role.IMPLICIT&&a.childNodes[0].childNodes.every(function(b){return b.type===sre.SemanticAttr.Type.NUMBER})&&a.childNodes[0].contentNodes.every(function(b){return b.role===sre.SemanticAttr.Role.SPACE})},method:function(a){a.type=sre.SemanticAttr.Type.MATRIX,a.role=sre.SemanticAttr.Role.CYCLE;var b=a.childNodes[0];return b.type=sre.SemanticAttr.Type.ROW,b.role=sre.SemanticAttr.Role.CYCLE,b.contentNodes=[],a}})),sre.SemanticProcessor=function(){this.factory_=new sre.SemanticNodeFactory,this.heuristics=sre.SemanticHeuristics.getInstance(),this.heuristics.factory=this.factory_,this.funcAppls={}},goog.addSingletonGetter(sre.SemanticProcessor),sre.SemanticProcessor.prototype.setNodeFactory=function(a){this.factory_=a,this.heuristics.factory=this.factory_},sre.SemanticProcessor.prototype.getNodeFactory=function(){return this.factory_},sre.SemanticProcessor.prototype.identifierNode=function(a,b,c){if("MathML-Unit"===c)a.type=sre.SemanticAttr.Type.IDENTIFIER,a.role=sre.SemanticAttr.Role.UNIT;else if(!b&&1===a.textContent.length&&(a.role===sre.SemanticAttr.Role.INTEGER||a.role===sre.SemanticAttr.Role.LATINLETTER||a.role===sre.SemanticAttr.Role.GREEKLETTER)&&a.font===sre.SemanticAttr.Font.NORMAL)return a.font=sre.SemanticAttr.Font.ITALIC,sre.SemanticHeuristics.run("simpleNamedFunction",a);return a.type===sre.SemanticAttr.Type.UNKNOWN&&(a.type=sre.SemanticAttr.Type.IDENTIFIER),sre.SemanticProcessor.exprFont_(a),sre.SemanticHeuristics.run("simpleNamedFunction",a)},sre.SemanticProcessor.prototype.implicitNode_=function(a){var b=sre.SemanticProcessor.getInstance().factory_.makeMultipleContentNodes(a.length-1,sre.SemanticAttr.invisibleTimes()),c=(sre.SemanticProcessor.matchSpaces_(a,b),sre.SemanticProcessor.getInstance().infixNode_(a,b[0]));return c.role=sre.SemanticAttr.Role.IMPLICIT,b.forEach(function(d){d.parent=c}),c.contentNodes=b,c},sre.SemanticProcessor.matchSpaces_=function(a,b){for(var d,c=0;d=b[c];c++){var e=a[c].mathmlTree,f=a[c+1].mathmlTree;e&&f&&(e=e.nextSibling)&&e!==f&&(f=sre.SemanticProcessor.getSpacer_(e))&&(d.mathml.push(f),d.mathmlTree=f,d.role=sre.SemanticAttr.Role.SPACE)}},sre.SemanticProcessor.getSpacer_=function(a){if("MSPACE"===sre.DomUtil.tagName(a))return a;for(;sre.SemanticUtil.hasEmptyTag(a)&&1===a.childNodes.length;)if(a=a.childNodes[0],"MSPACE"===sre.DomUtil.tagName(a))return a;return null},sre.SemanticProcessor.prototype.implicitNode=function(a){return a=sre.SemanticProcessor.getInstance().getMixedNumbers_(a),1===(a=sre.SemanticProcessor.getInstance().combineUnits_(a)).length?a[0]:(a=this.implicitNode_(a),sre.SemanticHeuristics.run("combine_juxtaposition",a))},sre.SemanticProcessor.prototype.infixNode_=function(a,b){return(a=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.INFIXOP,a,[b],sre.SemanticUtil.getEmbellishedInner(b).textContent)).role=b.role,sre.SemanticHeuristics.run("propagateSimpleFunction",a)},sre.SemanticProcessor.prototype.explicitMixed_=function(a){var b=sre.SemanticUtil.partitionNodes(a,function(h){return h.textContent===sre.SemanticAttr.invisiblePlus()});if(!b.rel.length)return a;a=[];for(var d,c=0;d=b.rel[c];c++){var e=b.comp[c],f=b.comp[c+1],g=e.length-1;e[g]&&f[0]&&sre.SemanticPred.isAttribute("type","NUMBER")(e[g])&&!sre.SemanticPred.isAttribute("role","MIXED")(e[g])&&sre.SemanticPred.isAttribute("type","FRACTION")(f[0])?((d=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.NUMBER,[e[g],f[0]],[])).role=sre.SemanticAttr.Role.MIXED,(a=a.concat(e.slice(0,g))).push(d),f.shift()):(a=a.concat(e)).push(d)}return a.concat(b.comp[b.comp.length-1])},sre.SemanticProcessor.prototype.concatNode_=function(a,b,c){var d;return 0!==b.length&&(d=b.map(function(e){return sre.SemanticUtil.getEmbellishedInner(e).textContent}).join(" "),a=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(c,[a],b,d),1<b.length)&&(a.role=sre.SemanticAttr.Role.MULTIOP),a},sre.SemanticProcessor.prototype.prefixNode_=function(a,b){for(b=sre.SemanticUtil.partitionNodes(b,sre.SemanticPred.isAttribute("role","SUBTRACTION")),1===(a=sre.SemanticProcessor.getInstance().concatNode_(a,b.comp.pop(),sre.SemanticAttr.Type.PREFIXOP)).contentNodes.length&&a.contentNodes[0].role===sre.SemanticAttr.Role.ADDITION&&"+"===a.contentNodes[0].textContent&&(a.role=sre.SemanticAttr.Role.POSITIVE);0<b.rel.length;)(a=sre.SemanticProcessor.getInstance().concatNode_(a,[b.rel.pop()],sre.SemanticAttr.Type.PREFIXOP)).role=sre.SemanticAttr.Role.NEGATIVE,a=sre.SemanticProcessor.getInstance().concatNode_(a,b.comp.pop(),sre.SemanticAttr.Type.PREFIXOP);return a},sre.SemanticProcessor.prototype.postfixNode_=function(a,b){return b.length?sre.SemanticProcessor.getInstance().concatNode_(a,b,sre.SemanticAttr.Type.POSTFIXOP):a},sre.SemanticProcessor.prototype.text=function(a,b){return sre.SemanticProcessor.exprFont_(a),a.type=sre.SemanticAttr.Type.TEXT,"MS"===b?a.role=sre.SemanticAttr.Role.STRING:"MSPACE"!==b&&!a.textContent.match(/^\s*$/)||(a.role=sre.SemanticAttr.Role.SPACE),a},sre.SemanticProcessor.prototype.row=function(a){return 0===(a=a.filter(function(b){return!sre.SemanticPred.isAttribute("type","EMPTY")(b)})).length?sre.SemanticProcessor.getInstance().factory_.makeEmptyNode():(a=sre.SemanticProcessor.getInstance().getFencesInRow_(a),a=sre.SemanticProcessor.getInstance().tablesInRow(a),a=sre.SemanticProcessor.getInstance().getPunctuationInRow_(a),a=sre.SemanticProcessor.getInstance().getTextInRow_(a),a=sre.SemanticProcessor.getInstance().getFunctionsInRow_(a),sre.SemanticProcessor.getInstance().relationsInRow_(a))},sre.SemanticProcessor.prototype.combineUnits_=function(a){var b=sre.SemanticUtil.partitionNodes(a,function(g){return!sre.SemanticPred.isAttribute("role","UNIT")(g)});if(a.length===b.rel.length)return b.rel;a=[];do{var c=b.comp.shift(),d=b.rel.shift(),e=null,f=a.pop()}while(f&&(c.length&&sre.SemanticPred.isUnitCounter(f)?c.unshift(f):a.push(f)),1===c.length&&(e=c.pop()),1<c.length&&((e=sre.SemanticProcessor.getInstance().implicitNode_(c)).role=sre.SemanticAttr.Role.UNIT),e&&a.push(e),d&&a.push(d),d);return a},sre.SemanticProcessor.prototype.getMixedNumbers_=function(a){var b=sre.SemanticUtil.partitionNodes(a,function(g){return sre.SemanticPred.isAttribute("type","FRACTION")(g)&&sre.SemanticPred.isAttribute("role","VULGAR")(g)});if(!b.rel.length)return a;a=[];for(var d,c=0;d=b.rel[c];c++){var e=b.comp[c],f=e.length-1;(a=e[f]&&sre.SemanticPred.isAttribute("type","NUMBER")(e[f])&&(sre.SemanticPred.isAttribute("role","INTEGER")(e[f])||sre.SemanticPred.isAttribute("role","FLOAT")(e[f]))?((d=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.NUMBER,[e[f],d],[])).role=sre.SemanticAttr.Role.MIXED,a.concat(e.slice(0,f))):a.concat(e)).push(d)}return a.concat(b.comp[b.comp.length-1])},sre.SemanticProcessor.prototype.getTextInRow_=function(a){if(a.length<=1)return a;var b=sre.SemanticUtil.partitionNodes(a,sre.SemanticPred.isAttribute("type","TEXT"));if(0===b.rel.length)return a;a=[];var c=b.comp[0];0<c.length&&a.push(sre.SemanticProcessor.getInstance().row(c));for(var d=0;c=b.rel[d];d++)a.push(c),0<(c=b.comp[d+1]).length&&a.push(sre.SemanticProcessor.getInstance().row(c));return[sre.SemanticProcessor.getInstance().dummyNode_(a)]},sre.SemanticProcessor.prototype.relationsInRow_=function(a){var b=sre.SemanticUtil.partitionNodes(a,sre.SemanticPred.isRelation),c=b.rel[0];return c?1===a.length?a[0]:(a=b.comp.map(goog.bind(sre.SemanticProcessor.getInstance().operationsInRow_,this)),b.rel.some(function(d){return!d.equals(c)})?(a=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.MULTIREL,a,b.rel),b.rel.every(function(d){return d.role===c.role})&&(a.role=c.role)):(a=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.RELSEQ,a,b.rel,sre.SemanticUtil.getEmbellishedInner(c).textContent)).role=c.role,a):sre.SemanticProcessor.getInstance().operationsInRow_(a)},sre.SemanticProcessor.prototype.operationsInRow_=function(a){if(0===a.length)return sre.SemanticProcessor.getInstance().factory_.makeEmptyNode();if(1===(a=this.explicitMixed_(a)).length)return a[0];for(var b=[];0<a.length&&sre.SemanticPred.isOperator(a[0]);)b.push(a.shift());return 0===a.length?sre.SemanticProcessor.getInstance().prefixNode_(b.pop(),b):1===a.length?sre.SemanticProcessor.getInstance().prefixNode_(a[0],b):(a=sre.SemanticHeuristics.runMulti("convert_juxtaposition",a),a=sre.SemanticUtil.sliceNodes(a,sre.SemanticPred.isOperator),b=sre.SemanticProcessor.getInstance().prefixNode_(sre.SemanticProcessor.getInstance().implicitNode(a.head),b),a.div?sre.SemanticProcessor.getInstance().operationsTree_(a.tail,b,a.div):b)},sre.SemanticProcessor.prototype.operationsTree_=function(a,b,c,d){return d=d||[],0===a.length?(d.unshift(c),b.type===sre.SemanticAttr.Type.INFIXOP?(d=sre.SemanticProcessor.getInstance().postfixNode_(b.childNodes.pop(),d),b.appendChild(d),b):sre.SemanticProcessor.getInstance().postfixNode_(b,d)):0===(a=sre.SemanticUtil.sliceNodes(a,sre.SemanticPred.isOperator)).head.length?(d.push(a.div),sre.SemanticProcessor.getInstance().operationsTree_(a.tail,b,c,d)):(d=sre.SemanticProcessor.getInstance().prefixNode_(sre.SemanticProcessor.getInstance().implicitNode(a.head),d),b=sre.SemanticProcessor.getInstance().appendOperand_(b,c,d),a.div?sre.SemanticProcessor.getInstance().operationsTree_(a.tail,b,a.div,[]):b)},sre.SemanticProcessor.prototype.appendOperand_=function(a,b,c){return a.type!==sre.SemanticAttr.Type.INFIXOP?sre.SemanticProcessor.getInstance().infixNode_([a,c],b):this.appendDivisionOp_(a,b,c)||(sre.SemanticProcessor.getInstance().appendExistingOperator_(a,b,c)?a:b.role===sre.SemanticAttr.Role.MULTIPLICATION?sre.SemanticProcessor.getInstance().appendMultiplicativeOp_(a,b,c):sre.SemanticProcessor.getInstance().appendAdditiveOp_(a,b,c))},sre.SemanticProcessor.prototype.appendDivisionOp_=function(a,b,c){return b.role===sre.SemanticAttr.Role.DIVISION?sre.SemanticPred.isImplicit(a)?sre.SemanticProcessor.getInstance().infixNode_([a,c],b):this.appendLastOperand_(a,b,c):a.role===sre.SemanticAttr.Role.DIVISION?this.infixNode_([a,c],b):null},sre.SemanticProcessor.prototype.appendLastOperand_=function(a,b,c){for(var d=a,e=a.childNodes[a.childNodes.length-1];e&&e.type===sre.SemanticAttr.Type.INFIXOP&&!sre.SemanticPred.isImplicit(e);)e=(d=e).childNodes[a.childNodes.length-1];return b=sre.SemanticProcessor.getInstance().infixNode_([d.childNodes.pop(),c],b),d.appendChild(b),a},sre.SemanticProcessor.prototype.appendMultiplicativeOp_=function(a,b,c){if(sre.SemanticPred.isImplicit(a))return sre.SemanticProcessor.getInstance().infixNode_([a,c],b);for(var d=a,e=a.childNodes[a.childNodes.length-1];e&&e.type===sre.SemanticAttr.Type.INFIXOP&&!sre.SemanticPred.isImplicit(e);)e=(d=e).childNodes[a.childNodes.length-1];return b=sre.SemanticProcessor.getInstance().infixNode_([d.childNodes.pop(),c],b),d.appendChild(b),a},sre.SemanticProcessor.prototype.appendAdditiveOp_=function(a,b,c){return sre.SemanticProcessor.getInstance().infixNode_([a,c],b)},sre.SemanticProcessor.prototype.appendExistingOperator_=function(a,b,c){return!(!a||a.type!==sre.SemanticAttr.Type.INFIXOP||sre.SemanticPred.isImplicit(a))&&(a.contentNodes[0].equals(b)?(a.appendContentNode(b),a.appendChild(c),!0):sre.SemanticProcessor.getInstance().appendExistingOperator_(a.childNodes[a.childNodes.length-1],b,c))},sre.SemanticProcessor.prototype.getFencesInRow_=function(a){a=sre.SemanticUtil.partitionNodes(a,sre.SemanticPred.isFence);var b=(a=sre.SemanticProcessor.purgeFences_(a)).comp.shift();return sre.SemanticProcessor.getInstance().fences_(a.rel,a.comp,[],[b])},sre.SemanticProcessor.prototype.fences_=function(a,b,c,d){if(0===a.length&&0===c.length)return d[0];var f,g,e=sre.SemanticPred.isAttribute("role","OPEN");if(0===a.length){for(a=d.shift();0<c.length;)e(c[0])?(b=c.shift(),sre.SemanticProcessor.fenceToPunct_(b),a.push(b)):(f=(c=sre.SemanticUtil.sliceNodes(c,e)).head.length-1,g=sre.SemanticProcessor.getInstance().neutralFences_(c.head,d.slice(0,f)),d=d.slice(f),a.push.apply(a,g),c.div&&c.tail.unshift(c.div),c=c.tail),a.push.apply(a,d.shift());return a}if(f=c[c.length-1],(g=a[0].role)!==sre.SemanticAttr.Role.OPEN&&(g!==sre.SemanticAttr.Role.NEUTRAL||f&&sre.SemanticPred.compareNeutralFences(a[0],f)))if(f&&g===sre.SemanticAttr.Role.CLOSE&&f.role===sre.SemanticAttr.Role.OPEN)e=sre.SemanticProcessor.getInstance().horizontalFencedNode_(c.pop(),a.shift(),d.pop()),d.push(d.pop().concat([e],b.shift()));else if(f&&sre.SemanticPred.compareNeutralFences(a[0],f))sre.SemanticPred.elligibleLeftNeutral(f)&&sre.SemanticPred.elligibleRightNeutral(a[0])?(e=sre.SemanticProcessor.getInstance().horizontalFencedNode_(c.pop(),a.shift(),d.pop()),d.push(d.pop().concat([e],b.shift()))):(c.push(a.shift()),(e=b.shift())&&d.push(e));else{if(f&&g===sre.SemanticAttr.Role.CLOSE&&f.role===sre.SemanticAttr.Role.NEUTRAL&&c.some(e))return c=sre.SemanticUtil.sliceNodes(c,e,!0),e=d.pop(),f=d.length-c.tail.length+1,g=sre.SemanticProcessor.getInstance().neutralFences_(c.tail,d.slice(f)),d=d.slice(0,f),e=sre.SemanticProcessor.getInstance().horizontalFencedNode_(c.div,a.shift(),d.pop().concat(g,e)),d.push(d.pop().concat([e],b.shift())),sre.SemanticProcessor.getInstance().fences_(a,b,c.head,d);e=a.shift(),sre.SemanticProcessor.fenceToPunct_(e),d.push(d.pop().concat([e],b.shift()))}else c.push(a.shift()),(e=b.shift())&&d.push(e);return sre.SemanticProcessor.getInstance().fences_(a,b,c,d)},sre.SemanticProcessor.prototype.neutralFences_=function(a,b){var c,d;return 0===a.length?a:1===a.length?(sre.SemanticProcessor.fenceToPunct_(a[0]),a):(c=a.shift(),sre.SemanticPred.elligibleLeftNeutral(c)&&(d=sre.SemanticUtil.sliceNodes(a,function(e){return sre.SemanticPred.compareNeutralFences(e,c)})).div?sre.SemanticPred.elligibleRightNeutral(d.div)?(b=sre.SemanticProcessor.getInstance().combineFencedContent_(c,d.div,d.head,b),0<d.tail.length?(a=b.shift(),d=sre.SemanticProcessor.getInstance().neutralFences_(d.tail,b),a.concat(d)):b[0]):(sre.SemanticProcessor.fenceToPunct_(d.div),a.unshift(c),sre.SemanticProcessor.getInstance().neutralFences_(a,b)):(sre.SemanticProcessor.fenceToPunct_(c),(d=b.shift()).unshift(c),d.concat(sre.SemanticProcessor.getInstance().neutralFences_(a,b))))},sre.SemanticProcessor.prototype.combineFencedContent_=function(a,b,c,d){var e,g,f;return 0===c.length?(a=sre.SemanticProcessor.getInstance().horizontalFencedNode_(a,b,d.shift()),0<d.length?d[0].unshift(a):d=[[a]]):(e=d.shift(),f=c.length-1,g=d.slice(0,f),f=(d=d.slice(f)).shift(),c=sre.SemanticProcessor.getInstance().neutralFences_(c,g),e.push.apply(e,c),e.push.apply(e,f),a=sre.SemanticProcessor.getInstance().horizontalFencedNode_(a,b,e),0<d.length?d[0].unshift(a):d=[[a]]),d},sre.SemanticProcessor.FENCE_TO_PUNCT_={},sre.SemanticProcessor.FENCE_TO_PUNCT_[sre.SemanticAttr.Role.NEUTRAL]=sre.SemanticAttr.Role.VBAR,sre.SemanticProcessor.FENCE_TO_PUNCT_[sre.SemanticAttr.Role.OPEN]=sre.SemanticAttr.Role.OPENFENCE,sre.SemanticProcessor.FENCE_TO_PUNCT_[sre.SemanticAttr.Role.CLOSE]=sre.SemanticAttr.Role.CLOSEFENCE,sre.SemanticProcessor.fenceToPunct_=function(a){var b=sre.SemanticProcessor.FENCE_TO_PUNCT_[a.role];if(b){for(;a.embellished;)a.embellished=sre.SemanticAttr.Type.PUNCTUATION,sre.SemanticPred.isAttribute("role","SUBSUP")(a)||sre.SemanticPred.isAttribute("role","UNDEROVER")(a)||(a.role=b),a=a.childNodes[0];a.type=sre.SemanticAttr.Type.PUNCTUATION,a.role=b}},sre.SemanticProcessor.prototype.horizontalFencedNode_=function(a,b,c){return c=sre.SemanticProcessor.getInstance().row(c),b=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.FENCED,[c],[a,b]),a.role===sre.SemanticAttr.Role.OPEN?(this.classifyHorizontalFence_(b),b=sre.SemanticHeuristics.run("propagateComposedFunction",b)):b.role=a.role,b=sre.SemanticHeuristics.run("detect_cycle",b),sre.SemanticProcessor.rewriteFencedNode_(b)},sre.SemanticProcessor.prototype.classifyHorizontalFence_=function(a){a.role=sre.SemanticAttr.Role.LEFTRIGHT;var c,d,b=a.childNodes;!sre.SemanticPred.isSetNode(a)||1<b.length||(0===b.length||b[0].type===sre.SemanticAttr.Type.EMPTY?a.role=sre.SemanticAttr.Role.SETEMPTY:(c=b[0].type,1===b.length&&sre.SemanticPred.isSingletonSetContent(b[0])?a.role=sre.SemanticAttr.Role.SETSINGLE:(d=b[0].role,c===sre.SemanticAttr.Type.PUNCTUATED&&d===sre.SemanticAttr.Role.SEQUENCE&&(b[0].contentNodes[0].role===sre.SemanticAttr.Role.COMMA?a.role=sre.SemanticAttr.Role.SETCOLLECT:1!==b[0].contentNodes.length||b[0].contentNodes[0].role!==sre.SemanticAttr.Role.VBAR&&b[0].contentNodes[0].role!==sre.SemanticAttr.Role.COLON||(a.role=sre.SemanticAttr.Role.SETEXT,this.setExtension_(a))))))},sre.SemanticProcessor.prototype.setExtension_=function(a){(a=a.childNodes[0].childNodes[0])&&a.type===sre.SemanticAttr.Type.INFIXOP&&1===a.contentNodes.length&&a.contentNodes[0].role===sre.SemanticAttr.Role.ELEMENT&&(a.contentNodes[0].role=sre.SemanticAttr.Role.SETEXT)},sre.SemanticProcessor.prototype.getPunctuationInRow_=function(a){if(a.length<=1)return a;function b(g){return"punctuation"===(g=g.type)||"text"===g||"operator"===g||"relation"===g}var c=sre.SemanticUtil.partitionNodes(a,function(g){var h;return!(!sre.SemanticPred.isPunctuation(g)||(!sre.SemanticPred.isPunctuation(g)||sre.SemanticPred.isAttribute("role","ELLIPSIS")(g))&&(0===(h=a.indexOf(g))?a[1]&&b(a[1]):(g=a[h-1],h===a.length-1?b(g):(h=a[h+1],b(g)&&b(h)))))});if(0===c.rel.length)return a;var d=[],e=c.comp.shift();0<e.length&&d.push(sre.SemanticProcessor.getInstance().row(e));for(var f=0;0<c.comp.length;)d.push(c.rel[f++]),0<(e=c.comp.shift()).length&&d.push(sre.SemanticProcessor.getInstance().row(e));return[sre.SemanticProcessor.getInstance().punctuatedNode_(d,c.rel)]},sre.SemanticProcessor.prototype.punctuatedNode_=function(a,b){var c=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.PUNCTUATED,a,b);if(b.length===a.length){var d=b[0].role;if(d!==sre.SemanticAttr.Role.UNKNOWN&&b.every(function(e){return e.role===d}))return c.role=d,c}return sre.SemanticPred.singlePunctAtPosition(a,b,0)?c.role=sre.SemanticAttr.Role.STARTPUNCT:sre.SemanticPred.singlePunctAtPosition(a,b,a.length-1)?c.role=sre.SemanticAttr.Role.ENDPUNCT:b.every(sre.SemanticPred.isAttribute("role","DUMMY"))?c.role=sre.SemanticAttr.Role.TEXT:b.every(sre.SemanticPred.isAttribute("role","SPACE"))?c.role=sre.SemanticAttr.Role.SPACE:c.role=sre.SemanticAttr.Role.SEQUENCE,c},sre.SemanticProcessor.prototype.dummyNode_=function(a){var b=sre.SemanticProcessor.getInstance().factory_.makeMultipleContentNodes(a.length-1,sre.SemanticAttr.invisibleComma());return b.forEach(function(c){c.role=sre.SemanticAttr.Role.DUMMY}),sre.SemanticProcessor.getInstance().punctuatedNode_(a,b)},sre.SemanticProcessor.MML_TO_LIMIT_={MSUB:{type:sre.SemanticAttr.Type.LIMLOWER,length:1},MUNDER:{type:sre.SemanticAttr.Type.LIMLOWER,length:1},MSUP:{type:sre.SemanticAttr.Type.LIMUPPER,length:1},MOVER:{type:sre.SemanticAttr.Type.LIMUPPER,length:1},MSUBSUP:{type:sre.SemanticAttr.Type.LIMBOTH,length:2},MUNDEROVER:{type:sre.SemanticAttr.Type.LIMBOTH,length:2}},sre.SemanticProcessor.MML_TO_BOUNDS_={MSUB:{type:sre.SemanticAttr.Type.SUBSCRIPT,length:1,accent:!1},MSUP:{type:sre.SemanticAttr.Type.SUPERSCRIPT,length:1,accent:!1},MSUBSUP:{type:sre.SemanticAttr.Type.SUBSCRIPT,length:2,accent:!1},MUNDER:{type:sre.SemanticAttr.Type.UNDERSCORE,length:1,accent:!0},MOVER:{type:sre.SemanticAttr.Type.OVERSCORE,length:1,accent:!0},MUNDEROVER:{type:sre.SemanticAttr.Type.UNDERSCORE,length:2,accent:!0}},sre.SemanticProcessor.prototype.accentRole_=function(a,b){return!!sre.SemanticPred.isAccent(a)&&(a.role=b===sre.SemanticAttr.Type.UNDERSCORE?sre.SemanticAttr.Role.UNDERACCENT:sre.SemanticAttr.Role.OVERACCENT,!0)},sre.SemanticProcessor.prototype.limitNode=function(a,b){if(!b.length)return sre.SemanticProcessor.getInstance().factory_.makeEmptyNode();var c=b[0];if(!b[1])return c;if(sre.SemanticPred.isLimitBase(c)){var d=sre.SemanticProcessor.MML_TO_LIMIT_[a],e=d.length,f=d.type;if(b=b.slice(0,d.length+1),1===e&&sre.SemanticPred.isAccent(b[1])||2===e&&sre.SemanticPred.isAccent(b[1])&&sre.SemanticPred.isAccent(b[2]))return d=sre.SemanticProcessor.MML_TO_BOUNDS_[a],this.accentNode_(c,b,d.type,d.length,d.accent);if(2===e){if(sre.SemanticPred.isAccent(b[1]))return c=this.accentNode_(c,[c,b[1]],{MSUBSUP:sre.SemanticAttr.Type.SUBSCRIPT,MUNDEROVER:sre.SemanticAttr.Type.UNDERSCORE}[a],1,!0),b[2]?this.makeLimitNode_(c,[c,b[2]],null,sre.SemanticAttr.Type.LIMUPPER):c;if(b[2]&&sre.SemanticPred.isAccent(b[2]))return c=this.accentNode_(c,[c,b[2]],{MSUBSUP:sre.SemanticAttr.Type.SUPERSCRIPT,MUNDEROVER:sre.SemanticAttr.Type.OVERSCORE}[a],1,!0),this.makeLimitNode_(c,[c,b[1]],null,sre.SemanticAttr.Type.LIMLOWER);b[e]||(f=sre.SemanticAttr.Type.LIMLOWER)}return this.makeLimitNode_(c,b,null,f)}return d=sre.SemanticProcessor.MML_TO_BOUNDS_[a],this.accentNode_(c,b,d.type,d.length,d.accent)},sre.SemanticProcessor.prototype.accentNode_=function(a,b,c,d,e){d=(b=b.slice(0,d+1))[1];var g,f=b[2];return!e&&f&&((g=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.SUBSCRIPT,[a,d],[])).role=sre.SemanticAttr.Role.SUBSUP,b=[g,f],c=sre.SemanticAttr.Type.SUPERSCRIPT),e&&(e=this.accentRole_(d,c),f)&&(c=this.accentRole_(f,sre.SemanticAttr.Type.OVERSCORE)&&!e?(b=[g=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.OVERSCORE,[a,f],[]),d],sre.SemanticAttr.Type.UNDERSCORE):(b=[g=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.UNDERSCORE,[a,d],[]),f],sre.SemanticAttr.Type.OVERSCORE),g.role=sre.SemanticAttr.Role.UNDEROVER),this.makeLimitNode_(a,b,g,c)},sre.SemanticProcessor.prototype.makeLimitNode_=function(a,b,c,d){return d===sre.SemanticAttr.Type.LIMUPPER&&a.type===sre.SemanticAttr.Type.LIMLOWER?(a.childNodes.push(b[1]),(b[1].parent=a).type=sre.SemanticAttr.Type.LIMBOTH,a):d===sre.SemanticAttr.Type.LIMLOWER&&a.type===sre.SemanticAttr.Type.LIMUPPER?(a.childNodes.splice(1,-1,b[1]),(b[1].parent=a).type=sre.SemanticAttr.Type.LIMBOTH,a):(b=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(d,b,[]),d=sre.SemanticPred.isEmbellished(a),c&&(c.embellished=d),b.embellished=d,b.role=a.role,b)},sre.SemanticProcessor.prototype.getFunctionsInRow_=function(a,b){var c,d;return b=b||[],0===a.length?b:(c=a.shift(),(d=sre.SemanticProcessor.classifyFunction_(c,a))?(a=sre.SemanticProcessor.getInstance().getFunctionsInRow_(a,[]),a=sre.SemanticProcessor.getInstance().getFunctionArgs_(c,a,d),b.concat(a)):(b.push(c),sre.SemanticProcessor.getInstance().getFunctionsInRow_(a,b)))},sre.SemanticProcessor.CLASSIFY_FUNCTION_={},sre.SemanticProcessor.CLASSIFY_FUNCTION_[sre.SemanticAttr.Role.INTEGRAL]="integral",sre.SemanticProcessor.CLASSIFY_FUNCTION_[sre.SemanticAttr.Role.SUM]="bigop",sre.SemanticProcessor.CLASSIFY_FUNCTION_[sre.SemanticAttr.Role.PREFIXFUNC]="prefix",sre.SemanticProcessor.CLASSIFY_FUNCTION_[sre.SemanticAttr.Role.LIMFUNC]="prefix",sre.SemanticProcessor.CLASSIFY_FUNCTION_[sre.SemanticAttr.Role.SIMPLEFUNC]="prefix",sre.SemanticProcessor.CLASSIFY_FUNCTION_[sre.SemanticAttr.Role.COMPFUNC]="prefix",sre.SemanticProcessor.classifyFunction_=function(a,b){return a.type===sre.SemanticAttr.Type.APPL||a.type===sre.SemanticAttr.Type.BIGOP||a.type===sre.SemanticAttr.Type.INTEGRAL?"":b[0]&&b[0].textContent===sre.SemanticAttr.functionApplication()?(sre.SemanticProcessor.getInstance().funcAppls[a.id]=b.shift(),b=sre.SemanticAttr.Role.SIMPLEFUNC,sre.SemanticHeuristics.run("simple2prefix",a),a.role!==sre.SemanticAttr.Role.PREFIXFUNC&&a.role!==sre.SemanticAttr.Role.LIMFUNC||(b=a.role),sre.SemanticProcessor.propagateFunctionRole_(a,b),"prefix"):(b=sre.SemanticProcessor.CLASSIFY_FUNCTION_[a.role])||(sre.SemanticPred.isSimpleFunctionHead(a)?"simple":"")},sre.SemanticProcessor.propagateFunctionRole_=function(a,b){a&&a.type!==sre.Semantic.Type.INFIXOP&&(sre.SemanticPred.isAttribute("role","SUBSUP")(a)||sre.SemanticPred.isAttribute("role","UNDEROVER")(a)||(a.role=b),sre.SemanticProcessor.propagateFunctionRole_(a.childNodes[0],b))},sre.SemanticProcessor.prototype.getFunctionArgs_=function(a,b,c){switch(c){case"integral":return(b=sre.SemanticProcessor.getInstance().getIntegralArgs_(b)).intvar||b.integrand.length?(c=sre.SemanticProcessor.getInstance().row(b.integrand),a=sre.SemanticProcessor.getInstance().integralNode_(a,c,b.intvar),b.rest.unshift(a)):b.rest.unshift(a),b.rest;case"prefix":var d;if(b[0]&&b[0].type===sre.SemanticAttr.Type.FENCED)return(d=b.shift()).role!==sre.SemanticAttr.Role.NEUTRAL&&(d.role=sre.SemanticAttr.Role.LEFTRIGHT),a=sre.SemanticProcessor.getInstance().functionNode_(a,d),b.unshift(a),b;if((c=sre.SemanticUtil.sliceNodes(b,sre.SemanticPred.isPrefixFunctionBoundary)).head.length)d=sre.SemanticProcessor.getInstance().row(c.head),c.div&&c.tail.unshift(c.div);else{if(!c.div||!sre.SemanticPred.isAttribute("type","APPL")(c.div))return b.unshift(a),b;d=c.div}return a=sre.SemanticProcessor.getInstance().functionNode_(a,d),c.tail.unshift(a),c.tail;case"bigop":return(c=sre.SemanticUtil.sliceNodes(b,sre.SemanticPred.isBigOpBoundary)).head.length?(d=sre.SemanticProcessor.getInstance().row(c.head),a=sre.SemanticProcessor.getInstance().bigOpNode_(a,d),c.div&&c.tail.unshift(c.div),c.tail.unshift(a),c.tail):(b.unshift(a),b);default:return 0===b.length?[a]:((c=b[0]).type===sre.SemanticAttr.Type.FENCED&&c.role!==sre.SemanticAttr.Role.NEUTRAL&&sre.SemanticPred.isSimpleFunctionScope(c)?(c.role=sre.SemanticAttr.Role.LEFTRIGHT,sre.SemanticProcessor.propagateFunctionRole_(a,sre.SemanticAttr.Role.SIMPLEFUNC),a=sre.SemanticProcessor.getInstance().functionNode_(a,b.shift()),b.unshift(a)):b.unshift(a),b)}},sre.SemanticProcessor.prototype.getIntegralArgs_=function(a,b){var c;return b=b||[],0===a.length||(c=a[0],sre.SemanticPred.isGeneralFunctionBoundary(c))?{integrand:b,intvar:null,rest:a}:sre.SemanticPred.isIntegralDxBoundarySingle(c)?(c.role=sre.SemanticAttr.Role.INTEGRAL,{integrand:b,intvar:c,rest:a.slice(1)}):a[1]&&sre.SemanticPred.isIntegralDxBoundary(c,a[1])?((c=sre.SemanticProcessor.getInstance().prefixNode_(a[1],[c])).role=sre.SemanticAttr.Role.INTEGRAL,{integrand:b,intvar:c,rest:a.slice(2)}):(b.push(a.shift()),sre.SemanticProcessor.getInstance().getIntegralArgs_(a,b))},sre.SemanticProcessor.prototype.functionNode_=function(a,b){var c=sre.SemanticProcessor.getInstance().factory_.makeContentNode(sre.SemanticAttr.functionApplication()),d=this.funcAppls[a.id];return d&&(c.mathmlTree=d.mathmlTree,c.mathml=d.mathml,c.annotation=d.annotation,c.attributes=d.attributes,delete this.funcAppls[a.id]),c.type=sre.SemanticAttr.Type.PUNCTUATION,c.role=sre.SemanticAttr.Role.APPLICATION,d=sre.SemanticProcessor.getFunctionOp_(a,function(e){return sre.SemanticPred.isAttribute("type","FUNCTION")(e)||sre.SemanticPred.isAttribute("type","IDENTIFIER")(e)&&sre.SemanticPred.isAttribute("role","SIMPLEFUNC")(e)}),sre.SemanticProcessor.getInstance().functionalNode_(sre.SemanticAttr.Type.APPL,[a,b],d,[c])},sre.SemanticProcessor.prototype.bigOpNode_=function(a,b){var c=sre.SemanticProcessor.getFunctionOp_(a,sre.SemanticPred.isAttribute("type","LARGEOP"));return sre.SemanticProcessor.getInstance().functionalNode_(sre.SemanticAttr.Type.BIGOP,[a,b],c,[])},sre.SemanticProcessor.prototype.integralNode_=function(a,b,c){b=b||sre.SemanticProcessor.getInstance().factory_.makeEmptyNode(),c=c||sre.SemanticProcessor.getInstance().factory_.makeEmptyNode();var d=sre.SemanticProcessor.getFunctionOp_(a,sre.SemanticPred.isAttribute("type","LARGEOP"));return sre.SemanticProcessor.getInstance().functionalNode_(sre.SemanticAttr.Type.INTEGRAL,[a,b,c],d,[])},sre.SemanticProcessor.prototype.functionalNode_=function(a,b,c,d){var f,e=b[0];return c&&(f=c.parent,d.push(c)),(a=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(a,b,d)).role=e.role,f&&(c.parent=f),a},sre.SemanticProcessor.getFunctionOp_=function(a,b){if(b(a))return a;for(var d,c=0;d=a.childNodes[c];c++)if(d=sre.SemanticProcessor.getFunctionOp_(d,b))return d;return null},sre.SemanticProcessor.prototype.tablesInRow=function(a){a=sre.SemanticUtil.partitionNodes(a,sre.SemanticPred.tableIsMatrixOrVector);for(var d,b=[],c=0;d=a.rel[c];c++)(b=b.concat(a.comp.shift())).push(sre.SemanticProcessor.tableToMatrixOrVector_(d));for(b=b.concat(a.comp.shift()),a=sre.SemanticUtil.partitionNodes(b,sre.SemanticPred.isTableOrMultiline),b=[],c=0;d=a.rel[c];c++){var e=a.comp.shift();sre.SemanticPred.tableIsCases(d,e)&&sre.SemanticProcessor.tableToCases_(d,e.pop()),(b=b.concat(e)).push(d)}return b.concat(a.comp.shift())},sre.SemanticProcessor.tableToMatrixOrVector_=function(a){var c,b=a.childNodes[0];for(sre.SemanticPred.isAttribute("type","MULTILINE")(b)?sre.SemanticProcessor.tableToVector_(a):sre.SemanticProcessor.tableToMatrix_(a),a.contentNodes.forEach(goog.bind(b.appendContentNode,b)),a=0;c=b.childNodes[a];a++)sre.SemanticProcessor.assignRoleToRow_(c,sre.SemanticProcessor.getComponentRoles_(b));return b.parent=null,b},sre.SemanticProcessor.tableToVector_=function(a){var b=a.childNodes[0];b.type=sre.SemanticAttr.Type.VECTOR,1===b.childNodes.length?sre.SemanticProcessor.tableToSquare_(a):sre.SemanticProcessor.binomialForm_(b)},sre.SemanticProcessor.binomialForm_=function(a){sre.SemanticPred.isBinomial(a)&&(a.role=sre.SemanticAttr.Role.BINOMIAL,a.childNodes[0].role=sre.SemanticAttr.Role.BINOMIAL,a.childNodes[1].role=sre.SemanticAttr.Role.BINOMIAL)},sre.SemanticProcessor.tableToMatrix_=function(a){var b=a.childNodes[0];b.type=sre.SemanticAttr.Type.MATRIX,b.childNodes&&0<b.childNodes.length&&b.childNodes[0].childNodes&&b.childNodes.length===b.childNodes[0].childNodes.length?sre.SemanticProcessor.tableToSquare_(a):b.childNodes&&1===b.childNodes.length&&(b.role=sre.SemanticAttr.Role.ROWVECTOR)},sre.SemanticProcessor.tableToSquare_=function(a){var b=a.childNodes[0];sre.SemanticPred.isAttribute("role","NEUTRAL")(a)?b.role=sre.SemanticAttr.Role.DETERMINANT:b.role=sre.SemanticAttr.Role.SQUAREMATRIX},sre.SemanticProcessor.getComponentRoles_=function(a){var b=a.role;return b&&b!==sre.SemanticAttr.Role.UNKNOWN?b:sre.SemanticAttr.Role[a.type.toUpperCase()]||sre.SemanticAttr.Role.UNKNOWN},sre.SemanticProcessor.tableToCases_=function(a,b){for(var d,c=0;d=a.childNodes[c];c++)sre.SemanticProcessor.assignRoleToRow_(d,sre.SemanticAttr.Role.CASES);return a.type=sre.SemanticAttr.Type.CASES,a.appendContentNode(b),sre.SemanticPred.tableIsMultiline(a)&&sre.SemanticProcessor.binomialForm_(a),a},sre.SemanticProcessor.tableToMultiline=function(a){if(sre.SemanticPred.tableIsMultiline(a)){a.type=sre.SemanticAttr.Type.MULTILINE;for(var c,b=0;c=a.childNodes[b];b++)sre.SemanticProcessor.rowToLine_(c,sre.SemanticAttr.Role.MULTILINE);1===a.childNodes.length&&sre.SemanticPred.isFencedElement(a.childNodes[0].childNodes[0])&&sre.SemanticProcessor.tableToMatrixOrVector_(sre.SemanticProcessor.rewriteFencedLine_(a)),sre.SemanticProcessor.binomialForm_(a),sre.SemanticProcessor.classifyMultiline(a)}else sre.SemanticProcessor.classifyTable(a)},sre.SemanticProcessor.rewriteFencedLine_=function(a){var b=a.childNodes[0],c=a.childNodes[0].childNodes[0],d=a.childNodes[0].childNodes[0].childNodes[0];return c.parent=a.parent,a.parent=c,d.parent=b,c.childNodes=[a],b.childNodes=[d],c},sre.SemanticProcessor.rowToLine_=function(a,b){b=b||sre.SemanticAttr.Role.UNKNOWN,sre.SemanticPred.isAttribute("type","ROW")(a)&&(a.type=sre.SemanticAttr.Type.LINE,a.role=b,1===a.childNodes.length)&&sre.SemanticPred.isAttribute("type","CELL")(a.childNodes[0])&&(a.childNodes=a.childNodes[0].childNodes,a.childNodes.forEach(function(c){c.parent=a}))},sre.SemanticProcessor.assignRoleToRow_=function(a,b){var c;sre.SemanticPred.isAttribute("type","LINE")(a)?a.role=b:sre.SemanticPred.isAttribute("type","ROW")(a)&&(a.role=b,c=sre.SemanticPred.isAttribute("type","CELL"),a.childNodes.forEach(function(d){c(d)&&(d.role=b)}))},sre.SemanticProcessor.prototype.mfenced=function(a,b,c,d){var e,f;return c&&0<d.length&&(e=sre.SemanticProcessor.nextSeparatorFunction_(c),f=[d.shift()],d.forEach(goog.bind(function(g){f.push(sre.SemanticProcessor.getInstance().factory_.makeContentNode(e())),f.push(g)},this)),d=f),a&&b?sre.SemanticProcessor.getInstance().horizontalFencedNode_(sre.SemanticProcessor.getInstance().factory_.makeContentNode(a),sre.SemanticProcessor.getInstance().factory_.makeContentNode(b),d):(a&&d.unshift(sre.SemanticProcessor.getInstance().factory_.makeContentNode(a)),b&&d.push(sre.SemanticProcessor.getInstance().factory_.makeContentNode(b)),sre.SemanticProcessor.getInstance().row(d))},sre.SemanticProcessor.nextSeparatorFunction_=function(a){if(a){if(a.match(/^\s+$/))return null;var b=a.replace(/\s/g,"").split("").filter(function(c){return c})}else b=[","];return function(){return 1<b.length?b.shift():b[0]}},sre.SemanticProcessor.number=function(a){a.type!==sre.SemanticAttr.Type.UNKNOWN&&a.type!==sre.SemanticAttr.Type.IDENTIFIER||(a.type=sre.SemanticAttr.Type.NUMBER),sre.SemanticProcessor.numberRole_(a),sre.SemanticProcessor.exprFont_(a)},sre.SemanticProcessor.numberRole_=function(a){var b,c;a.role===sre.SemanticAttr.Role.UNKNOWN&&((c=(b=sre.SemanticUtil.splitUnicode(a.textContent)).map(sre.SemanticAttr.lookupMeaning)).every(function(d){return d.type===sre.SemanticAttr.Type.NUMBER&&d.role===sre.SemanticAttr.Role.INTEGER||d.type===sre.SemanticAttr.Type.PUNCTUATION&&d.role===sre.SemanticAttr.Role.COMMA})?(a.role=sre.SemanticAttr.Role.INTEGER,"0"===b[0]&&a.addAnnotation("general","basenumber")):c.every(function(d){return d.type===sre.SemanticAttr.Type.NUMBER&&d.role===sre.SemanticAttr.Role.INTEGER||d.type===sre.SemanticAttr.Type.PUNCTUATION})?a.role=sre.SemanticAttr.Role.FLOAT:a.role=sre.SemanticAttr.Role.OTHERNUMBER)},sre.SemanticProcessor.exprFont_=function(a){var b;a.font===sre.SemanticAttr.Font.UNKNOWN&&(b=sre.SemanticUtil.splitUnicode(a.textContent).map(sre.SemanticAttr.lookupMeaning).reduce(function(c,d){return c&&d.font&&d.font!==sre.SemanticAttr.Font.UNKNOWN&&d.font!==c?c===sre.SemanticAttr.Font.UNKNOWN?d.font:null:c},sre.SemanticAttr.Font.UNKNOWN))&&(a.font=b)},sre.SemanticProcessor.prototype.fractionLikeNode=function(a,b,c,d){return!d&&sre.SemanticUtil.isZeroLength(c)?(d=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.LINE,[a],[]),b=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.LINE,[b],[]),b=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.MULTILINE,[d,b],[]),sre.SemanticProcessor.binomialForm_(b),sre.SemanticProcessor.classifyMultiline(b)):(b=sre.SemanticProcessor.getInstance().fractionNode_(a,b),d&&b.addAnnotation("general","bevelled")),b},sre.SemanticProcessor.prototype.fractionNode_=function(a,b){return(a=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.FRACTION,[a,b],[])).role=a.childNodes.every(function(c){return sre.SemanticPred.isAttribute("type","NUMBER")(c)&&sre.SemanticPred.isAttribute("role","INTEGER")(c)})?sre.SemanticAttr.Role.VULGAR:a.childNodes.every(sre.SemanticPred.isPureUnit)?sre.SemanticAttr.Role.UNIT:sre.SemanticAttr.Role.DIVISION,sre.SemanticHeuristics.run("propagateSimpleFunction",a)},sre.SemanticProcessor.prototype.tensor=function(a,b,c,d,e){return(b=sre.SemanticProcessor.getInstance().factory_.makeBranchNode(sre.SemanticAttr.Type.TENSOR,[a,sre.SemanticProcessor.getInstance().scriptNode_(b,sre.SemanticAttr.Role.LEFTSUB),sre.SemanticProcessor.getInstance().scriptNode_(c,sre.SemanticAttr.Role.LEFTSUPER),sre.SemanticProcessor.getInstance().scriptNode_(d,sre.SemanticAttr.Role.RIGHTSUB),sre.SemanticProcessor.getInstance().scriptNode_(e,sre.SemanticAttr.Role.RIGHTSUPER)],[])).role=a.role,b.embellished=sre.SemanticPred.isEmbellished(a),b},sre.SemanticProcessor.prototype.pseudoTensor=function(a,b,c){var f,e=b.filter(d=function(g){return!sre.SemanticPred.isAttribute("type","EMPTY")(g)}).length,d=c.filter(d).length;return e||d?(f=e?d?"MSUBSUP":"MSUB":"MSUP",a=[a],e&&a.push(sre.SemanticProcessor.getInstance().scriptNode_(b,sre.SemanticAttr.Role.RIGHTSUB,!0)),d&&a.push(sre.SemanticProcessor.getInstance().scriptNode_(c,sre.SemanticAttr.Role.RIGHTSUPER,!0)),sre.SemanticProcessor.getInstance().limitNode(f,a)):a},sre.SemanticProcessor.prototype.scriptNode_=function(a,b,c){switch(a.length){case 0:a=sre.SemanticProcessor.getInstance().factory_.makeEmptyNode();break;case 1:if(a=a[0],c)return a;break;default:a=sre.SemanticProcessor.getInstance().dummyNode_(a)}return a.role=b,a},sre.SemanticProcessor.purgeFences_=function(a){var b=a.rel;a=a.comp;for(var c=[],d=[];0<b.length;){var e=b.shift(),f=a.shift();sre.SemanticPred.isElligibleEmbellishedFence(e)?(c.push(e),d.push(f)):(sre.SemanticProcessor.fenceToPunct_(e),f.push(e),f=f.concat(a.shift()),a.unshift(f))}return d.push(a.shift()),{rel:c,comp:d}},sre.SemanticProcessor.rewriteFencedNode_=function(a){var b=a.contentNodes[1],c=sre.SemanticProcessor.rewriteFence_(a,a.contentNodes[0]);return a.contentNodes[0]=c.fence,c=sre.SemanticProcessor.rewriteFence_(c.node,b),a.contentNodes[1]=c.fence,(a.contentNodes[0].parent=a).contentNodes[1].parent=a,c.node.parent=null,c.node},sre.SemanticProcessor.rewriteFence_=function(a,b){var c,d;return b.embellished?(c=b.childNodes[0],d=sre.SemanticProcessor.rewriteFence_(a,c),sre.SemanticPred.isAttribute("type","SUPERSCRIPT")(b)||sre.SemanticPred.isAttribute("type","SUBSCRIPT")(b)||sre.SemanticPred.isAttribute("type","TENSOR")(b)?(sre.SemanticPred.isAttribute("role","SUBSUP")(b)||(b.role=a.role),c!==d.node&&(b.replaceChild(c,d.node),c.parent=a),sre.SemanticProcessor.propagateFencePointer_(b,c),{node:b,fence:d.fence}):(b.replaceChild(c,d.fence),b.mathmlTree&&-1===b.mathml.indexOf(b.mathmlTree)&&b.mathml.push(b.mathmlTree),{node:d.node,fence:b})):{node:a,fence:b}},sre.SemanticProcessor.propagateFencePointer_=function(a,b){a.fencePointer=b.fencePointer||b.id.toString(),a.embellished=null},sre.SemanticProcessor.classifyMultiline=function(a){for(var d,e,b=0,c=a.childNodes.length;b<c&&(!(d=a.childNodes[b])||!d.childNodes.length);)b++;c<=b||(e=d.childNodes[0].role)!==sre.SemanticAttr.Role.UNKNOWN&&a.childNodes.every(function(f){return!(f=f.childNodes[0])||f.role===e&&(sre.SemanticPred.isAttribute("type","RELATION")(f)||sre.SemanticPred.isAttribute("type","RELSEQ")(f))})&&(a.role=e)},sre.SemanticProcessor.classifyTable=function(a){var b=sre.SemanticProcessor.computeColumns_(a);sre.SemanticProcessor.classifyByColumns_(a,b,"EQUALITY")||sre.SemanticProcessor.classifyByColumns_(a,b,"INEQUALITY",["EQUALITY"])||sre.SemanticProcessor.classifyByColumns_(a,b,"ARROW")},sre.SemanticProcessor.classifyByColumns_=function(a,b,c,d){return!!(3===b.length&&sre.SemanticProcessor.testColumns_(b,1,function(g){return sre.SemanticProcessor.isPureRelation_(g,c)})||2===b.length&&(sre.SemanticProcessor.testColumns_(b,1,function(g){return sre.SemanticProcessor.isEndRelation_(g,c)||sre.SemanticProcessor.isPureRelation_(g,c)})||sre.SemanticProcessor.testColumns_(b,0,function(g){return sre.SemanticProcessor.isEndRelation_(g,c,!0)||sre.SemanticProcessor.isPureRelation_(g,c)})))&&(a.role=sre.SemanticAttr.Role[c],!0)},sre.SemanticProcessor.isEndRelation_=function(a,b,c){return c=c?a.childNodes.length-1:0,sre.SemanticPred.isAttribute("type","RELSEQ")(a)&&sre.SemanticPred.isAttribute("role",b)(a)&&sre.SemanticPred.isAttribute("type","EMPTY")(a.childNodes[c])},sre.SemanticProcessor.isPureRelation_=function(a,b){return sre.SemanticPred.isAttribute("type","RELATION")(a)&&sre.SemanticPred.isAttribute("role",b)(a)},sre.SemanticProcessor.computeColumns_=function(a){for(var d,b=[],c=0;d=a.childNodes[c];c++)for(var f,e=0;f=d.childNodes[e];e++)b[e]?b[e].push(f):b[e]=[f];return b},sre.SemanticProcessor.testColumns_=function(a,b,c){return!!(a=a[b])&&a.some(function(d){return d.childNodes.length&&c(d.childNodes[0])})&&a.every(function(d){return!d.childNodes.length||c(d.childNodes[0])})},sre.SemanticProcessor.MATHJAX_FONTS={"-tex-caligraphic":sre.SemanticAttr.Font.CALIGRAPHIC,"-tex-caligraphic-bold":sre.SemanticAttr.Font.CALIGRAPHICBOLD,"-tex-calligraphic":sre.SemanticAttr.Font.CALIGRAPHIC,"-tex-calligraphic-bold":sre.SemanticAttr.Font.CALIGRAPHICBOLD,"-tex-oldstyle":sre.SemanticAttr.Font.OLDSTYLE,"-tex-oldstyle-bold":sre.SemanticAttr.Font.OLDSTYLEBOLD,"-tex-mathit":sre.SemanticAttr.Font.ITALIC},sre.SemanticProcessor.prototype.font=function(a){var b=sre.SemanticProcessor.MATHJAX_FONTS[a];return b||a},sre.SemanticProcessor.proof=function(a,b,c){return b=sre.SemanticProcessor.separateSemantics(b),sre.SemanticProcessor.getInstance().proof(a,b,c)},sre.SemanticProcessor.prototype.proof=function(a,b,c){return b.inference||b.axiom||console.log("Noise"),b.axiom?((b=(b=this.cleanInference(a.childNodes)).length?this.factory_.makeBranchNode(sre.SemanticAttr.Type.INFERENCE,c(b),[]):this.factory_.makeEmptyNode()).role=sre.SemanticAttr.Role.AXIOM,b.mathmlTree=a,b):(a=this.inference(a,b,c),b.proof&&(a.role=sre.SemanticAttr.Role.PROOF,a.childNodes[0].role=sre.SemanticAttr.Role.FINAL),a)},sre.SemanticProcessor.prototype.inference=function(a,b,c){var d,e;return b.inferenceRule?(c=this.getFormulas(a,[],c),this.factory_.makeBranchNode(sre.SemanticAttr.Type.INFERENCE,[c.conclusion,c.premises],[])):(d=b.labelledRule,e=sre.DomUtil.toArray(a.childNodes),b=[],"left"!==d&&"both"!==d||b.push(this.getLabel(a,e,c,sre.SemanticAttr.Role.LEFT)),"right"!==d&&"both"!==d||b.push(this.getLabel(a,e,c,sre.SemanticAttr.Role.RIGHT)),c=this.getFormulas(a,e,c),(c=this.factory_.makeBranchNode(sre.SemanticAttr.Type.INFERENCE,[c.conclusion,c.premises],b)).mathmlTree=a,c)},sre.SemanticProcessor.prototype.getLabel=function(a,b,c,d){return a=this.findNestedRow(b,"prooflabel",d),(c=this.factory_.makeBranchNode(sre.SemanticAttr.Type.RULELABEL,c(sre.DomUtil.toArray(a.childNodes)),[])).role=d,c.mathmlTree=a,c},sre.SemanticProcessor.prototype.getFormulas=function(a,b,c){b=b.length?this.findNestedRow(b,"inferenceRule"):a;a=(d="up"===sre.SemanticProcessor.getSemantics(b).inferenceRule)?b.childNodes[0]:b.childNodes[1],b=(d?b.childNodes[1]:b.childNodes[0]).childNodes[0].childNodes[0];for(var e=sre.DomUtil.toArray(b.childNodes[0].childNodes),d=[],f=1,g=(e=$jscomp.makeIterator(e)).next();!g.done;g=e.next())g=g.value,f%2&&d.push(g.childNodes[0]),f++;return d=c(d),c=c(sre.DomUtil.toArray(a.childNodes[0].childNodes))[0],(d=this.factory_.makeBranchNode(sre.SemanticAttr.Type.PREMISES,d,[])).mathmlTree=b,(c=this.factory_.makeBranchNode(sre.SemanticAttr.Type.CONCLUSION,[c],[])).mathmlTree=a.childNodes[0].childNodes[0],{conclusion:c,premises:d}},sre.SemanticProcessor.prototype.findNestedRow=function(a,b,c){return this.findNestedRow_(a,b,0,c)},sre.SemanticProcessor.prototype.findNestedRow_=function(a,b,c,d){if(!(3<c))for(var f,e=0;f=a[e];e++){var g=sre.DomUtil.tagName(f);if("MSPACE"!==g){if("MROW"===g)return this.findNestedRow_(sre.DomUtil.toArray(f.childNodes),b,c+1,d);if(sre.SemanticProcessor.findSemantics(f,b,d))return f}}return null},sre.SemanticProcessor.prototype.cleanInference=function(a){return sre.DomUtil.toArray(a).filter(function(b){return"MSPACE"!==sre.DomUtil.tagName(b)})},sre.SemanticProcessor.findSemantics=function(a,b,c){return c=null==c?null:c,!(!(a=sre.SemanticProcessor.getSemantics(a))||!a[b]||null!=c&&a[b]!==c)},sre.SemanticProcessor.getSemantics=function(a){return(a=a.getAttribute("semantics"))?sre.SemanticProcessor.separateSemantics(a):null},sre.SemanticProcessor.removePrefix=function(a){return(a=$jscomp.makeIterator(a.split("_"))).next(),$jscomp.arrayFromIterator(a).join("_")},sre.SemanticProcessor.separateSemantics=function(a){var b={};return a.split(";").forEach(function(c){var d=$jscomp.makeIterator(c.split(":"));c=d.next().value,d=d.next().value,b[sre.SemanticProcessor.removePrefix(c)]=d}),b},sre.SemanticProcessor.prototype.operatorNode=function(a){return a.type===sre.SemanticAttr.Type.UNKNOWN&&(a.type=sre.SemanticAttr.Type.OPERATOR),sre.SemanticHeuristics.run("multioperator",a)},sre.SemanticMathml=function(){sre.SemanticAbstractParser.call(this,"MathML"),this.parseMap_={SEMANTICS:goog.bind(this.semantics_,this),MATH:goog.bind(this.rows_,this),MROW:goog.bind(this.rows_,this),MPADDED:goog.bind(this.rows_,this),MSTYLE:goog.bind(this.rows_,this),MFRAC:goog.bind(this.fraction_,this),MSUB:goog.bind(this.limits_,this),MSUP:goog.bind(this.limits_,this),MSUBSUP:goog.bind(this.limits_,this),MOVER:goog.bind(this.limits_,this),MUNDER:goog.bind(this.limits_,this),MUNDEROVER:goog.bind(this.limits_,this),MROOT:goog.bind(this.root_,this),MSQRT:goog.bind(this.sqrt_,this),MTABLE:goog.bind(this.table_,this),MLABELEDTR:goog.bind(this.tableLabeledRow_,this),MTR:goog.bind(this.tableRow_,this),MTD:goog.bind(this.tableCell_,this),MS:goog.bind(this.text_,this),MTEXT:goog.bind(this.text_,this),MSPACE:goog.bind(this.space_,this),"ANNOTATION-XML":goog.bind(this.text_,this),MI:goog.bind(this.identifier_,this),MN:goog.bind(this.number_,this),MO:goog.bind(this.operator_,this),MFENCED:goog.bind(this.fenced_,this),MENCLOSE:goog.bind(this.enclosed_,this),MMULTISCRIPTS:goog.bind(this.multiscripts_,this),ANNOTATION:goog.bind(this.empty_,this),NONE:goog.bind(this.empty_,this),MACTION:goog.bind(this.action_,this)};var a={type:sre.SemanticAttr.Type.IDENTIFIER,role:sre.SemanticAttr.Role.NUMBERSET,font:sre.SemanticAttr.Font.DOUBLESTRUCK};"CHNPQRZℂℍℕℙℚℝℤ".split("").forEach((function(b){this.getFactory().defaultMap.add(b,a)}).bind(this))},goog.inherits(sre.SemanticMathml,sre.SemanticAbstractParser),sre.SemanticMathml.prototype.parse=function(a){sre.SemanticProcessor.getInstance().setNodeFactory(this.getFactory());var b=sre.DomUtil.toArray(a.childNodes),c=sre.DomUtil.tagName(a),d=this.parseMap_[c],b=(d||goog.bind(this.dummy_,this))(a,b);return sre.SemanticUtil.addAttributes(b,a),-1===["MATH","MROW","MPADDED","MSTYLE","SEMANTICS"].indexOf(c)&&(b.mathml.unshift(a),b.mathmlTree=a),b},sre.SemanticMathml.prototype.semantics_=function(a,b){return b.length?this.parse(b[0]):this.getFactory().makeEmptyNode()},sre.SemanticMathml.prototype.rows_=function(a,b){var c=a.getAttribute("semantics");return c&&c.match("bspr_")?sre.SemanticProcessor.proof(a,c,goog.bind(this.parseList,this)):(1===(b=sre.SemanticUtil.purgeNodes(b)).length?(b=this.parse(b[0])).type!==sre.SemanticAttr.Type.EMPTY||b.mathmlTree||(b.mathmlTree=a):b=sre.SemanticProcessor.getInstance().row(this.parseList(b)),b.mathml.unshift(a),b)},sre.SemanticMathml.prototype.fraction_=function(a,b){var c;return b.length?(c=this.parse(b[0]),b=b[1]?this.parse(b[1]):this.getFactory().makeEmptyNode(),sre.SemanticProcessor.getInstance().fractionLikeNode(c,b,a.getAttribute("linethickness"),"true"===a.getAttribute("bevelled"))):this.getFactory().makeEmptyNode()},sre.SemanticMathml.prototype.limits_=function(a,b){return sre.SemanticProcessor.getInstance().limitNode(sre.DomUtil.tagName(a),this.parseList(b))},sre.SemanticMathml.prototype.root_=function(a,b){return b[1]?this.getFactory().makeBranchNode(sre.SemanticAttr.Type.ROOT,[this.parse(b[1]),this.parse(b[0])],[]):this.sqrt_(a,b)},sre.SemanticMathml.prototype.sqrt_=function(a,b){return a=this.parseList(sre.SemanticUtil.purgeNodes(b)),this.getFactory().makeBranchNode(sre.SemanticAttr.Type.SQRT,[sre.SemanticProcessor.getInstance().row(a)],[])},sre.SemanticMathml.prototype.table_=function(a,b){var c=a.getAttribute("semantics");return c&&c.match("bspr_")?sre.SemanticProcessor.proof(a,c,goog.bind(this.parseList,this)):(a=this.getFactory().makeBranchNode(sre.SemanticAttr.Type.TABLE,this.parseList(b),[]),sre.SemanticProcessor.tableToMultiline(a),a)},sre.SemanticMathml.prototype.tableRow_=function(a,b){return(a=this.getFactory().makeBranchNode(sre.SemanticAttr.Type.ROW,this.parseList(b),[])).role=sre.SemanticAttr.Role.TABLE,a},sre.SemanticMathml.prototype.tableLabeledRow_=function(a,b){return b.length?((a=this.parse(b[0])).role=sre.SemanticAttr.Role.LABEL,(b=this.getFactory().makeBranchNode(sre.SemanticAttr.Type.ROW,this.parseList(b.slice(1)),[a])).role=sre.SemanticAttr.Role.TABLE,b):this.tableRow_(a,b)},sre.SemanticMathml.prototype.tableCell_=function(a,b){return a=(a=this.parseList(sre.SemanticUtil.purgeNodes(b))).length?1===a.length&&sre.SemanticPred.isAttribute("type","EMPTY")(a[0])?a:[sre.SemanticProcessor.getInstance().row(a)]:[],(a=this.getFactory().makeBranchNode(sre.SemanticAttr.Type.CELL,a,[])).role=sre.SemanticAttr.Role.TABLE,a},sre.SemanticMathml.prototype.space_=function(a,b){var c,e,d=(c=a.getAttribute("width"))&&c.match(/[a-z]*$/);return!d||(e=d[0],c=parseFloat(c.slice(0,d.index)),!(e={cm:.4,pc:.5,em:.5,ex:1,in:.15,pt:5,mm:5}[e]))||isNaN(c)||c<e?this.empty_(a,b):(b=this.getFactory().makeUnprocessed(a),sre.SemanticProcessor.getInstance().text(b,sre.DomUtil.tagName(a)))},sre.SemanticMathml.prototype.text_=function(a,b){return b=this.leaf_(a,b),a.textContent?(b.updateContent(a.textContent,!0),sre.SemanticProcessor.getInstance().text(b,sre.DomUtil.tagName(a))):b},sre.SemanticMathml.prototype.identifier_=function(a,b){return b=this.leaf_(a,b),sre.SemanticProcessor.getInstance().identifierNode(b,sre.SemanticProcessor.getInstance().font(a.getAttribute("mathvariant")),a.getAttribute("class"))},sre.SemanticMathml.prototype.number_=function(a,b){return a=this.leaf_(a,b),sre.SemanticProcessor.number(a),a},sre.SemanticMathml.prototype.operator_=function(a,b){return a=this.leaf_(a,b),sre.SemanticProcessor.getInstance().operatorNode(a),a},sre.SemanticMathml.prototype.fenced_=function(a,b){b=this.parseList(sre.SemanticUtil.purgeNodes(b));var c=sre.SemanticMathml.getAttribute_(a,"separators",","),d=sre.SemanticMathml.getAttribute_(a,"open","(");return a=sre.SemanticMathml.getAttribute_(a,"close",")"),a=sre.SemanticProcessor.getInstance().mfenced(d,a,c,b),sre.SemanticProcessor.getInstance().tablesInRow([a])[0]},sre.SemanticMathml.prototype.enclosed_=function(a,b){return b=this.parseList(sre.SemanticUtil.purgeNodes(b)),(b=this.getFactory().makeBranchNode(sre.SemanticAttr.Type.ENCLOSE,[sre.SemanticProcessor.getInstance().row(b)],[])).role=a.getAttribute("notation")||sre.SemanticAttr.Role.UNKNOWN,b},sre.SemanticMathml.prototype.multiscripts_=function(a,b){if(!b.length)return this.getFactory().makeEmptyNode();if(a=this.parse(b.shift()),!b.length)return a;for(var l,c=[],d=[],e=[],f=[],g=!1,h=0,k=0;l=b[k];k++)"MPRESCRIPTS"===sre.DomUtil.tagName(l)?(g=!0,h=0):((g?1&h?c:d:1&h?e:f).push(l),h++);return sre.SemanticUtil.purgeNodes(c).length||sre.SemanticUtil.purgeNodes(d).length?sre.SemanticProcessor.getInstance().tensor(a,this.parseList(d),this.parseList(c),this.parseList(f),this.parseList(e)):sre.SemanticProcessor.getInstance().pseudoTensor(a,this.parseList(f),this.parseList(e))},sre.SemanticMathml.prototype.empty_=function(a,b){return this.getFactory().makeEmptyNode()},sre.SemanticMathml.prototype.action_=function(a,b){return 1<b.length?this.parse(b[1]):this.getFactory().makeUnprocessed(a)},sre.SemanticMathml.prototype.dummy_=function(a,b){return(b=this.getFactory().makeUnprocessed(a)).role=a.tagName,b.textContent=a.textContent,b},sre.SemanticMathml.prototype.leaf_=function(a,b){return 1===b.length&&b[0].nodeType!==sre.DomUtil.NodeType.TEXT_NODE?((a=this.getFactory().makeUnprocessed(a)).role=b[0].tagName,sre.SemanticUtil.addAttributes(a,b[0]),a):this.getFactory().makeLeafNode(a.textContent,sre.SemanticProcessor.getInstance().font(a.getAttribute("mathvariant")))},sre.SemanticMathml.getAttribute_=function(a,b,c){return a.hasAttribute(b)?(a=a.getAttribute(b)).match(/^\s*$/)?null:a:c},sre.SemanticTree=function(a){this.mathml=a,this.parser=new sre.SemanticMathml,this.root=this.parser.parse(a),this.collator=this.parser.getFactory().leafMap.collateMeaning();var b=this.collator.newDefault();b&&(this.parser=new sre.SemanticMathml,this.parser.getFactory().defaultMap=b,this.root=this.parser.parse(a)),sre.SemanticTree.unitVisitor_.visit(this.root,{}),sre.SemanticAnnotations.getInstance().annotate(this.root)},sre.SemanticTree.unitVisitor_=new sre.SemanticVisitor("general","unit",function(a,b){return a.type!==sre.SemanticAttr.Type.INFIXOP||a.role!==sre.SemanticAttr.Role.MULTIPLICATION&&a.role!==sre.SemanticAttr.Role.IMPLICIT||(b=a.childNodes).length&&(sre.SemanticPred.isPureUnit(b[0])||sre.SemanticPred.isUnitCounter(b[0]))&&a.childNodes.slice(1).every(sre.SemanticPred.isPureUnit)&&(a.role=sre.SemanticAttr.Role.UNIT),!1}),sre.SemanticTree.empty=function(){var a=sre.DomUtil.parseInput("<math/>"),b=new sre.SemanticTree(a);return b.mathml=a,b},sre.SemanticTree.fromNode=function(a,b){var c=sre.SemanticTree.empty();return c.root=a,b&&(c.mathml=b),c},sre.SemanticTree.fromRoot=function(a,b){for(;a.parent;)a=a.parent;return a=sre.SemanticTree.fromNode(a),b&&(a.mathml=b),a},sre.SemanticTree.prototype.xml=function(a){var b=sre.DomUtil.parseInput("<stree></stree>");return a=this.root.xml(b.ownerDocument,a),b.appendChild(a),b},sre.SemanticTree.prototype.toString=function(a){return(new sre.SystemExternal.xmldom.XMLSerializer).serializeToString(this.xml(a))},sre.SemanticTree.prototype.formatXml=function(a){return a=this.toString(a),sre.DomUtil.formatXml(a)},sre.SemanticTree.prototype.displayTree=function(){this.root.displayTree()},sre.SemanticTree.prototype.replaceNode=function(a,b){var c=a.parent;c?c.replaceChild(a,b):this.root=b},sre.SemanticTree.prototype.toJson=function(){var a={};return a.stree=this.root.toJson(),a},sre.SemanticTree.fromXml=function(a){var b=sre.SemanticTree.empty();return a.childNodes[0]&&(b.root=sre.SemanticNode.fromXml(a.childNodes[0])),b},sre.Semantic={},sre.Semantic.Font=sre.SemanticAttr.Font,sre.Semantic.Role=sre.SemanticAttr.Role,sre.Semantic.Type=sre.SemanticAttr.Type,sre.Semantic.xmlTree=function(a){return sre.Semantic.getTree(a).xml()},sre.Semantic.getTree=function(a){return new sre.SemanticTree(a)},sre.Semantic.getTreeFromString=function(a){return a=sre.DomUtil.parseInput(a),sre.Semantic.getTree(a)},sre.MathspeakUtil={},sre.MathspeakUtil.spaceoutText=function(a){return Array.from(a.textContent).join(" ")},sre.MathspeakUtil.spaceoutNodes=function(a,b){var c=Array.from(a.textContent),d=[],e=sre.SemanticProcessor.getInstance();a=a.ownerDocument;for(var g,f=0;g=c[f];f++)g=e.getNodeFactory().makeLeafNode(g,sre.Semantic.Font.UNKNOWN),b(g=e.identifierNode(g,sre.Semantic.Font.UNKNOWN,"")),d.push(g.xml(a));return d},sre.MathspeakUtil.spaceoutNumber=function(a){return sre.MathspeakUtil.spaceoutNodes(a,function(b){b.textContent.match(/\W/)||(b.type=sre.Semantic.Type.NUMBER)})},sre.MathspeakUtil.spaceoutIdentifier=function(a){return sre.MathspeakUtil.spaceoutNodes(a,function(b){b.font=sre.Semantic.Font.UNKNOWN,b.type=sre.Semantic.Type.IDENTIFIER})},sre.MathspeakUtil.nestingBarriers=[sre.Semantic.Type.CASES,sre.Semantic.Type.CELL,sre.Semantic.Type.INTEGRAL,sre.Semantic.Type.LINE,sre.Semantic.Type.MATRIX,sre.Semantic.Type.MULTILINE,sre.Semantic.Type.OVERSCORE,sre.Semantic.Type.ROOT,sre.Semantic.Type.ROW,sre.Semantic.Type.SQRT,sre.Semantic.Type.SUBSCRIPT,sre.Semantic.Type.SUPERSCRIPT,sre.Semantic.Type.TABLE,sre.Semantic.Type.UNDERSCORE,sre.Semantic.Type.VECTOR],sre.MathspeakUtil.nestingDepth={},sre.MathspeakUtil.resetNestingDepth=function(a){return sre.MathspeakUtil.nestingDepth={},[a]},sre.MathspeakUtil.getNestingDepth=function(a,b,c,d,e,f){d=d||sre.MathspeakUtil.nestingBarriers,e=e||{},f=f||function(h){return!1};var g=(new sre.SystemExternal.xmldom.XMLSerializer).serializeToString(b);return sre.MathspeakUtil.nestingDepth[a]||(sre.MathspeakUtil.nestingDepth[a]={}),sre.MathspeakUtil.nestingDepth[a][g]||(f(b)||c.indexOf(b.tagName)<0?0:(b=sre.MathspeakUtil.computeNestingDepth_(b,c,sre.BaseUtil.setdifference(d,c),e,f,0),sre.MathspeakUtil.nestingDepth[a][g]=b))},sre.MathspeakUtil.containsAttr=function(a,b){if(a.attributes){a=sre.DomUtil.toArray(a.attributes);for(var d,c=0;d=a[c];c++)if(b[d.nodeName]===d.nodeValue)return!0}return!1},sre.MathspeakUtil.computeNestingDepth_=function(a,b,c,d,e,f){return!(e(a)||-1<c.indexOf(a.tagName)||sre.MathspeakUtil.containsAttr(a,d))&&(-1<b.indexOf(a.tagName)&&f++,a.childNodes)&&0!==a.childNodes.length?(a=sre.DomUtil.toArray(a.childNodes),Math.max.apply(null,a.map(function(g){return sre.MathspeakUtil.computeNestingDepth_(g,b,c,d,e,f)}))):f},sre.MathspeakUtil.fractionNestingDepth=function(a){return sre.MathspeakUtil.getNestingDepth("fraction",a,["fraction"],sre.MathspeakUtil.nestingBarriers,{},sre.Messages.MS_FUNC.FRAC_NEST_DEPTH)},sre.MathspeakUtil.nestedFraction=function(a,b,c){return a=sre.MathspeakUtil.fractionNestingDepth(a),a=Array.apply(null,Array(a)).map(function(d){return b}),c&&a.push(c),a.join(sre.Messages.REGEXP.JOINER_FRAC)},sre.MathspeakUtil.openingFractionVerbose=function(a){return sre.MathspeakUtil.nestedFraction(a,sre.Messages.MS.START,sre.Messages.MS.FRAC_V)},sre.MathspeakUtil.closingFractionVerbose=function(a){return sre.MathspeakUtil.nestedFraction(a,sre.Messages.MS.END,sre.Messages.MS.FRAC_V)},sre.MathspeakUtil.overFractionVerbose=function(a){return sre.MathspeakUtil.nestedFraction(a,sre.Messages.MS.FRAC_OVER)},sre.MathspeakUtil.openingFractionBrief=function(a){return sre.MathspeakUtil.nestedFraction(a,sre.Messages.MS.START,sre.Messages.MS.FRAC_B)},sre.MathspeakUtil.closingFractionBrief=function(a){return sre.MathspeakUtil.nestedFraction(a,sre.Messages.MS.END,sre.Messages.MS.FRAC_B)},sre.MathspeakUtil.openingFractionSbrief=function(a){return 1===(a=sre.MathspeakUtil.fractionNestingDepth(a))?sre.Messages.MS.FRAC_S:sre.Messages.MS_FUNC.COMBINE_NESTED_FRACTION(sre.Messages.MS.NEST_FRAC,sre.Messages.MS_FUNC.RADICAL_NEST_DEPTH(a-1),sre.Messages.MS.FRAC_S)},sre.MathspeakUtil.closingFractionSbrief=function(a){return 1===(a=sre.MathspeakUtil.fractionNestingDepth(a))?sre.Messages.MS.ENDFRAC:sre.Messages.MS_FUNC.COMBINE_NESTED_FRACTION(sre.Messages.MS.NEST_FRAC,sre.Messages.MS_FUNC.RADICAL_NEST_DEPTH(a-1),sre.Messages.MS.ENDFRAC)},sre.MathspeakUtil.overFractionSbrief=function(a){return 1===(a=sre.MathspeakUtil.fractionNestingDepth(a))?sre.Messages.MS.FRAC_OVER:sre.Messages.MS_FUNC.COMBINE_NESTED_FRACTION(sre.Messages.MS.NEST_FRAC,sre.Messages.MS_FUNC.RADICAL_NEST_DEPTH(a-1),sre.Messages.MS.FRAC_OVER)},sre.MathspeakUtil.isSmallVulgarFraction=function(a){return sre.NumbersUtil.vulgarFractionSmall(a,10,100)?[a]:[]},sre.MathspeakUtil.nestedSubSuper=function(a,b,c){for(;a.parentNode;){var d=a.parentNode,e=d.parentNode;if(!e)break;var f=a.getAttribute&&a.getAttribute("role");(e.tagName===sre.Semantic.Type.SUBSCRIPT&&a===d.childNodes[1]||e.tagName===sre.Semantic.Type.TENSOR&&f&&(f===sre.Semantic.Role.LEFTSUB||f===sre.Semantic.Role.RIGHTSUB))&&(b=c.sub+sre.Messages.REGEXP.JOINER_SUBSUPER+b),(e.tagName===sre.Semantic.Type.SUPERSCRIPT&&a===d.childNodes[1]||e.tagName===sre.Semantic.Type.TENSOR&&f&&(f===sre.Semantic.Role.LEFTSUPER||f===sre.Semantic.Role.RIGHTSUPER))&&(b=c.sup+sre.Messages.REGEXP.JOINER_SUBSUPER+b),a=e}return b.trim()},sre.MathspeakUtil.subscriptVerbose=function(a){return sre.MathspeakUtil.nestedSubSuper(a,sre.Messages.MS.SUBSCRIPT,{sup:sre.Messages.MS.SUPER,sub:sre.Messages.MS.SUB})},sre.MathspeakUtil.subscriptBrief=function(a){return sre.MathspeakUtil.nestedSubSuper(a,sre.Messages.MS.SUB,{sup:sre.Messages.MS.SUP,sub:sre.Messages.MS.SUB})},sre.MathspeakUtil.superscriptVerbose=function(a){return sre.MathspeakUtil.nestedSubSuper(a,sre.Messages.MS.SUPERSCRIPT,{sup:sre.Messages.MS.SUPER,sub:sre.Messages.MS.SUB})},sre.MathspeakUtil.superscriptBrief=function(a){return sre.MathspeakUtil.nestedSubSuper(a,sre.Messages.MS.SUP,{sup:sre.Messages.MS.SUP,sub:sre.Messages.MS.SUB})},sre.MathspeakUtil.baselineVerbose=function(a){return(a=sre.MathspeakUtil.nestedSubSuper(a,"",{sup:sre.Messages.MS.SUPER,sub:sre.Messages.MS.SUB}))?a.replace(new RegExp(sre.Messages.MS.SUB+"$"),sre.Messages.MS.SUBSCRIPT).replace(new RegExp(sre.Messages.MS.SUPER+"$"),sre.Messages.MS.SUPERSCRIPT):sre.Messages.MS.BASELINE},sre.MathspeakUtil.baselineBrief=function(a){return sre.MathspeakUtil.nestedSubSuper(a,"",{sup:sre.Messages.MS.SUP,sub:sre.Messages.MS.SUB})||sre.Messages.MS.BASE},sre.MathspeakUtil.radicalNestingDepth=function(a){return sre.MathspeakUtil.getNestingDepth("radical",a,["sqrt","root"],sre.MathspeakUtil.nestingBarriers,{})},sre.MathspeakUtil.nestedRadical=function(a,b,c){var d=sre.MathspeakUtil.radicalNestingDepth(a);return c=(a=sre.MathspeakUtil.getRootIndex(a))?sre.Messages.MS_FUNC.COMBINE_ROOT_INDEX(c,a):c,1===d?c:sre.Messages.MS_FUNC.COMBINE_NESTED_RADICAL(b,sre.Messages.MS_FUNC.RADICAL_NEST_DEPTH(d-1),c)},sre.MathspeakUtil.getRootIndex=function(a){return a="sqrt"===a.tagName?"2":sre.XpathUtil.evalXPath("children/*[1]",a)[0].textContent.trim(),sre.Messages.MS_ROOT_INDEX[a]||""},sre.MathspeakUtil.openingRadicalVerbose=function(a){return sre.MathspeakUtil.nestedRadical(a,sre.Messages.MS.NESTED,sre.Messages.MS.STARTROOT)},sre.MathspeakUtil.closingRadicalVerbose=function(a){return sre.MathspeakUtil.nestedRadical(a,sre.Messages.MS.NESTED,sre.Messages.MS.ENDROOT)},sre.MathspeakUtil.indexRadicalVerbose=function(a){return sre.MathspeakUtil.nestedRadical(a,sre.Messages.MS.NESTED,sre.Messages.MS.ROOTINDEX)},sre.MathspeakUtil.openingRadicalBrief=function(a){return sre.MathspeakUtil.nestedRadical(a,sre.Messages.MS.NEST_ROOT,sre.Messages.MS.STARTROOT)},sre.MathspeakUtil.closingRadicalBrief=function(a){return sre.MathspeakUtil.nestedRadical(a,sre.Messages.MS.NEST_ROOT,sre.Messages.MS.ENDROOT)},sre.MathspeakUtil.indexRadicalBrief=function(a){return sre.MathspeakUtil.nestedRadical(a,sre.Messages.MS.NEST_ROOT,sre.Messages.MS.ROOTINDEX)},sre.MathspeakUtil.openingRadicalSbrief=function(a){return sre.MathspeakUtil.nestedRadical(a,sre.Messages.MS.NEST_ROOT,sre.Messages.MS.ROOT)},sre.MathspeakUtil.indexRadicalSbrief=function(a){return sre.MathspeakUtil.nestedRadical(a,sre.Messages.MS.NEST_ROOT,sre.Messages.MS.INDEX)},sre.MathspeakUtil.underscoreNestingDepth=function(a){return sre.MathspeakUtil.getNestingDepth("underscore",a,["underscore"],sre.MathspeakUtil.nestingBarriers,{},function(b){return b.tagName&&b.tagName===sre.Semantic.Type.UNDERSCORE&&b.childNodes[0].childNodes[1].getAttribute("role")===sre.Semantic.Role.UNDERACCENT})},sre.MathspeakUtil.nestedUnderscore=function(a){return a=sre.MathspeakUtil.underscoreNestingDepth(a),Array(a).join(sre.Messages.MS.UNDER)+sre.Messages.MS.UNDERSCRIPT},sre.MathspeakUtil.overscoreNestingDepth=function(a){return sre.MathspeakUtil.getNestingDepth("overscore",a,["overscore"],sre.MathspeakUtil.nestingBarriers,{},function(b){return b.tagName&&b.tagName===sre.Semantic.Type.OVERSCORE&&b.childNodes[0].childNodes[1].getAttribute("role")===sre.Semantic.Role.OVERACCENT})},sre.MathspeakUtil.nestedOverscore=function(a){return a=sre.MathspeakUtil.overscoreNestingDepth(a),Array(a).join(sre.Messages.MS.OVER)+sre.Messages.MS.OVERSCRIPT},sre.MathspeakUtil.determinantIsSimple=function(a){if(a.tagName!==sre.Semantic.Type.MATRIX||a.getAttribute("role")!==sre.Semantic.Role.DETERMINANT)return[];for(var d,b=sre.XpathUtil.evalXPath("children/row/children/cell/children/*",a),c=0;d=b[c];c++)if(d.tagName!==sre.Semantic.Type.NUMBER){if(d.tagName!==sre.Semantic.Type.IDENTIFIER||(d=d.getAttribute("role"))!==sre.Semantic.Role.LATINLETTER&&d!==sre.Semantic.Role.GREEKLETTER&&d!==sre.Semantic.Role.OTHERLETTER)return[];continue}return[a]},sre.MathspeakUtil.generateBaselineConstraint=function(){for(var f,b="not("+(a=function(g){return g.map(function(h){return"ancestor::"+h})})(["subscript","superscript","tensor"]).join(" or ")+")",c=a(["relseq","multrel"]),a=a(["fraction","punctuation","fenced","sqrt","root"]),d=[],e=0;f=a[e];e++)d=d.concat(c.map(function(g){return f+"/"+g}));return[["ancestor::*/following-sibling::*",b,c="not("+d.join(" | ")+")"].join(" and ")]},sre.MathspeakUtil.removeParens=function(a){return a.childNodes.length&&a.childNodes[0].childNodes.length&&a.childNodes[0].childNodes[0].childNodes.length?(a=a.childNodes[0].childNodes[0].childNodes[0].textContent).match(/^\(.+\)$/)?a.slice(1,-1):a:""},sre.MathspeakUtil.componentString_={3:"CSFleftsuperscript",4:"CSFleftsubscript",2:"CSFbaseline",1:"CSFrightsubscript",0:"CSFrightsuperscript"},sre.MathspeakUtil.childNumber_={4:2,3:3,2:1,1:4,0:5},sre.MathspeakUtil.generateTensorRuleStrings_=function(a){var b=[],c="",d="";a=parseInt(a,2);for(var e=0;e<5;e++){var g,f="children/*["+sre.MathspeakUtil.childNumber_[e]+"]";1&a?(c="[t] "+(g=sre.MathspeakUtil.componentString_[e%5])+"Verbose; [n] "+f+";"+c,d="[t] "+g+"Brief; [n] "+f+";"+d):b.unshift("name("+f+')="empty"'),a>>=1}return b.push(c),b.push(d),b},sre.MathspeakUtil.generateTensorRules=function(a){var b=goog.bind(a.defineRule,a);a=goog.bind(a.defineSpecialisedRule,a);for(var c="11111 11110 11101 11100 10111 10110 10101 10100 01111 01110 01101 01100".split(" "),d=0;e=c[d];d++){var e,f="tensor"+e,g=(e=sre.MathspeakUtil.generateTensorRuleStrings_(e)).pop(),h=e.pop(),k=[f,"default",h,"self::tensor"].concat(e),l=[f,"brief",g,"self::tensor"].concat(e);b.apply(null,k),b.apply(null,l),a(f,"brief","sbrief"),g+="; [t]"+(k=sre.MathspeakUtil.componentString_[2])+"Brief",k=[f+="-baseline","default",h+="; [t]"+k+"Verbose","self::tensor","((.//*[not(*)])[last()]/@id)!=(((.//ancestor::fraction|ancestor::root|ancestor::sqrt|ancestor::cell|ancestor::line|ancestor::stree)[1]//*[not(*)])[last()]/@id)"].concat(e),l=[f,"brief",g,"self::tensor","((.//*[not(*)])[last()]/@id)!=(((.//ancestor::fraction|ancestor::root|ancestor::sqrt|ancestor::cell|ancestor::line|ancestor::stree)[1]//*[not(*)])[last()]/@id)"].concat(e),b.apply(null,k),b.apply(null,l),a(f,"brief","sbrief")}},sre.Locale={},sre.Locale.nestingToString=function(a){switch(a){case 1:return sre.Messages.MS.ONCE||"";case 2:return sre.Messages.MS.TWICE;default:return a.toString()}},sre.Locale.vulgarNestingDepth=function(a){return!!sre.MathspeakUtil.isSmallVulgarFraction(a).length},sre.Locale.combinePostfixIndex=function(a,b){return a===sre.Messages.MS.ROOTINDEX||a===sre.Messages.MS.INDEX?a:a+" "+b},sre.Locale.localFont=function(a){var b=sre.Messages.FONT[a];return"string"==typeof(b=void 0===b?a||"":b)?b:b[0]},sre.Grammar.getInstance().setCorrection("localFont",sre.Locale.localFont),sre.Locale.localRole=function(a){return sre.Messages.ROLE[a]||a},sre.Grammar.getInstance().setCorrection("localRole",sre.Locale.localRole),sre.Locale.localEnclose=function(a){return sre.Messages.ENCLOSE[a]||a},sre.Grammar.getInstance().setCorrection("localEnclose",sre.Locale.localEnclose),sre.Locale.prefixCombiner=function(a,b,c){return a=c?c+" "+a:a,b?b+" "+a:a},sre.Locale.postfixCombiner=function(a,b,c){return a=c?c+" "+a:a,b?a+" "+b:a},sre.Numbers.de={},sre.Numbers.de.onesNumbers_=" eins zwei drei vier fünf sechs sieben acht neun zehn elf zwölf dreizehn vierzehn fünfzehn sechzehn siebzehn achtzehn neunzehn".split(" "),sre.Numbers.de.tensNumbers_="  zwanzig dreißig vierzig fünfzig sechzig siebzig achtzig neunzig".split(" "),sre.Numbers.de.largeNumbers_=" tausend million milliarde billion billiarde trillion trilliard quadrillion quadrilliard quintillion quintilliarde sextillion sextilliarde".split(" "),sre.Numbers.de.onePrefix_=function(a){return a===sre.Numbers.de.onesNumbers_[1]?"ein":a},sre.Numbers.de.hundredsToWords_=function(a){a%=1e3;var d,b=sre.Numbers.de.onesNumbers_[Math.floor(a/100)],c=b?sre.Numbers.de.onePrefix_(b)+"hundert":"";return(a%=100)&&(c+=c?sre.Numbers.de.NUMBERS.numSep:"",(b=sre.Numbers.de.onesNumbers_[a])?c+=b:(d=sre.Numbers.de.tensNumbers_[Math.floor(a/10)],c+=(b=sre.Numbers.de.onesNumbers_[a%10])?sre.Numbers.de.onePrefix_(b)+"und"+d:d)),c},sre.Numbers.de.numberToWords=function(a){if(a>=Math.pow(10,36))return a.toString();for(var d,b=0,c="";0<a;)a%1e3&&(d=sre.Numbers.de.hundredsToWords_(a%1e3),c=sre.Numbers.de.onePrefix_(d)+(b?sre.Numbers.de.largeNumbers_[b]:"")+c),a=Math.floor(a/1e3),b++;return c.replace(/ein$/,"eins")},sre.Numbers.de.numberToOrdinal=function(a,b){return 1===a?"eintel":2===a?b?"halbe":"halb":sre.Numbers.de.wordOrdinal(a)+"l"},sre.Numbers.de.wordOrdinal=function(a){return 1===a?"erste":3===a?"dritte":7===a?"siebte":8===a?"achte":sre.Numbers.de.numberToWords(a)+(a<19?"te":"ste")},sre.Numbers.de.simpleOrdinal=function(a){return a.toString()+"."},sre.Numbers.de.NUMBERS={wordOrdinal:sre.Numbers.de.wordOrdinal,simpleOrdinal:sre.Numbers.de.simpleOrdinal,numberToWords:sre.Numbers.de.numberToWords,numberToOrdinal:sre.Numbers.de.numberToOrdinal,vulgarSep:" ",numSep:""},function(a,b,c){return"s"===c&&(b=b.split(" ").map(function(d){return d.replace(/s$/,"")}).join(" "),c=""),a=c?c+" "+a:a,b?b+" "+a:a}),germanPostfixCombiner=function(a,b,c){return a=c&&"s"!==c?c+" "+a:a,b?a+" "+b:a},sansserifCombiner=(sre.Locale.de={MS:{START:"Anfang",FRAC_V:"Bruch",FRAC_B:"Bruch",FRAC_S:"Bruch",END:"Ende",FRAC_OVER:"durch",TWICE:"Twice",NEST_FRAC:"geschachtelt",ENDFRAC:"Ende Bruch",SUPER:"hoch",SUB:"Index",SUP:"hoch",SUPERSCRIPT:"hoch",SUBSCRIPT:"Index",BASELINE:"Grundlinie",BASE:"Grund",NESTED:"geschachtelte",NEST_ROOT:"geschachtelte",STARTROOT:"Anfang Wurzel",ENDROOT:"Ende Wurzel",ROOTINDEX:"Wurzelexponent",ROOT:"Wurzel",INDEX:"Exponent",UNDER:"Unter",UNDERSCRIPT:"Unterschrift",OVER:"Über",OVERSCRIPT:"Überschrift"},MS_FUNC:{FRAC_NEST_DEPTH:sre.Locale.vulgarNestingDepth,RADICAL_NEST_DEPTH:function(a){return 1<a?sre.Numbers.de.NUMBERS.numberToWords(a)+"fach":""},COMBINE_ROOT_INDEX:function(a,b){return a.replace("Wurzel",b?b+"wurzel":"")},COMBINE_NESTED_FRACTION:function(a,b,c){return a+b+c},COMBINE_NESTED_RADICAL:function(a,b,c){return a=(b?b+" ":"")+(a=c.match(/exponent$/)?a+"r":a),c.match(/ /)?c.replace(/ /," "+a+" "):a+" "+c},FONT_REGEXP:function(a){return a=a.split(" ").map(function(b){return b.replace(/s$/,"(|s)")}).join(" "),new RegExp("((^"+a+" )|( "+a+"$))")}},MS_ROOT_INDEX:{2:"Quadrat",3:"Kubik"},FONT:{bold:"fettes","bold-fraktur":"fettes Fraktur","bold-italic":"fettkursives","bold-script":"fettes Schreibschrift",caligraphic:"kalligrafisches","caligraphic-bold":"fettes kalligrafisches","double-struck":["mit Doppelstrich",germanPostfixCombiner],"double-struck-italic":["kursiv mit Doppelstrich",germanPostfixCombiner],fraktur:"Fraktur",fullwidth:"vollbreites",italic:"kursives",monospace:"nichtproportionales",normal:"normales",oldstyle:"antiquiertes","oldstyle-bold":"antiquiertes fettes",script:"Schreibschrift","sans-serif":"serifenloses","sans-serif-italic":"serifenloses kursives","sans-serif-bold":"serifenloses fettes","sans-serif-bold-italic":"serifenloses fettkursives",unknown:"unbekannt"},EMBELLISH:{super:"hoch",sub:"Index",circled:"eingekreistes",parenthesized:"eingeklammertes",period:["Punkt",germanPostfixCombiner],"negative-circled":"schwarz eingekreistes","double-circled":"doppelt eingekreistes","circled-sans-serif":"eingekreistes serifenloses","negative-circled-sans-serif":"schwarz eingekreistes serifenloses",comma:["Komma",germanPostfixCombiner],squared:"umrahmtes","negative-squared":"schwarz umrahmtes"},ROLE:{addition:"Addition",multiplication:"Multiplikation",subtraction:"Subtraktion",division:"Division",equality:"Gleichung",inequality:"Ungleichung",element:"Element",arrow:"Pfeil",determinant:"Determinante",rowvector:"Zeilenvektor",binomial:"Binomialkoeffizient",squarematrix:"quadratische Matrize",multiline:"mehrzeiligem Ausdruck",matrix:"Matrize",vector:"Vektor",cases:"Fallunterscheidung",table:"Tabelle",unknown:"unbekannt"},ENCLOSE:{longdiv:"langer Bruchstrich",actuarial:"Bilanzsumme",radical:"Quadratwurzel",box:"rechteckige Umrandung",roundedbox:"abgerundete rechteckige Umrandung",circle:"kreisähnliche Umrandung",left:"senkrechte Linie links",right:"senkrechte Linie rechts",top:"waagerechte Linie oberhalb",bottom:"waagerechte Linie unterhalb",updiagonalstrike:"durchgestrichen",downdiagonalstrike:"durchgestrichen",verticalstrike:"senkrecht durchgestrichen",horizontalstrike:"durchgestrichen",madruwb:"arabisches Fakultätssymbol",updiagonalarrow:"Pfeil von links unten nach rechts oben",phasorangle:"phasor angle",unknown:"langer Bruchstrich"},NAVIGATE:{COLLAPSIBLE:"kollabierbar",EXPANDABLE:"ausfaltbar",LEVEL:"Niveau"},REGEXP:{TEXT:"a-zA-ZäöüÄÖÜß",NUMBER:"((\\d{1,3})(?=(.| ))((.| )\\d{3})*(\\,\\d+)?)|^\\d*\\,\\d+|^\\d+",DECIMAL_MARK:",",DIGIT_GROUP:"\\.",JOINER_SUBSUPER:" ",JOINER_FRAC:" "},SI:function(a,b){return a+b.toLowerCase()},PLURAL:function(a){return a},NUMBERS:sre.Numbers.de.NUMBERS,ALPHABETS:{latinSmall:"abcdefghijklmnopqrstuvwxyz".split(""),latinCap:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),greekSmall:"nabla;alpha;beta;gamma;delta;epsilon;zeta;eta;theta;iota;kappa;lambda;my;ny;xi;omikron;pi;rho;abschließendes sigma;sigma;tau;ypsilon;phi;chi;psi;omega;partielle Ableitung;epsilon;theta;kappa;phi;rho;pi".split(";"),greekCap:"Alpha Beta Gamma Delta Epsilon Zeta Eta Theta Iota Kappa Lambda My Ny Xi Omikron Pi Rho Theta Sigma Tau Ypsilon Phi Chi Psi Omega".split(" ")},ALPHABET_TRANSFORMERS:{digit:{default:function(a){return 0===a?"null":sre.Numbers.de.numberToWords(a)},mathspeak:function(a){return a.toString()},clearspeak:function(a){return a.toString()}},letter:{default:function(a){return a}}},ALPHABET_PREFIXES:{capPrefix:{default:"großes"},smallPrefix:{default:""},digitPrefix:{default:"s"}},ALPHABET_COMBINER:germanPrefixCombiner},sre.Grammar.getInstance().setCorrection("correctOne",function(a){return a.replace(/^eins$/,"ein")}),sre.Grammar.getInstance().setCorrection("localFontNumber",function(a){var b=sre.Messages.FONT[a];return(b="string"==typeof(b=void 0===b?a||"":b)?b:b[0]).split(" ").map(function(c){return c.replace(/s$/,"")}).join(" ")}),sre.Grammar.getInstance().setCorrection("lowercase",function(a){return a.toLowerCase()}),sre.Grammar.getInstance().setCorrection("article",function(a){return"dative"===sre.Grammar.getInstance().getParameter("case")?{der:"dem",die:"der",das:"dem"}[a]:a}),sre.Grammar.getInstance().setCorrection("masculine",function(a){return"dative"===sre.Grammar.getInstance().getParameter("case")?a+"n":a}),sre.Numbers.en={},sre.Numbers.en.onesNumbers_=" one two three four five six seven eight nine ten eleven twelve thirteen fourteen fifteen sixteen seventeen eighteen nineteen".split(" "),sre.Numbers.en.tensNumbers_="  twenty thirty forty fifty sixty seventy eighty ninety".split(" "),sre.Numbers.en.largeNumbers_=" thousand million billion trillion quadrillion quintillion sextillion septillion octillion nonillion decillion".split(" "),sre.Numbers.en.hundredsToWords_=function(a){a%=1e3;var b=sre.Numbers.en.onesNumbers_[Math.floor(a/100)]?sre.Numbers.en.onesNumbers_[Math.floor(a/100)]+sre.Numbers.en.NUMBERS.numSep+"hundred":"";return b=(a%=100)?(b+=b?sre.Numbers.en.NUMBERS.numSep:"")+(sre.Numbers.en.onesNumbers_[a]||sre.Numbers.en.tensNumbers_[Math.floor(a/10)]+(a%10?sre.Numbers.en.NUMBERS.numSep+sre.Numbers.en.onesNumbers_[a%10]:"")):b},sre.Numbers.en.numberToWords=function(a){if(a>=Math.pow(10,36))return a.toString();for(var b=0,c="";0<a;)a%1e3&&(c=sre.Numbers.en.hundredsToWords_(a%1e3)+(b?"-"+sre.Numbers.en.largeNumbers_[b]+"-":"")+c),a=Math.floor(a/1e3),b++;return c.replace(/-$/,"")},sre.Numbers.en.numberToOrdinal=function(a,b){return 1===a?b?"oneths":"oneth":2===a?b?"halves":"half":(a=sre.Numbers.en.wordOrdinal(a),b?a+"s":a)},sre.Numbers.en.wordOrdinal=function(a){return(a=sre.Numbers.en.numberToWords(a)).match(/one$/)?a.slice(0,-3)+"first":a.match(/two$/)?a.slice(0,-3)+"second":a.match(/three$/)?a.slice(0,-5)+"third":a.match(/five$/)?a.slice(0,-4)+"fifth":a.match(/eight$/)?a.slice(0,-5)+"eighth":a.match(/nine$/)?a.slice(0,-4)+"ninth":a.match(/twelve$/)?a.slice(0,-6)+"twelfth":a.match(/ty$/)?a.slice(0,-2)+"tieth":a+"th"},sre.Numbers.en.simpleOrdinal=function(a){var b=a%100,c=a.toString();if(10<b&&b<20)return c+"th";switch(a%10){case 1:return c+"st";case 2:return c+"nd";case 3:return c+"rd";default:return c+"th"}},sre.Numbers.en.NUMBERS={wordOrdinal:sre.Numbers.en.wordOrdinal,simpleOrdinal:sre.Numbers.en.simpleOrdinal,numberToWords:sre.Numbers.en.numberToWords,numberToOrdinal:sre.Numbers.en.numberToOrdinal,vulgarSep:" ",numSep:" "},sre.Locale.en={MS:{START:"Start",FRAC_V:"Fraction",FRAC_B:"Frac",FRAC_S:"Frac",END:"End",FRAC_OVER:"Over",TWICE:"Twice",NEST_FRAC:"Nest",ENDFRAC:"EndFrac",SUPER:"Super",SUB:"Sub",SUP:"Sup",SUPERSCRIPT:"Superscript",SUBSCRIPT:"Subscript",BASELINE:"Baseline",BASE:"Base",NESTED:"Nested",NEST_ROOT:"Nest",STARTROOT:"StartRoot",ENDROOT:"EndRoot",ROOTINDEX:"RootIndex",ROOT:"Root",INDEX:"Index",UNDER:"Under",UNDERSCRIPT:"Underscript",OVER:"Over",OVERSCRIPT:"Overscript"},MS_FUNC:{FRAC_NEST_DEPTH:sre.Locale.vulgarNestingDepth,RADICAL_NEST_DEPTH:sre.Locale.nestingToString,COMBINE_ROOT_INDEX:function(a,b){return a},COMBINE_NESTED_FRACTION:function(a,b,c){return a+b+c},COMBINE_NESTED_RADICAL:function(a,b,c){return a+b+c},FONT_REGEXP:function(a){return new RegExp("^"+a.split(/ |-/).join("( |-)")+"( |-)")}},MS_ROOT_INDEX:{},FONT:{bold:"bold","bold-fraktur":"bold fraktur","bold-italic":"bold italic","bold-script":"bold script",caligraphic:"calligraphic","caligraphic-bold":"calligraphic bold","double-struck":"double struck","double-struck-italic":"double struck italic",fraktur:"fraktur",fullwidth:"fullwidth",italic:"italic",monospace:"monospace",normal:"normal",oldstyle:"oldstyle","oldstyle-bold":"oldstyle bold",script:"script","sans-serif":"sans serif","sans-serif-italic":"sans serif italic","sans-serif-bold":"sans serif bold","sans-serif-bold-italic":"sans serif bold italic",unknown:"unknown"},EMBELLISH:{super:"super",sub:"sub",circled:"circled",parenthesized:"parenthesized",period:["period",sre.Locale.postfixCombiner],"negative-circled":"black circled","double-circled":"double circled","circled-sans-serif":"circled sans serif","negative-circled-sans-serif":"black circled sans serif",comma:["comma",sre.Locale.postfixCombiner],squared:"squared","negative-squared":"black squared"},ROLE:{addition:"addition",multiplication:"multiplication",subtraction:"subtraction",division:"division",equality:"equality",inequality:"inequality",element:"element",arrow:"arrow",determinant:"determinant",rowvector:"row vector",binomial:"binomial",squarematrix:"square matrix",multiline:"multiple lines",matrix:"matrix",vector:"vector",cases:"case statement",table:"table",unknown:"unknown"},ENCLOSE:{longdiv:"long division",actuarial:"actuarial symbol",radical:"square root",box:"box",roundedbox:"rounded box",circle:"circle",left:"left vertical-line",right:"right vertical-line",top:"overbar",bottom:"underbar",updiagonalstrike:"crossout",downdiagonalstrike:"crossout",verticalstrike:"vertical strikeout",horizontalstrike:"crossout",madruwb:"Arabic factorial symbol",updiagonalarrow:"diagonal arrow",phasorangle:"phasor angle",unknown:"long division"},NAVIGATE:{COLLAPSIBLE:"collapsible",EXPANDABLE:"expandable",LEVEL:"Level"},REGEXP:{TEXT:"a-zA-Z",NUMBER:"((\\d{1,3})(?=(,| ))((,| )\\d{3})*(\\.\\d+)?)|^\\d*\\.\\d+|^\\d+",DECIMAL_MARK:"\\.",DIGIT_GROUP:",",JOINER_SUBSUPER:" ",JOINER_FRAC:""},SI:function(a,b){return{megaohm:"megohm",kiloohm:"kilohm"}[a+=b]||a},PLURAL:function(a){return/.*s$/.test(a)?a:a+"s"},NUMBERS:sre.Numbers.en.NUMBERS,ALPHABETS:{latinSmall:"abcdefghijklmnopqrstuvwxyz".split(""),latinCap:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),greekSmall:"nabla;alpha;beta;gamma;delta;epsilon;zeta;eta;theta;iota;kappa;lamda;mu;nu;xi;omicron;pi;rho;final sigma;sigma;tau;upsilon;phi;chi;psi;omega;partial differential;epsilon;theta;kappa;phi;rho;pi".split(";"),greekCap:"Alpha Beta Gamma Delta Epsilon Zeta Eta Theta Iota Kappa Lamda Mu Nu Xi Omicron Pi Rho Theta Sigma Tau Upsilon Phi Chi Psi Omega".split(" ")},ALPHABET_TRANSFORMERS:{digit:{default:function(a){return 0===a?"zero":sre.Numbers.en.numberToWords(a)},mathspeak:function(a){return a.toString()},clearspeak:function(a){return a.toString()}},letter:{default:function(a){return a}}},ALPHABET_PREFIXES:{capPrefix:{default:"cap",mathspeak:"upper"},smallPrefix:{default:""},digitPrefix:{default:""}},ALPHABET_COMBINER:sre.Locale.prefixCombiner},sre.Grammar.getInstance().setCorrection("noarticle",function(a){return sre.Grammar.getInstance().getParameter("noArticle")?"":a}),sre.Numbers.es={},sre.Numbers.es.onesNumbers_=" uno dos tres cuatro cinco seis siete ocho nueve diez once doce trece catorce quince dieciséis diecisiete dieciocho diecinueve veinte veintiuno veintidós veintitrés veinticuatro veinticinco veintiséis veintisiete veintiocho veintinueve".split(" "),sre.Numbers.es.tensNumbers_="   treinta cuarenta cincuenta sesenta setenta ochenta noventa".split(" "),sre.Numbers.es.hundredsNumbers_=" cien doscientos trescientos cuatrocientos quinientos seiscientos setecientos ochocientos novecientos".split(" "),sre.Numbers.es.largeNumbers_=";mil;millón;mil millónes;billón;mil billónes;trillón;mil trillónes;cuatrilló;mil cuatrillóes;quintillón;mil quintillónes;sextillón;mil sextillónes;septillón;mil septillónes;octillón;mil octillónes;nonillón;mil nonillónes;decillón;mil decillónes".split(";"),sre.Numbers.es.tensToWords_=function(a){var b=a%100;return b<30?sre.Numbers.es.onesNumbers_[b]:(a=sre.Numbers.es.tensNumbers_[Math.floor(b/10)],b=sre.Numbers.es.onesNumbers_[b%10],a&&b?a+" y "+b:a||b)},sre.Numbers.es.hundredsToWords_=function(a){var b=a%1e3,c=(a=Math.floor(b/100),sre.Numbers.es.hundredsNumbers_[a]),b=sre.Numbers.es.tensToWords_(b%100);return 1===a?b?c+"to "+b:c:c&&b?c+" "+b:c||b},sre.Numbers.es.numberToWords=function(a){if(a>=Math.pow(10,36))return a.toString();for(var b=0,c="";0<a;){var e,f,d=a%1e3;d&&(e=sre.Numbers.es.largeNumbers_[b],f=sre.Numbers.es.hundredsToWords_(d),c=b?1==d?(e=e.match("/^mil( |$)/")?e:"un "+e)+(c?" "+c:""):(e=e.replace(/\u00f3n$/,"ones"),sre.Numbers.es.hundredsToWords_(d)+" "+e+(c?" "+c:"")):f),a=Math.floor(a/1e3),b++}return c},sre.Numbers.es.onesOrdinals_="primera segunda tercera cuarta quinta sexta séptima octava novena décima undécima duodécima".split(" "),sre.Numbers.es.tensOrdinals_="décima vigésima trigésima cuadragésima quincuagésima sexagésima septuagésima octogésima nonagésima".split(" "),sre.Numbers.es.hundredsOrdinals_="centésima ducentésima tricentésima cuadringentésima quingentésima sexcentésima septingentésima octingentésima noningentésima".split(" "),sre.Numbers.es.numberToOrdinal=function(a,b){var c;return 1999<a?a.toString()+"a":a<=12?sre.Numbers.es.onesOrdinals_[a-1]:(b=[],1e3<=a&&(a-=1e3,b.push("milésima")),a&&(0<(c=Math.floor(a/100))&&(b.push(sre.Numbers.es.hundredsOrdinals_[c-1]),a%=100),a<=12||(0<(c=Math.floor(a/10))&&(b.push(sre.Numbers.es.tensOrdinals_[c-1]),a%=10),0<a))&&b.push(sre.Numbers.es.onesOrdinals_[a-1]),b.join(" "))},sre.Numbers.es.simpleOrdinal=function(a){var b=sre.Grammar.getInstance().getParameter("gender");return a.toString()+("female"===b?"a":"o")},sre.Numbers.es.NUMBERS={simpleOrdinal:sre.Numbers.es.simpleOrdinal,numberToWords:sre.Numbers.es.numberToWords,numberToOrdinal:sre.Numbers.es.numberToOrdinal,vulgarSep:"-"},function(a,b,c){return a="sans serif "+(c?c+" "+a:a),b?a+" "+b:a}),italianPostfixCombiner=(sre.Locale.es={MS:{START:"empezar",FRAC_V:"fracción",FRAC_B:"frac",FRAC_S:"frac",END:"finalizar",FRAC_OVER:"entre",TWICE:"",NEST_FRAC:"",ENDFRAC:"",SUPER:"super",SUB:"sub",SUP:"sup",SUPERSCRIPT:"superíndice",SUBSCRIPT:"subíndice",BASELINE:"línea base",BASE:"base",NESTED:"",NEST_ROOT:"",STARTROOT:"empezar raíz",ENDROOT:"finalizar raíz",ROOTINDEX:"índice de raíz",ROOT:"raíz",INDEX:"",UNDER:"bajo",UNDERSCRIPT:"bajoíndice",OVER:"sobre",OVERSCRIPT:"sobreíndice"},MS_FUNC:{FRAC_NEST_DEPTH:function(a){return!1},RADICAL_NEST_DEPTH:function(a){return""},COMBINE_ROOT_INDEX:sre.Locale.combinePostfixIndex,COMBINE_NESTED_FRACTION:function(a,b,c){return a+b+c},COMBINE_NESTED_RADICAL:function(a,b,c){return a+c},FONT_REGEXP:function(a){return RegExp("^"+a+" ")}},MS_ROOT_INDEX:{2:"cuadrada",3:"cúbica",4:"a la cuarta",5:"a la quinta",6:"a la sexta",7:"a la séptima",8:"a la octava",9:"a la novena",10:"a la décima"},FONT:{bold:"negrita","bold-fraktur":"negrita Fraktur","bold-italic":"negrita cursiva","bold-script":"negrita script",caligraphic:"caligráfica","caligraphic-bold":"caligráfica negrita","double-struck":"negrita de pizarra","double-struck-italic":"negrita de pizarra cursiva",fraktur:"Fraktur",fullwidth:"ancho completo",italic:"cursiva",monospace:"monoespacio",normal:"normal",oldstyle:"estilo antiguo","oldstyle-bold":"estilo antiguo negrita",script:"script","sans-serif":"sans serif","sans-serif-italic":"sans serif cursiva","sans-serif-bold":"sans serif negrita","sans-serif-bold-italic":"sans serif negrita cursiva",unknown:"desconocida"},ROLE:{addition:"adición",multiplication:"multiplicación",subtraction:"resta",division:"división",equality:"igualdad",inequality:"desigualdad",element:"elemento",arrow:"flecha",determinant:"determinante",rowvector:"fila vector",binomial:"binomial",squarematrix:"matriz cuadrada",multiline:"líneas múltiples",matrix:"matriz",vector:"vector",cases:"declaración de caso",table:"mesa",unknown:"desconocida"},ENCLOSE:{longdiv:"división larga",actuarial:"símbolo actuarial",radical:"raíz cuadrada",box:"caja",roundedbox:"caja redondeada",circle:"círculo",left:"barra vertical izquierda",right:"barra vertical derecha",top:"barra",bottom:"subbarra",updiagonalstrike:"tachadura",downdiagonalstrike:"tachadura",verticalstrike:"ponchado vertical",horizontalstrike:"cruce",madruwb:"símbolo factorial árabe",updiagonalarrow:"flecha diagonal",phasorangle:"ángulo de fasores",unknown:"división larga"},EMBELLISH:{super:"superíndice",sub:"subíndice",circled:["en circulo",sre.Locale.postfixCombiner],parenthesized:["entre paréntesis",sre.Locale.postfixCombiner],period:["punto",sre.Locale.postfixCombiner],"negative-circled":["en circulo negro",sre.Locale.postfixCombiner],"double-circled":["en doble circulo",sre.Locale.postfixCombiner],"circled-sans-serif":["en circulo",sansserifCombiner],"negative-circled-sans-serif":["en circulo negro",sansserifCombiner],comma:["coma",sre.Locale.postfixCombiner],squared:["en cuadrado",sre.Locale.postfixCombiner],"negative-squared":["en cuadrado negro",sre.Locale.postfixCombiner]},NAVIGATE:{COLLAPSIBLE:"plegable",EXPANDABLE:"ampliable",LEVEL:"nivel"},REGEXP:{TEXT:"a-zA-ZáéíóúñÁÉÍÓÚÑ",NUMBER:"((\\d{1,3})(?=( ))(( )\\d{3})*(,\\d+)?)|^\\d*,\\d+|^\\d+",DECIMAL_MARK:",",DIGIT_GROUP:"",JOINER_SUBSUPER:" ",JOINER_FRAC:" "},PLURAL:function(a){return/.*(a|e|i|o|u)$/.test(a)?a+"s":/.*z$/.test(a)?a.slice(0,-1)+"ces":/.*c$/.test(a)?a.slice(0,-1)+"ques":/.*g$/.test(a)?a+"ues":/.*\u00f3n$/.test(a)?a.slice(0,-2)+"ones":a+"es"},SI:function(a,b){return(a=b.match(/^metro/)?a.replace(/a$/,"á").replace(/o$/,"ó").replace(/i$/,"í"):a)+b},NUMBERS:sre.Numbers.es.NUMBERS,ALPHABETS:{latinSmall:"abcdefghijklmnopqrstuvwxyz".split(""),latinCap:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),greekSmall:"nabla;alfa;beta;gamma;delta;épsilon;zeta;eta;theta;iota;kappa;lambda;mi;ni;xi;ómicron;pi;rho;sigma final;sigma;tau;ípsilon;phi;ji;psi;omega;diferencial parcial;épsilon;theta;kappa;phi;rho;pi".split(";"),greekCap:"Alfa Beta Gamma Delta Épsilon Zeta Eta Theta Iota Kappa Lambda Mi Ni Xi Ómicron Pi Rho Theta Sigma Tau Ípsilon Phi Ji Psi Omega".split(" ")},ALPHABET_TRANSFORMERS:{digit:{default:function(a){return 0===a?"cero":sre.Numbers.es.numberToWords(a)},mathspeak:function(a){return a.toString()},clearspeak:function(a){return a.toString()}},letter:{default:function(a){return a}}},ALPHABET_PREFIXES:{capPrefix:{default:"mayúscula"},smallPrefix:{default:""},digitPrefix:{default:""}},ALPHABET_COMBINER:sre.Locale.prefixCombiner,UNIT_TIMES:"por"},sre.Numbers.fr={},sre.Numbers.fr.SUB_ISO="fr",sre.Numbers.fr.onesNumbers_=" un deux trois quatre cinq six sept huit neuf dix onze douze treize quatorze quinze seize dix-sept dix-huit dix-neuf".split(" "),sre.Numbers.fr.tensNumbers_={fr:"  vingt trente quarante cinquante soixante soixante-dix quatre-vingts quatre-vingt-dix".split(" "),be:"  vingt trente quarante cinquante soixante septante quatre-vingts nonante".split(" "),sw:"  vingt trente quarante cinquante soixante septante huitante nonante".split(" ")},sre.Numbers.fr.largeNumbers_=";mille;millions;milliards;billions;mille billions;trillions;mille trillions;quadrillions;mille quadrillions;quintillions;mille quintillions".split(";"),sre.Numbers.fr.hundredsToWords_=function(a){var c,d,b=a%1e3;return a=sre.Numbers.fr.onesNumbers_[Math.floor(b/100)]?sre.Numbers.fr.onesNumbers_[Math.floor(b/100)]+"-cent":"",(b%=100)&&(a+=a?"-":"",(c=sre.Numbers.fr.onesNumbers_[b])?a+=c:(d=sre.Numbers.fr.tensNumbers_[sre.Numbers.fr.SUB_ISO][Math.floor(b/10)]).match(/\-dix$/)?(c=sre.Numbers.fr.onesNumbers_[b%10+10],a+=d.replace(/\-dix$/,"")+"-"+c):a+=d+(b%10?"-"+sre.Numbers.fr.onesNumbers_[b%10]:"")),(b=a.match(/s\-\w+$/))?a.replace(/s\-\w+$/,b[0].slice(1)):a.replace(/\-un$/,"-et-un")},sre.Numbers.fr.numberToWords=function(a){if(a>=Math.pow(10,36))return a.toString();for(var b=0,c="";0<a;){var e,f,d=a%1e3;d&&(e=sre.Numbers.fr.largeNumbers_[b],f=sre.Numbers.fr.hundredsToWords_(d),c=e&&e.match(/^mille /)?(d=e.replace(/^mille /,""),c.match(RegExp(d))?f+(b?"-mille-":"")+c:c.match(RegExp(d.replace(/s$/,"")))?f+(b?"-mille-":"")+c.replace(d.replace(/s$/,""),d):f+(b?"-"+e+"-":"")+c):(e=1===d&&e?e.replace(/s$/,""):e,f+(b?"-"+e+"-":"")+c)),a=Math.floor(a/1e3),b++}return c.replace(/-$/,"")},sre.Numbers.fr.SMALL_ORDINAL={1:"unième",2:"demi",3:"tiers",4:"quart"},sre.Numbers.fr.numberToOrdinal=function(a,b){var c=sre.Numbers.fr.SMALL_ORDINAL[a]||sre.Numbers.fr.wordOrdinal(a);return 3!==a&&b?c+"s":c},sre.Numbers.fr.wordOrdinal=function(a){return 1===a?"première":((a=sre.Numbers.fr.numberToWords(a)).match(/^neuf$/)?a=a.slice(0,-1)+"v":a.match(/cinq$/)?a+="u":a.match(/trois$/)||!a.match(/e$/)&&!a.match(/s$/)||(a=a.slice(0,-1)),a+"ième")},sre.Numbers.fr.simpleOrdinal=function(a){var b=sre.Grammar.getInstance().getParameter("gender");return 1===a?a.toString()+("male"===b?"er":"re"):a.toString()+"e"},sre.Numbers.fr.NUMBERS={wordOrdinal:sre.Numbers.fr.wordOrdinal,simpleOrdinal:sre.Numbers.fr.simpleOrdinal,numberToWords:sre.Numbers.fr.numberToWords,numberToOrdinal:sre.Numbers.fr.numberToOrdinal,vulgarSep:"-"},sre.Locale.fr={MS:{START:"début",FRAC_V:"fraction",FRAC_B:"frac",FRAC_S:"frac",END:"fin",FRAC_OVER:"sur",ONCE:"1",TWICE:"2",NEST_FRAC:"imbriquée",ENDFRAC:"fin frac",SUPER:"sup",SUB:"sub",SUP:"sup",SUPERSCRIPT:"exposant",SUBSCRIPT:"indice",BASELINE:"position de base",BASE:"position de base",NESTED:"imbriquée",NEST_ROOT:"imbriquée",STARTROOT:"début racine",ENDROOT:"fin racine",ROOTINDEX:"indice du radical",ROOT:"racine",INDEX:"indice",UNDER:"sous",UNDERSCRIPT:"souscript",OVER:"sus",OVERSCRIPT:"suscript"},MS_FUNC:{FRAC_NEST_DEPTH:function(a){return!1},RADICAL_NEST_DEPTH:sre.Locale.nestingToString,COMBINE_ROOT_INDEX:sre.Locale.combinePostfixIndex,COMBINE_NESTED_FRACTION:function(a,b,c){return c.replace(/ $/g,"")+b+a},COMBINE_NESTED_RADICAL:function(a,b,c){return c+" "+a},FONT_REGEXP:function(a){return RegExp(" (en |)"+a+"$")}},MS_ROOT_INDEX:{2:"carrée",3:"cubique"},FONT:{bold:"en gras","bold-fraktur":"en gothique gras","bold-italic":"en italique gras","bold-script":"de ronde en gras",caligraphic:"en calligraphique","caligraphic-bold":"en calligraphique gras","double-struck":"ajouré","double-struck-italic":"ajouré en italique",fraktur:"en gothique",fullwidth:"en pleine largeur",italic:"en italique",monospace:"en chasse fixe",normal:"en normal",oldstyle:"en ancien","oldstyle-bold":"en ancien gras",script:"de ronde","sans-serif":"sans empattement","sans-serif-italic":"en italique sans empattement","sans-serif-bold":"en gras sans empattement","sans-serif-bold-italic":"en italique gras sans empattement",unknown:"inconnu"},EMBELLISH:{super:["exposant",sre.Locale.prefixCombiner],sub:["indice",sre.Locale.prefixCombiner],circled:"encerclé",parenthesized:"entre parenthèses",period:"un point","negative-circled":"encerclé noir","double-circled":"encerclé double","circled-sans-serif":"sans empattement encerclé","negative-circled-sans-serif":"sans empattement encerclé noir",comma:"virgule",squared:"encadré","negative-squared":"encadré inverse"},ROLE:{addition:"addition",multiplication:"multiplication",subtraction:"soustraction",division:"division",equality:"égalité",inequality:"inégalité",element:"élément",arrow:"flèche",determinant:"déterminant",rowvector:"vecteur-rangée",binomial:"binomial",squarematrix:"matrice carrée","set empty":"ensemble vide","set extended":"extension","set singleton":"singleton","set collection":"collection",label:"étiquette",multiline:"multi-ligne",matrix:"matrice",vector:"vecteur",cases:"déclaration de cas",table:"tableau",unknown:"inconnu"},ENCLOSE:{longdiv:"longue division",actuarial:"notation actuarielle",radical:"radical",box:"boîte",roundedbox:"boîte arrondie",circle:"cercle",left:"barre verticale gauche",right:"barre verticale droite",top:"trait suscrit",bottom:"trait souscrit",updiagonalstrike:"texte biffé diagonal montant",downdiagonalstrike:"texte biffé diagonal descendant",verticalstrike:"texte biffé vertical",horizontalstrike:"texte biffé horizontal",madruwb:"symbole factorielle arabe",updiagonalarrow:"flèche diagonale montante",phasorangle:"angle de phase",unknown:"division longue"},NAVIGATE:{COLLAPSIBLE:"compressible",EXPANDABLE:"décompressible",LEVEL:"niveau"},REGEXP:{TEXT:"a-zA-ZàâæçéèêëîïôœùûüÿÀÂÆÇÉÈÊËÎÏÔŒÙÛÜŸ",NUMBER:"((\\d{1,3})(?=( ))(( )\\d{3})*(,\\d+)?)|^\\d*,\\d+|^\\d+",DECIMAL_MARK:",",DIGIT_GROUP:"",JOINER_SUBSUPER:"-",JOINER_FRAC:" "},SI:function(a,b){return a+b},PLURAL:function(a){return/.*s$/.test(a)?a:a+"s"},NUMBERS:sre.Numbers.fr.NUMBERS,ALPHABETS:{latinSmall:"abcdefghijklmnopqrstuvwxyz".split(""),latinCap:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),greekSmall:"nabla;alpha;bêta;gamma;delta;epsilon;zêta;êta;thêta;iota;kappa;lambda;mû;nû;xi;omicron;pi;rhô;sigma final;sigma;tau;upsilon;phi;chi;psi;oméga;dérivée partielle;epsilon;thêta;kappa;phi;rhô;pi".split(";"),greekCap:"Alpha Bêta Gamma Delta Epsilon Zêta Êta Thêta Iota Kappa Lambda Mû Nû Xi Omicron Pi Rhô Thêta Sigma Tau Upsilon Phi Chi Psi Oméga".split(" ")},ALPHABET_TRANSFORMERS:{digit:{default:function(a){return 0===a?"zero":sre.Numbers.fr.numberToWords(a)},mathspeak:function(a){return a.toString()},clearspeak:function(a){return a.toString()}},letter:{default:function(a){return a}}},ALPHABET_PREFIXES:{capPrefix:{default:"majuscule"},smallPrefix:{default:""},digitPrefix:{default:""}},ALPHABET_COMBINER:function(a,b,c){return a=c?a+" "+c:a,b?a+" "+b:a}},sre.Numbers.hi={},sre.Numbers.hi.onesNumbers_=" एक दो तीन चार पाँच छः सात आठ नौ दस ग्यारह बारह तेरह चौदह पंद्रह सोलह सत्रह अठारह उन्नीस बीस इक्कीस बाईस तेइस चौबीस पच्चीस छब्बीस सताइस अट्ठाइस उनतीस तीस इकतीस बतीस तैंतीस चौंतीस पैंतीस छतीस सैंतीस अड़तीस उनतालीस चालीस इकतालीस बयालीस तैतालीस चवालीस पैंतालीस छयालिस सैंतालीस अड़तालीस उनचास पचास इक्यावन बावन तिरपन चौवन पचपन छप्पन सतावन अठावन उनसठ साठ इकसठ बासठ तिरसठ चौंसठ पैंसठ छियासठ सड़सठ अड़सठ उनहतर सत्तर इकहतर बहतर तिहतर चौहतर पचहतर छिहतर सतहतर अठहतर उन्नासी अस्सी इक्यासी बयासी तिरासी चौरासी पचासी छियासी सतासी अट्ठासी नवासी नब्बे इक्यानवे ब्यानवे तिरानवे चौरानवे पचानवे छियानवे सतानवे अट्ठानवे निन्यानवे".split(" "),sre.Numbers.hi.hundred_="सौ",sre.Numbers.hi.largeNumbers_="हजार लाख करोड़ अरब खरब नील पद्मा शंख महाशंख महाउपाध जल्द परार्ध अंत शिष्ट".split(" "),sre.Numbers.hi.hundredsToWords_=function(a){a%=1e3;var b=""+(sre.Numbers.hi.onesNumbers_[Math.floor(a/100)]?sre.Numbers.hi.onesNumbers_[Math.floor(a/100)]+sre.Numbers.hi.NUMBERS.numSep+sre.Numbers.hi.hundred_:"");return b=(a%=100)?(b+=b?sre.Numbers.hi.NUMBERS.numSep:"")+sre.Numbers.hi.onesNumbers_[a]:b},sre.Numbers.hi.numberToWords=function(a){if(a>=Math.pow(10,32))return a.toString();var b=0,c="",d=sre.Numbers.hi.hundredsToWords_(a%1e3);if(!(a=Math.floor(a/1e3)))return d;for(;0<a;){var e=a%100;e&&(c=sre.Numbers.hi.onesNumbers_[e]+sre.Numbers.hi.NUMBERS.numSep+sre.Numbers.hi.largeNumbers_[b]+(c?sre.Numbers.hi.NUMBERS.numSep+c:"")),a=Math.floor(a/100),b++}return d?c+sre.Numbers.hi.NUMBERS.numSep+d:c},sre.Numbers.hi.smallDenominators_=" एकांश द्वितीयांश तृतीयांश चतुर्थांश पंचमांश षष्टांश सप्तमांश अष्टांश नवमांश दशांश".split(" "),sre.Numbers.hi.numberToOrdinal=function(a,b){return a<=10?sre.Numbers.hi.smallDenominators_[a]:sre.Numbers.hi.wordOrdinal(a)+" अंश"},sre.Numbers.hi.ordinalsMasculine_=" पहला दूसरा तीसरा चौथा पांचवाँ छठा सातवाँ आठवाँ नौवाँ".split(" "),sre.Numbers.hi.ordinalsFeminine_=" पहली दूसरी तीसरी चौथी पाँचवीं छठी सातवीं आठवीं नौवीं".split(" "),sre.Numbers.hi.wordOrdinal=function(a){var b=sre.Grammar.getInstance().getParameter("gender");return a<=0?a.toString():a<10?("female"===b?sre.Numbers.hi.ordinalsFeminine_:sre.Numbers.hi.ordinalsMasculine_)[a]:sre.Numbers.hi.numberToWords(a)+("female"===b?"वीं":"वाँ")},sre.Numbers.hi.simpleNumbers_="०१२३४५६७८९".split(""),sre.Numbers.hi.simpleSmallOrdinalsMasculine_=" १ला २रा ३रा ४था ५वाँ ६ठा ७वाँ ८वाँ ९वाँ".split(" "),sre.Numbers.hi.simpleSmallOrdinalsFeminine_=" १ली २री ३री ४थी ५वीं ६ठी ७वीं ८वीं ९वीं".split(" "),sre.Numbers.hi.simpleOrdinal=function(a){var b=sre.Grammar.getInstance().getParameter("gender");return 0<a&&a<10?("female"===b?sre.Numbers.hi.simpleSmallOrdinalsFeminine_:sre.Numbers.hi.simpleSmallOrdinalsMasculine_)[a]:a.toString().split("").map(function(c){return c=parseInt(c,10),isNaN(c)?"":sre.Numbers.hi.simpleNumbers_[c]}).join("")+("female"===b?"वीं":"वाँ")},sre.Numbers.hi.NUMBERS={wordOrdinal:sre.Numbers.hi.wordOrdinal,simpleOrdinal:sre.Numbers.hi.simpleOrdinal,numberToWords:sre.Numbers.hi.numberToWords,numberToOrdinal:sre.Numbers.hi.numberToOrdinal,vulgarSep:" ",numSep:" "},sre.Locale.hi={MS:{START:"आरंभ",FRAC_V:"भिन्न",FRAC_B:"भिन्न",FRAC_S:"भिन्न",END:"अंत",FRAC_OVER:"के हर में",TWICE:"दुबारा",NEST_FRAC:"नीड़ित भिन्न",ENDFRAC:"भिन्न समाप्त",SUPER:"उर्ध्व",SUB:"अधो",SUP:"उर्ध्व",SUPERSCRIPT:"उर्ध्वान्क",SUBSCRIPT:"पादांक",BASELINE:"आधार रेखा",BASE:"आधार",NESTED:"नीड़ित",NEST_ROOT:"नीड़ित मूल",STARTROOT:"मूल आरंभ",ENDROOT:"मूल समाप्त",ROOTINDEX:"मूलांक",ROOT:"मूल",INDEX:"मूलांक",UNDER:"निचे",UNDERSCRIPT:"निम्नांक",OVER:"ऊपर",OVERSCRIPT:"उर्ध्व लिपि"},MS_FUNC:{FRAC_NEST_DEPTH:sre.Locale.vulgarNestingDepth,RADICAL_NEST_DEPTH:sre.Locale.nestingToString,COMBINE_ROOT_INDEX:function(a,b){return a},COMBINE_NESTED_FRACTION:function(a,b,c){return a+b+c},COMBINE_NESTED_RADICAL:function(a,b,c){return a+b+c},FONT_REGEXP:function(a){return new RegExp("^"+a.split(/ |-/).join("( |-)")+"( |-)")}},MS_ROOT_INDEX:{},FONT:{bold:"बोल्ड","bold-fraktur":"बोल्ड फ़्रेक्टुर","bold-italic":"बोल्ड इटैलिक","bold-script":"बोल्ड स्क्रिप्ट",caligraphic:"caligraphic","caligraphic-bold":"caligraphic-bold","double-struck":"डबल-स्ट्रक","double-struck-italic":"डबल-स्ट्रक इटैलिक",fraktur:"फ़्राक्टुर",fullwidth:"पूर्णता",italic:"इटैलिक",monospace:"मोनोपेस",normal:"सामान्य",oldstyle:"oldstyle","oldstyle-bold":"oldstyle-bold",script:"लिपि","sans-serif":"संस-सेरिफ़","sans-serif-bold":"संस-सेरिफ़ बोल्ड","sans-serif-italic":"सैंस-सेरिफ़ इटैलिक","sans-serif-bold-italic":"संस-सेरिफ़ बोल्ड इटैलिक",unknown:"unknown"},EMBELLISH:{super:"सुपरस्क्रिप्ट",sub:"सबस्क्रिप्ट",circled:"सर्किल",parenthesized:"कोष्ठक",period:["पूर्ण विराम",sre.Locale.postfixCombiner],"negative-circled":"नेगेटिव सर्किल","double-circled":"डबल सर्किल","circled-sans-serif":"सर्किल सैंस-सेरिफ़","negative-circled-sans-serif":"नेगेटिव सर्किल सैंस-सेरिफ़",comma:["अल्प विराम",sre.Locale.postfixCombiner],squared:"चुकता","negative-squared":"नकारात्मक वर्ग"},ROLE:{addition:"योग",multiplication:"गुणन",subtraction:"व्यवकलन",division:"विभाजन",equality:"समता",inequality:"असमता",element:"अवयव",arrow:"तीर",determinant:"सारणिक",rowvector:"पंक्ति सदिश",binomial:"द्विपद",squarematrix:"वर्ग आव्यूह","set empty":"रिक्त समुच्चय","set extended":"समुच्चय विस्तार","set singleton":"वर्ग आव्यूह","set collection":"संग्रह",label:"सूचक पर्चा",multiline:"बहु रेखाएं",matrix:"आव्यूह",vector:"सदिश",cases:"फलन उपशर्त",table:"सारणी",unknown:"अज्ञात"},ENCLOSE:{longdiv:"विस्तृत विभाजन",actuarial:"बीमांकिक प्रतिक",radical:"वर्ग मूल",box:"कोष्ठ",roundedbox:"भोथरा कोष्ठ",circle:"वर्तुल",left:"वाम ऊर्ध्वाधर रेखा",right:"दक्षिण ऊर्ध्वाधर रेखा",top:"क्षैतिज ऊर्ध्वरेखा",bottom:"क्षैतिज पादरेखा",updiagonalstrike:"उर्ध्वगामी विकर्ण छेदिका",downdiagonalstrike:"अधोगामी विकर्ण छेदिका",verticalstrike:"ऊर्ध्वाधर छेदिका",horizontalstrike:"छेदन रेखा",madruwb:"Arabic factorial symbol",updiagonalarrow:"उर्ध्वगामी विकर्ण तीर",phasorangle:"फेजर कोण",unknown:"लंबा विभाजन"},NAVIGATE:{COLLAPSIBLE:"निपातीय",EXPANDABLE:"विस्तारनीय",LEVEL:"स्तर"},REGEXP:{TEXT:"a-zA-Z",NUMBER:"((\\d{1,3})(?=(,| ))((,| )\\d{3})*(\\.\\d+)?)|^\\d*\\.\\d+|^\\d+",DECIMAL_MARK:"\\.",DIGIT_GROUP:",",JOINER_SUBSUPER:" ",JOINER_FRAC:""},SI:function(a,b){return a+b},PLURAL:function(a){return a},NUMBERS:sre.Numbers.hi.NUMBERS,ALPHABETS:{latinSmall:"ए बी सी डी ई एफ जी एच आय जे के एल एम एन ओ पी क्यू आर एस टी यू वी डब्ल्यू एक्स वाई जेड".split(" "),latinCap:"ए बी सी डी ई एफ जी एच आय जे के एल एम एन ओ पी क्यू आर एस टी यू वी डब्ल्यू एक्स वाई जेड".split(" "),greekSmall:"नाबला;आल्फा;बीटा;गामा;डेल्टा;एप्सिलॉन;ज़ेटा;एटा;थीटा;आयोटा;कप्पा;लैम्ब्डा;मु;नू;ग्जाए;ओमिक्रॉन;पाइ;रो;अंतिम सिग्मा ;सिग्मा;टाउ;अपसिलं;फाई;काई;साई;ओमेगा;आंशिक अवकलन;ल्यूनेट एप्सिलॉन ;थीटा ;कप्पा ;फाई;रो ;पोमेगा".split(";"),greekCap:"आल्फा बीटा गामा डेल्टा एप्सिलॉन ज़ेटा एटा थीटा आयोटा कप्पा लैम्ब्डा मु नू ग्जाए ओमिक्रॉन पाइ रो थीटा सिग्मा टाउ अपसिलं फाई काई साई ओमेगा".split(" ")},ALPHABET_TRANSFORMERS:{digit:{default:function(a){return 0===a?"शून्य":sre.Numbers.hi.numberToWords(a)},mathspeak:function(a){return a.toString()},clearspeak:function(a){return a.toString()}},letter:{default:function(a){return a}}},ALPHABET_PREFIXES:{capPrefix:{default:"कैपिटल"},smallPrefix:{default:""},digitPrefix:{default:""}},ALPHABET_COMBINER:sre.Locale.prefixCombiner},sre.Numbers.it={},sre.Numbers.it.onesNumbers_=" uno due tre quattro cinque sei sette otto nove dieci undici dodici tredici quattordici quindici sedici diciassette diciotto diciannove".split(" "),sre.Numbers.it.tensNumbers_="  venti trenta quaranta cinquanta sessanta settanta ottanta novanta".split(" "),sre.Numbers.it.largeNumbers_=" mille milione miliardo bilione biliardo trilione triliardo quadrilione quadriliardo quntilione quintiliardo".split(" "),sre.Numbers.it.hundredsToWords_=function(a){a%=1e3;var c,d,b=sre.Numbers.it.onesNumbers_[Math.floor(a/100)]?sre.Numbers.it.onesNumbers_[Math.floor(a/100)]+sre.Numbers.it.NUMBERS.numSep+"cento":"";return(a%=100)&&(b+=b?sre.Numbers.it.NUMBERS.numSep:"",(c=sre.Numbers.it.onesNumbers_[a])?b+=c:(c=sre.Numbers.it.tensNumbers_[Math.floor(a/10)],b=b+(c=1!=(d=a%10)&&8!=d?c:c.slice(0,-1))+(d?sre.Numbers.it.NUMBERS.numSep+sre.Numbers.it.onesNumbers_[a%10]:""))),b},sre.Numbers.it.numberToWords=function(a){if(a>=Math.pow(10,36))return a.toString();if(1===a&&sre.Grammar.getInstance().getParameter("fraction"))return"un";for(var b=0,c="";0<a;)a%1e3&&(c=sre.Numbers.it.hundredsToWords_(a%1e3)+(b?"-"+sre.Numbers.it.largeNumbers_[b]+"-":"")+c),a=Math.floor(a/1e3),b++;return c.replace(/-$/,"")},sre.Numbers.it.numberToOrdinal=function(a,b){return 2===a?b?"mezzi":"mezzo":(a=sre.Numbers.it.wordOrdinal(a),b?(b=a.match(/o$/)?"i":"e",a.slice(0,-1)+b):a)},sre.Numbers.it.onesOrdinals_="zero primo secondo terzo quarto quinto sesto settimo ottavo nono decimo".split(" "),sre.Numbers.it.wordOrdinal=function(a){var b="male"===sre.Grammar.getInstance().getParameter("gender")?"o":"a",c=sre.Numbers.it.onesOrdinals_[a];return c?c.slice(0,-1)+b:(c=sre.Numbers.it.numberToWords(a)).slice(0,-1)+"esim"+b},sre.Numbers.it.simpleOrdinal=function(a){var b=sre.Grammar.getInstance().getParameter("gender");return a.toString()+("male"===b?"o":"a")},sre.Numbers.it.NUMBERS={wordOrdinal:sre.Numbers.it.wordOrdinal,simpleOrdinal:sre.Numbers.it.simpleOrdinal,numberToWords:sre.Numbers.it.numberToWords,numberToOrdinal:sre.Numbers.it.numberToOrdinal,vulgarSep:" ",numSep:""},function(a,b,c){return a.match(/^[a-zA-Z]$/)&&(b=b.replace("cerchiato","cerchiata")),a=c?a+" "+c:a,b?a+" "+b:a}),simpleEnglish=(sre.Locale.it={MS:{START:"inizio",FRAC_V:"frazione",FRAC_B:"frazione",FRAC_S:"frazione",END:"fine",FRAC_OVER:"fratto",ONCE:"una volta",TWICE:"due volte",NEST_FRAC:"annidamento",ENDFRAC:"fine frazione",SUPER:"super",SUB:"sub",SUP:"sup",SUPERSCRIPT:"apice",SUBSCRIPT:"pedice",BASELINE:"linea di base",BASE:"base",NESTED:"annidato",NEST_ROOT:"annidamento",STARTROOT:"inizio radice",ENDROOT:"fine radice",ROOTINDEX:"indice radice",ROOT:"radice",INDEX:"indice Radice",UNDER:"sotto",UNDERSCRIPT:"sottoscritto",OVER:"sopra",OVERSCRIPT:"soprascritto"},MS_FUNC:{FRAC_NEST_DEPTH:function(a){return!1},RADICAL_NEST_DEPTH:sre.Locale.nestingToString,COMBINE_ROOT_INDEX:sre.Locale.combinePostfixIndex,COMBINE_NESTED_FRACTION:function(a,b,c){return c.replace(/ $/g,"")+b+a},COMBINE_NESTED_RADICAL:function(a,b,c){return c+" "+a},FONT_REGEXP:function(a){return RegExp(" (en |)"+a+"$")}},MS_ROOT_INDEX:{2:"",3:""},FONT:{bold:"grassetto","bold-fraktur":"grassetto gotico","bold-italic":"grassetto italico","bold-script":"grassetto script",caligraphic:"calligrafico","caligraphic-bold":"grassetto calligrafico","double-struck":"grassetto da lavagna","double-struck-italic":"grassetto da lavagna italico",fraktur:"gotico",fullwidth:"fullwidth",italic:"italico",monospace:"monospazio",normal:"normale",oldstyle:"vecchio stile","oldstyle-bold":"vecchio stile grassetto",script:"script","sans-serif":"senza grazie","sans-serif-italic":"senza grazie italico","sans-serif-bold":"senza grazie grassetto","sans-serif-bold-italic":"senza grazie grassetto italico",unknown:"sconosciuto"},EMBELLISH:{super:["apice",sre.Locale.prefixCombiner],sub:["pedice",sre.Locale.prefixCombiner],circled:["cerchiato",italianPostfixCombiner],parenthesized:"tra parentesi",period:"punto","negative-circled":["cerchiato in negativo",italianPostfixCombiner],"double-circled":"doppio cerchiato","circled-sans-serif":"cerchiato senza grazie","negative-circled-sans-serif":"cerchiato in negativo senza grazie",comma:"virgola",squared:"dentro quadrato","negative-squared":"dentro quadrato in negativo"},ROLE:{addition:"addizione",multiplication:"moltiplicazione",subtraction:"sottrazione",division:"divisione",equality:"uguaglianza",inequality:"disuguaglianza",element:"elemento",arrow:"freccia",determinant:"determinante",rowvector:"vettore riga",binomial:"binomiale",squarematrix:"matrice quadrata","set empty":"insieme vuoto","set extended":"estensione di insieme","set singleton":"singoletto","set collection":"collezione",label:"eitchetta",multiline:"linee multiple",matrix:"matrice",vector:"vettore",cases:"comando switch",table:"tavola",unknown:"sconosciuto"},ENCLOSE:{longdiv:"divisione lunga",actuarial:"simbolo attuario",radical:"radice quadrata",box:"riquadro",roundedbox:"riquadro arrotondato",circle:"cerchio",left:"linea verticale sinistra",right:"linea verticale destra",top:"barra sopra",bottom:"barra sotto",updiagonalstrike:"cancellatura",downdiagonalstrike:"cancellatura",verticalstrike:"cancellatura verticale",horizontalstrike:"cancellatura",madruwb:"simbolo fattoriale arabo",updiagonalarrow:"freccia diagonale",phasorangle:"angolo fasore",unknown:"divisione lunga"},NAVIGATE:{COLLAPSIBLE:"collassabile",EXPANDABLE:"espandibile",LEVEL:"livello"},REGEXP:{TEXT:"a-zA-ZàèìòùéóÀ",NUMBER:"((\\d{1,3})(?=(.| ))((.| )\\d{3})*(\\,\\d+)?)|^\\d*\\,\\d+|^\\d+",DECIMAL_MARK:",",DIGIT_GROUP:"\\.",JOINER_SUBSUPER:" ",JOINER_FRAC:" "},PLURAL:function(a){return a},SI:function(a,b){return a+b},NUMBERS:sre.Numbers.it.NUMBERS,ALPHABETS:{latinSmall:"abcdefghijklmnopqrstuvwxyz".split(""),latinCap:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),greekSmall:"nabla;alfa;beta;gamma;delta;epsilon;zeta greca;eta;theta;iota;kappa greca;lambda;mu;nu;xi;omicron;pi greco;rho;sigma final;sigma;tau;upsilon;phi;chi;psi;omega;derivata parziale;epsilon;theta;kappa;phi;rho;pi".split(";"),greekCap:"Alfa;Beta;Gamma;Delta;Epsilon;Zeta greca;Eta;Theta;Iota;Kappa greca;Lambda;Mu;Nu;Xi;Omicron;Pi greca;Rho;Theta;Sigma;Tau;Upsilon;Phi;Chi;Psi;Omega".split(";")},ALPHABET_TRANSFORMERS:{digit:{default:function(a){return 0===a?"zero":sre.Numbers.it.numberToWords(a)},mathspeak:function(a){return a.toString()},clearspeak:function(a){return a.toString()}},letter:{default:function(a){return a}}},ALPHABET_PREFIXES:{capPrefix:{default:"maiuscola"},smallPrefix:{default:""},digitPrefix:{default:""}},ALPHABET_COMBINER:function(a,b,c){return a=c?a+" "+c:a,b?a+" "+b:a}},sre.Numbers.nemeth={},sre.Numbers.nemeth.oneNumbers_="⠴⠂⠆⠒⠲⠢⠖⠶⠦⠔".split(""),sre.Numbers.nemeth.numberToWords=function(a){return a.toString().split("").map(function(b){return sre.Numbers.nemeth.oneNumbers_[parseInt(b,10)]}).join("")},sre.Numbers.nemeth.NUMBERS={numberToWords:sre.Numbers.nemeth.numberToWords,simpleOrdinal:sre.Numbers.nemeth.numberToWords,vulgarSep:""},function(a){return a.match(RegExp("^"+sre.Locale.nemeth.ALPHABET_PREFIXES.languagePrefix.english))?a.slice(1):a}),postfixCombiner=function(a,b,c){return a=simpleEnglish(a),b?a+b:a},germanCombiner=function(a,b,c){return b+simpleEnglish(a)},embellishCombiner=function(a,b,c){return b+(c||"")+(a=simpleEnglish(a))+"⠻"},doubleEmbellishCombiner=function(a,b,c){return b+(c||"")+(a=simpleEnglish(a))+"⠻⠻"},parensCombiner=function(a,b,c){return b+(a=simpleEnglish(a))+"⠾"};sre.Locale.nemeth={MS:{FRACTION_REPEAT:"⠠",FRACTION_START:"⠹",FRAC_V:"⠹",FRAC_B:"Frac",FRAC_S:"Frac",END:"⠠",FRACTION_OVER:"⠌",TWICE:"Twice",NEST_FRAC:"Nest",ENDFRAC:"⠼",FRACTION_END:"⠼",SUPER:"⠘",SUB:"⠰",SUP:"⠘",SUPERSCRIPT:"⠘",SUBSCRIPT:"⠰",BASELINE:"⠐",BASE:"⠐",NESTED:"⠨",NEST_ROOT:"Nest",STARTROOT:"⠜",ENDROOT:"⠻",ROOTINDEX:"⠣",ROOT:"⠨",INDEX:"⠣",UNDER:"⠩",UNDERSCRIPT:"⠩",OVER:"⠣",OVERSCRIPT:"⠣"},MS_FUNC:{FRAC_NEST_DEPTH:function(a){return!1},RADICAL_NEST_DEPTH:function(a){return""},COMBINE_ROOT_INDEX:function(a,b){return a},FONT_REGEXP:function(a){return RegExp("^"+a)}},MS_ROOT_INDEX:{},FONT:{bold:"⠸","bold-fraktur":["⠸⠀⠸",germanCombiner],"bold-italic":"⠸⠨","bold-script":"⠸⠈",caligraphic:"⠈","caligraphic-bold":"⠈⠸","double-struck":"⠈","double-struck-italic":"⠸⠨",fraktur:["⠸",germanCombiner],fullwidth:"",italic:"⠨",monospace:"",normal:"",oldstyle:"","oldstyle-bold":"⠸",script:"⠈","sans-serif":"⠠⠨","sans-serif-italic":"⠠⠨⠨","sans-serif-bold":"⠠⠨⠸","sans-serif-bold-italic":"⠠⠨⠸⠨",unknown:""},EMBELLISH:{super:["⠘",germanCombiner],sub:["⠰",germanCombiner],circled:["⠫⠉⠸⠫",embellishCombiner],parenthesized:["⠷",parensCombiner],period:["⠸⠲",postfixCombiner],"negative-circled":["⠫⠸⠉⠸⠫",embellishCombiner],"double-circled":["⠫⠉⠸⠫⠫⠉⠸⠫",doubleEmbellishCombiner],"circled-sans-serif":["⠫⠉⠸⠫⠠⠨",embellishCombiner],"negative-circled-sans-serif":["⠫⠸⠉⠸⠫⠠⠨",embellishCombiner],comma:["⠠",postfixCombiner],squared:["⠫⠲⠸⠫",embellishCombiner],"negative-squared":["⠫⠸⠲⠸⠫",embellishCombiner]},ROLE:{addition:"addition",multiplication:"multiplication",subtraction:"subtraction",division:"division",equality:"equality",inequality:"inequality",element:"element",arrow:"arrow",determinant:"determinant",rowvector:"row vector",binomial:"binomial",squarematrix:"square matrix",multiline:"multiple lines",matrix:"matrix",vector:"vector",cases:"case statement",table:"table",unknown:"unknown"},ENCLOSE:{longdiv:"long division",actuarial:"actuarial symbol",radical:"square root",box:"⠗",roundedbox:"rounded box",circle:"⠉",left:"left vertical-line",right:"right vertical-line",top:"overbar",bottom:"underbar",updiagonalstrike:"crossout",downdiagonalstrike:"crossout",verticalstrike:"vertical strikeout",horizontalstrike:"crossout",madruwb:"Arabic factorial symbol",updiagonalarrow:"diagonal arrow",phasorangle:"⠪",unknown:"long division"},REGEXP:{TEXT:"a-zA-Z",NUMBER:"((\\d{1,3})(?=(,| ))((,| )\\d{3})*(\\.\\d+)?)|^\\d*\\.\\d+|^\\d+",DECIMAL_MARK:".",DIGIT_GROUP:",",JOINER_SUBSUPER:"",JOINER_FRAC:""},NAVIGATE:{COLLAPSIBLE:"collapsible",EXPANDABLE:"expandable",LEVEL:"Level"},NUMBERS:sre.Numbers.nemeth.NUMBERS,ALPHABETS:{latinSmall:"⠰⠁ ⠰⠃ ⠰⠉ ⠰⠙ ⠰⠑ ⠰⠋ ⠰⠛ ⠰⠓ ⠰⠊ ⠰⠚ ⠰⠅ ⠰⠇ ⠰⠍ ⠰⠝ ⠰⠕ ⠰⠏ ⠰⠟ ⠰⠗ ⠰⠎ ⠰⠞ ⠰⠥ ⠰⠧ ⠰⠺ ⠰⠭ ⠰⠽ ⠰⠵".split(" "),latinCap:"⠰⠠⠁ ⠰⠠⠃ ⠰⠠⠉ ⠰⠠⠙ ⠰⠠⠑ ⠰⠠⠋ ⠰⠠⠛ ⠰⠠⠓ ⠰⠠⠊ ⠰⠠⠚ ⠰⠠⠅ ⠰⠠⠇ ⠰⠠⠍ ⠰⠠⠝ ⠰⠠⠕ ⠰⠠⠏ ⠰⠠⠟ ⠰⠠⠗ ⠰⠠⠎ ⠰⠠⠞ ⠰⠠⠥ ⠰⠠⠧ ⠰⠠⠺ ⠰⠠⠭ ⠰⠠⠽ ⠰⠠⠵".split(" "),greekSmall:"⠨⠫ ⠨⠁ ⠨⠃ ⠨⠛ ⠨⠙ ⠨⠑ ⠨⠵ ⠨⠱ ⠨⠹ ⠨⠊ ⠨⠅ ⠨⠇ ⠨⠍ ⠨⠝ ⠨⠭ ⠨⠕ ⠨⠏ ⠨⠗ ⠨⠈⠎ ⠨⠎ ⠨⠞ ⠨⠥ ⠨⠈⠋ ⠨⠯ ⠨⠽ ⠨⠺ ⠈⠙ ⠨⠑ ⠨⠈⠹ ⠨⠅ ⠨⠋ ⠨⠗ ⠨⠏".split(" "),greekCap:"⠨⠠⠁ ⠨⠠⠃ ⠨⠠⠛ ⠨⠠⠙ ⠨⠠⠑ ⠨⠠⠵ ⠨⠠⠱ ⠨⠠⠹ ⠨⠠⠊ ⠨⠠⠅ ⠨⠠⠇ ⠨⠠⠍ ⠨⠠⠝ ⠨⠠⠭ ⠨⠠⠕ ⠨⠠⠏ ⠨⠠⠗ ⠨⠠⠹ ⠨⠠⠎ ⠨⠠⠞ ⠨⠠⠥ ⠨⠠⠋ ⠨⠠⠯ ⠨⠠⠽ ⠨⠠⠺".split(" ")},ALPHABET_TRANSFORMERS:{digit:{default:sre.Numbers.nemeth.numberToWords},letter:{default:function(a){return a}}},ALPHABET_PREFIXES:{capPrefix:{default:""},smallPrefix:{default:""},digitPrefix:{default:"⠼"},languagePrefix:{greek:"⠨",english:"⠰",german:"⠸",hebrew:"⠠⠠",number:"⠼"}},ALPHABET_COMBINER:function(a,b,c){return b?b+c+a:simpleEnglish(a)}},sre.L10n={},sre.L10n.setLocale=function(){var a=sre.L10n.getLocale();if(a)for(var b in a)sre.Messages[b]=a[b]},sre.L10n.getLocale=function(){var a=sre.Engine.getInstance().locale;return-1===sre.Variables.LOCALES.indexOf(a)&&(console.error("Locale "+a+" does not exist! Using en instead."),sre.Engine.getInstance().locale="en"),sre.Locale[sre.Engine.getInstance().locale]||sre.Locale.en},sre.EnrichCase=function(){},sre.EnrichCase.prototype.getMathml=function(){},sre.AbstractEnrichCase=function(a){this.semantic=a},sre.AbstractEnrichCase.prototype.getMathml=goog.abstractMethod,sre.EnrichCaseFactory=function(){},sre.EnrichCaseFactory.cases=[],sre.EnrichCaseFactory.getCase=function(a){for(var c,b=0;c=sre.EnrichCaseFactory.cases[b];b++)if(c.test(a))return new c.constr(a);return null},sre.SemanticSkeleton=function(a){this.array=a=0===a?a:a||[],this.levelsMap=this.parents=null},sre.SemanticSkeleton.prototype.populate=function(){this.parents&&this.levelsMap||(this.parents={},this.levelsMap={},this.populate_(this.array,this.array,[]))},sre.SemanticSkeleton.prototype.populate_=function(a,b,c){if(sre.SemanticSkeleton.simpleCollapseStructure(a))this.levelsMap[a]=b,this.parents[a]=a===c[0]?c.slice(1):c;else{c=[(b=sre.SemanticSkeleton.contentCollapseStructure(a)?a.slice(1):a)[0]].concat(c);for(var d=0,e=b.length;d<e;d++)this.populate_(b[d],a,c)}},sre.SemanticSkeleton.prototype.toString=function(){return sre.SemanticSkeleton.makeSexp_(this.array)},sre.SemanticSkeleton.makeSexp_=function(a){return sre.SemanticSkeleton.simpleCollapseStructure(a)?a.toString():sre.SemanticSkeleton.contentCollapseStructure(a)?"(c "+a.slice(1).map(sre.SemanticSkeleton.makeSexp_).join(" ")+")":"("+a.map(sre.SemanticSkeleton.makeSexp_).join(" ")+")"},sre.SemanticSkeleton.fromTree=function(a){return sre.SemanticSkeleton.fromNode(a.root)},sre.SemanticSkeleton.fromNode=function(a){return new sre.SemanticSkeleton(sre.SemanticSkeleton.fromNode_(a))},sre.SemanticSkeleton.fromString=function(a){return new sre.SemanticSkeleton(sre.SemanticSkeleton.fromString_(a))},sre.SemanticSkeleton.fromString_=function(a){return a=(a=(a=(a=a.replace(/\(/g,"[")).replace(/\)/g,"]")).replace(/ /g,",")).replace(/c/g,'"c"'),JSON.parse(a)},sre.SemanticSkeleton.fromNode_=function(a){var b,c,d;return a?((b=a.contentNodes).length&&(c=b.map(sre.SemanticSkeleton.fromNode_)).unshift("c"),(d=a.childNodes).length?(d=d.map(sre.SemanticSkeleton.fromNode_),b.length&&d.unshift(c),d.unshift(a.id),d):b.length?[a.id,c]:a.id):[]},sre.SemanticSkeleton.simpleCollapseStructure=function(a){return"number"==typeof a},sre.SemanticSkeleton.contentCollapseStructure=function(a){return!!a&&!sre.SemanticSkeleton.simpleCollapseStructure(a)&&"c"===a[0]},sre.SemanticSkeleton.interleaveIds=function(a,b){return sre.BaseUtil.interleaveLists(sre.SemanticSkeleton.collapsedLeafs(a),sre.SemanticSkeleton.collapsedLeafs(b))},sre.SemanticSkeleton.collapsedLeafs=function(a){return Array.prototype.slice.call(arguments,0).reduce(function(c,d){return c.concat(function(c){return sre.SemanticSkeleton.simpleCollapseStructure(c)?[c]:sre.SemanticSkeleton.contentCollapseStructure(c[1])?c.slice(2):c.slice(1)}(d))},[])},sre.SemanticSkeleton.fromStructure=function(a,b){return new sre.SemanticSkeleton(sre.SemanticSkeleton.tree_(a,b.root))},sre.SemanticSkeleton.tree_=function(a,b){if(!b)return[];if(!b.childNodes.length)return b.id;var e,d=[c=b.id],c=sre.XpathUtil.evalXPath(".//self::*[@"+sre.EnrichMathml.Attribute.ID+"="+c+"]",a)[0];for(b=sre.SemanticSkeleton.combineContentChildren(b,b.contentNodes.map(function(f){return f}),b.childNodes.map(function(f){return f})),c&&sre.SemanticSkeleton.addOwns_(c,b),c=0;e=b[c];c++)d.push(sre.SemanticSkeleton.tree_(a,e));return d},sre.SemanticSkeleton.addOwns_=function(a,b){var c=a.getAttribute(sre.EnrichMathml.Attribute.COLLAPSED);b=c?sre.SemanticSkeleton.realLeafs_(sre.SemanticSkeleton.fromString(c).array):b.map(function(d){return d.id}),a.setAttribute(sre.EnrichMathml.Attribute.OWNS,b.join(" "))},sre.SemanticSkeleton.realLeafs_=function(a){if(sre.SemanticSkeleton.simpleCollapseStructure(a))return[a];if(sre.SemanticSkeleton.contentCollapseStructure(a))return[];for(var b=[],c=1;c<a.length;c++)b=b.concat(sre.SemanticSkeleton.realLeafs_(a[c]));return b},sre.SemanticSkeleton.combineContentChildren=function(a,b,c){switch(a.type){case sre.Semantic.Type.RELSEQ:case sre.Semantic.Type.INFIXOP:case sre.Semantic.Type.MULTIREL:return sre.BaseUtil.interleaveLists(c,b);case sre.Semantic.Type.PREFIXOP:return b.concat(c);case sre.Semantic.Type.POSTFIXOP:return c.concat(b);case sre.Semantic.Type.FENCED:return c.unshift(b[0]),c.push(b[1]),c;case sre.Semantic.Type.APPL:return[c[0],b[0],c[1]];case sre.Semantic.Type.ROOT:return[c[1],c[0]];case sre.Semantic.Type.ROW:case sre.Semantic.Type.LINE:return b.length&&c.unshift(b[0]),c;default:return c}},sre.EnrichMathml={},sre.EnrichMathml.Error=function(a){Error.call(this),this.message=a||"",this.name="MathML Enrichment Error"},goog.inherits(sre.EnrichMathml.Error,Error),sre.EnrichMathml.SETTINGS={collapsed:!0,implicit:!0},sre.EnrichMathml.ATTRIBUTE_PREFIX_="data-semantic-",sre.EnrichMathml.Attribute={ADDED:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"added",ALTERNATIVE:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"alternative",CHILDREN:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"children",COLLAPSED:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"collapsed",CONTENT:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"content",EMBELLISHED:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"embellished",FENCEPOINTER:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"fencepointer",FONT:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"font",ID:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"id",ANNOTATION:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"annotation",OPERATOR:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"operator",OWNS:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"owns",PARENT:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"parent",POSTFIX:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"postfix",PREFIX:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"prefix",ROLE:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"role",SPEECH:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"speech",STRUCTURE:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"structure",TYPE:sre.EnrichMathml.ATTRIBUTE_PREFIX_+"type"},sre.EnrichMathml.enrich=function(a,b){var c=a.cloneNode(!0);return sre.EnrichMathml.walkTree(b.root),sre.Engine.getInstance().structure&&a.setAttribute(sre.EnrichMathml.Attribute.STRUCTURE,sre.SemanticSkeleton.fromStructure(a,b).toString()),sre.Debugger.getInstance().generateOutput(function(){return sre.EnrichMathml.formattedOutput(c,a,b,!0),[]}),a},sre.EnrichMathml.walkTree=function(a){var d,c,b=sre.EnrichCaseFactory.getCase(a);return b?c=b.getMathml():1===a.mathml.length?(sre.Debugger.getInstance().output("Walktree Case 0"),c=a.mathml[0],sre.EnrichMathml.setAttributes(c,a),a.childNodes.length&&(sre.Debugger.getInstance().output("Walktree Case 0.1"),a.childNodes.forEach(function(e){e.type===sre.SemanticAttr.Type.EMPTY&&c.appendChild(sre.EnrichMathml.walkTree(e))}))):(b=a.contentNodes.map(sre.EnrichMathml.cloneContentNode),sre.EnrichMathml.setOperatorAttribute_(a,b),d=a.childNodes.map(sre.EnrichMathml.walkTree),b=sre.SemanticSkeleton.combineContentChildren(a,b,d),c=null===(c=a.mathmlTree)?(sre.Debugger.getInstance().output("Walktree Case 1"),sre.EnrichMathml.introduceNewLayer(b,a)):(d=sre.EnrichMathml.attachedElement_(b),sre.Debugger.getInstance().output("Walktree Case 2"),d?(sre.Debugger.getInstance().output("Walktree Case 2.1"),d.parentNode):(sre.Debugger.getInstance().output("Walktree Case 2.2"),sre.EnrichMathml.getInnerNode(c))),c=sre.EnrichMathml.rewriteMfenced(c),sre.EnrichMathml.mergeChildren_(c,b,a),sre.EnrichMathml.setAttributes(c,a)),sre.EnrichMathml.ascendNewNode(c)},sre.EnrichMathml.introduceNewLayer=function(a,b){var c=sre.EnrichMathml.mathmlLca_(a),d=c.node,e=c.type;return e===sre.EnrichMathml.lcaType.VALID&&sre.SemanticUtil.hasEmptyTag(d)||(sre.Debugger.getInstance().output("Walktree Case 1.1"),d=sre.DomUtil.createElement("mrow"),e===sre.EnrichMathml.lcaType.PRUNED?(sre.Debugger.getInstance().output("Walktree Case 1.1.0"),d=sre.EnrichMathml.introduceLayerAboveLca(d,c.node,a)):a[0]&&(sre.Debugger.getInstance().output("Walktree Case 1.1.1"),c=sre.EnrichMathml.attachedElement_(a),a=sre.EnrichMathml.childrenSubset_(c.parentNode,a),sre.DomUtil.replaceNode(c,d),a.forEach(function(f){d.appendChild(f)}))),b.mathmlTree||(b.mathmlTree=d),d},sre.EnrichMathml.introduceLayerAboveLca=function(a,b,c){var e,d=sre.EnrichMathml.descendNode_(b);return sre.SemanticUtil.hasMathTag(d)&&(sre.Debugger.getInstance().output("Walktree Case 1.1.0.0"),sre.EnrichMathml.moveSemanticAttributes_(d,a),sre.DomUtil.toArray(d.childNodes).forEach(function(f){a.appendChild(f)}),e=a,a=d,d=e),b=c.indexOf(b),c[b]=d,sre.DomUtil.replaceNode(d,a),a.appendChild(d),c.forEach(function(f){a.appendChild(f)}),a},sre.EnrichMathml.moveSemanticAttributes_=function(a,b){for(var c in sre.EnrichMathml.Attribute){c=sre.EnrichMathml.Attribute[c];a.hasAttribute(c)&&(b.setAttribute(c,a.getAttribute(c)),a.removeAttribute(c))}},sre.EnrichMathml.childrenSubset_=function(a,b){var c=sre.DomUtil.toArray(a.childNodes),d=1/0,e=-1/0;return b.forEach(function(f){-1!==(f=c.indexOf(f))&&(d=Math.min(d,f),e=Math.max(e,f))}),c.slice(d,e+1)},sre.EnrichMathml.collateChildNodes_=function(a,b,c){var d=[];a=sre.DomUtil.toArray(a.childNodes);for(var e=!1;a.length;){var g,f=a.shift();f.hasAttribute(sre.EnrichMathml.Attribute.TYPE)?d.push(f):0!==(g=sre.EnrichMathml.collectChildNodes_(f)).length&&(1===g.length?d.push(f):(e?f.setAttribute("AuxiliaryImplicit",!0):e=!0,a=g.concat(a)))}for(a=[],c=c.childNodes.map(function(h){return h.mathmlTree});c.length;)if(e=c.pop()){if(-1!==d.indexOf(e))break;-1!==b.indexOf(e)&&a.unshift(e)}return d.concat(a)},sre.EnrichMathml.collectChildNodes_=function(a){var b=[];for(a=sre.DomUtil.toArray(a.childNodes);a.length;){var c=a.shift();c.nodeType===sre.DomUtil.NodeType.ELEMENT_NODE&&(c.hasAttribute(sre.EnrichMathml.Attribute.TYPE)?b.push(c):a=sre.DomUtil.toArray(c.childNodes).concat(a))}return b},sre.EnrichMathml.mergeChildren_=function(a,b,c){if((c=c.role===sre.SemanticAttr.Role.IMPLICIT&&sre.SemanticHeuristics.getInstance().flags.combine_juxtaposition?sre.EnrichMathml.collateChildNodes_(a,b,c):sre.DomUtil.toArray(a.childNodes)).length)for(var d=0;b.length;){var e=b[0];c[d]===e||sre.EnrichMathml.functionApplication_(c[d],e)?(b.shift(),d++):c[d]&&-1===b.indexOf(c[d])?d++:(sre.EnrichMathml.isDescendant_(e,a)||sre.EnrichMathml.insertNewChild_(a,c[d],e),b.shift())}else b.forEach(function(f){a.appendChild(f)})},sre.EnrichMathml.insertNewChild_=function(a,b,c){if(b){for(var d=sre.EnrichMathml.parentNode_(b);d&&d.firstChild===b&&!b.hasAttribute("AuxiliaryImplicit")&&d!==a;)b=d,d=sre.EnrichMathml.parentNode_(b);d&&(d.insertBefore(c,b),b.removeAttribute("AuxiliaryImplicit"))}else a.insertBefore(c,null)},sre.EnrichMathml.isDescendant_=function(a,b){if(a)do{if((a=a.parentNode)===b)return!0}while(a);return!1},sre.EnrichMathml.functionApplication_=function(a,b){var d,c=sre.SemanticAttr.functionApplication();if(a&&b&&a.textContent&&b.textContent&&a.textContent===c&&b.textContent===c&&"true"===b.getAttribute(sre.EnrichMathml.Attribute.ADDED)){c=0;for(;d=a.attributes[c];c++)b.hasAttribute(d.nodeName)||b.setAttribute(d.nodeName,d.nodeValue);return sre.DomUtil.replaceNode(a,b),!0}return!1},sre.EnrichMathml.lcaType={VALID:"valid",INVALID:"invalid",PRUNED:"pruned"},sre.EnrichMathml.mathmlLca_=function(a){var c,b,d,e;return(b=sre.EnrichMathml.attachedElement_(a))?b===(c=sre.EnrichMathml.attachedElement_(a.slice().reverse()))?{type:sre.EnrichMathml.lcaType.VALID,node:b}:(b=sre.EnrichMathml.pathToRoot_(b),d=sre.EnrichMathml.prunePath_(b,a),c=(a=sre.EnrichMathml.pathToRoot_(c,function(f){return-1!==d.indexOf(f)}))[0],-1===(e=d.indexOf(c))?{type:sre.EnrichMathml.lcaType.INVALID,node:null}:{type:d.length!==b.length?sre.EnrichMathml.lcaType.PRUNED:sre.EnrichMathml.validLca_(d[e+1],a[1])?sre.EnrichMathml.lcaType.VALID:sre.EnrichMathml.lcaType.INVALID,node:c}):{type:sre.EnrichMathml.lcaType.INVALID,node:null}},sre.EnrichMathml.prunePath_=function(a,b){for(var c=0;a[c]&&-1===b.indexOf(a[c]);)c++;return a.slice(0,c+1)},sre.EnrichMathml.attachedElement_=function(a){for(var b=0,c=null;!c&&b<a.length;)a[b].parentNode&&(c=a[b]),b++;return c},sre.EnrichMathml.pathToRoot_=function(a,b){b=b||function(d){return!1};for(var c=[a];!b(a)&&!sre.SemanticUtil.hasMathTag(a)&&a.parentNode;)a=sre.EnrichMathml.parentNode_(a),c.unshift(a);return c},sre.EnrichMathml.validLca_=function(a,b){return!(!a||!b||a.previousSibling||b.nextSibling)},sre.EnrichMathml.ascendNewNode=function(a){for(;!sre.SemanticUtil.hasMathTag(a)&&sre.EnrichMathml.unitChild_(a);)a=sre.EnrichMathml.parentNode_(a);return a},sre.EnrichMathml.descendNode_=function(a){var b=sre.DomUtil.toArray(a.childNodes);return b&&1===(b=b.filter(function(c){return c.nodeType===sre.DomUtil.NodeType.ELEMENT_NODE&&!sre.SemanticUtil.hasIgnoreTag(c)})).length&&sre.SemanticUtil.hasEmptyTag(b[0])&&!b[0].hasAttribute(sre.EnrichMathml.Attribute.TYPE)?sre.EnrichMathml.descendNode_(b[0]):a},sre.EnrichMathml.unitChild_=function(a){var b=sre.EnrichMathml.parentNode_(a);return!(!b||!sre.SemanticUtil.hasEmptyTag(b))&&sre.DomUtil.toArray(b.childNodes).every(function(c){return c===a||sre.EnrichMathml.isIgnorable_(c)})},sre.EnrichMathml.isIgnorable_=function(a){var b;return!(a.nodeType===sre.DomUtil.NodeType.ELEMENT_NODE&&a&&!sre.SemanticUtil.hasIgnoreTag(a))||(b=sre.DomUtil.toArray(a.childNodes),!(!sre.SemanticUtil.hasEmptyTag(a)&&b.length||sre.SemanticUtil.hasDisplayTag(a)||a.hasAttribute(sre.EnrichMathml.Attribute.TYPE)||sre.SemanticUtil.isOrphanedGlyph(a))&&sre.DomUtil.toArray(a.childNodes).every(sre.EnrichMathml.isIgnorable_))},sre.EnrichMathml.parentNode_=function(a){return a.parentNode},sre.EnrichMathml.addCollapsedAttribute=function(a,b){b=new sre.SemanticSkeleton(b),a.setAttribute(sre.EnrichMathml.Attribute.COLLAPSED,b.toString())},sre.EnrichMathml.cloneContentNode=function(a){var b;return a.mathml.length?sre.EnrichMathml.walkTree(a):(b=sre.EnrichMathml.SETTINGS.implicit?sre.EnrichMathml.createInvisibleOperator_(a):sre.DomUtil.createElement("mrow"),a.mathml=[b],b)},sre.EnrichMathml.makeIdList=function(a){return a.map(function(b){return b.id}).join(",")},sre.EnrichMathml.setAttributes=function(a,b){a.setAttribute(sre.EnrichMathml.Attribute.TYPE,b.type);for(var e,c=b.allAttributes(),d=0;e=c[d];d++)a.setAttribute(sre.EnrichMathml.Attribute[e[0].toUpperCase()],e[1]);b.childNodes.length&&a.setAttribute(sre.EnrichMathml.Attribute.CHILDREN,sre.EnrichMathml.makeIdList(b.childNodes)),b.contentNodes.length&&a.setAttribute(sre.EnrichMathml.Attribute.CONTENT,sre.EnrichMathml.makeIdList(b.contentNodes)),b.parent&&a.setAttribute(sre.EnrichMathml.Attribute.PARENT,b.parent.id),sre.EnrichMathml.setPostfix(a,b)},sre.EnrichMathml.setPostfix=function(a,b){var c=[];"mglyph"===b.role&&c.push("image"),b.attributes.href&&c.push("link"),c.length&&a.setAttribute(sre.EnrichMathml.Attribute.POSTFIX,c.join(" "))},sre.EnrichMathml.rewriteMfenced=function(a){if("MFENCED"!==sre.DomUtil.tagName(a))return a;for(var d,b=sre.DomUtil.createElement("mrow"),c=0;d=a.attributes[c];c++)-1===["open","close","separators"].indexOf(d.name)&&b.setAttribute(d.name,d.value);return sre.DomUtil.toArray(a.childNodes).forEach(function(e){b.appendChild(e)}),sre.DomUtil.replaceNode(a,b),b},sre.EnrichMathml.createInvisibleOperator_=function(a){var b=sre.DomUtil.createElement("mo"),c=sre.DomUtil.createTextNode(a.textContent);return b.appendChild(c),sre.EnrichMathml.setAttributes(b,a),b.setAttribute(sre.EnrichMathml.Attribute.ADDED,"true"),b},sre.EnrichMathml.setOperatorAttribute_=function(a,b){var c=a.type+(a.textContent?","+a.textContent:"");b.forEach(function(d){sre.EnrichMathml.getInnerNode(d).setAttribute(sre.EnrichMathml.Attribute.OPERATOR,c)})},sre.EnrichMathml.getInnerNode=function(a){if(!(b=sre.DomUtil.toArray(a.childNodes)))return a;for(var e,f,b=b.filter(function(g){return!sre.EnrichMathml.isIgnorable_(g)}),c=[],d=0;e=b[d];d++)sre.SemanticUtil.hasEmptyTag(e)?(f=sre.EnrichMathml.getInnerNode(e))&&f!==e&&c.push(f):c.push(e);return 1===c.length?c[0]:a},sre.EnrichMathml.formattedOutput=function(a,b,c,d){sre.EnrichMathml.formattedOutput_(a,"Original MathML",d=d||!1),sre.EnrichMathml.formattedOutput_(c,"Semantic Tree",d),sre.EnrichMathml.formattedOutput_(b,"Semantically enriched MathML",d)},sre.EnrichMathml.formattedOutput_=function(a,b,c){a=sre.DomUtil.formatXml(a.toString()),c?console.info(b+":\n```html\n"+sre.EnrichMathml.removeAttributePrefix(a)+"\n```\n"):console.info(a)},sre.EnrichMathml.removeAttributePrefix=function(a){return a.toString().replace(new RegExp(sre.EnrichMathml.ATTRIBUTE_PREFIX_,"g"),"")},sre.EnrichMathml.addPrefix=function(a){var b=a.toUpperCase();return sre.EnrichMathml.Attribute[b]||sre.EnrichMathml.ATTRIBUTE_PREFIX_+a},sre.EnrichMathml.collapsePunctuated=function(a,b){var c=!!b,d=(b=b||[],a.parent);(e=a.contentNodes.map(function(k){return k.id})).unshift("c");for(var g,e=[a.id,e],f=0;g=a.childNodes[f];f++){var h=sre.EnrichMathml.walkTree(g);b.push(h),h=sre.EnrichMathml.getInnerNode(h),d&&!c&&h.setAttribute(sre.EnrichMathml.Attribute.PARENT,d.id),e.push(g.id)}return e},sre.EnrichMathml.printNodeList__=function(a,b){console.info(a),sre.DomUtil.toArray(b).forEach(function(c){console.info(c.toString())}),console.info("<<<<<<<<<<<<<<<<<")},sre.CaseBinomial=function(a){sre.AbstractEnrichCase.call(this,a),this.mml=a.mathmlTree},goog.inherits(sre.CaseBinomial,sre.AbstractEnrichCase),sre.CaseBinomial.test=function(a){return!a.mathmlTree&&a.type===sre.SemanticAttr.Type.LINE&&a.role===sre.SemanticAttr.Role.BINOMIAL},sre.CaseBinomial.prototype.getMathml=function(){var a;return this.semantic.childNodes.length&&(this.mml=sre.EnrichMathml.walkTree(this.semantic.childNodes[0]),this.mml.hasAttribute(sre.EnrichMathml.Attribute.TYPE)&&((a=sre.DomUtil.createElement("mrow")).setAttribute(sre.EnrichMathml.Attribute.ADDED,"true"),sre.DomUtil.replaceNode(this.mml,a),a.appendChild(this.mml),this.mml=a),sre.EnrichMathml.setAttributes(this.mml,this.semantic)),this.mml},sre.CaseDoubleScript=function(a){sre.AbstractEnrichCase.call(this,a),this.mml=a.mathmlTree},goog.inherits(sre.CaseDoubleScript,sre.AbstractEnrichCase),sre.CaseDoubleScript.test=function(a){var b;return!(!a.mathmlTree||!a.childNodes.length)&&(b=sre.DomUtil.tagName(a.mathmlTree),a=a.childNodes[0].role,"MSUBSUP"===b&&a===sre.SemanticAttr.Role.SUBSUP||"MUNDEROVER"===b&&a===sre.SemanticAttr.Role.UNDEROVER)},sre.CaseDoubleScript.prototype.getMathml=function(){var a=this.semantic.childNodes[0],b=a.childNodes[0],c=this.semantic.childNodes[1],d=a.childNodes[1],e=sre.EnrichMathml.walkTree(c),f=sre.EnrichMathml.walkTree(b),g=sre.EnrichMathml.walkTree(d);return sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.mml.setAttribute(sre.EnrichMathml.Attribute.CHILDREN,sre.EnrichMathml.makeIdList([b,d,c])),[f,g,e].forEach(goog.bind(function(h){sre.EnrichMathml.getInnerNode(h).setAttribute(sre.EnrichMathml.Attribute.PARENT,this.mml.getAttribute(sre.EnrichMathml.Attribute.ID))},this)),this.mml.setAttribute(sre.EnrichMathml.Attribute.TYPE,a.role),sre.EnrichMathml.addCollapsedAttribute(this.mml,[this.semantic.id,[a.id,b.id,d.id],c.id]),this.mml},sre.CaseMultiindex=function(a){sre.AbstractEnrichCase.call(this,a),this.mml=a.mathmlTree},goog.inherits(sre.CaseMultiindex,sre.AbstractEnrichCase),sre.CaseMultiindex.prototype.completeMultiscript=function(a,b){var c=sre.DomUtil.toArray(this.mml.childNodes).slice(1),d=0,e=goog.bind(function(f){for(var h,g=0;h=f[g];g++){var l,k=c[d];k&&h==sre.EnrichMathml.getInnerNode(k).getAttribute(sre.EnrichMathml.Attribute.ID)?(sre.EnrichMathml.getInnerNode(k).setAttribute(sre.EnrichMathml.Attribute.PARENT,this.semantic.id),d++):(l=this.semantic.querySelectorAll(function(m){return m.id===h}),this.mml.insertBefore(sre.CaseMultiindex.createNone_(l[0]),k||null))}},this);e(a),c[d]&&"MPRESCRIPTS"!==sre.DomUtil.tagName(c[d])?this.mml.insertBefore(c[d],sre.DomUtil.createElement("mprescripts")):d++,e(b)},sre.CaseMultiindex.createNone_=function(a){var b=sre.DomUtil.createElement("none");return a&&sre.EnrichMathml.setAttributes(b,a),b.setAttribute(sre.EnrichMathml.Attribute.ADDED,"true"),b},sre.CaseMultiindex.multiscriptIndex=function(a){return a.type===sre.SemanticAttr.Type.PUNCTUATED&&a.contentNodes[0].role===sre.SemanticAttr.Role.DUMMY?sre.EnrichMathml.collapsePunctuated(a):(sre.EnrichMathml.walkTree(a),a.id)},sre.CaseMultiscripts=function(a){sre.CaseMultiindex.call(this,a)},goog.inherits(sre.CaseMultiscripts,sre.CaseMultiindex),sre.CaseMultiscripts.test=function(a){return!!a.mathmlTree&&"MMULTISCRIPTS"===sre.DomUtil.tagName(a.mathmlTree)&&(a.type===sre.SemanticAttr.Type.SUPERSCRIPT||a.type===sre.SemanticAttr.Type.SUBSCRIPT)},sre.CaseMultiscripts.prototype.getMathml=function(){var a,b,c,d,e;return sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.semantic.childNodes[0]&&this.semantic.childNodes[0].role===sre.SemanticAttr.Role.SUBSUP?(b=(a=this.semantic.childNodes[0]).childNodes[0],c=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[1]),d=sre.CaseMultiindex.multiscriptIndex(a.childNodes[1]),e=[this.semantic.id,[a.id,b.id,d],c],sre.EnrichMathml.addCollapsedAttribute(this.mml,e),this.mml.setAttribute(sre.EnrichMathml.Attribute.TYPE,a.role),this.completeMultiscript(sre.SemanticSkeleton.interleaveIds(d,c),[])):(b=this.semantic.childNodes[0],c=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[1]),e=[this.semantic.id,b.id,c],sre.EnrichMathml.addCollapsedAttribute(this.mml,e)),a=sre.SemanticSkeleton.collapsedLeafs(d||[],c),c=sre.EnrichMathml.walkTree(b),sre.EnrichMathml.getInnerNode(c).setAttribute(sre.EnrichMathml.Attribute.PARENT,this.semantic.id),a.unshift(b.id),this.mml.setAttribute(sre.EnrichMathml.Attribute.CHILDREN,a.join(",")),this.mml},sre.CaseEmbellished=function(a){sre.AbstractEnrichCase.call(this,a),this.ofenceMml=this.ofence=this.fencedMml=this.fenced=null,this.ofenceMap={},this.cfenceMml=this.cfence=null,this.cfenceMap={},this.parentCleanup=[]},goog.inherits(sre.CaseEmbellished,sre.AbstractEnrichCase),sre.CaseEmbellished.test=function(a){return!(!a.mathmlTree||!a.fencePointer||a.mathmlTree.getAttribute("data-semantic-type"))},sre.CaseEmbellished.prototype.getMathml=function(){return this.getFenced_(),this.fencedMml=sre.EnrichMathml.walkTree(this.fenced),this.getFencesMml_(),this.fenced.type!==sre.SemanticAttr.Type.EMPTY||this.fencedMml.parentNode||(this.fencedMml.setAttribute(sre.EnrichMathml.Attribute.ADDED,"true"),this.cfenceMml.parentNode.insertBefore(this.fencedMml,this.cfenceMml)),this.rewrite_()},sre.CaseEmbellished.prototype.getFenced_=function(){for(var a=this.semantic;a.type!==sre.SemanticAttr.Type.FENCED;)a=a.childNodes[0];this.fenced=a.childNodes[0],this.ofence=a.contentNodes[0],this.cfence=a.contentNodes[1],sre.CaseEmbellished.fencedMap_(this.ofence,this.ofenceMap),sre.CaseEmbellished.fencedMap_(this.cfence,this.cfenceMap)},sre.CaseEmbellished.fencedMap_=function(a,b){b[a.id]=a.mathmlTree,a.embellished&&sre.CaseEmbellished.fencedMap_(a.childNodes[0],b)},sre.CaseEmbellished.prototype.getFencesMml_=function(){for(var a=this.semantic,b=Object.keys(this.ofenceMap),c=Object.keys(this.cfenceMap);!(this.ofenceMml&&this.cfenceMml||a===this.fenced);)-1===b.indexOf(a.fencePointer)||this.ofenceMml||(this.ofenceMml=a.mathmlTree),-1===c.indexOf(a.fencePointer)||this.cfenceMml||(this.cfenceMml=a.mathmlTree),a=a.childNodes[0];this.ofenceMml||(this.ofenceMml=this.ofence.mathmlTree),this.cfenceMml||(this.cfenceMml=this.cfence.mathmlTree),this.ofenceMml&&(this.ofenceMml=sre.EnrichMathml.ascendNewNode(this.ofenceMml)),this.cfenceMml&&(this.cfenceMml=sre.EnrichMathml.ascendNewNode(this.cfenceMml))},sre.CaseEmbellished.prototype.rewrite_=function(){var a=this.semantic,b=null,c=this.introduceNewLayer_();for(sre.EnrichMathml.setAttributes(c,this.fenced.parent);a.type!==sre.SemanticAttr.Type.FENCED;){var d=a.mathmlTree;if(e=this.specialCase_(a,d))a=e;else{sre.EnrichMathml.setAttributes(d,a);for(var g,e=[],f=1;g=a.childNodes[f];f++)e.push(sre.EnrichMathml.walkTree(g));a=a.childNodes[0]}e=sre.DomUtil.createElement("dummy"),f=c.parentNode,g=d.childNodes[0],sre.DomUtil.replaceNode(d,e),sre.DomUtil.replaceNode(c,d),sre.DomUtil.replaceNode(d.childNodes[0],c),sre.DomUtil.replaceNode(e,g),d.parentNode=f,c=d.childNodes[0],b=b||d}return sre.EnrichMathml.walkTree(this.ofence),sre.EnrichMathml.walkTree(this.cfence),this.cleanupParents_(),b||c},sre.CaseEmbellished.prototype.specialCase_=function(a,b){var e,c=sre.DomUtil.tagName(b),d=null;return"MSUBSUP"===c?(d=a.childNodes[0],e=sre.CaseDoubleScript):"MMULTISCRIPTS"===c&&(a.type===sre.SemanticAttr.Type.SUPERSCRIPT||a.type===sre.SemanticAttr.Type.SUBSCRIPT?e=sre.CaseMultiscripts:a.type===sre.SemanticAttr.Type.TENSOR&&(e=sre.CaseTensor),d=e&&a.childNodes[0]&&a.childNodes[0].role===sre.SemanticAttr.Role.SUBSUP?a.childNodes[0]:a),d?(c=d.childNodes[0],b=sre.CaseEmbellished.makeEmptyNode_(c.id),d.childNodes[0]=b,b=new e(a).getMathml(),d.childNodes[0]=c,this.parentCleanup.push(b),d.childNodes[0]):null},sre.CaseEmbellished.makeEmptyNode_=function(a){var b=sre.DomUtil.createElement("mrow");return(a=new sre.SemanticNode(a)).type=sre.SemanticAttr.Type.EMPTY,a.mathmlTree=b,a},sre.CaseEmbellished.prototype.introduceNewLayer_=function(){var a=this.fullFence(this.ofenceMml),b=this.fullFence(this.cfenceMml),c=sre.DomUtil.createElement("mrow");if(sre.DomUtil.replaceNode(this.fencedMml,c),c.appendChild(this.fencedMml),c.insertBefore(a,this.fencedMml),c.appendChild(b),!c.parentNode){for(a=sre.DomUtil.createElement("mrow");0<c.childNodes.length;)a.appendChild(c.childNodes[0]);c.appendChild(a),c=a}return c},sre.CaseEmbellished.prototype.fullFence=function(a){for(var b=this.fencedMml.parentNode;a.parentNode&&a.parentNode!==b;)a=a.parentNode;return a},sre.CaseEmbellished.prototype.cleanupParents_=function(){this.parentCleanup.forEach(function(a){var b=a.childNodes[1].getAttribute(sre.EnrichMathml.Attribute.PARENT);a.childNodes[0].setAttribute(sre.EnrichMathml.Attribute.PARENT,b)})},sre.CaseLimit=function(a){sre.AbstractEnrichCase.call(this,a),this.mml=a.mathmlTree},goog.inherits(sre.CaseLimit,sre.AbstractEnrichCase),sre.CaseLimit.test=function(a){var b;return!(!a.mathmlTree||!a.childNodes.length||(b=sre.DomUtil.tagName(a.mathmlTree),((a=a.type)!==sre.SemanticAttr.Type.LIMUPPER&&a!==sre.SemanticAttr.Type.LIMLOWER||"MSUBSUP"!==b&&"MUNDEROVER"!==b)&&(a!==sre.SemanticAttr.Type.LIMBOTH||"MSUB"!==b&&"MUNDER"!==b&&"MSUP"!==b&&"MOVER"!==b)))},sre.CaseLimit.prototype.getMathml=function(){var a=this.semantic.childNodes;return this.semantic.type!==sre.SemanticAttr.Type.LIMBOTH&&3<=this.mml.childNodes.length&&(this.mml=sre.EnrichMathml.introduceNewLayer([this.mml],this.semantic)),sre.EnrichMathml.setAttributes(this.mml,this.semantic),a[0].mathmlTree||(a[0].mathmlTree=this.semantic.mathmlTree),a.forEach(sre.CaseLimit.walkTree_),this.mml},sre.CaseLimit.walkTree_=function(a){a&&sre.EnrichMathml.walkTree(a)},sre.CaseLine=function(a){sre.AbstractEnrichCase.call(this,a),this.mml=a.mathmlTree},goog.inherits(sre.CaseLine,sre.AbstractEnrichCase),sre.CaseLine.test=function(a){return!!a.mathmlTree&&a.type===sre.SemanticAttr.Type.LINE},sre.CaseLine.prototype.getMathml=function(){return this.semantic.contentNodes.length&&sre.EnrichMathml.walkTree(this.semantic.contentNodes[0]),this.semantic.childNodes.length&&sre.EnrichMathml.walkTree(this.semantic.childNodes[0]),sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.mml},sre.CaseProof=function(a){sre.AbstractEnrichCase.call(this,a),this.mml=a.mathmlTree},goog.inherits(sre.CaseProof,sre.AbstractEnrichCase),sre.CaseProof.test=function(a){return!!a.mathmlTree&&(a.type===sre.SemanticAttr.Type.INFERENCE||a.type===sre.SemanticAttr.Type.PREMISES)},sre.CaseProof.prototype.getMathml=function(){return this.semantic.childNodes.length&&(this.semantic.contentNodes.forEach(function(a){sre.EnrichMathml.walkTree(a),sre.EnrichMathml.setAttributes(a.mathmlTree,a)}),this.semantic.childNodes.forEach(function(a){sre.EnrichMathml.walkTree(a)}),sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.mml.getAttribute("data-semantic-id")===this.mml.getAttribute("data-semantic-parent"))&&this.mml.removeAttribute("data-semantic-parent"),this.mml},sre.CaseTable=function(a){sre.AbstractEnrichCase.call(this,a),this.mml=a.mathmlTree,this.inner=[]},goog.inherits(sre.CaseTable,sre.AbstractEnrichCase),sre.CaseTable.test=function(a){return a.type===sre.SemanticAttr.Type.MATRIX||a.type===sre.SemanticAttr.Type.VECTOR||a.type===sre.SemanticAttr.Type.CASES},sre.CaseTable.prototype.getMathml=function(){var a=sre.EnrichMathml.cloneContentNode(this.semantic.contentNodes[0]),b=this.semantic.contentNodes[1]?sre.EnrichMathml.cloneContentNode(this.semantic.contentNodes[1]):null;return this.inner=this.semantic.childNodes.map(sre.EnrichMathml.walkTree),this.mml?"MFENCED"===sre.DomUtil.tagName(this.mml)?(this.mml.insertBefore(a,this.mml.childNodes[0]||null),b&&this.mml.appendChild(b),this.mml=sre.EnrichMathml.rewriteMfenced(this.mml)):(a=[a,this.mml],b&&a.push(b),this.mml=sre.EnrichMathml.introduceNewLayer(a,this.semantic)):this.mml=sre.EnrichMathml.introduceNewLayer([a,this.inner,b],this.semantic),sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.mml},sre.CaseTensor=function(a){sre.CaseMultiindex.call(this,a)},goog.inherits(sre.CaseTensor,sre.CaseMultiindex),sre.CaseTensor.test=function(a){return!!a.mathmlTree&&a.type===sre.SemanticAttr.Type.TENSOR},sre.CaseTensor.prototype.getMathml=function(){sre.EnrichMathml.walkTree(this.semantic.childNodes[0]);var a=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[1]),b=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[2]),c=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[3]),d=sre.CaseMultiindex.multiscriptIndex(this.semantic.childNodes[4]),e=(sre.EnrichMathml.setAttributes(this.mml,this.semantic),sre.EnrichMathml.addCollapsedAttribute(this.mml,[this.semantic.id,this.semantic.childNodes[0].id,a,b,c,d]),sre.SemanticSkeleton.collapsedLeafs(a,b,c,d));return e.unshift(this.semantic.childNodes[0].id),this.mml.setAttribute(sre.EnrichMathml.Attribute.CHILDREN,e.join(",")),this.completeMultiscript(sre.SemanticSkeleton.interleaveIds(c,d),sre.SemanticSkeleton.interleaveIds(a,b)),this.mml},sre.CaseText=function(a){sre.AbstractEnrichCase.call(this,a),this.mml=a.mathmlTree},goog.inherits(sre.CaseText,sre.AbstractEnrichCase),sre.CaseText.test=function(a){return a.type===sre.SemanticAttr.Type.PUNCTUATED&&(a.role===sre.SemanticAttr.Role.TEXT||a.contentNodes.every(function(b){return b.role===sre.SemanticAttr.Role.DUMMY}))},sre.CaseText.prototype.getMathml=function(){var a=[],b=sre.EnrichMathml.collapsePunctuated(this.semantic,a);return this.mml=sre.EnrichMathml.introduceNewLayer(a,this.semantic),sre.EnrichMathml.setAttributes(this.mml,this.semantic),this.mml.removeAttribute(sre.EnrichMathml.Attribute.CONTENT),sre.EnrichMathml.addCollapsedAttribute(this.mml,b),this.mml},sre.EnrichCases=function(){},sre.EnrichCaseFactory.cases.push({test:sre.CaseLimit.test,constr:sre.CaseLimit},{test:sre.CaseEmbellished.test,constr:sre.CaseEmbellished},{test:sre.CaseDoubleScript.test,constr:sre.CaseDoubleScript},{test:sre.CaseTensor.test,constr:sre.CaseTensor},{test:sre.CaseMultiscripts.test,constr:sre.CaseMultiscripts},{test:sre.CaseLine.test,constr:sre.CaseLine},{test:sre.CaseBinomial.test,constr:sre.CaseBinomial},{test:sre.CaseProof.test,constr:sre.CaseProof},{test:sre.CaseTable.test,constr:sre.CaseTable},{test:sre.CaseText.test,constr:sre.CaseText}),sre.Enrich={},sre.Enrich.semanticMathmlNode=function(a){a=a.cloneNode(!0);var b=sre.Semantic.getTree(a);return sre.EnrichMathml.enrich(a,b)},sre.Enrich.semanticMathmlSync=function(a){return a=sre.DomUtil.parseInput(a),sre.Enrich.semanticMathmlNode(a)},sre.Enrich.semanticMathml=function(a,b){var c;sre.Engine.isReady()?(c=sre.DomUtil.parseInput(a),b(sre.Enrich.semanticMathmlNode(c))):setTimeout(function(){sre.Enrich.semanticMathml(a,b)},500)},sre.Enrich.testTranslation__=function(a){return new sre.EnrichCases,sre.Debugger.getInstance().init(),a=sre.Enrich.semanticMathmlSync(sre.Enrich.prepareMmlString(a)).toString(),sre.EnrichMathml.removeAttributePrefix(a),sre.Debugger.getInstance().exit(),a},sre.Enrich.prepareMmlString=function(a){return(a=a.match(/^<math/)?a:"<math>"+a).match(/\/math>$/)||(a+="</math>"),a},sre.ColorPicker=function(a,b){this.foreground=sre.ColorPicker.getChannelColor_(b,sre.ColorPicker.DEFAULT_FOREGROUND_),this.background=sre.ColorPicker.getChannelColor_(a,sre.ColorPicker.DEFAULT_BACKGROUND_)},sre.ColorPicker.DEFAULT_BACKGROUND_="blue",sre.ColorPicker.DEFAULT_FOREGROUND_="black",sre.ColorPicker.namedColors_={red:{red:255,green:0,blue:0},green:{red:0,green:255,blue:0},blue:{red:0,green:0,blue:255},yellow:{red:255,green:255,blue:0},cyan:{red:0,green:255,blue:255},magenta:{red:255,green:0,blue:255},white:{red:255,green:255,blue:255},black:{red:0,green:0,blue:0}},sre.ColorPicker.getChannelColor_=function(a,b){var c=(a=a||{color:b}).color?sre.ColorPicker.namedColors_[a.color]:a;return(c=c||sre.ColorPicker.namedColors_[b]).alpha=a.hasOwnProperty("alpha")?a.alpha:1,sre.ColorPicker.normalizeColor_(c)},sre.ColorPicker.normalizeColor_=function(a){function b(c){return c=Math.max(c,0),c=Math.min(255,c),Math.round(c)}return a.red=b(a.red),a.green=b(a.green),a.blue=b(a.blue),a.alpha=Math.max(a.alpha,0),a.alpha=Math.min(1,a.alpha),a},sre.ColorPicker.prototype.rgba=function(){function a(b){return"rgba("+b.red+","+b.green+","+b.blue+","+b.alpha+")"}return{background:a(this.background),foreground:a(this.foreground)}},sre.ColorPicker.prototype.rgb=function(){function a(b){return"rgb("+b.red+","+b.green+","+b.blue+")"}return{background:a(this.background),alphaback:this.background.alpha.toString(),foreground:a(this.foreground),alphafore:this.foreground.alpha.toString()}},sre.ColorPicker.prototype.hex=function(){function a(b){return"#"+sre.ColorPicker.toHex_(b.red)+sre.ColorPicker.toHex_(b.green)+sre.ColorPicker.toHex_(b.blue)}return{background:a(this.background),alphaback:this.background.alpha.toString(),foreground:a(this.foreground),alphafore:this.foreground.alpha.toString()}},sre.ColorPicker.toHex_=function(a){return 1===(a=a.toString(16)).length?"0"+a:a},sre.ContrastPicker=function(){this.hue=10,this.sat=100,this.incr=this.light=50},sre.ContrastPicker.prototype.generate=function(){return sre.ColorPicker.RGB2hex_(sre.ColorPicker.rgb2RGB_(sre.ColorPicker.hsl2rgb_(this.hue,this.sat,this.light)))},sre.ContrastPicker.prototype.increment=function(){this.hue=(this.hue+this.incr)%360},sre.ColorPicker.hsl2rgb_=function(a,b,c){c=1<c?c/100:c;var d=(1-Math.abs(2*c-1))*(1<b?b/100:b),e=d*(1-Math.abs(a/60%2-1)),f=(c-=d/2,b=0),g=0;return 0<=a&&a<60?(b=(a=$jscomp.makeIterator([d,e,0])).next().value,f=a.next().value,g=a.next().value):60<=a&&a<120?(b=(a=$jscomp.makeIterator([e,d,0])).next().value,f=a.next().value,g=a.next().value):120<=a&&a<180?(b=(a=$jscomp.makeIterator([0,d,e])).next().value,f=a.next().value,g=a.next().value):180<=a&&a<240?(b=(a=$jscomp.makeIterator([0,e,d])).next().value,f=a.next().value,g=a.next().value):240<=a&&a<300?(b=(a=$jscomp.makeIterator([e,0,d])).next().value,f=a.next().value,g=a.next().value):300<=a&&a<360&&(b=(a=$jscomp.makeIterator([d,0,e])).next().value,f=a.next().value,g=a.next().value),{red:b+c,green:f+c,blue:g+c}},sre.ColorPicker.rgb2RGB_=function(a){return{red:Math.round(255*a.red),green:Math.round(255*a.green),blue:Math.round(255*a.blue)}},sre.ColorPicker.RGB2hex_=function(a){return"rgb("+a.red+","+a.green+","+a.blue+")"},sre.Highlighter=function(){},sre.Highlighter.prototype.highlight=function(a){},sre.Highlighter.prototype.unhighlight=function(){},sre.Highlighter.prototype.highlightAll=function(a){},sre.Highlighter.prototype.unhighlightAll=function(){},sre.Highlighter.prototype.setColor=function(a){},sre.Highlighter.prototype.addEvents=function(a,b){},sre.AbstractHighlighter=function(){this.currentHighlights_=[],this.color=null,this.mactionName=""},sre.AbstractHighlighter.ATTR="sre-highlight",sre.AbstractHighlighter.prototype.highlight=function(a){this.currentHighlights_.push(a.map(goog.bind(function(b){var c=this.highlightNode(b);return this.setHighlighted(b),c},this)))},sre.AbstractHighlighter.prototype.highlightNode=goog.abstractMethod,sre.AbstractHighlighter.prototype.highlightAll=function(a){a=this.getMactionNodes(a);for(var c,b=0;c=a[b];b++)this.highlight([c])},sre.AbstractHighlighter.prototype.unhighlight=function(){var a=this.currentHighlights_.pop();a&&a.forEach(goog.bind(function(b){this.isHighlighted(b.node)&&(this.unhighlightNode(b),this.unsetHighlighted(b.node))},this))},sre.AbstractHighlighter.prototype.unhighlightNode=goog.abstractMethod,sre.AbstractHighlighter.prototype.unhighlightAll=function(){for(;0<this.currentHighlights_.length;)this.unhighlight()},sre.AbstractHighlighter.prototype.setColor=function(a){this.color=a},sre.AbstractHighlighter.prototype.colorString=function(){return this.color.rgba()},sre.AbstractHighlighter.prototype.addEvents=function(a,b){a=this.getMactionNodes(a);for(var d,c=0;d=a[c];c++)for(var e in b)d.addEventListener(e,b[e])},sre.AbstractHighlighter.prototype.getMactionNodes=function(a){return a.getElementsByClassName(this.mactionName)},sre.AbstractHighlighter.prototype.isMactionNode=function(a){return!!(a=a.className||a.getAttribute("class"))&&a.match(new RegExp(this.mactionName))},sre.AbstractHighlighter.prototype.isHighlighted=function(a){return a.hasAttribute(sre.AbstractHighlighter.ATTR)},sre.AbstractHighlighter.prototype.setHighlighted=function(a){a.setAttribute(sre.AbstractHighlighter.ATTR,!0)},sre.AbstractHighlighter.prototype.unsetHighlighted=function(a){a.removeAttribute(sre.AbstractHighlighter.ATTR)},sre.AbstractHighlighter.prototype.colorizeAll=function(a){sre.XpathUtil.evalXPath(".//*[@"+sre.EnrichMathml.Attribute.ID+"]",a).forEach(goog.bind(function(b){this.colorize(b)},this))},sre.AbstractHighlighter.prototype.uncolorizeAll=function(a){sre.XpathUtil.evalXPath(".//*[@"+sre.EnrichMathml.Attribute.ID+"]",a).forEach(goog.bind(function(b){this.uncolorize(b)},this))},sre.AbstractHighlighter.prototype.colorize=function(a){var b=sre.EnrichMathml.addPrefix("foreground");a.hasAttribute(b)&&(a.setAttribute(b+"-old",a.style.color),a.style.color=a.getAttribute(b))},sre.AbstractHighlighter.prototype.uncolorize=function(a){var b=sre.EnrichMathml.addPrefix("foreground")+"-old";a.hasAttribute(b)&&(a.style.color=a.getAttribute(b))},sre.CssHighlighter=function(){sre.AbstractHighlighter.call(this),this.mactionName="mjx-maction"},goog.inherits(sre.CssHighlighter,sre.AbstractHighlighter),sre.CssHighlighter.prototype.highlightNode=function(a){var b={node:a,background:a.style.backgroundColor,foreground:a.style.color},c=this.colorString();return a.style.backgroundColor=c.background,a.style.color=c.foreground,b},sre.CssHighlighter.prototype.unhighlightNode=function(a){a.node.style.backgroundColor=a.background,a.node.style.color=a.foreground},sre.ChtmlHighlighter=function(){sre.CssHighlighter.call(this)},goog.inherits(sre.ChtmlHighlighter,sre.CssHighlighter),sre.ChtmlHighlighter.prototype.isMactionNode=function(a){return a.tagName.toUpperCase()===this.mactionName.toUpperCase()},sre.ChtmlHighlighter.prototype.getMactionNodes=function(a){return a.getElementsByTagName(this.mactionName)},sre.HtmlHighlighter=function(){sre.AbstractHighlighter.call(this),this.mactionName="maction"},goog.inherits(sre.HtmlHighlighter,sre.AbstractHighlighter),sre.HtmlHighlighter.prototype.setMode=function(a){this.mode=a},sre.HtmlHighlighter.prototype.highlightNode=function(a){var e,f,b={node:a,foreground:a.style.color,position:a.style.position},c=this.color.rgb(),d=(a.style.color=c.foreground,a.style.position="relative",a.bbox);return d&&d.w&&(e=sre.DomUtil.createElement("span"),f=parseFloat(a.style.paddingLeft||"0"),e.style.backgroundColor=c.background,e.style.opacity=c.alphaback.toString(),e.style.display="inline-block",e.style.height=d.h+d.d+.1+"em",e.style.verticalAlign=-d.d+"em",e.style.marginTop=e.style.marginBottom="-0.05em",e.style.width=d.w+0+"em",e.style.marginLeft=+f+"em",e.style.marginRight=-d.w-f+"em",a.parentNode.insertBefore(e,a),b.box=e),b},sre.HtmlHighlighter.prototype.unhighlightNode=function(a){var b=a.node;b.style.color=a.foreground,b.style.position=a.position,a.box&&a.box.parentNode.removeChild(a.box)},sre.MmlCssHighlighter=function(){sre.CssHighlighter.call(this),this.mactionName="maction"},goog.inherits(sre.MmlCssHighlighter,sre.CssHighlighter),sre.MmlCssHighlighter.prototype.getMactionNodes=function(a){return a.getElementsByTagName(this.mactionName)},sre.MmlCssHighlighter.prototype.isMactionNode=function(a){return a.tagName===this.mactionName},sre.MmlHighlighter=function(){sre.AbstractHighlighter.call(this),this.mactionName="maction"},goog.inherits(sre.MmlHighlighter,sre.AbstractHighlighter),sre.MmlHighlighter.prototype.highlightNode=function(a){var b=a.getAttribute("style"),b=(b+=";background-color: "+this.colorString().background)+(";color: "+this.colorString().foreground);return a.setAttribute("style",b),{node:a}},sre.MmlHighlighter.prototype.unhighlightNode=function(a){var b=a.node.getAttribute("style");b=(b=b.replace(";background-color: "+this.colorString().background,"")).replace(";color: "+this.colorString().foreground,""),a.node.setAttribute("style",b)},sre.MmlHighlighter.prototype.colorString=function(){return this.color.rgba()},sre.MmlHighlighter.prototype.getMactionNodes=function(a){return a.getElementsByTagName(this.mactionName)},sre.MmlHighlighter.prototype.isMactionNode=function(a){return a.tagName===this.mactionName},sre.SvgHighlighter=function(){sre.AbstractHighlighter.call(this),this.mactionName="mjx-svg-maction"},goog.inherits(sre.SvgHighlighter,sre.AbstractHighlighter),sre.SvgHighlighter.prototype.highlightNode=function(a){var c,d,b;return this.isHighlighted(a)?{node:a.previousSibling||a,background:a.style.backgroundColor,foreground:a.style.color}:("svg"===a.tagName?(b={node:a,background:a.style.backgroundColor,foreground:a.style.color},a.style.backgroundColor=this.colorString().background,a.style.color=this.colorString().foreground):(b=sre.DomUtil.createElementNS("http://www.w3.org/2000/svg","rect"),"use"===a.nodeName?(c=sre.DomUtil.createElementNS("http://www.w3.org/2000/svg","g"),a.parentNode.insertBefore(c,a),c.appendChild(a),d=c.getBBox(),c.parentNode.replaceChild(a,c)):d=a.getBBox(),b.setAttribute("x",d.x-40),b.setAttribute("y",d.y-40),b.setAttribute("width",d.width+80),b.setAttribute("height",d.height+80),(d=a.getAttribute("transform"))&&b.setAttribute("transform",d),b.setAttribute("fill",this.colorString().background),b.setAttribute(sre.AbstractHighlighter.ATTR,!0),a.parentNode.insertBefore(b,a),b={node:b,foreground:a.getAttribute("fill")},a.setAttribute("fill",this.colorString().foreground)),b)},sre.SvgHighlighter.prototype.setHighlighted=function(a){"svg"===a.tagName&&sre.SvgHighlighter.superClass_.setHighlighted.call(this,a)},sre.SvgHighlighter.prototype.unhighlightNode=function(a){"background"in a?(a.node.style.backgroundColor=a.background,a.node.style.color=a.foreground):(a.foreground?a.node.nextSibling.setAttribute("fill",a.foreground):a.node.nextSibling.removeAttribute("fill"),a.node.parentNode.removeChild(a.node))},sre.SvgHighlighter.prototype.isMactionNode=function(a){return!!(a=void 0!==(a=a.className||a.getAttribute("class")).baseVal?a.baseVal:a)&&a.match(new RegExp(this.mactionName))},sre.SvgV3Highlighter=function(){sre.SvgHighlighter.call(this),this.mactionName="maction"},goog.inherits(sre.SvgV3Highlighter,sre.SvgHighlighter),sre.SvgV3Highlighter.prototype.highlightNode=function(a){var b,c;return this.isHighlighted(a)?{node:a,background:this.colorString().background,foreground:this.colorString().foreground}:("svg"===a.tagName||"MJX-CONTAINER"===a.tagName?(b={node:a,background:a.style.backgroundColor,foreground:a.style.color},a.style.backgroundColor=this.colorString().background,a.style.color=this.colorString().foreground):((b=sre.DomUtil.createElementNS("http://www.w3.org/2000/svg","rect")).setAttribute("sre-highlighter-added",!0),c=a.getBBox(),b.setAttribute("x",c.x-40),b.setAttribute("y",c.y-40),b.setAttribute("width",c.width+80),b.setAttribute("height",c.height+80),(c=a.getAttribute("transform"))&&b.setAttribute("transform",c),b.setAttribute("fill",this.colorString().background),a.setAttribute(sre.AbstractHighlighter.ATTR,!0),a.parentNode.insertBefore(b,a),b={node:a,foreground:a.getAttribute("fill")},"rect"===a.nodeName?(c=new sre.ColorPicker({alpha:0,color:"black"}),a.setAttribute("fill",c.rgba().foreground)):a.setAttribute("fill",this.colorString().foreground)),b)},sre.SvgV3Highlighter.prototype.unhighlightNode=function(a){var b=a.node.previousSibling;b&&b.hasAttribute("sre-highlighter-added")?(a.foreground?a.node.setAttribute("fill",a.foreground):a.node.removeAttribute("fill"),a.node.parentNode.removeChild(b)):(a.node.style.backgroundColor=a.background,a.node.style.color=a.foreground)},sre.SvgV3Highlighter.prototype.isMactionNode=function(a){return a.getAttribute("data-mml-node")===this.mactionName},sre.SvgV3Highlighter.prototype.getMactionNodes=function(a){return sre.XpathUtil.evalXPath('.//*[@data-mml-node="'+this.mactionName+'"]',a)},sre.HighlighterFactory={},sre.HighlighterFactory.highlighter=function(a,b,c){return a=new sre.ColorPicker(a,b),(c=new(sre.HighlighterFactory.highlighterMapping_["NativeMML"===c.renderer&&"Safari"===c.browser?"MML-CSS":"SVG"===c.renderer&&"v3"===c.browser?"SVG-V3":c.renderer]||sre.HighlighterFactory.highlighterMapping_.NativeMML)).setColor(a),c},sre.HighlighterFactory.addEvents=function(a,b,c){(c=sre.HighlighterFactory.highlighterMapping_[c.renderer])&&(new c).addEvents(a,b)},sre.HighlighterFactory.highlighterMapping_={SVG:sre.SvgHighlighter,"SVG-V3":sre.SvgV3Highlighter,NativeMML:sre.MmlHighlighter,"HTML-CSS":sre.HtmlHighlighter,"MML-CSS":sre.MmlCssHighlighter,CommonHTML:sre.CssHighlighter,CHTML:sre.ChtmlHighlighter},sre.WalkerUtil={},sre.WalkerUtil.splitAttribute=function(a){return a?a.split(/,/):[]},sre.WalkerUtil.getAttribute=function(a,b){return sre.DomUtil.getDataAttribute(a,b)},sre.WalkerUtil.getSemanticRoot=function(a){if(!a.hasAttribute(sre.EnrichMathml.Attribute.TYPE)||a.hasAttribute(sre.EnrichMathml.Attribute.PARENT))for(var d,b=sre.DomUtil.querySelectorAllByAttr(a,sre.EnrichMathml.Attribute.TYPE),c=0;d=b[c];c++)if(!d.hasAttribute(sre.EnrichMathml.Attribute.PARENT))return d;return a},sre.WalkerUtil.getBySemanticId=function(a,b){return a.getAttribute(sre.EnrichMathml.Attribute.ID)===b?a:sre.DomUtil.querySelectorAllByAttrValue(a,sre.EnrichMathml.Attribute.ID,b)[0]},sre.RebuildStree=function(a){this.factory=new sre.SemanticNodeFactory,this.nodeDict={},this.mathml=a,this.mmlRoot=sre.WalkerUtil.getSemanticRoot(a),this.streeRoot=this.assembleTree(this.mmlRoot),this.stree=sre.SemanticTree.fromNode(this.streeRoot,this.mathml),this.xml=this.stree.xml(),sre.SemanticProcessor.getInstance().setNodeFactory(this.factory)},sre.RebuildStree.prototype.getTree=function(){return this.stree},sre.RebuildStree.addAttributes=function(a,b,c){c&&1===b.childNodes.length&&b.childNodes[0].nodeType!==sre.DomUtil.NodeType.TEXT_NODE&&sre.SemanticUtil.addAttributes(a,b.childNodes[0]),sre.SemanticUtil.addAttributes(a,b)},sre.RebuildStree.prototype.assembleTree=function(a){var e,b=this.makeNode(a),c=sre.WalkerUtil.splitAttribute(sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.CHILDREN)),d=sre.WalkerUtil.splitAttribute(sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.CONTENT));return sre.RebuildStree.addAttributes(b,a,!(c.length||d.length)),0===d.length&&0===c.length?(sre.RebuildStree.textContent(b,a),b):(0<d.length&&(e=sre.WalkerUtil.getBySemanticId(this.mathml,d[0]))&&sre.RebuildStree.textContent(b,e,!0),b.contentNodes=d.map(goog.bind(e=function(f){return f=sre.WalkerUtil.getBySemanticId(this.mathml,f),(f=this.assembleTree(f)).parent=b,f},this)),b.childNodes=c.map(goog.bind(e,this)),(a=sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.COLLAPSED))?this.postProcess(b,a):b)},sre.RebuildStree.textContent=function(a,b,c){!c&&b.textContent?a.textContent=b.textContent:1<(b=sre.WalkerUtil.splitAttribute(sre.WalkerUtil.getAttribute(b,sre.EnrichMathml.Attribute.OPERATOR))).length&&(a.textContent=b[1])},sre.RebuildStree.prototype.makeNode=function(a){var b=sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.TYPE),c=sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.ROLE),d=sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.FONT),e=sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.ANNOTATION)||"",f=sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.ID),g=sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.EMBELLISHED);return a=sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.FENCEPOINTER),(f=this.createNode(parseInt(f,10))).type=b,f.role=c,f.font=d||sre.SemanticAttr.Font.UNKNOWN,f.parseAnnotation(e),a&&(f.fencePointer=a),g&&(f.embellished=g),f},sre.RebuildStree.isPunctuated=function(a){return!sre.SemanticSkeleton.simpleCollapseStructure(a)&&a[1]&&sre.SemanticSkeleton.contentCollapseStructure(a[1])},sre.RebuildStree.prototype.makePunctuation=function(a){return(a=this.createNode(a)).updateContent(sre.SemanticAttr.invisibleComma()),a.role=sre.SemanticAttr.Role.DUMMY,a},sre.RebuildStree.prototype.makePunctuated=function(a,b,c){var d=this.createNode(b[0]);d.type=sre.SemanticAttr.Type.PUNCTUATED,d.embellished=a.embellished,d.fencePointer=a.fencePointer,d.role=c,a=b.splice(1,1)[0].slice(1),d.contentNodes=a.map(goog.bind(this.makePunctuation,this)),this.collapsedChildren_(b)},sre.RebuildStree.prototype.makeEmpty=function(a,b,c){(b=this.createNode(b)).type=sre.SemanticAttr.Type.EMPTY,b.embellished=a.embellished,b.fencePointer=a.fencePointer,b.role=c},sre.RebuildStree.prototype.makeIndex=function(a,b,c){sre.RebuildStree.isPunctuated(b)?this.makePunctuated(a,b,c):sre.SemanticSkeleton.simpleCollapseStructure(b)&&!this.nodeDict[b.toString()]&&this.makeEmpty(a,b,c)},sre.RebuildStree.prototype.postProcess=function(a,b){var c;return b=sre.SemanticSkeleton.fromString(b).array,a.type===sre.SemanticAttr.Role.SUBSUP?((c=this.createNode(b[1][0])).type=sre.SemanticAttr.Type.SUBSCRIPT,c.role=sre.SemanticAttr.Role.SUBSUP,a.type=sre.SemanticAttr.Type.SUPERSCRIPT,c.embellished=a.embellished,c.fencePointer=a.fencePointer,this.makeIndex(a,b[1][2],sre.SemanticAttr.Role.RIGHTSUB),this.makeIndex(a,b[2],sre.SemanticAttr.Role.RIGHTSUPER),this.collapsedChildren_(b)):a.type===sre.SemanticAttr.Type.SUBSCRIPT?(this.makeIndex(a,b[2],sre.SemanticAttr.Role.RIGHTSUB),this.collapsedChildren_(b)):a.type===sre.SemanticAttr.Type.SUPERSCRIPT?(this.makeIndex(a,b[2],sre.SemanticAttr.Role.RIGHTSUPER),this.collapsedChildren_(b)):a.type===sre.SemanticAttr.Type.TENSOR?(this.makeIndex(a,b[2],sre.SemanticAttr.Role.LEFTSUB),this.makeIndex(a,b[3],sre.SemanticAttr.Role.LEFTSUPER),this.makeIndex(a,b[4],sre.SemanticAttr.Role.RIGHTSUB),this.makeIndex(a,b[5],sre.SemanticAttr.Role.RIGHTSUPER),this.collapsedChildren_(b)):a.type===sre.SemanticAttr.Type.PUNCTUATED?sre.RebuildStree.isPunctuated(b)&&(b=b.splice(1,1)[0].slice(1),a.contentNodes=b.map(goog.bind(this.makePunctuation,this))):a.type===sre.SemanticAttr.Role.UNDEROVER&&(c=this.createNode(b[1][0]),a.childNodes[1].role===sre.SemanticAttr.Role.OVERACCENT?(c.type=sre.SemanticAttr.Type.OVERSCORE,a.type=sre.SemanticAttr.Type.UNDERSCORE):(c.type=sre.SemanticAttr.Type.UNDERSCORE,a.type=sre.SemanticAttr.Type.OVERSCORE),c.role=sre.SemanticAttr.Role.UNDEROVER,c.embellished=a.embellished,c.fencePointer=a.fencePointer,this.collapsedChildren_(b)),a},sre.RebuildStree.prototype.createNode=function(a){var b=this.factory.makeNode(a);return this.nodeDict[a.toString()]=b},sre.RebuildStree.prototype.collapsedChildren_=function(a){var b=goog.bind(function(c){var d=this.nodeDict[c[0]];d.childNodes=[];for(var e=1,f=c.length;e<f;e++){var g=c[e];d.childNodes.push(sre.SemanticSkeleton.simpleCollapseStructure(g)?this.nodeDict[g]:b(g))}return d},this);b(a)},sre.SpeechGenerator=function(){},sre.SpeechGenerator.prototype.getSpeech=function(a,b){},sre.SpeechGenerator.prototype.getRebuilt=function(){},sre.SpeechGenerator.prototype.setRebuilt=function(a){},sre.SpeechGenerator.prototype.setOptions=function(a){},sre.SpeechGenerator.prototype.getOptions=function(){},sre.SpeechGenerator.prototype.start=function(){},sre.SpeechGenerator.prototype.end=function(){},sre.AudioUtil={},sre.AudioUtil.mergePause=function(a,b,c){return a?{pause:sre.AudioUtil.mergePause_(a.pause,b.pause,c)}:b},sre.AudioUtil.mergePause_=function(a,b,c){return(c||function(d,e){return"number"==typeof d||"number"==typeof e?d+e:"number"==typeof d?e:"number"==typeof e?d:[a,b].sort()[0]}).call(null,a,b)},sre.AudioUtil.mergeMarkup=function(a,b){delete a.open,b.close.forEach(function(d){delete a[d]}),b.open.forEach(function(d){a[d]=b[d]});var c=Object.keys(a);a.open=c},sre.AudioUtil.sortClose=function(a,b){if(a.length<=1)return a;for(var e,c=[],d=0;e=b[d],a.length;d++)e.close&&e.close.length&&e.close.forEach(function(f){var g=a.indexOf(f);-1!==g&&(c.unshift(f),a.splice(g,1))});return c},sre.AudioUtil.PersonalityRanges_={},sre.AudioUtil.LastOpen_=[],sre.AudioUtil.personalityMarkup=function(a){sre.AudioUtil.PersonalityRanges_={},sre.AudioUtil.LastOpen_=[];for(var b=[],c={},d=0;e=a[d];d++){var f=null,g=e.descriptionSpan(),h=e.personality,e=h[sre.Engine.personalityProps.JOIN];delete h[sre.Engine.personalityProps.JOIN],void 0!==h[sre.Engine.personalityProps.PAUSE]&&((f={})[sre.Engine.personalityProps.PAUSE]=h[sre.Engine.personalityProps.PAUSE],delete h[sre.Engine.personalityProps.PAUSE]),h=sre.AudioUtil.personalityDiff_(h,c),sre.AudioUtil.appendMarkup_(b,g,h,e,f,!0)}return b=b.concat(sre.AudioUtil.finaliseMarkup_()),sre.AudioUtil.simplifyMarkup_(b)},sre.AudioUtil.appendElement_=function(a,b){var d,c=a[a.length-1];c?sre.AudioUtil.isSpanElement(b)&&sre.AudioUtil.isSpanElement(c)?void 0===c.join?c.span=c.span.concat(b.span):(a=c.span.pop(),d=b.span.shift(),c.span.push(a+c.join+d),c.span=c.span.concat(b.span),c.join=b.join):sre.AudioUtil.isPauseElement(b)&&sre.AudioUtil.isPauseElement(c)?c.pause=sre.AudioUtil.mergePause_(c.pause,b.pause):a.push(b):a.push(b)},sre.AudioUtil.simplifyMarkup_=function(a){for(var e,f,g,b={},c=[],d=0;e=a[d];d++)sre.AudioUtil.isMarkupElement(e)?e.close&&1===e.close.length&&!e.open.length&&(f=a[d+1])&&!sre.AudioUtil.isSpanElement(f)&&(f=(g=sre.AudioUtil.isPauseElement(f)?f:null)?a[d+2]:f)&&sre.AudioUtil.isMarkupElement(f)&&f.open[0]===e.close[0]&&!f.close.length&&f[f.open[0]]===b[f.open[0]]?g?(sre.AudioUtil.appendElement_(c,g),d+=2):d+=1:(sre.AudioUtil.copyValues_(e,b),c.push(e)):sre.AudioUtil.appendElement_(c,e);return c},sre.AudioUtil.copyValues_=function(a,b){a.rate&&(b.rate=a.rate),a.pitch&&(b.pitch=a.pitch),a.volume&&(b.volume=a.volume)},sre.AudioUtil.finaliseMarkup_=function(){for(var a=[],b=sre.AudioUtil.LastOpen_.length-1;0<=b;b--){var c=sre.AudioUtil.LastOpen_[b];if(c.length){for(var d={open:[],close:[]},e=0;e<c.length;e++){var f=c[e];d.close.push(f),d[f]=0}a.push(d)}}return a},sre.AudioUtil.isMarkupElement=function(a){return"object"==typeof a&&a.open},sre.AudioUtil.isPauseElement=function(a){return"object"==typeof a&&1===Object.keys(a).length&&Object.keys(a)[0]===sre.Engine.personalityProps.PAUSE},sre.AudioUtil.isSpanElement=function(a){var b=Object.keys(a);return"object"==typeof a&&(1===b.length&&"span"===b[0]||2===b.length&&("span"===b[0]&&"join"===b[1]||"span"===b[1]&&"join"===b[0]))},sre.AudioUtil.appendMarkup_=function(a,b,c,d,e,f){var g,h;f&&((f=a[a.length-1])&&(g=f[sre.Engine.personalityProps.JOIN]),f&&!b.string&&e&&sre.AudioUtil.isPauseElement(f)&&(f[h=sre.Engine.personalityProps.PAUSE]=sre.AudioUtil.mergePause_(f[h],e[h]),e=null),f)&&b.string&&0===Object.keys(c).length&&sre.AudioUtil.isSpanElement(f)&&(void 0!==g&&(h=f.span.pop(),b=new sre.Span(h.string+g+b.string,h.attributes)),f.span.push(b),b=new sre.Span("",{}),f[sre.Engine.personalityProps.JOIN]=d),0!==Object.keys(c).length&&a.push(c),b.string&&a.push({span:[b],join:d}),e&&a.push(e)},sre.AudioUtil.personalityDiff_=function(a,b){if(!b)return a;var c={};for(h in sre.Engine.personalityProps){var g,d=sre.Engine.personalityProps[h],e=a[d],f=b[d];!e&&!f||e&&f&&e===f||(g=e||0,sre.AudioUtil.isMarkupElement(c)||(c.open=[],c.close=[]),e||c.close.push(d),f||c.open.push(d),f&&e&&(c.close.push(d),c.open.push(d)),b[d]=g,c[d]=g,sre.AudioUtil.PersonalityRanges_[d]?sre.AudioUtil.PersonalityRanges_[d].push(g):sre.AudioUtil.PersonalityRanges_[d]=[g])}if(sre.AudioUtil.isMarkupElement(c)){for(a=c.close.slice();0<a.length;){var h=sre.AudioUtil.LastOpen_.pop(),d=sre.BaseUtil.setdifference(h,a);if(a=sre.BaseUtil.setdifference(a,h),h=d,0===a.length)0!==h.length&&sre.AudioUtil.LastOpen_.push(h);else if(0!==h.length)for(c.close=c.close.concat(h),c.open=c.open.concat(h),d=0;e=h[d];d++)c[e]=b[e]}sre.AudioUtil.LastOpen_.push(c.open)}return c},sre.AudioRenderer=function(){},sre.AudioRenderer.prototype.setSeparator=function(a){},sre.AudioRenderer.prototype.getSeparator=function(){},sre.AudioRenderer.prototype.markup=function(a){},sre.AudioRenderer.prototype.error=function(a){},sre.AudioRenderer.prototype.merge=function(a){},sre.AudioRenderer.prototype.finalize=function(a){},sre.AbstractAudioRenderer=function(){this.separator_=" "},sre.AbstractAudioRenderer.prototype.setSeparator=function(a){this.separator_=a},sre.AbstractAudioRenderer.prototype.getSeparator=function(){return"braille"===sre.Engine.getInstance().modality?"":this.separator_},sre.AbstractAudioRenderer.prototype.markup=goog.abstractMethod,sre.AbstractAudioRenderer.prototype.error=function(a){return null},sre.AbstractAudioRenderer.prototype.merge=function(a){for(var e,b="",c=a.length-1,d=0;e=a[d];d++)b+=e.string,d<c&&(b+=void 0!==(e=e.attributes.separator)?e:this.getSeparator());return b},sre.AbstractAudioRenderer.prototype.finalize=function(a){return a},sre.AbstractAudioRenderer.prototype.pauseValue=function(a){switch(a){case"long":a=750;break;case"medium":a=500;break;case"short":a=250;break;default:a=parseInt(a,10)}return Math.floor(a*parseInt(sre.Engine.getInstance().getRate(),10)/100)},sre.MarkupRenderer=function(){sre.AbstractAudioRenderer.call(this),this.scaleFunction_=null},goog.inherits(sre.MarkupRenderer,sre.AbstractAudioRenderer),sre.MarkupRenderer.prototype.setScaleFunction=function(a,b,c,d,e){var f=e||0;this.scaleFunction_=function(g){return g=(g-a)/(b-a),+(Math.round(c*(1-g)+d*g+"e+"+f)+"e-"+f)}},sre.MarkupRenderer.prototype.applyScaleFunction=function(a){return this.scaleFunction_?this.scaleFunction_(a):a},sre.MarkupRenderer.prototype.pause=goog.abstractMethod,sre.MarkupRenderer.prototype.prosodyElement=goog.abstractMethod,sre.AcssRenderer=function(){sre.MarkupRenderer.call(this)},goog.inherits(sre.AcssRenderer,sre.MarkupRenderer),sre.AcssRenderer.prototype.markup=function(a){this.setScaleFunction(-2,2,0,10,0),a=sre.AudioUtil.personalityMarkup(a);for(var g,h,b=[],c={open:[]},d=null,e=!1,f=0;g=a[f];f++)sre.AudioUtil.isMarkupElement(g)?sre.AudioUtil.mergeMarkup(c,g):sre.AudioUtil.isPauseElement(g)?e&&(d=sre.AudioUtil.mergePause(d,g,Math.max)):(g='"'+this.merge(g.span)+'"',e=!0,d&&(b.push(this.pause(d)),d=null),h=this.prosody_(c),b.push(h?"(text ("+h+") "+g+")":g));return"(exp "+b.join(" ")+")"},sre.AcssRenderer.prototype.error=function(a){return'(error "'+sre.EventUtil.Move[a.toString()]+'")'},sre.AcssRenderer.prototype.prosody_=function(a){for(var e,b=a.open,c=[],d=0;e=b[d];d++)c.push(this.prosodyElement(e,a[e]));return c.join(" ")},sre.AcssRenderer.prototype.prosodyElement=function(a,b){switch(b=this.applyScaleFunction(b),a){case sre.Engine.personalityProps.RATE:return"(richness . "+b+")";case sre.Engine.personalityProps.PITCH:return"(average-pitch . "+b+")";case sre.Engine.personalityProps.VOLUME:return"(stress . "+b+")"}return"(value . "+b+")"},sre.AcssRenderer.prototype.pause=function(a){return"(pause . "+this.pauseValue(a[sre.Engine.personalityProps.PAUSE])+")"},sre.PunctuationRenderer=function(){sre.AbstractAudioRenderer.call(this)},goog.inherits(sre.PunctuationRenderer,sre.AbstractAudioRenderer),sre.PunctuationRenderer.prototype.markup=function(a){a=sre.AudioUtil.personalityMarkup(a);for(var f,b="",c=null,d=!1,e=0;f=a[e];e++)sre.AudioUtil.isMarkupElement(f)||(sre.AudioUtil.isPauseElement(f)?d&&(c=sre.AudioUtil.mergePause(c,f,Math.max)):(c&&(b+=this.pause(c[sre.Engine.personalityProps.PAUSE]),c=null),b+=(d?this.getSeparator():"")+this.merge(f.span),d=!0));return b},sre.PunctuationRenderer.PAUSE_PUNCTUATION_={short:",",medium:";",long:"."},sre.PunctuationRenderer.prototype.pause=function(a){return sre.PunctuationRenderer.PAUSE_PUNCTUATION_["number"==typeof a?a<=250?"short":a<=500?"medium":"long":a]||""},sre.XmlRenderer=function(){sre.MarkupRenderer.call(this)},goog.inherits(sre.XmlRenderer,sre.MarkupRenderer),sre.XmlRenderer.prototype.markup=function(a){this.setScaleFunction(-2,2,-100,100,2),a=sre.AudioUtil.personalityMarkup(a);for(var e,b=[],c=[],d=0;e=a[d];d++)if(e.span)b.push(this.merge(e.span));else if(sre.AudioUtil.isPauseElement(e))b.push(this.pause(e));else{if(e.close.length)for(var f=0;f<e.close.length;f++){var g=c.pop();if(-1===e.close.indexOf(g))throw new sre.Engine.Error("Unknown closing markup element: "+g);b.push(this.closeTag(g))}e.open.length&&sre.AudioUtil.sortClose(e.open.slice(),a.slice(d+1)).forEach(goog.bind(function(h){b.push(this.prosodyElement(h,e[h])),c.push(h)},this))}return b.join(" ")},sre.XmlRenderer.prototype.closeTag=goog.abstractMethod,sre.SableRenderer=function(){sre.XmlRenderer.call(this)},goog.inherits(sre.SableRenderer,sre.XmlRenderer),sre.SableRenderer.prototype.finalize=function(a){return'<?xml version="1.0"?><!DOCTYPE SABLE PUBLIC "-//SABLE//DTD SABLE speech mark up//EN" "Sable.v0_2.dtd" []><SABLE>'+this.getSeparator()+a+this.getSeparator()+"</SABLE>"},sre.SableRenderer.prototype.pause=function(a){return'<BREAK MSEC="'+this.pauseValue(a[sre.Engine.personalityProps.PAUSE])+'"/>'},sre.SableRenderer.prototype.prosodyElement=function(a,b){switch(b=this.applyScaleFunction(b),a){case sre.Engine.personalityProps.PITCH:return'<PITCH RANGE="'+b+'%">';case sre.Engine.personalityProps.RATE:return'<RATE SPEED="'+b+'%">';case sre.Engine.personalityProps.VOLUME:return'<VOLUME LEVEL="'+b+'%">';default:return"<"+a.toUpperCase()+' VALUE="'+b+'">'}},sre.SableRenderer.prototype.closeTag=function(a){return"</"+a.toUpperCase()+">"},sre.SsmlRenderer=function(){sre.XmlRenderer.call(this)},goog.inherits(sre.SsmlRenderer,sre.XmlRenderer),sre.SsmlRenderer.prototype.finalize=function(a){return'<?xml version="1.0"?><speak version="1.1" xmlns="http://www.w3.org/2001/10/synthesis"><prosody rate="'+sre.Engine.getInstance().getRate()+'%">'+this.getSeparator()+a+this.getSeparator()+"</prosody></speak>"},sre.SsmlRenderer.prototype.pause=function(a){return'<break time="'+this.pauseValue(a[sre.Engine.personalityProps.PAUSE])+'ms"/>'},sre.SsmlRenderer.prototype.prosodyElement=function(a,b){return b=(b=Math.floor(this.applyScaleFunction(b)))<0?b.toString():"+"+b.toString(),"<prosody "+a.toLowerCase()+'="'+b+(a===sre.Engine.personalityProps.VOLUME?">":'%">')},sre.SsmlRenderer.prototype.closeTag=function(a){return"</prosody>"},sre.SsmlStepRenderer=function(){sre.SsmlRenderer.call(this)},goog.inherits(sre.SsmlStepRenderer,sre.SsmlRenderer),sre.SsmlStepRenderer.prototype.markup=function(a){return sre.SsmlStepRenderer.MARKS={},sre.SsmlStepRenderer.superClass_.markup.call(this,a)},sre.SsmlStepRenderer.CHARACTER_ATTR_="character",sre.SsmlStepRenderer.MARKS={},sre.SsmlStepRenderer.prototype.merge=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.attributes.extid;e&&!sre.SsmlStepRenderer.MARKS[e]&&(b.push('<mark name="'+e+'"/>'),sre.SsmlStepRenderer.MARKS[e]=!0),1===d.string.length&&d.string.match(/[a-zA-Z]/)?b.push('<say-as interpret-as="'+sre.SsmlStepRenderer.CHARACTER_ATTR_+'">'+d.string+"</say-as>"):b.push(d.string)}return b.join(this.getSeparator())},sre.StringRenderer=function(){sre.AbstractAudioRenderer.call(this)},goog.inherits(sre.StringRenderer,sre.AbstractAudioRenderer),sre.StringRenderer.prototype.markup=function(a){var b="";if((a=sre.AudioUtil.personalityMarkup(a).filter(function(f){return f.span})).length)for(var e,c=a.length-1,d=0;e=a[d];d++)e.span&&(b+=this.merge(e.span)),c<=d||(b+=void 0===(e=e.join)?this.getSeparator():e);return b},sre.AuralRendering=function(){},goog.addSingletonGetter(sre.AuralRendering),sre.AuralRendering.prototype.setSeparator=function(a){var b=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];b&&b.setSeparator(a)},sre.AuralRendering.prototype.getSeparator=function(){var a=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];return a?a.getSeparator():""},sre.AuralRendering.prototype.markup=function(a){var b=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];return b?b.markup(a):""},sre.AuralRendering.prototype.merge=function(a){var b=a.map(function(d){return{string:d,attributes:{}}}),c=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];return c?c.merge(b):a.join()},sre.AuralRendering.prototype.finalize=function(a){var b=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];return b?b.finalize(a):a},sre.AuralRendering.prototype.error=function(a){var b=sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup];return b?b.error(a):""},sre.AuralRendering.registerRenderer=function(a,b){sre.AuralRendering.rendererMapping_[a]=b},sre.AuralRendering.ofType=function(a){return sre.AuralRendering.rendererMapping_[sre.Engine.getInstance().markup]instanceof a},sre.AuralRendering.rendererMapping_={},sre.AuralRendering.registerRenderer(sre.Engine.Markup.NONE,new sre.StringRenderer),sre.AuralRendering.registerRenderer(sre.Engine.Markup.PUNCTUATION,new sre.PunctuationRenderer),sre.AuralRendering.registerRenderer(sre.Engine.Markup.ACSS,new sre.AcssRenderer),sre.AuralRendering.registerRenderer(sre.Engine.Markup.SABLE,new sre.SableRenderer),sre.AuralRendering.xmlInstance=new sre.SsmlRenderer,sre.AuralRendering.registerRenderer(sre.Engine.Markup.VOICEXML,sre.AuralRendering.xmlInstance),sre.AuralRendering.registerRenderer(sre.Engine.Markup.SSML,sre.AuralRendering.xmlInstance),sre.AuralRendering.registerRenderer(sre.Engine.Markup.SSML_STEP,new sre.SsmlStepRenderer),sre.AuditoryDescription=function(a){this.context=a.context||"",this.text=a.text||"",this.userValue=a.userValue||"",this.annotation=a.annotation||"",this.attributes=a.attributes||{},this.personality=a.personality||{}},sre.AuditoryDescription.create=function(a,b){return a.text=sre.Grammar.getInstance().apply(a.text,b||{}),new sre.AuditoryDescription(a)},sre.AuditoryDescription.prototype.isEmpty=function(){return 0==this.context.length&&0==this.text.length&&0==this.userValue.length&&0==this.annotation.length},sre.AuditoryDescription.prototype.clone=function(){if(this.personality){var b,a={};for(b in this.personality)a[b]=this.personality[b]}if(this.attributes){var c={};for(b in this.attributes)c[b]=this.attributes[b]}return new sre.AuditoryDescription({context:this.context,text:this.text,userValue:this.userValue,annotation:this.annotation,personality:a,attributes:c})},sre.AuditoryDescription.prototype.toString=function(){return'AuditoryDescription(context="'+this.context+'"  text="'+this.text+'"  userValue="'+this.userValue+'"  annotation="'+this.annotation+'")'},sre.AuditoryDescription.prototype.descriptionString=function(){return this.context&&this.text?this.context+" "+this.text:this.context||this.text},sre.AuditoryDescription.prototype.descriptionSpan=function(){return new sre.Span(this.descriptionString(),this.attributes)},sre.AuditoryDescription.prototype.equals=function(a){return this.context==a.context&&this.text==a.text&&this.userValue==a.userValue&&this.annotation==a.annotation},sre.SpeechRule=function(a,b,c,d){this.name=a,this.dynamicCstr=b,this.precondition=c,this.action=d,this.context=null},sre.SpeechRule.prototype.toString=function(){return this.name+" | "+this.dynamicCstr.toString()+" | "+this.precondition.toString()+" ==> "+this.action.toString()},sre.SpeechRule.Type={NODE:"NODE",MULTI:"MULTI",TEXT:"TEXT",PERSONALITY:"PERSONALITY"},sre.SpeechRule.Type.fromString=function(a){switch(a){case"[n]":return sre.SpeechRule.Type.NODE;case"[m]":return sre.SpeechRule.Type.MULTI;case"[t]":return sre.SpeechRule.Type.TEXT;case"[p]":return sre.SpeechRule.Type.PERSONALITY;default:throw"Parse error: "+a}},sre.SpeechRule.Type.toString=function(a){switch(a){case sre.SpeechRule.Type.NODE:return"[n]";case sre.SpeechRule.Type.MULTI:return"[m]";case sre.SpeechRule.Type.TEXT:return"[t]";case sre.SpeechRule.Type.PERSONALITY:return"[p]";default:throw"Unknown type error: "+a}},sre.SpeechRule.Component=function(a){this.type=a.type,this.content=a.content,this.attributes=a.attributes,this.grammar=a.grammar},sre.SpeechRule.Component.fromString=function(a){var b={};if(b.type=sre.SpeechRule.Type.fromString(a.substring(0,3)),!(a=a.slice(3).trim()))throw new sre.SpeechRule.OutputError("Missing content.");switch(b.type){case sre.SpeechRule.Type.TEXT:if('"'==a[0]){var c=sre.SpeechRule.splitString_(a,"\\(")[0].trim();if('"'!=c.slice(-1))throw new sre.SpeechRule.OutputError("Invalid string syntax.");b.content=c,-1==(a=a.slice(c.length).trim()).indexOf("(")&&(a="");break}case sre.SpeechRule.Type.NODE:case sre.SpeechRule.Type.MULTI:a=-1==(c=a.indexOf(" ("))?(b.content=a.trim(),""):(b.content=a.substring(0,c).trim(),a.slice(c).trim())}return a&&((a=sre.SpeechRule.Component.attributesFromString(a)).grammar&&(b.grammar=a.grammar,delete a.grammar),Object.keys(a).length)&&(b.attributes=a),new sre.SpeechRule.Component(b)},sre.SpeechRule.Component.prototype.toString=function(){var a=""+sre.SpeechRule.Type.toString(this.type),b=(a+=this.content?" "+this.content:"",this.attributesToString());return a+(b?" "+b:"")},sre.SpeechRule.Component.grammarFromString=function(a){return sre.Grammar.parseInput(a)},sre.SpeechRule.Component.prototype.grammarToString=function(){return this.getGrammar().join(":")},sre.SpeechRule.Component.prototype.getGrammar=function(){var b,a=[];for(b in this.grammar)!0===this.grammar[b]?a.push(b):!1===this.grammar[b]?a.push("!"+b):a.push(b+"="+this.grammar[b]);return a},sre.SpeechRule.Component.attributesFromString=function(a){if("("!=a[0]||")"!=a.slice(-1))throw new sre.SpeechRule.OutputError("Invalid attribute expression: "+a);for(var b={},c=0,d=(a=sre.SpeechRule.splitString_(a.slice(1,-1),",")).length;c<d;c++){var g,e=a[c],f=e.indexOf(":");-1==f?b[e.trim()]="true":(g=e.substring(0,f).trim(),e=e.slice(f+1).trim(),b[g]="grammar"===g?sre.SpeechRule.Component.grammarFromString(e):b[g]=e)}return b},sre.SpeechRule.Component.prototype.attributesToString=function(){var a=this.getAttributes(),b=this.grammarToString();return b&&a.push("grammar:"+b),0<a.length?"("+a.join(", ")+")":""},sre.SpeechRule.Component.prototype.getAttributes=function(){var b,a=[];for(b in this.attributes){var c=this.attributes[b];a.push("true"===c?b:b+":"+c)}return a},sre.SpeechRule.Action=function(a){this.components=a},sre.SpeechRule.Action.fromString=function(a){for(var b=[],c=0,d=(a=sre.SpeechRule.splitString_(a,";").filter(function(f){return f.match(/\S/)}).map(function(f){return f.trim()})).length;c<d;c++){var e=sre.SpeechRule.Component.fromString(a[c]);e&&b.push(e)}return new sre.SpeechRule.Action(b)},sre.SpeechRule.Action.prototype.toString=function(){return this.components.map(function(a){return a.toString()}).join("; ")},sre.SpeechRule.Precondition=function(a,b){this.query=a,this.constraints=b||[],this.priority=this.calculatePriority_()},sre.SpeechRule.Precondition.prototype.calculatePriority_=function(){var b,a=sre.SpeechRule.Precondition.constraintValue_(this.query,sre.SpeechRule.Precondition.queryPriorities_);return a?(b=this.query.match(/^self::.+\[(.+)\]/)[1],100*a+10*(b=sre.SpeechRule.Precondition.constraintValue_(b,sre.SpeechRule.Precondition.attributePriorities_))):0},sre.SpeechRule.Precondition.queryPriorities_=[/^self::\*\[.+\]$/,/^self::[\w-]+\[.+\]$/],sre.SpeechRule.Precondition.attributePriorities_=[/^@[\w-]+$/,/^@[\w-]+!=".+"$/,/^not\(contains\(@[\w-]+,\s*".+"\)\)$/,/^contains\(@[\w-]+,".+"\)$/,/^@[\w-]+=".+"$/],sre.SpeechRule.Precondition.constraintValue_=function(a,b){for(var d,c=0;d=b[c];c++)if(a.match(d))return++c;return 0},sre.SpeechRule.Precondition.prototype.toString=function(){var a=this.constraints.join(", ");return this.query+", "+a+" ("+this.priority+")"},sre.SpeechRule.splitString_=function(a,b){for(var c=[],d="";""!=a;){var e=a.search(b);if(-1==e){if(0!=(a.match(/"/g)||[]).length%2)throw new sre.SpeechRule.OutputError("Invalid string in expression: "+a);c.push(d+a),a=d=""}else if(0==(a.substring(0,e).match(/"/g)||[]).length%2)c.push(d+a.substring(0,e)),d="",a=a.substring(e+1);else{var f=a.substring(e).search('"');if(-1==f)throw new sre.SpeechRule.OutputError("Invalid string in expression: "+a);d+=a.substring(0,e+f+1),a=a.substring(e+f+1)}}return d&&c.push(d),c},sre.SpeechRule.OutputError=function(a){sre.Engine.Error.call(this,a),this.name="RuleError"},goog.inherits(sre.SpeechRule.OutputError,sre.Engine.Error),sre.SpeechRuleFunctions=function(){},sre.SpeechRuleFunctions.Store_=function(a,b){this.prefix_=a,this.store_=b},sre.SpeechRuleFunctions.Store_.prototype.add=function(a,b){this.checkCustomFunctionSyntax_(a)&&(this.store_[a]=b)},sre.SpeechRuleFunctions.Store_.prototype.addStore=function(a){for(var d,b=Object.keys(a.store_),c=0;d=b[c];c++)this.add(d,a.store_[d])},sre.SpeechRuleFunctions.Store_.prototype.lookup=function(a){return this.store_[a]},sre.SpeechRuleFunctions.CustomQueries=function(){sre.SpeechRuleFunctions.Store_.call(this,"CQF",{})},goog.inherits(sre.SpeechRuleFunctions.CustomQueries,sre.SpeechRuleFunctions.Store_),sre.SpeechRuleFunctions.CustomStrings=function(){sre.SpeechRuleFunctions.Store_.call(this,"CSF",{})},goog.inherits(sre.SpeechRuleFunctions.CustomStrings,sre.SpeechRuleFunctions.Store_),sre.SpeechRuleFunctions.ContextFunctions=function(){sre.SpeechRuleFunctions.Store_.call(this,"CTF",{})},goog.inherits(sre.SpeechRuleFunctions.ContextFunctions,sre.SpeechRuleFunctions.Store_),sre.SpeechRuleFunctions.CustomGenerators=function(){sre.SpeechRuleFunctions.Store_.call(this,"CGF",{})},goog.inherits(sre.SpeechRuleFunctions.CustomGenerators,sre.SpeechRuleFunctions.Store_),sre.SpeechRuleFunctions.Store_.prototype.checkCustomFunctionSyntax_=function(a){return!!a.match(new RegExp("^"+this.prefix_))||(console.error("FunctionError: Invalid function name. Expected prefix "+this.prefix_),!1)},sre.SpeechRuleContext=function(){this.customQueries=new sre.SpeechRuleFunctions.CustomQueries,this.customStrings=new sre.SpeechRuleFunctions.CustomStrings,this.contextFunctions=new sre.SpeechRuleFunctions.ContextFunctions,this.customGenerators=new sre.SpeechRuleFunctions.CustomGenerators},sre.SpeechRuleContext.prototype.applyCustomQuery=function(a,b){return(b=this.customQueries.lookup(b))?b(a):null},sre.SpeechRuleContext.prototype.applySelector=function(a,b){return this.applyCustomQuery(a,b)||sre.XpathUtil.evalXPath(b,a)},sre.SpeechRuleContext.prototype.applyQuery=function(a,b){return 0<(a=this.applySelector(a,b)).length?a[0]:null},sre.SpeechRuleContext.prototype.applyConstraint=function(a,b){return!!this.applyQuery(a,b)||sre.XpathUtil.evaluateBoolean(b,a)},sre.SpeechRuleContext.prototype.constructString=function(a,b){var c;return b?'"'==b.charAt(0)?b.slice(1,-1):(c=this.customStrings.lookup(b))?c(a):sre.XpathUtil.evaluateString(b,a):""},sre.SpeechRuleContext.prototype.parse=function(a){a=Array.isArray(a)?a:Object.entries(a);for(var c,b=0;c=a[b];b++){var d=c[0].slice(0,3);(d={CQF:this.customQueries,CSF:this.customStrings,CTF:this.contextFunctions,CGF:this.customGenerators}[d])?d.add(c[0],c[1]):console.error("FunctionError: Invalid function name "+c[0])}},sre.SpeechRuleEvaluator=function(){},sre.SpeechRuleEvaluator.prototype.evaluateDefault=goog.abstractMethod,sre.SpeechRuleEvaluator.prototype.evaluateWhitespace=goog.abstractMethod,sre.SpeechRuleEvaluator.prototype.evaluateString=goog.abstractMethod,sre.SpeechRuleEvaluator.prototype.evaluateCustom=goog.abstractMethod,sre.SpeechRuleEvaluator.prototype.evaluateCharacter=goog.abstractMethod,sre.SpeechRuleStore=function(){},sre.SpeechRuleStore.prototype.addRule=goog.abstractMethod,sre.SpeechRuleStore.prototype.deleteRule=goog.abstractMethod,sre.SpeechRuleStore.prototype.findRule=goog.abstractMethod,sre.SpeechRuleStore.prototype.findAllRules=goog.abstractMethod,sre.SpeechRuleStore.prototype.lookupRule=goog.abstractMethod,sre.SpeechRuleStore.prototype.defineRule=goog.abstractMethod,sre.TrieNode=function(){},sre.TrieNode.prototype.getConstraint=function(){},sre.TrieNode.prototype.getKind=function(){},sre.TrieNode.prototype.applyTest=function(a){},sre.TrieNode.prototype.addChild=function(a){},sre.TrieNode.prototype.getChild=function(a){},sre.TrieNode.prototype.getChildren=function(){},sre.TrieNode.prototype.findChildren=function(a){},sre.TrieNode.prototype.removeChild=function(a){},sre.TrieNode.Kind={ROOT:"root",DYNAMIC:"dynamic",QUERY:"query",BOOLEAN:"boolean",STATIC:"static"},sre.AbstractTrieNode=function(a,b){this.constraint=a,this.test=b,this.children_={},this.kind=sre.TrieNode.Kind.ROOT},sre.AbstractTrieNode.prototype.getConstraint=function(){return this.constraint},sre.AbstractTrieNode.prototype.getKind=function(){return this.kind},sre.AbstractTrieNode.prototype.applyTest=function(a){return this.test(a)},sre.AbstractTrieNode.prototype.addChild=function(a){var b=a.getConstraint(),c=this.children_[b];return this.children_[b]=a,c},sre.AbstractTrieNode.prototype.getChild=function(a){return this.children_[a]},sre.AbstractTrieNode.prototype.getChildren=function(){var b,a=[];for(b in this.children_)a.push(this.children_[b]);return a},sre.AbstractTrieNode.prototype.findChildren=function(a){var c,b=[];for(c in this.children_){var d=this.children_[c];d.applyTest(a)&&b.push(d)}return b},sre.AbstractTrieNode.prototype.removeChild=function(a){delete this.children_[a]},sre.AbstractTrieNode.prototype.toString=function(){return this.constraint},sre.StaticTrieNode=function(a,b){sre.AbstractTrieNode.call(this,a,b),this.kind=sre.TrieNode.Kind.STATIC,this.rule_=null},goog.inherits(sre.StaticTrieNode,sre.AbstractTrieNode),sre.StaticTrieNode.prototype.getRule=function(){return this.rule_},sre.StaticTrieNode.prototype.setRule=function(a){this.rule_&&sre.Debugger.getInstance().output("Replacing rule "+this.rule_+" with "+a),this.rule_=a},sre.StaticTrieNode.prototype.toString=function(){return this.getRule()?this.constraint+"\n==> "+this.getRule().action:this.constraint},sre.TrieNodeFactory={},sre.TrieNodeFactory.getNode=function(a,b,c){switch(a){case sre.TrieNode.Kind.ROOT:return new sre.RootTrieNode;case sre.TrieNode.Kind.DYNAMIC:return new sre.DynamicTrieNode(b);case sre.TrieNode.Kind.QUERY:return new sre.QueryTrieNode(b,c);case sre.TrieNode.Kind.BOOLEAN:return new sre.BooleanTrieNode(b,c);default:return null}},sre.RootTrieNode=function(){sre.AbstractTrieNode.call(this,"",function(){return!0}),this.kind=sre.TrieNode.Kind.ROOT},goog.inherits(sre.RootTrieNode,sre.AbstractTrieNode),sre.DynamicTrieNode=function(a){sre.AbstractTrieNode.call(this,a,function(b){return b===a}),this.kind=sre.TrieNode.Kind.DYNAMIC},goog.inherits(sre.DynamicTrieNode,sre.AbstractTrieNode),sre.TrieNodeFactory.constraintTest_=function(a){var b,c,d,e,f;return a.match(/^self::\*$/)?function(g){return!0}:a.match(/^self::\w+$/)?(b=a.slice(6).toUpperCase(),function(g){return g.tagName&&sre.DomUtil.tagName(g)===b}):a.match(/^self::\w+:\w+$/)?(a=a.split(":"),(c=sre.XpathUtil.resolveNameSpace(a[2]))?(b=a[3].toUpperCase(),function(g){return g.localName&&g.localName.toUpperCase()===b&&g.namespaceURI===c}):null):a.match(/^@\w+$/)?(d=a.slice(1),function(g){return g.hasAttribute&&g.hasAttribute(d)}):a.match(/^@\w+="[\w\d ]+"$/)?(d=(a=a.split("="))[0].slice(1),e=a[1].slice(1,-1),function(g){return g.hasAttribute&&g.hasAttribute(d)&&g.getAttribute(d)===e}):a.match(/^@\w+!="[\w\d ]+"$/)?(a=a.split("!="),d=a[0].slice(1),e=a[1].slice(1,-1),function(g){return!g.hasAttribute||!g.hasAttribute(d)||g.getAttribute(d)!==e}):a.match(/^contains\(\s*@grammar\s*,\s*"[\w\d ]+"\s*\)$/)?(a=a.split('"'),e=a[1],function(g){return sre.Grammar.getInstance().getParameter(e)}):a.match(/^not\(\s*contains\(\s*@grammar\s*,\s*"[\w\d ]+"\s*\)\s*\)$/)?(a=a.split('"'),e=a[1],function(g){return!sre.Grammar.getInstance().getParameter(e)}):a.match(/^name\(\.\.\/\.\.\)="\w+"$/)?(a=a.split('"'),b=a[1].toUpperCase(),function(g){return g.parentNode&&g.parentNode.parentNode&&g.parentNode.parentNode.tagName&&sre.DomUtil.tagName(g.parentNode.parentNode)===b}):a.match(/^count\(preceding-sibling::\*\)=\d+$/)?(a=a.split("="),f=parseInt(a[1],10),function(g){return g.parentNode&&g.parentNode.childNodes[f]===g}):null},sre.QueryTrieNode=function(a,b){this.context_=b,sre.StaticTrieNode.call(this,a,sre.TrieNodeFactory.constraintTest_(a)),this.kind=sre.TrieNode.Kind.QUERY},goog.inherits(sre.QueryTrieNode,sre.StaticTrieNode),sre.QueryTrieNode.prototype.applyTest=function(a){return this.test?this.test(a):this.context_.applyQuery(a,this.constraint)===a},sre.BooleanTrieNode=function(a,b){this.context_=b,sre.StaticTrieNode.call(this,a,sre.TrieNodeFactory.constraintTest_(a)),this.kind=sre.TrieNode.Kind.BOOLEAN},goog.inherits(sre.BooleanTrieNode,sre.StaticTrieNode),sre.BooleanTrieNode.prototype.applyTest=function(a){return this.test?this.test(a):this.context_.applyConstraint(a,this.constraint)},sre.Trie=function(a){this.store=a,this.root=sre.TrieNodeFactory.getNode(sre.TrieNode.Kind.ROOT,"",this.store.context)},sre.Trie.prototype.addRule=function(a){for(var b=this.root,c=a.context,d=a.dynamicCstr.getValues(),e=0,f=d.length;e<f;e++)b=this.addNode_(b,d[e],sre.TrieNode.Kind.DYNAMIC,c);for(b=this.addNode_(b,a.precondition.query,sre.TrieNode.Kind.QUERY,c),e=0,f=(d=a.precondition.constraints).length;e<f;e++)b=this.addNode_(b,d[e],sre.TrieNode.Kind.BOOLEAN,c);b.setRule(a)},sre.Trie.prototype.addNode_=function(a,b,c,d){var e=a.getChild(b);return e||(e=sre.TrieNodeFactory.getNode(c,b,d),a.addChild(e)),e},sre.Trie.prototype.lookupRules=function(a,b){for(var c=[this.root],d=[];b.length;){for(var e=b.shift(),f=[];c.length;){var g=c.shift();(g=g.getChildren()).forEach(function(h){h.getKind()===sre.TrieNode.Kind.DYNAMIC&&-1===e.indexOf(h.getConstraint())||f.push(h)})}c=f.slice()}for(;c.length;)(g=c.shift()).getRule&&(b=g.getRule())&&d.push(b),g=g.findChildren(a),c=c.concat(g);return d},sre.Trie.prototype.hasSubtrie=function(a){for(var b=this.root,c=0,d=a.length;c<d;c++)if(!(b=b.getChild(a[c])))return!1;return!0},sre.Trie.prototype.toString=function(){return sre.Trie.printWithDepth_(this.root,0,"")},sre.Trie.prototype.collectRules=function(){return sre.Trie.collectRules_(this.root)},sre.Trie.prototype.order=function(){return sre.Trie.order_(this.root)},sre.Trie.printWithDepth_=function(a,b,c){var e,d=Array(b+2).join(b)+": ";for(c+=d+a.toString()+"\n",a=a.getChildren(),d=0;e=a[d];d++)c=sre.Trie.printWithDepth_(e,b+1,c);return c},sre.Trie.order_=function(a){var b;return(a=a.getChildren()).length?(b=Math.max.apply(null,a.map(sre.Trie.order_)),Math.max(a.length,b)):0},sre.Trie.collectRules_=function(a){var b=[];for(a=[a];a.length;){var d,c=a.shift();c.getKind()!==sre.TrieNode.Kind.QUERY&&c.getKind()!==sre.TrieNode.Kind.BOOLEAN||(d=c.getRule())&&b.unshift(d),a=a.concat(c.getChildren())}return b},sre.Trie.prototype.enumerate=function(a){return this.enumerate_(this.root,a)},sre.Trie.prototype.enumerate_=function(a,b){b=b||{},a=a.getChildren();for(var d,c=0;d=a[c];c++)d.kind===sre.TrieNode.Kind.DYNAMIC&&(b[d.getConstraint()]=this.enumerate_(d,b[d.getConstraint()]));return b},sre.Trie.prototype.byConstraint=function(a){for(var b=this.root;a.length&&b;)var c=a.shift(),b=b.getChild(c);return b||null},sre.BaseRuleStore=function(){this.context=new sre.SpeechRuleContext,this.speechRules_=[],this.trie=new sre.Trie(this),this.parseOrder=sre.DynamicCstr.DEFAULT_ORDER,this.parser=new sre.DynamicCstr.Parser(this.parseOrder),this.locale=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE],this.modality=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.MODALITY],this.domain="",this.initialized=!1,this.parseMethods={Rule:goog.bind(this.defineRule,this),Generator:goog.bind(this.generateRules,this)},this.customTranscriptions={}},sre.BaseRuleStore.prototype.lookupRule=function(a,b){return a&&(a.nodeType==sre.DomUtil.NodeType.ELEMENT_NODE||a.nodeType==sre.DomUtil.NodeType.TEXT_NODE)&&0<(a=this.lookupRules(a,b)).length?this.pickMostConstraint_(b,a):null},sre.BaseRuleStore.prototype.lookupRules=function(a,b){return this.trie.lookupRules(a,b.allProperties())},sre.BaseRuleStore.prototype.defineRule=function(a,b,c,d,e){try{var f=sre.SpeechRule.Action.fromString(c),g=Array.prototype.slice.call(arguments,4),h=this.parsePrecondition(d,g),k=this.parseCstr(b),l=new sre.SpeechRule(a,k,h,f)}catch(m){if("RuleError"==m.name)return console.error("Rule Error ",d,"("+b+"):",m.message),null;throw m}return this.addRule(l),l},sre.BaseRuleStore.prototype.addRule=function(a){a.context=this.context,this.trie.addRule(a),this.speechRules_.unshift(a)},sre.BaseRuleStore.prototype.deleteRule=function(a){-1!=(a=this.speechRules_.indexOf(a))&&this.speechRules_.splice(a,1)},sre.BaseRuleStore.prototype.findRule=function(a){for(var c,b=0;c=this.speechRules_[b];b++)if(a(c))return c;return null},sre.BaseRuleStore.prototype.findAllRules=function(a){return this.speechRules_.filter(a)},sre.BaseRuleStore.prototype.evaluateDefault=function(a){return(a=a.textContent.slice(0)).match(/^\s+$/)?this.evaluateWhitespace(a):this.evaluateString(a)},sre.BaseRuleStore.prototype.evaluateString=goog.abstractMethod,sre.BaseRuleStore.prototype.evaluateWhitespace=function(a){return[]},sre.BaseRuleStore.prototype.evaluateCustom=function(a){return void 0!==(a=this.customTranscriptions[a])?sre.AuditoryDescription.create({text:a},{adjust:!0,translate:!1}):null},sre.BaseRuleStore.prototype.evaluateCharacter=function(a){return this.evaluateCustom(a)||sre.AuditoryDescription.create({text:a},{adjust:!0,translate:!0})},sre.BaseRuleStore.prototype.debugSpeechRule=function(a,b){var c=a.precondition,d=a.context.applyQuery(b,c.query);sre.Debugger.getInstance().output(c.query,d&&d.toString()),c.constraints.forEach(goog.bind(function(e){sre.Debugger.getInstance().output(e,a.context.applyConstraint(b,e))},this))},sre.BaseRuleStore.prototype.initialize=goog.abstractMethod,sre.BaseRuleStore.prototype.removeDuplicates=function(a){for(var c,b=this.speechRules_.length-1;c=this.speechRules_[b];b--)c!=a&&a.dynamicCstr.equal(c.dynamicCstr)&&sre.BaseRuleStore.comparePreconditions_(c,a)&&this.speechRules_.splice(b,1)},sre.BaseRuleStore.prototype.pickMostConstraint_=function(a,b){var c=sre.Engine.getInstance().comparator;return b.sort(function(d,e){return c.compare(d.dynamicCstr,e.dynamicCstr)||sre.BaseRuleStore.priority_(d,e)||e.precondition.constraints.length-d.precondition.constraints.length}),sre.Debugger.getInstance().generateOutput(goog.bind(function(){return b.map(function(d){return d.name+"("+d.dynamicCstr.toString()+")"})},this)),b[0]},sre.BaseRuleStore.compareStaticConstraints_=function(a,b){if(a.length!=b.length)return!1;for(var d,c=0;d=a[c];c++)if(-1==b.indexOf(d))return!1;return!0},sre.BaseRuleStore.comparePreconditions_=function(a,b){return a=a.precondition,b=b.precondition,a.query==b.query&&sre.BaseRuleStore.compareStaticConstraints_(a.constraints,b.constraints)},sre.BaseRuleStore.priority_=function(a,b){return(a=a.precondition.priority)===(b=b.precondition.priority)?0:b<a?-1:1},sre.BaseRuleStore.prototype.getSpeechRules=function(){return this.speechRules_},sre.BaseRuleStore.prototype.setSpeechRules=function(a){this.speechRules_=a},sre.BaseRuleStore.prototype.parseCstr=function(a){return this.parser.parse(this.locale+"."+this.modality+(this.domain?"."+this.domain:"")+"."+a)},sre.BaseRuleStore.prototype.parsePrecondition=function(a,b){a=(c=this.parsePrecondition_(a))[0];for(var c=c.slice(1),d=(b=$jscomp.makeIterator(b)).next();!d.done;d=b.next())c=c.concat(this.parsePrecondition_(d.value));return new sre.SpeechRule.Precondition(a,c)},sre.BaseRuleStore.prototype.parsePrecondition_=function(a){var b=this.context.customGenerators.lookup(a);return b?b():[a]},sre.BaseRuleStore.prototype.parse=function(a){this.modality=a.modality||this.modality,this.locale=a.locale||this.locale,this.domain=a.domain||this.domain,this.context.parse(a.functions||[]),this.parseRules(a.rules||[])},sre.BaseRuleStore.prototype.parseRules=function(a){for(var c,b=0;c=a[b];b++){var d=c[0],e=this.parseMethods[d];d&&e&&e.apply(this,c.slice(1))}},sre.BaseRuleStore.prototype.generateRules=function(a){(a=this.context.customGenerators.lookup(a))&&a(this)},sre.BaseRuleStore.prototype.prune=function(a){var b=a.pop();(a=this.trie.byConstraint(a))&&a.removeChild(b)},sre.MathStore=function(){sre.BaseRuleStore.call(this),this.annotators=[],this.parseMethods.Alias=goog.bind(this.defineRuleAlias,this),this.parseMethods.Aliases=goog.bind(this.defineRulesAlias,this),this.parseMethods.UniqueAlias=goog.bind(this.defineUniqueRuleAlias,this),this.parseMethods.SpecializedRule=goog.bind(this.defineSpecialisedRule,this)},goog.inherits(sre.MathStore,sre.BaseRuleStore),sre.MathStore.prototype.initialize=function(){this.initialized||(this.annotations(),this.setSpeechRules(this.trie.collectRules()),this.initialized=!0)},sre.MathStore.prototype.annotations=function(){for(var b,a=0;b=this.annotators[a];a++)sre.SemanticAnnotations.getInstance().activate(this.domain,b)},sre.MathStore.prototype.defineUniqueRuleAlias=function(a,b,c,d){var e=this.parseCstr(b),f=this.findRule(goog.bind(function(g){return g.name==a&&e.equal(g.dynamicCstr)},this));if(!f)throw new sre.SpeechRule.OutputError("Rule named "+a+" with style "+b+" does not exist.");this.addAlias_(f,c,Array.prototype.slice.call(arguments,3))},sre.MathStore.prototype.defineRuleAlias=function(a,b,c){var d=this.findRule(function(e){return e.name==a});if(!d)throw new sre.SpeechRule.OutputError("Rule with named "+a+" does not exist.");this.addAlias_(d,b,Array.prototype.slice.call(arguments,2))},sre.MathStore.prototype.defineRulesAlias=function(a,b,c){var d=this.findAllRules(function(g){return g.name==a});if(0==d.length)throw new sre.SpeechRule.OutputError("Rule with name "+a+" does not exist.");var e=Array.prototype.slice.call(arguments,2),f=[];d.forEach(goog.bind(function(g){a:{for(var m,h=g.dynamicCstr.toString(),k=g.action.toString(),l=0;m=f[l];l++)if(m.action===k&&m.cstr===h){h=!1;break a}f.push({cstr:h,action:k}),h=!0}h&&this.addAlias_(g,b,e)},this))},sre.MathStore.prototype.addAlias_=function(a,b,c){b=this.parsePrecondition(b,c),(b=new sre.SpeechRule(a.name,a.dynamicCstr,b,a.action)).name=a.name,this.addRule(b)},sre.MathStore.prototype.defineSpecialisedRule=function(a,b,c,d){var e=this.parseCstr(b),f=this.findRule(goog.bind(function(g){return g.name==a&&e.equal(g.dynamicCstr)},this));if(!f)throw new sre.SpeechRule.OutputError("Rule named "+a+" with style "+b+" does not exist.");b=this.parseCstr(c),d=d?sre.SpeechRule.Action.fromString(d):f.action,f=new sre.SpeechRule(f.name,b,f.precondition,d),this.addRule(f)},sre.MathStore.prototype.evaluateString=function(a){var b=[];if(!a.match(/^\s+$/))if((c=this.matchNumber_(a))&&c.length===a.length)b.push(this.evaluateCharacter(c.number));else{a=sre.BaseUtil.removeEmpty(a.replace(/\s/g," ").split(" "));for(var d=0;c=a[d];d++)if(1==c.length)b.push(this.evaluateCharacter(c));else if(c.match(new RegExp("^["+sre.Messages.REGEXP.TEXT+"]+$")))b.push(this.evaluateCharacter(c));else for(var e=c;e;)var c=this.matchNumber_(e),f=e.match(new RegExp("^["+sre.Messages.REGEXP.TEXT+"]+")),e=c?(b.push(this.evaluateCharacter(c.number)),e.substring(c.length)):f?(b.push(this.evaluateCharacter(f[0])),e.substring(f[0].length)):(c=Array.from(e),b.push(this.evaluateCharacter(c[0])),c.slice(1).join(""))}return b},sre.MathStore.prototype.matchNumber_=function(a){var d,b=a.match(new RegExp("^"+sre.Messages.REGEXP.NUMBER)),c=a.match(new RegExp("^"+sre.Locale.en.REGEXP.NUMBER));return b||c?(d=c&&c[0]===a,b&&b[0]===a||!d?b?{number:b[0],length:b[0].length}:null:{number:c[0].replace(new RegExp(sre.Locale.en.REGEXP.DIGIT_GROUP,"g"),"X").replace(new RegExp(sre.Locale.en.REGEXP.DECIMAL_MARK,"g"),sre.Messages.REGEXP.DECIMAL_MARK).replace(/X/g,sre.Messages.REGEXP.DIGIT_GROUP.replace(/\\/g,"")),length:c[0].length}):null},sre.MathStore.prototype.parse=function(a){sre.MathStore.superClass_.parse.call(this,a),this.annotators=a.annotators||[]},sre.BrailleStore=function(){sre.MathStore.call(this),this.modality="braille",this.customTranscriptions={"⋊":"⠈⠡⠳"}},goog.inherits(sre.BrailleStore,sre.MathStore),sre.BrailleStore.prototype.evaluateString=function(a){var b=[];a=Array.from(a);for(var c=0;c<a.length;c++)b.push(this.evaluateCharacter(a[c]));return b},sre.BrailleStore.prototype.annotations=function(){for(var b,a=0;b=this.annotators[a];a++)sre.SemanticAnnotations.getInstance().activate(this.locale,b)},sre.ClearspeakPreferences=function(a,b){sre.DynamicCstr.call(this,a),this.preference=b},goog.inherits(sre.ClearspeakPreferences,sre.DynamicCstr),sre.ClearspeakPreferences.prototype.equal=function(a){if(!sre.ClearspeakPreferences.superClass_.equal.call(this,a))return!1;var b=Object.keys(this.preference);if(a=a.preference,b.length!==Object.keys(a).length)return!1;for(var d,c=0;d=b[c];c++)if(this.preference[d]!==a[d])return!1;return!0},sre.ClearspeakPreferences.AUTO="Auto",sre.ClearspeakPreferences.PREFERENCES=new sre.DynamicProperties({AbsoluteValue:["Auto","AbsEnd","Cardinality","Determinant"],Bar:["Auto","Conjugate"],Caps:["Auto","SayCaps"],CombinationPermutation:["Auto","ChoosePermute"],Currency:["Auto","Position","Prefix"],Ellipses:["Auto","AndSoOn"],Enclosed:["Auto","EndEnclose"],Exponent:["Auto","AfterPower","Ordinal","OrdinalPower","Exponent"],Fraction:"Auto EndFrac FracOver General GeneralEndFrac Ordinal Over OverEndFrac Per".split(" "),Functions:["Auto","None","Reciprocal"],ImpliedTimes:["Auto","MoreImpliedTimes","None"],Log:["Auto","LnAsNaturalLog"],Matrix:"Auto Combinatoric EndMatrix EndVector SilentColNum SpeakColNum Vector".split(" "),MultiLineLabel:"Auto Case Constraint Equation Line None Row Step".split(" "),MultiLineOverview:["Auto","None"],MultiLinePausesBetweenColumns:["Auto","Long","Short"],MultsymbolDot:["Auto","Dot"],MultsymbolX:["Auto","By","Cross"],Paren:"Auto CoordPoint Interval Silent Speak SpeakNestingLevel".split(" "),Prime:["Auto","Angle","Length"],Roots:["Auto","PosNegSqRoot","PosNegSqRootEnd","RootEnd"],SetMemberSymbol:["Auto","Belongs","Element","Member"],Sets:["Auto","SilentBracket","woAll"],TriangleSymbol:["Auto","Delta"],Trig:["Auto","ArcTrig","TrigInverse","Reciprocal"],VerticalLine:["Auto","Divides","Given","SuchThat"]}),sre.ClearspeakPreferences.comparator=function(){return new sre.ClearspeakPreferences.Comparator(sre.Engine.getInstance().dynamicCstr,sre.DynamicProperties.create([sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE]],[sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.MODALITY]],[sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.DOMAIN]],[sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.STYLE]]))},sre.ClearspeakPreferences.Comparator=function(a,b){sre.DynamicCstr.DefaultComparator.call(this,a,b),this.preference=a.preference||{}},goog.inherits(sre.ClearspeakPreferences.Comparator,sre.DynamicCstr.DefaultComparator),sre.ClearspeakPreferences.Comparator.prototype.match=function(a){if(!sre.ClearspeakPreferences.Comparator.superClass_.match.call(this,a))return!1;if(a.preference)for(var d,b=Object.keys(a.preference),c=0;d=b[c];c++)if(this.preference[d]!==a.preference[d])return!1;return!0},sre.ClearspeakPreferences.Comparator.prototype.compare=function(a,b){var c=sre.ClearspeakPreferences.Comparator.superClass_.compare.call(this,a,b);return 0!==c?c:!a.preference&&b.preference?1:a.preference&&!b.preference?-1:a.preference||b.preference?(a=Object.keys(a.preference).length,(b=Object.keys(b.preference).length)<a?-1:a<b?1:0):0},sre.ClearspeakPreferences.Parser=function(){sre.DynamicCstr.Parser.call(this,[sre.DynamicCstr.Axis.LOCALE,sre.DynamicCstr.Axis.MODALITY,sre.DynamicCstr.Axis.DOMAIN,sre.DynamicCstr.Axis.STYLE])},goog.inherits(sre.ClearspeakPreferences.Parser,sre.DynamicCstr.Parser),sre.ClearspeakPreferences.Parser.prototype.parse=function(a){a=(b=sre.ClearspeakPreferences.Parser.superClass_.parse.call(this,a)).getValue(sre.DynamicCstr.Axis.STYLE);var c=b.getValue(sre.DynamicCstr.Axis.LOCALE),b=b.getValue(sre.DynamicCstr.Axis.MODALITY),d={};return a!==sre.DynamicCstr.DEFAULT_VALUE&&(d=this.fromPreference(a),a=this.toPreference(d)),new sre.ClearspeakPreferences({locale:c,modality:b,domain:"clearspeak",style:a},d)},sre.ClearspeakPreferences.Parser.prototype.fromPreference=function(a){return sre.ClearspeakPreferences.fromPreference(a)},sre.ClearspeakPreferences.fromPreference=function(a){a=a.split(":");for(var b={},c=sre.ClearspeakPreferences.PREFERENCES.getProperties(),d=Object.keys(c),e=0;f=a[e];e++){var g,f=f.split("_");-1!==d.indexOf(f[0])&&(g=f[1])&&g!==sre.ClearspeakPreferences.AUTO&&-1!==c[f[0]].indexOf(g)&&(b[f[0]]=f[1])}return b},sre.ClearspeakPreferences.Parser.prototype.toPreference=function(a){return sre.ClearspeakPreferences.toPreference(a)},sre.ClearspeakPreferences.toPreference=function(a){for(var b=Object.keys(a),c=[],d=0;d<b.length;d++)c.push(b[d]+"_"+a[b[d]]);return c.length?c.join(":"):sre.DynamicCstr.DEFAULT_VALUE},sre.ClearspeakPreferences.getLocalePreferences=function(a){return a=a||sre.MathCompoundStore.getInstance().enumerate(sre.SpeechRuleEngine.getInstance().enumerate()),sre.ClearspeakPreferences.getLocalePreferences_(a)},sre.ClearspeakPreferences.getLocalePreferences_=function(a){var c,b={};for(c in a)if(a[c].speech&&a[c].speech.clearspeak){var f,d=Object.keys(a[c].speech.clearspeak),e=b[c]={};for(f in sre.ClearspeakPreferences.PREFERENCES.getProperties()){var g=sre.ClearspeakPreferences.PREFERENCES.getProperties()[f],h=[f+"_Auto"];if(g)for(var k=(g=$jscomp.makeIterator(g)).next();!k.done;k=g.next())k=k.value,-1!==d.indexOf(f+"_"+k)&&h.push(f+"_"+k);e[f]=h}}return b},sre.ClearspeakPreferences.smartPreferences=function(a,b){if(!(b=sre.ClearspeakPreferences.getLocalePreferences()[b]))return[];if(!(a=a.explorers))return[{type:"radio",content:"Standard",id:"clearspeak-default",variable:"speechRules"}];a=sre.ClearspeakPreferences.relevantPreferences(a.walker.getFocus().getSemanticPrimary());var c=sre.Engine.DOMAIN_TO_STYLES.clearspeak;return[{type:"radio",content:"No Preferences",id:"clearspeak-default",variable:"speechRules"},{type:"radio",content:"Current Preferences",id:"clearspeak-"+c,variable:"speechRules"},{type:"rule"},{type:"label",content:"Preferences for "+a},{type:"rule"}].concat(b[a].map(function(d){return{type:"radio",content:(d=d.split("_"))[1],id:"clearspeak-"+sre.ClearspeakPreferences.addPreference(c,d[0],d[1]),variable:"speechRules"}}))},sre.ClearspeakPreferences.relevantPreferences=function(a){var b=sre.ClearspeakPreferences.SEMANTIC_MAPPING_[a.type];return b&&(b[a.role]||b[""])||"ImpliedTimes"},sre.ClearspeakPreferences.REVERSE_MAPPING_=[["AbsoluteValue",sre.SemanticAttr.Type.FENCED,sre.SemanticAttr.Role.NEUTRAL],["Bar",sre.SemanticAttr.Type.OVERSCORE,sre.SemanticAttr.Role.OVERACCENT],["Caps",sre.SemanticAttr.Type.IDENTIFIER,sre.SemanticAttr.Role.LATINLETTER],["CombinationPermutation",sre.SemanticAttr.Type.APPL,sre.SemanticAttr.Role.UNKNOWN],["Ellipses",sre.SemanticAttr.Type.PUNCTUATION,sre.SemanticAttr.Role.ELLIPSIS],["Exponent",sre.SemanticAttr.Type.SUPERSCRIPT,""],["Fraction",sre.SemanticAttr.Type.FRACTION,""],["Functions",sre.SemanticAttr.Type.APPL,sre.SemanticAttr.Role.SIMPLEFUNC],["ImpliedTimes",sre.SemanticAttr.Type.OPERATOR,sre.SemanticAttr.Role.IMPLICIT],["Log",sre.SemanticAttr.Type.APPL,sre.SemanticAttr.Role.PREFIXFUNC],["Matrix",sre.SemanticAttr.Type.MATRIX,""],["Matrix",sre.SemanticAttr.Type.VECTOR,""],["MultiLineLabel",sre.SemanticAttr.Type.MULTILINE,sre.SemanticAttr.Role.LABEL],["MultiLineOverview",sre.SemanticAttr.Type.MULTILINE,sre.SemanticAttr.Role.TABLE],["MultiLinePausesBetweenColumns",sre.SemanticAttr.Type.MULTILINE,sre.SemanticAttr.Role.TABLE],["MultiLineLabel",sre.SemanticAttr.Type.TABLE,sre.SemanticAttr.Role.LABEL],["MultiLineOverview",sre.SemanticAttr.Type.TABLE,sre.SemanticAttr.Role.TABLE],["MultiLinePausesBetweenColumns",sre.SemanticAttr.Type.TABLE,sre.SemanticAttr.Role.TABLE],["MultiLineLabel",sre.SemanticAttr.Type.CASES,sre.SemanticAttr.Role.LABEL],["MultiLineOverview",sre.SemanticAttr.Type.CASES,sre.SemanticAttr.Role.TABLE],["MultiLinePausesBetweenColumns",sre.SemanticAttr.Type.CASES,sre.SemanticAttr.Role.TABLE],["MultsymbolDot",sre.SemanticAttr.Type.OPERATOR,sre.SemanticAttr.Role.MULTIPLICATION],["MultsymbolX",sre.SemanticAttr.Type.OPERATOR,sre.SemanticAttr.Role.MULTIPLICATION],["Paren",sre.SemanticAttr.Type.FENCED,sre.SemanticAttr.Role.LEFTRIGHT],["Prime",sre.SemanticAttr.Type.SUPERSCRIPT,sre.SemanticAttr.Role.PRIME],["Roots",sre.SemanticAttr.Type.ROOT,""],["Roots",sre.SemanticAttr.Type.SQRT,""],["SetMemberSymbol",sre.SemanticAttr.Type.RELATION,sre.SemanticAttr.Role.ELEMENT],["Sets",sre.SemanticAttr.Type.FENCED,sre.SemanticAttr.Role.SETEXT],["TriangleSymbol",sre.SemanticAttr.Type.IDENTIFIER,sre.SemanticAttr.Role.GREEKLETTER],["Trig",sre.SemanticAttr.Type.APPL,sre.SemanticAttr.Role.PREFIXFUNC],["VerticalLine",sre.SemanticAttr.Type.PUNCTUATED,sre.SemanticAttr.Role.VBAR]],sre.ClearspeakPreferences.SEMANTIC_MAPPING_=function(){for(var c,a={},b=0;c=sre.ClearspeakPreferences.REVERSE_MAPPING_[b];b++){var d=c[0],e=a[c[1]];e||(a[c[1]]=e={}),e[c[2]]=d}return a}(),sre.ClearspeakPreferences.findPreference=function(a,b){return"default"!==a&&sre.ClearspeakPreferences.fromPreference(a)[b]||sre.ClearspeakPreferences.AUTO},sre.ClearspeakPreferences.addPreference=function(a,b,c){return"default"===a?b+"_"+c:((a=sre.ClearspeakPreferences.fromPreference(a))[b]=c,sre.ClearspeakPreferences.toPreference(a))},sre.Engine.getInstance().comparators.clearspeak=sre.ClearspeakPreferences.comparator,sre.Engine.getInstance().parsers.clearspeak=new sre.ClearspeakPreferences.Parser,sre.AlphabetGenerator={},sre.AlphabetGenerator.Font={BOLD:"bold",BOLDFRAKTUR:"bold-fraktur",BOLDITALIC:"bold-italic",BOLDSCRIPT:"bold-script",DOUBLESTRUCK:"double-struck",FULLWIDTH:"fullwidth",FRAKTUR:"fraktur",ITALIC:"italic",MONOSPACE:"monospace",NORMAL:"normal",SCRIPT:"script",SANSSERIF:"sans-serif",SANSSERIFITALIC:"sans-serif-italic",SANSSERIFBOLD:"sans-serif-bold",SANSSERIFBOLDITALIC:"sans-serif-bold-italic"},sre.AlphabetGenerator.Embellish={SUPER:"super",SUB:"sub",CIRCLED:"circled",PARENTHESIZED:"parenthesized",PERIOD:"period",NEGATIVECIRCLED:"negative-circled",DOUBLECIRCLED:"double-circled",CIRCLEDSANSSERIF:"circled-sans-serif",NEGATIVECIRCLEDSANSSERIF:"negative-circled-sans-serif",COMMA:"comma",SQUARED:"squared",NEGATIVESQUARED:"negative-squared"},sre.AlphabetGenerator.Base={LATINCAP:"latinCap",LATINSMALL:"latinSmall",GREEKCAP:"greekCap",GREEKSMALL:"greekSmall",DIGIT:"digit"},sre.AlphabetGenerator.Domains_={small:["default"],capital:["default"],digit:["default"]},sre.AlphabetGenerator.makeDomains_=function(){function c(d,e){var f={};return Object.keys(d).forEach(function(g){f[g]=!0}),Object.keys(e).forEach(function(g){f[g]=!0}),Object.keys(f)}var a=sre.Messages.ALPHABET_PREFIXES,b=sre.Messages.ALPHABET_TRANSFORMERS;sre.AlphabetGenerator.Domains_.small=c(a.smallPrefix,b.letter),sre.AlphabetGenerator.Domains_.capital=c(a.capPrefix,b.letter),sre.AlphabetGenerator.Domains_.digit=c(a.digitPrefix,b.digit)},sre.AlphabetGenerator.generate=function(a,b){var c=sre.Engine.getInstance().locale;sre.Engine.getInstance().locale=a,sre.L10n.setLocale(),b.addSymbolRules({locale:a}),sre.AlphabetGenerator.makeDomains_(),a=sre.AlphabetGenerator.INTERVALS;for(var e,d=0;e=a[d];d++){var f=sre.AlphabetGenerator.makeInterval(e.interval,e.subst),g=f.map(function(h){return sre.SemanticUtil.numberToUnicode(parseInt(h,16))});"offset"in e?sre.AlphabetGenerator.numberRules(b,f,g,e.font,e.category,e.offset||0):sre.AlphabetGenerator.alphabetRules(b,f,g,sre.Messages.ALPHABETS[e.base],e.font,e.category,!!e.capital)}sre.Engine.getInstance().locale=c,sre.L10n.setLocale()},sre.AlphabetGenerator.makeInterval=function(a,b){var c=parseInt(a[0],16);a=parseInt(a[1],16);for(var d=[];c<=a;c++){var e=c.toString(16).toUpperCase();!1!==b[e=3<e.length?e:("000"+e).slice(-4)]&&(e=b[e]||e,d.push(e))}return d},sre.AlphabetGenerator.getFont=function(a){return"string"==typeof(a="normal"!==a&&"fullwidth"!==a&&(sre.Messages.FONT[a]||sre.Messages.EMBELLISH[a])||"")?{font:a,combiner:sre.Messages.ALPHABET_COMBINER}:{font:a[0],combiner:a[1]}},sre.AlphabetGenerator.alphabetRules=function(a,b,c,d,e,f,g){e=sre.AlphabetGenerator.getFont(e);for(var k,l,m,h=0;k=b[h],l=c[h],m=d[h];h++)sre.AlphabetGenerator.makeLetter(a,e.combiner,k,l,m,e.font,g?sre.Messages.ALPHABET_PREFIXES.capPrefix:sre.Messages.ALPHABET_PREFIXES.smallPrefix,f,sre.Messages.ALPHABET_TRANSFORMERS.letter,g?sre.AlphabetGenerator.Domains_.capital:sre.AlphabetGenerator.Domains_.small)},sre.AlphabetGenerator.numberRules=function(a,b,c,d,e,f){d=sre.AlphabetGenerator.getFont(d);for(var h,k,g=0;h=b[g],k=c[g];g++)sre.AlphabetGenerator.makeLetter(a,d.combiner,h,k,g+f,d.font,sre.Messages.ALPHABET_PREFIXES.digitPrefix,e,sre.Messages.ALPHABET_TRANSFORMERS.digit,sre.AlphabetGenerator.Domains_.digit)},sre.AlphabetGenerator.makeLetter=function(a,b,c,d,e,f,g,h,k,l){for(var n,m=0;n=l[m];m++){var p=n in g?g[n]:g.default;a.defineRule(c.toString(),n,"default",h,d,b((n in k?k[n]:k.default)(e),f,p))}},sre.AlphabetGenerator.INTERVALS=[{interval:["1D400","1D419"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.BOLD},{interval:["1D41A","1D433"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.BOLD},{interval:["1D56C","1D585"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.BOLDFRAKTUR},{interval:["1D586","1D59F"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.BOLDFRAKTUR},{interval:["1D468","1D481"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.BOLDITALIC},{interval:["1D482","1D49B"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.BOLDITALIC},{interval:["1D4D0","1D4E9"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.BOLDSCRIPT},{interval:["1D4EA","1D503"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.BOLDSCRIPT},{interval:["1D538","1D551"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{"1D53A":"2102","1D53F":"210D","1D545":"2115","1D547":"2119","1D548":"211A","1D549":"211D","1D551":"2124"},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.DOUBLESTRUCK},{interval:["1D552","1D56B"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.DOUBLESTRUCK},{interval:["1D504","1D51D"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{"1D506":"212D","1D50B":"210C","1D50C":"2111","1D515":"211C","1D51D":"2128"},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.FRAKTUR},{interval:["1D51E","1D537"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.FRAKTUR},{interval:["FF21","FF3A"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.FULLWIDTH},{interval:["FF41","FF5A"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.FULLWIDTH},{interval:["1D434","1D44D"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.ITALIC},{interval:["1D44E","1D467"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{"1D455":"210E"},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.ITALIC},{interval:["1D670","1D689"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.MONOSPACE},{interval:["1D68A","1D6A3"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.MONOSPACE},{interval:["0041","005A"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.NORMAL},{interval:["0061","007A"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.NORMAL},{interval:["1D49C","1D4B5"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{"1D49D":"212C","1D4A0":"2130","1D4A1":"2131","1D4A3":"210B","1D4A4":"2110","1D4A7":"2112","1D4A8":"2133","1D4AD":"211B"},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.SCRIPT},{interval:["1D4B6","1D4CF"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{"1D4BA":"212F","1D4BC":"210A","1D4C4":"2134"},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.SCRIPT},{interval:["1D5A0","1D5B9"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.SANSSERIF},{interval:["1D5BA","1D5D3"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.SANSSERIF},{interval:["1D608","1D621"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.SANSSERIFITALIC},{interval:["1D622","1D63B"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.SANSSERIFITALIC},{interval:["1D5D4","1D5ED"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.SANSSERIFBOLD},{interval:["1D5EE","1D607"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.SANSSERIFBOLD},{interval:["1D63C","1D655"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.SANSSERIFBOLDITALIC},{interval:["1D656","1D66F"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.SANSSERIFBOLDITALIC},{interval:["0391","03A9"],base:sre.AlphabetGenerator.Base.GREEKCAP,subst:{"03A2":"03F4"},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.NORMAL},{interval:["03B0","03D0"],base:sre.AlphabetGenerator.Base.GREEKSMALL,subst:{"03B0":"2207","03CA":"2202","03CB":"03F5","03CC":"03D1","03CD":"03F0","03CE":"03D5","03CF":"03F1","03D0":"03D6"},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.NORMAL},{interval:["1D6A8","1D6C0"],base:sre.AlphabetGenerator.Base.GREEKCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.BOLD},{interval:["1D6C1","1D6E1"],base:sre.AlphabetGenerator.Base.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.BOLD},{interval:["1D6E2","1D6FA"],base:sre.AlphabetGenerator.Base.GREEKCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.ITALIC},{interval:["1D6FB","1D71B"],base:sre.AlphabetGenerator.Base.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.ITALIC},{interval:["1D71C","1D734"],base:sre.AlphabetGenerator.Base.GREEKCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.BOLDITALIC},{interval:["1D735","1D755"],base:sre.AlphabetGenerator.Base.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.BOLDITALIC},{interval:["1D756","1D76E"],base:sre.AlphabetGenerator.Base.GREEKCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.SANSSERIFBOLD},{interval:["1D76F","1D78F"],base:sre.AlphabetGenerator.Base.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.SANSSERIFBOLD},{interval:["1D790","1D7A8"],base:sre.AlphabetGenerator.Base.GREEKCAP,subst:{},capital:!0,category:"Lu",font:sre.AlphabetGenerator.Font.SANSSERIFBOLDITALIC},{interval:["1D7A9","1D7C9"],base:sre.AlphabetGenerator.Base.GREEKSMALL,subst:{},capital:!1,category:"Ll",font:sre.AlphabetGenerator.Font.SANSSERIFBOLDITALIC},{interval:["0030","0039"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:0,category:"Nd",font:sre.AlphabetGenerator.Font.NORMAL},{interval:["2070","2079"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{2071:"00B9",2072:"00B2",2073:"00B3"},offset:0,category:"No",font:sre.AlphabetGenerator.Embellish.SUPER},{interval:["2080","2089"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:0,category:"No",font:sre.AlphabetGenerator.Embellish.SUB},{interval:["245F","2473"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{"245F":"24EA"},offset:0,category:"No",font:sre.AlphabetGenerator.Embellish.CIRCLED},{interval:["3251","325F"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:21,category:"No",font:sre.AlphabetGenerator.Embellish.CIRCLED},{interval:["32B1","32BF"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:36,category:"No",font:sre.AlphabetGenerator.Embellish.CIRCLED},{interval:["2474","2487"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:1,category:"No",font:sre.AlphabetGenerator.Embellish.PARENTHESIZED},{interval:["2487","249B"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{2487:"1F100"},offset:0,category:"No",font:sre.AlphabetGenerator.Embellish.PERIOD},{interval:["2775","277F"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{2775:"24FF"},offset:0,category:"No",font:sre.AlphabetGenerator.Embellish.NEGATIVECIRCLED},{interval:["24EB","24F4"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:11,category:"No",font:sre.AlphabetGenerator.Embellish.NEGATIVECIRCLED},{interval:["24F5","24FE"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:1,category:"No",font:sre.AlphabetGenerator.Embellish.DOUBLECIRCLED},{interval:["277F","2789"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{"277F":"1F10B"},offset:0,category:"No",font:sre.AlphabetGenerator.Embellish.CIRCLEDSANSSERIF},{interval:["2789","2793"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{2789:"1F10C"},offset:0,category:"No",font:sre.AlphabetGenerator.Embellish.NEGATIVECIRCLEDSANSSERIF},{interval:["FF10","FF19"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:0,category:"Nd",font:sre.AlphabetGenerator.Font.FULLWIDTH},{interval:["1D7CE","1D7D7"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:0,category:"Nd",font:sre.AlphabetGenerator.Font.BOLD},{interval:["1D7D8","1D7E1"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:0,category:"Nd",font:sre.AlphabetGenerator.Font.DOUBLESTRUCK},{interval:["1D7E2","1D7EB"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:0,category:"Nd",font:sre.AlphabetGenerator.Font.SANSSERIF},{interval:["1D7EC","1D7F5"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:0,category:"Nd",font:sre.AlphabetGenerator.Font.SANSSERIFBOLD},{interval:["1D7F6","1D7FF"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:0,category:"Nd",font:sre.AlphabetGenerator.Font.MONOSPACE},{interval:["1F101","1F10A"],base:sre.AlphabetGenerator.Base.DIGIT,subst:{},offset:0,category:"No",font:sre.AlphabetGenerator.Embellish.COMMA},{interval:["24B6","24CF"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"So",font:sre.AlphabetGenerator.Embellish.CIRCLED},{interval:["24D0","24E9"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"So",font:sre.AlphabetGenerator.Embellish.CIRCLED},{interval:["1F110","1F129"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"So",font:sre.AlphabetGenerator.Embellish.PARENTHESIZED},{interval:["249C","24B5"],base:sre.AlphabetGenerator.Base.LATINSMALL,subst:{},capital:!1,category:"So",font:sre.AlphabetGenerator.Embellish.PARENTHESIZED},{interval:["1F130","1F149"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"So",font:sre.AlphabetGenerator.Embellish.SQUARED},{interval:["1F170","1F189"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"So",font:sre.AlphabetGenerator.Embellish.NEGATIVESQUARED},{interval:["1F150","1F169"],base:sre.AlphabetGenerator.Base.LATINCAP,subst:{},capital:!0,category:"So",font:sre.AlphabetGenerator.Embellish.NEGATIVECIRCLED}],sre.MathSimpleStore=function(){sre.MathStore.call(this),this.category=""},goog.inherits(sre.MathSimpleStore,sre.MathStore),sre.MathSimpleStore.prototype.defineRulesFromMappings=function(a,b,c){for(var d in c)for(var e in c[d])this.defineRuleFromStrings(a,d,e,b,c[d][e])},sre.MathSimpleStore.prototype.defineRuleFromStrings=function(a,b,c,d,e){this.defineRule(a,b+"."+c,'[t] "'+e+'"',"self::text()",'"'===d?"self::text() = '"+d+"'":'self::text() = "'+d+'"')},sre.MathSimpleStore.prototype.lookupRule=function(a,b){return(a=this.getSpeechRules().filter(function(c){return sre.MathSimpleStore.testDynamicConstraints_(b,c)})).length?a.sort(function(c,d){return sre.Engine.getInstance().comparator.compare(c.dynamicCstr,d.dynamicCstr)})[0]:null},sre.MathSimpleStore.testDynamicConstraints_=function(a,b){return sre.Engine.getInstance().strict?b.dynamicCstr.equal(a):sre.Engine.getInstance().comparator.match(b.dynamicCstr)},sre.MathCompoundStore=function(){this.subStores_={},this.locale=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE],this.modality=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.MODALITY],this.siPrefixes={}},goog.addSingletonGetter(sre.MathCompoundStore),sre.MathCompoundStore.prototype.getSubStore_=function(a){var b=this.subStores_[a];return b?(sre.Debugger.getInstance().output("Store exists! "+a),b):(b=new sre.MathSimpleStore,this.subStores_[a]=b)},sre.MathCompoundStore.prototype.setupStore_=function(a,b){a.locale=this.locale,a.modality=this.modality,b&&(a.category=b)},sre.MathCompoundStore.prototype.defineRules=function(a,b,c,d){var e=this.getSubStore_(b);this.setupStore_(e,c),e.defineRulesFromMappings(a,b,d)},sre.MathCompoundStore.prototype.defineRule=function(a,b,c,d,e,f){var g=this.getSubStore_(e);this.setupStore_(g,d),g.defineRuleFromStrings(a,b,c,e,f)},sre.MathCompoundStore.prototype.changeLocale_=function(a){return!(!a.locale&&!a.modality||(this.locale=a.locale||this.locale,this.modality=a.modality||this.modality,0))},sre.MathCompoundStore.prototype.addSymbolRules=function(a){var b;this.changeLocale_(a)||(b=sre.MathSimpleStore.parseUnicode_(a.key),this.defineRules(a.key,b,a.category,a.mappings))},sre.MathCompoundStore.prototype.addFunctionRules=function(a){if(!this.changeLocale_(a)){var b=a.names,c=a.mappings;a=a.category;for(var e,d=0;e=b[d];d++)this.defineRules(e,e,a,c)}},sre.MathCompoundStore.prototype.addUnitRules=function(a){this.changeLocale_(a)||(a.si?this.addSiUnitRules(a):this.addUnitRules_(a))},sre.MathCompoundStore.prototype.addUnitRules_=function(a){var b=a.names;b&&(a.names=b.map(function(c){return c+":unit"})),this.addFunctionRules(a)},sre.MathCompoundStore.prototype.addSiUnitRules=function(a){for(var b=$jscomp.makeIterator(Object.keys(this.siPrefixes)),c=b.next();!c.done;c=b.next()){var d=c.value,e=((c=Object.assign({},a)).mappings={},this.siPrefixes[d]);c.key=d+c.key,c.names=c.names.map(function(l){return d+l});for(var f=$jscomp.makeIterator(Object.keys(a.mappings)),g=f.next();!g.done;g=f.next()){g=g.value,c.mappings[g]={};for(var h=$jscomp.makeIterator(Object.keys(a.mappings[g])),k=h.next();!k.done;k=h.next())k=k.value,c.mappings[g][k]=sre.Locale[this.locale].SI(e,a.mappings[g][k])}this.addUnitRules_(c)}this.addUnitRules_(a)},sre.MathCompoundStore.prototype.lookupRule=function(a,b){return(a=this.subStores_[a])?a.lookupRule(null,b):null},sre.MathCompoundStore.prototype.lookupCategory=function(a){return(a=this.subStores_[a])?a.category:""},sre.MathCompoundStore.prototype.lookupString=function(a,b){return(a=this.lookupRule(a,b))?a.action.components.map(function(c){return c.content.slice(1,-1)}).join(" "):null},sre.MathCompoundStore.prototype.enumerate=function(a){for(var b in a=a||{},this.subStores_)a=this.subStores_[b].trie.enumerate(a);return a},sre.MathSimpleStore.parseUnicode_=function(a){return(a=parseInt(a,16))<65536?String.fromCharCode(a):(a-=65536,String.fromCharCode(55296+(a>>10),56320+(1023&a)))},sre.MathMap=function(){this.store=sre.MathCompoundStore.getInstance(),this.loaded_=[],this.addSymbols={functions:goog.bind(this.store.addFunctionRules,this.store),symbols:goog.bind(this.store.addSymbolRules,this.store),units:goog.bind(this.store.addUnitRules,this.store),si:goog.bind(this.addSiPrefixes,this)}},goog.addSingletonGetter(sre.MathMap),sre.MathMap.oldInst_=sre.MathMap.getInstance,sre.MathMap.prototype.addSiPrefixes=function(a){this.store.siPrefixes=a},sre.MathMap.getInstance=function(){var a=sre.MathMap.oldInst_();return a.loadLocale(),a},sre.MathMap.prototype.loadLocale=function(){var a=sre.Engine.getInstance().locale;-1===this.loaded_.indexOf(a)&&(sre.SpeechRuleEngine.getInstance().prune=!0,this.retrieveMaps(a),this.loaded_.push(a))},sre.MathMap.toFetch_=0,sre.Engine.registerTest(function(){return sre.MathMap.getInstance()&&!sre.MathMap.toFetch_}),sre.MathMap.prototype.retrieveFiles=function(a,b){var c=sre.Engine.getInstance().mode===sre.Engine.Mode.ASYNC;switch(c&&(sre.Engine.getInstance().mode=sre.Engine.Mode.SYNC),sre.Engine.getInstance().mode){case sre.Engine.Mode.ASYNC:sre.MathMap.toFetch_++,sre.MathMap.fromFile_(a,function(d,e){sre.MathMap.toFetch_--,d||b(e)});break;case sre.Engine.Mode.HTTP:sre.MathMap.toFetch_++,sre.MathMap.getJsonAjax_(a,b);break;default:a=sre.MathMap.loadFile(a),b(a)}c&&(sre.Engine.getInstance().mode=sre.Engine.Mode.ASYNC)},sre.MathMap.prototype.parseMaps=function(a){a=JSON.parse(a),this.addMaps(a)},sre.MathMap.prototype.addMaps=function(a,b){for(var d,c=0;d=Object.keys(a)[c];c++){var e=d.split("/");b&&b!==e[0]||("rules"!==e[1]?a[d].forEach(this.addSymbols[e[1]]):sre.SpeechRuleEngine.getInstance().addStore(a[d]))}},sre.MathMap.prototype.retrieveMaps=function(a){var b;sre.AlphabetGenerator.generate(a,this.store),sre.Engine.getInstance().isIE&&sre.Engine.getInstance().mode===sre.Engine.Mode.HTTP?this.getJsonIE_(a):(a=sre.BaseUtil.makePath(sre.SystemExternal.jsonPath)+a+".js",b=goog.bind(this.parseMaps,this),this.retrieveFiles(a,b))},sre.MathMap.prototype.getJsonIE_=function(a,b){var c=b||1;sre.BrowserUtil.mapsForIE?this.addMaps(sre.BrowserUtil.mapsForIE,a):c<=5&&setTimeout(goog.bind(function(){this.getJsonIE_(a,c++)},this),300)},sre.MathMap.fromFile_=function(a,b){return sre.SystemExternal.fs.readFile(a,"utf8",b)},sre.MathMap.loadFile=function(a){try{return sre.MathMap.readJSON_(a)}catch(b){console.error("Unable to load file: "+a+"\n"+b)}return"{}"},sre.MathMap.readJSON_=function(a){return sre.SystemExternal.fs.readFileSync(a)},sre.MathMap.getJsonAjax_=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&(sre.MathMap.toFetch_--,200===c.status)&&b(c.responseText)},c.open("GET",a,!0),c.send()},sre.NemethUtil={},sre.NemethUtil.openingFraction=function(a){return a=sre.MathspeakUtil.fractionNestingDepth(a),Array(a).join(sre.Messages.MS.FRACTION_REPEAT)+sre.Messages.MS.FRACTION_START},sre.NemethUtil.closingFraction=function(a){return a=sre.MathspeakUtil.fractionNestingDepth(a),Array(a).join(sre.Messages.MS.FRACTION_REPEAT)+sre.Messages.MS.FRACTION_END},sre.NemethUtil.overFraction=function(a){return a=sre.MathspeakUtil.fractionNestingDepth(a),Array(a).join(sre.Messages.MS.FRACTION_REPEAT)+sre.Messages.MS.FRACTION_OVER},sre.NemethUtil.overBevelledFraction=function(a){return a=sre.MathspeakUtil.fractionNestingDepth(a),Array(a).join(sre.Messages.MS.FRACTION_REPEAT)+"⠸"+sre.Messages.MS.FRACTION_OVER},sre.NemethUtil.nestedRadical=function(a,b){return 1===(a=sre.NemethUtil.radicalNestingDepth(a))?b:Array(a).join(sre.Messages.MS.NESTED)+b},sre.NemethUtil.radicalNestingDepth=function(a,b){return b=b||0,a.parentNode?sre.NemethUtil.radicalNestingDepth(a.parentNode,"root"===a.tagName||"sqrt"===a.tagName?b+1:b):b},sre.NemethUtil.openingRadical=function(a){return sre.NemethUtil.nestedRadical(a,sre.Messages.MS.STARTROOT)},sre.NemethUtil.closingRadical=function(a){return sre.NemethUtil.nestedRadical(a,sre.Messages.MS.ENDROOT)},sre.NemethUtil.indexRadical=function(a){return sre.NemethUtil.nestedRadical(a,sre.Messages.MS.ROOTINDEX)},sre.NemethUtil.enlargeFence=function(a){var b;return 1===a.length?"⠠"+a:(b=a.split("")).every(function(c){return"⠳"===c})?"⠠"+b.join("⠠"):a.slice(0,1)+"⠠"+a.slice(1)},sre.Grammar.getInstance().setCorrection("enlargeFence",sre.NemethUtil.enlargeFence),sre.NemethUtil.NUMBER_PROPAGATORS_=[sre.SemanticAttr.Type.MULTIREL,sre.SemanticAttr.Type.RELSEQ,sre.SemanticAttr.Type.APPL,sre.SemanticAttr.Type.ROW,sre.SemanticAttr.Type.LINE],sre.NemethUtil.NUMBER_INHIBITORS_=[sre.SemanticAttr.Type.SUBSCRIPT,sre.SemanticAttr.Type.SUPERSCRIPT,sre.SemanticAttr.Type.OVERSCORE,sre.SemanticAttr.Type.UNDERSCORE],sre.NemethUtil.checkParent_=function(a,b){var c;return!!(a=a.parent)&&(c=a.type,-1!==sre.NemethUtil.NUMBER_PROPAGATORS_.indexOf(c)||c===sre.SemanticAttr.Type.PREFIXOP&&a.role===sre.SemanticAttr.Role.NEGATIVE&&!b.script||c===sre.SemanticAttr.Type.PREFIXOP&&a.role===sre.SemanticAttr.Role.GEOMETRY||c===sre.SemanticAttr.Type.PUNCTUATED&&(!b.enclosed||a.role===sre.SemanticAttr.Role.TEXT))},sre.NemethUtil.propagateNumber=function(a,b){return a.childNodes.length?(-1!==sre.NemethUtil.NUMBER_INHIBITORS_.indexOf(a.type)&&(b.script=!0),a.type===sre.SemanticAttr.Type.FENCED?(b.number=!1,b.enclosed=!0):sre.NemethUtil.checkParent_(a,b)&&(b.number=!0,b.enclosed=!1),["",b]):(sre.NemethUtil.checkParent_(a,b)&&(b.number=!0,b.script=!1,b.enclosed=!1),[b.number?"number":"",{number:!1,enclosed:b.enclosed,script:b.script}])},sre.SemanticAnnotations.getInstance().register(new sre.SemanticVisitor("nemeth","number",sre.NemethUtil.propagateNumber,{number:!0})),sre.NemethUtil.componentString_={2:"CSFbaseline",1:"CSFsubscript",0:"CSFsuperscript"},sre.NemethUtil.childNumber_={4:2,3:3,2:1,1:4,0:5},sre.NemethUtil.generateTensorRuleStrings_=function(a){var b=[],c="";a=parseInt(a,2);for(var d=0;d<5;d++){var e="children/*["+sre.NemethUtil.childNumber_[d]+"]";1&a?c="[t] "+sre.NemethUtil.componentString_[d%3]+"Verbose; [n] "+e+";"+c:b.unshift("name("+e+')="empty"'),a>>=1}return b.push(c),b},sre.NemethUtil.generateTensorRules=function(a){var b=goog.bind(a.defineRule,a);a=goog.bind(a.defineRulesAlias,a);for(var c="11111 11110 11101 11100 10111 10110 10101 10100 01111 01110 01101 01100".split(" "),d=0;e=c[d];d++){var e,f="tensor"+e,g=(e=sre.NemethUtil.generateTensorRuleStrings_(e)).pop(),h=[f,"default",g,"self::tensor"].concat(e);b.apply(null,h),h=[f+="-baseline","default",g+="; [t]"+sre.NemethUtil.componentString_[2]+"Verbose","self::tensor","following-sibling::*"].concat(e),b.apply(null,h),f=[f,"self::tensor","not(following-sibling::*)","ancestor::fraction|ancestor::punctuated|ancestor::fenced|ancestor::root|ancestor::sqrt|ancestor::relseq|ancestor::multirel|@embellished"].concat(e),a.apply(null,f)}},sre.NemethUtil.relationIterator=function(a,b){var c=a.slice(0),d=!0,e=0<a.length?sre.XpathUtil.evalXPath("../../content/*",a[0]):[];return function(){var l,f=e.shift(),g=c.shift(),h=c[0],k=b?[sre.AuditoryDescription.create({text:b},{translate:!0})]:[];return f?(l=g?sre.MathspeakUtil.nestedSubSuper(g,"",{sup:sre.Messages.MS.SUPER,sub:sre.Messages.MS.SUB}):"",g=g&&"EMPTY"!==sre.DomUtil.tagName(g)||d&&f.parentNode.parentNode&&f.parentNode.parentNode.previousSibling?[sre.AuditoryDescription.create({text:"⠀"+l},{})]:[],h=h&&"EMPTY"!==sre.DomUtil.tagName(h)||!e.length&&f.parentNode.parentNode&&f.parentNode.parentNode.nextSibling?[sre.AuditoryDescription.create({text:"⠀"},{})]:[],f=sre.SpeechRuleEngine.getInstance().evaluateNode(f),d=!1,k.concat(g,f,h)):k}},sre.NemethUtil.implicitIterator=function(a,b){var c=a.slice(0),d=0<a.length?sre.XpathUtil.evalXPath("../../content/*",a[0]):[];return function(){var e=c.shift(),f=c[0],g=d.shift(),h=b?[sre.AuditoryDescription.create({text:b},{translate:!0})]:[];return g?(e=e&&"NUMBER"===sre.DomUtil.tagName(e),f=f&&"NUMBER"===sre.DomUtil.tagName(f),h.concat(e&&f&&g.getAttribute("role")===sre.SemanticAttr.Role.SPACE?[sre.AuditoryDescription.create({text:"⠀"},{})]:[])):h}},sre.StoreUtil={},sre.StoreUtil.nodeCounter=function(a,b){var c=a.length,d=0,e=b?b:"";return function(){return d<c&&(d+=1),e+" "+d}},sre.StoreUtil.pauseSeparator=function(a,b){a=parseFloat(b);var c=isNaN(a)?b:a;return function(){return[sre.AuditoryDescription.create({text:"",personality:{pause:c}})]}},sre.StoreUtil.contentIterator=function(a,b){var c=0<a.length?sre.XpathUtil.evalXPath("../../content/*",a[0]):[];return function(){var d=c.shift(),e=b?[sre.AuditoryDescription.create({text:b},{translate:!0})]:[];return d?(d=sre.SpeechRuleEngine.getInstance().evaluateNode(d),e.concat(d)):e}},sre.PrefixRules=function(){sre.SpeechRules.getInstance().addStore("en.prefix.default","",{CSFordinalPosition:sre.NumbersUtil.ordinalPosition})},sre.OtherRules=function(){sre.SpeechRules.getInstance().addStore("en.speech.chromevox","",{CTFnodeCounter:sre.StoreUtil.nodeCounter,CTFcontentIterator:sre.StoreUtil.contentIterator}),sre.SpeechRules.getInstance().addStore("en.speech.emacspeak","en.speech.chromevox",{CQFvulgarFractionSmall:sre.MathspeakUtil.isSmallVulgarFraction,CSFvulgarFraction:sre.NumbersUtil.vulgarFraction})},sre.BrailleRules=function(){sre.SpeechRules.getInstance().addStore("nemeth.braille.default","en.speech.mathspeak",{CSFopenFraction:sre.NemethUtil.openingFraction,CSFcloseFraction:sre.NemethUtil.closingFraction,CSFoverFraction:sre.NemethUtil.overFraction,CSFoverBevFraction:sre.NemethUtil.overBevelledFraction,CSFopenRadical:sre.NemethUtil.openingRadical,CSFcloseRadical:sre.NemethUtil.closingRadical,CSFindexRadical:sre.NemethUtil.indexRadical,CSFsubscript:sre.MathspeakUtil.subscriptVerbose,CSFsuperscript:sre.MathspeakUtil.superscriptVerbose,CSFbaseline:sre.MathspeakUtil.baselineVerbose,CGFtensorRules:sre.NemethUtil.generateTensorRules,CTFrelationIterator:sre.NemethUtil.relationIterator,CTFimplicitIterator:sre.NemethUtil.implicitIterator})},sre.ClearspeakUtil={},sre.ClearspeakUtil.numbersToAlpha=function(a){return a.match(/\d+/)?sre.Messages.NUMBERS.numberToWords(parseInt(a,10)):a},sre.Grammar.getInstance().setPreprocessor("numbers2alpha",sre.ClearspeakUtil.numbersToAlpha),sre.ClearspeakUtil.nodeCounter=function(a,b){b=b.split("-");var c=sre.StoreUtil.nodeCounter(a,b[0]||""),d=b[1]||"",e=b[2]||"",f=!0;return function(){var g=c();return f?(f=!1,e+g+d):g+d}},sre.ClearspeakUtil.isSimpleExpression=function(a){return sre.ClearspeakUtil.isSimpleNumber_(a)||sre.ClearspeakUtil.isSimpleLetters_(a)||sre.ClearspeakUtil.isSimpleDegree_(a)||sre.ClearspeakUtil.isSimpleNegative_(a)||sre.ClearspeakUtil.isSimpleFunction_(a)},sre.ClearspeakUtil.isSimpleFunction_=function(a){return a.type===sre.SemanticAttr.Type.APPL&&(a.childNodes[0].role===sre.SemanticAttr.Role.PREFIXFUNC||a.childNodes[0].role===sre.SemanticAttr.Role.SIMPLEFUNC)&&(sre.ClearspeakUtil.isSimple_(a.childNodes[1])||a.childNodes[1].type===sre.SemanticAttr.Type.FENCED&&sre.ClearspeakUtil.isSimple_(a.childNodes[1].childNodes[0]))},sre.ClearspeakUtil.isSimpleNegative_=function(a){return a.type===sre.SemanticAttr.Type.PREFIXOP&&a.role===sre.SemanticAttr.Role.NEGATIVE&&sre.ClearspeakUtil.isSimple_(a.childNodes[0])&&a.childNodes[0].type!==sre.SemanticAttr.Type.PREFIXOP&&a.childNodes[0].type!==sre.SemanticAttr.Type.APPL&&a.childNodes[0].type!==sre.SemanticAttr.Type.PUNCTUATED},sre.ClearspeakUtil.isSimpleDegree_=function(a){return a.type===sre.SemanticAttr.Type.PUNCTUATED&&a.role===sre.SemanticAttr.Role.ENDPUNCT&&2===a.childNodes.length&&a.childNodes[1].role===sre.SemanticAttr.Role.DEGREE&&(sre.ClearspeakUtil.isLetter_(a.childNodes[0])||sre.ClearspeakUtil.isNumber_(a.childNodes[0])||a.childNodes[0].type===sre.SemanticAttr.Type.PREFIXOP&&a.childNodes[0].role===sre.SemanticAttr.Role.NEGATIVE&&(sre.ClearspeakUtil.isLetter_(a.childNodes[0].childNodes[0])||sre.ClearspeakUtil.isNumber_(a.childNodes[0].childNodes[0])))},sre.ClearspeakUtil.isSimpleLetters_=function(a){return sre.ClearspeakUtil.isLetter_(a)||a.type===sre.SemanticAttr.Type.INFIXOP&&a.role===sre.SemanticAttr.Role.IMPLICIT&&(2===a.childNodes.length&&(sre.ClearspeakUtil.isLetter_(a.childNodes[0])||sre.ClearspeakUtil.isSimpleNumber_(a.childNodes[0]))&&sre.ClearspeakUtil.isLetter_(a.childNodes[1])||3===a.childNodes.length&&sre.ClearspeakUtil.isSimpleNumber_(a.childNodes[0])&&sre.ClearspeakUtil.isLetter_(a.childNodes[1])&&sre.ClearspeakUtil.isLetter_(a.childNodes[2]))},sre.ClearspeakUtil.isSimple_=function(a){return a.hasAnnotation("clearspeak","simple")},sre.ClearspeakUtil.isLetter_=function(a){return a.type===sre.SemanticAttr.Type.IDENTIFIER&&(a.role===sre.SemanticAttr.Role.LATINLETTER||a.role===sre.SemanticAttr.Role.GREEKLETTER||a.role===sre.SemanticAttr.Role.OTHERLETTER||a.role===sre.SemanticAttr.Role.SIMPLEFUNC)},sre.ClearspeakUtil.isNumber_=function(a){return a.type===sre.SemanticAttr.Type.NUMBER&&(a.role===sre.SemanticAttr.Role.INTEGER||a.role===sre.SemanticAttr.Role.FLOAT)},sre.ClearspeakUtil.isSimpleNumber_=function(a){return sre.ClearspeakUtil.isNumber_(a)||sre.ClearspeakUtil.isSimpleFraction_(a)},sre.ClearspeakUtil.isSimpleFraction_=function(a){var b;return!sre.ClearspeakUtil.hasPreference("Fraction_Over")&&!sre.ClearspeakUtil.hasPreference("Fraction_FracOver")&&a.type===sre.SemanticAttr.Type.FRACTION&&a.role===sre.SemanticAttr.Role.VULGAR&&(!!sre.ClearspeakUtil.hasPreference("Fraction_Ordinal")||(b=parseInt(a.childNodes[0].textContent,10),a=parseInt(a.childNodes[1].textContent,10),0<b&&b<20&&0<a&&a<11))},sre.ClearspeakUtil.hasPreference=function(a){return sre.Engine.getInstance().style===a},sre.SemanticAnnotations.getInstance().register(new sre.SemanticAnnotator("clearspeak","simple",function(a){return sre.ClearspeakUtil.isSimpleExpression(a)?"simple":""})),sre.ClearspeakUtil.simpleNode=function(a){return!!a.hasAttribute("annotation")&&(a=a.getAttribute("annotation"),!!/clearspeak:simple$|clearspeak:simple;/.exec(a))},sre.ClearspeakUtil.simpleCell_=function(a){var b;return!!sre.ClearspeakUtil.simpleNode(a)||a.tagName===sre.SemanticAttr.Type.SUBSCRIPT&&(b=(a=a.childNodes[0].childNodes)[1],a[0].tagName===sre.SemanticAttr.Type.IDENTIFIER)&&(sre.ClearspeakUtil.isInteger_(b)||b.tagName===sre.SemanticAttr.Type.INFIXOP&&b.hasAttribute("role")&&b.getAttribute("role")===sre.SemanticAttr.Role.IMPLICIT&&sre.ClearspeakUtil.allIndices_(b))},sre.ClearspeakUtil.isInteger_=function(a){return a.tagName===sre.SemanticAttr.Type.NUMBER&&a.hasAttribute("role")&&a.getAttribute("role")===sre.SemanticAttr.Role.INTEGER},sre.ClearspeakUtil.allIndices_=function(a){return sre.XpathUtil.evalXPath("children/*",a).every(function(b){return sre.ClearspeakUtil.isInteger_(b)||b.tagName===sre.SemanticAttr.Type.IDENTIFIER})},sre.ClearspeakUtil.allCellsSimple=function(a){return sre.XpathUtil.evalXPath(a.tagName===sre.SemanticAttr.Type.MATRIX?"children/row/children/cell/children/*":"children/line/children/*",a).every(sre.ClearspeakUtil.simpleCell_)?[a]:[]},sre.ClearspeakUtil.isSmallVulgarFraction=function(a){return sre.NumbersUtil.vulgarFractionSmall(a,20,11)?[a]:[]},sre.ClearspeakUtil.isUnitExpression=function(a){return a.type===sre.SemanticAttr.Type.TEXT||a.type===sre.SemanticAttr.Type.PUNCTUATED&&a.role===sre.SemanticAttr.Role.TEXT&&sre.ClearspeakUtil.isNumber_(a.childNodes[0])&&sre.ClearspeakUtil.allTextLastContent_(a.childNodes.slice(1))||a.type===sre.SemanticAttr.Type.IDENTIFIER&&a.role===sre.SemanticAttr.Role.UNIT||a.type===sre.SemanticAttr.Type.INFIXOP&&(a.role===sre.SemanticAttr.Role.IMPLICIT||a.role===sre.SemanticAttr.Role.UNIT)},sre.ClearspeakUtil.allTextLastContent_=function(a){for(var b=0;b<a.length-1;b++)if(a[b].type!==sre.SemanticAttr.Type.TEXT||""!==a[b].textContent)return!1;return a[a.length-1].type===sre.SemanticAttr.Type.TEXT},sre.SemanticAnnotations.getInstance().register(new sre.SemanticAnnotator("clearspeak","unit",function(a){return sre.ClearspeakUtil.isUnitExpression(a)?"unit":""})),sre.ClearspeakUtil.ordinalExponent=function(a){var b=parseInt(a.textContent,10);return isNaN(b)?a.textContent:10<b?sre.Messages.NUMBERS.simpleOrdinal(b):sre.Messages.NUMBERS.wordOrdinal(b)},sre.ClearspeakUtil.isCapitalLetter=function(a){return"Lu"===sre.MathCompoundStore.getInstance().lookupCategory(a.textContent)?[a]:[]},sre.ClearspeakUtil.NESTING_DEPTH=null,sre.ClearspeakUtil.nestingDepth=function(a){var b=0,c=a.textContent,d="open"===a.getAttribute("role")?0:1;for(a=a.parentNode;a;)a.tagName===sre.SemanticAttr.Type.FENCED&&a.childNodes[0].childNodes[d].textContent===c&&b++,a=a.parentNode;return sre.ClearspeakUtil.NESTING_DEPTH=1<b?sre.Messages.NUMBERS.wordOrdinal(b):"",sre.ClearspeakUtil.NESTING_DEPTH},sre.ClearspeakUtil.matchingFences=function(a){var b=a.previousSibling,c=b?a:(b=a).nextSibling;return c&&sre.SemanticAttr.isMatchingFence(b.textContent,c.textContent)?[a]:[]},sre.ClearspeakUtil.insertNesting=function(a,b){var c;return b&&a?(c=a.match(/^(open|close) /))?c[0]+b+" "+a.substring(c[0].length):b+" "+a:a},sre.Grammar.getInstance().setCorrection("insertNesting",sre.ClearspeakUtil.insertNesting),sre.ClearspeakUtil.fencedArguments=function(a){var b=sre.DomUtil.toArray(a.parentNode.childNodes),c=sre.XpathUtil.evalXPath("../../children/*",a),b=b.indexOf(a);return sre.ClearspeakUtil.fencedFactor_(c[b])||sre.ClearspeakUtil.fencedFactor_(c[b+1])?[a]:[]},sre.ClearspeakUtil.simpleArguments=function(a){var b=sre.DomUtil.toArray(a.parentNode.childNodes),c=sre.XpathUtil.evalXPath("../../children/*",a),b=b.indexOf(a);return sre.ClearspeakUtil.simpleFactor_(c[b])&&c[b+1]&&(sre.ClearspeakUtil.simpleFactor_(c[b+1])||c[b+1].tagName===sre.SemanticAttr.Type.ROOT||c[b+1].tagName===sre.SemanticAttr.Type.SQRT||c[b+1].tagName===sre.SemanticAttr.Type.SUPERSCRIPT&&c[b+1].childNodes[0].childNodes[0]&&(c[b+1].childNodes[0].childNodes[0].tagName===sre.SemanticAttr.Type.NUMBER||c[b+1].childNodes[0].childNodes[0].tagName===sre.SemanticAttr.Type.IDENTIFIER)&&("2"===c[b+1].childNodes[0].childNodes[1].textContent||"3"===c[b+1].childNodes[0].childNodes[1].textContent))?[a]:[]},sre.ClearspeakUtil.simpleFactor_=function(a){return!!a&&(a.tagName===sre.SemanticAttr.Type.NUMBER||a.tagName===sre.SemanticAttr.Type.IDENTIFIER||a.tagName===sre.SemanticAttr.Type.FUNCTION||a.tagName===sre.SemanticAttr.Type.APPL||a.tagName===sre.SemanticAttr.Type.FRACTION)},sre.ClearspeakUtil.fencedFactor_=function(a){return a&&(a.tagName===sre.SemanticAttr.Type.FENCED||a.hasAttribute("role")&&a.getAttribute("role")===sre.SemanticAttr.Role.LEFTRIGHT||sre.ClearspeakUtil.layoutFactor_(a))},sre.ClearspeakUtil.layoutFactor_=function(a){return!!a&&(a.tagName===sre.SemanticAttr.Type.MATRIX||a.tagName===sre.SemanticAttr.Type.VECTOR)},sre.ClearspeakUtil.isHyperbolic=function(a){if(a.tagName===sre.SemanticAttr.Type.APPL){var b=sre.XpathUtil.evalXPath("children/*[1]",a)[0];if(b&&b.tagName===sre.SemanticAttr.Type.FUNCTION&&"Hyperbolic"===sre.MathCompoundStore.getInstance().lookupCategory(b.textContent))return[a]}return[]},sre.ClearspeakUtil.isLogarithmWithBase=function(a){if(a.tagName===sre.SemanticAttr.Type.SUBSCRIPT){var b=sre.XpathUtil.evalXPath("children/*[1]",a)[0];if(b&&b.tagName===sre.SemanticAttr.Type.FUNCTION&&"Logarithm"===sre.MathCompoundStore.getInstance().lookupCategory(b.textContent))return[a]}return[]},sre.ClearspeakUtil.wordOrdinal=function(a){return sre.Messages.NUMBERS.wordOrdinal(parseInt(a.textContent,10))},sre.ClearspeakUtil.firstCurrency=function(a){var b=sre.XpathUtil.evalXPath("children/*[1]",a)[0];return b&&"currency"===sre.MathCompoundStore.getInstance().lookupCategory(b.textContent+":unit")?[a]:[]},sre.ClearspeakUtil.lastCurrency=function(a){var b=sre.XpathUtil.evalXPath("children/*[last()]",a)[0];return b&&"currency"===sre.MathCompoundStore.getInstance().lookupCategory(b.textContent+":unit")?[a]:[]},sre.ClearspeakUtil.isLengthUnit=function(a){var b=sre.XpathUtil.evalXPath("children/*[1]",a)[0];return b&&"length"===sre.MathCompoundStore.getInstance().lookupCategory(b.textContent.trim()+":unit")?[a]:[]},sre.SpeechRules=function(){this.store={}},goog.addSingletonGetter(sre.SpeechRules),sre.SpeechRules.prototype.addStore=function(a,b,c){var d={};b&&Object.assign(d,this.store[b]||{}),this.store[a]=Object.assign(d,c)},sre.SpeechRules.prototype.getStore=function(a,b,c){return this.store[[a,b,c].join(".")]||this.store[[sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE],b,c].join(".")]||{}},sre.ClearspeakRules=function(){sre.SpeechRules.getInstance().addStore("en.speech.clearspeak","",{CTFpauseSeparator:sre.StoreUtil.pauseSeparator,CTFnodeCounter:sre.ClearspeakUtil.nodeCounter,CTFcontentIterator:sre.StoreUtil.contentIterator,CSFvulgarFraction:sre.NumbersUtil.vulgarFraction,CQFvulgarFractionSmall:sre.ClearspeakUtil.isSmallVulgarFraction,CQFcellsSimple:sre.ClearspeakUtil.allCellsSimple,CSFordinalExponent:sre.ClearspeakUtil.ordinalExponent,CSFwordOrdinal:sre.ClearspeakUtil.wordOrdinal,CQFisCapital:sre.ClearspeakUtil.isCapitalLetter,CQFmatchingFences:sre.ClearspeakUtil.matchingFences,CSFnestingDepth:sre.ClearspeakUtil.nestingDepth,CQFfencedArguments:sre.ClearspeakUtil.fencedArguments,CQFsimpleArguments:sre.ClearspeakUtil.simpleArguments,CQFisHyperbolic:sre.ClearspeakUtil.isHyperbolic,CQFisLogarithm:sre.ClearspeakUtil.isLogarithmWithBase,CQFspaceoutNumber:sre.MathspeakUtil.spaceoutNumber,CQFisLengthUnit:sre.ClearspeakUtil.isLengthUnit,CQFfirstCurrency:sre.ClearspeakUtil.firstCurrency,CQFlastCurrency:sre.ClearspeakUtil.lastCurrency}),sre.SpeechRules.getInstance().addStore("fr.speech.clearspeak","en.speech.clearspeak",{}),sre.SpeechRules.getInstance().addStore("de.speech.clearspeak","en.speech.clearspeak",{})},sre.MathspeakFrenchUtil={},sre.MathspeakFrenchUtil.smallRoot=function(a){var b;return a.childNodes&&0!==a.childNodes.length&&a.childNodes[0].childNodes&&(b=a.childNodes[0].childNodes[0].textContent,/^\d+$/.test(b))&&1<(b=parseInt(b,10))&&b<=3?[a]:[]},sre.MathspeakFrenchUtil.baselineVerbose=function(a){return sre.MathspeakUtil.baselineVerbose(a).replace(/\-$/,"")},sre.MathspeakFrenchUtil.baselineBrief=function(a){return sre.MathspeakUtil.baselineBrief(a).replace(/\-$/,"")},sre.MathspeakFrenchUtil.leftSuperscriptVerbose=function(a){return sre.MathspeakUtil.superscriptVerbose(a).replace(/^exposant/,"exposant gauche")},sre.MathspeakFrenchUtil.leftSubscriptVerbose=function(a){return sre.MathspeakUtil.subscriptVerbose(a).replace(/^indice/,"indice gauche")},sre.MathspeakFrenchUtil.leftSuperscriptBrief=function(a){return sre.MathspeakUtil.superscriptBrief(a).replace(/^sup/,"sup gauche")},sre.MathspeakFrenchUtil.leftSubscriptBrief=function(a){return sre.MathspeakUtil.subscriptBrief(a).replace(/^sub/,"sub gauche")},sre.MathspeakSpanishUtil={},sre.MathspeakSpanishUtil.ordinalCounter=function(a,b){var c=0;return function(){return sre.Messages.NUMBERS.numberToOrdinal(++c,!1)+" "+b}},sre.MathspeakSpanishUtil.smallRoot=function(a){var b;return a.childNodes&&0!==a.childNodes.length&&a.childNodes[0].childNodes&&(b=a.childNodes[0].childNodes[0].textContent,/^\d+$/.test(b))&&1<(b=parseInt(b,10))&&b<=10?[a]:[]},sre.UnitUtil={},sre.UnitUtil.unitMultipliers=function(a,b){var c=0;return function(){var d=sre.AuditoryDescription.create({text:sre.UnitUtil.rightMostUnit(a[c])&&sre.UnitUtil.leftMostUnit(a[c+1])?sre.Messages.UNIT_TIMES:""},{});return c++,[d]}},sre.UnitUtil.SCRIPT_ELEMENTS=[sre.SemanticAttr.Type.SUPERSCRIPT,sre.SemanticAttr.Type.SUBSCRIPT,sre.SemanticAttr.Type.OVERSCORE,sre.SemanticAttr.Type.UNDERSCORE],sre.UnitUtil.rightMostUnit=function(a){for(;a;){if("unit"===a.getAttribute("role"))return!0;var b=a.tagName;a=sre.XpathUtil.evalXPath("children/*",a),a=-1!==sre.UnitUtil.SCRIPT_ELEMENTS.indexOf(b)?a[0]:a[a.length-1]}return!1},sre.UnitUtil.leftMostUnit=function(a){for(;a;){if("unit"===a.getAttribute("role"))return!0;a=sre.XpathUtil.evalXPath("children/*",a)[0]}return!1},sre.UnitUtil.oneLeft=function(a){for(;a;){if("number"===a.tagName&&"1"===a.textContent)return[a];if("infixop"!==a.tagName||"multiplication"!==a.getAttribute("role")&&"implicit"!==a.getAttribute("role"))break;a=sre.XpathUtil.evalXPath("children/*",a)[0]}return[]},sre.MathspeakRules=function(){sre.SpeechRules.getInstance().addStore("en.speech.mathspeak","",{CQFspaceoutNumber:sre.MathspeakUtil.spaceoutNumber,CQFspaceoutIdentifier:sre.MathspeakUtil.spaceoutIdentifier,CSFspaceoutText:sre.MathspeakUtil.spaceoutText,CSFopenFracVerbose:sre.MathspeakUtil.openingFractionVerbose,CSFcloseFracVerbose:sre.MathspeakUtil.closingFractionVerbose,CSFoverFracVerbose:sre.MathspeakUtil.overFractionVerbose,CSFopenFracBrief:sre.MathspeakUtil.openingFractionBrief,CSFcloseFracBrief:sre.MathspeakUtil.closingFractionBrief,CSFopenFracSbrief:sre.MathspeakUtil.openingFractionSbrief,CSFcloseFracSbrief:sre.MathspeakUtil.closingFractionSbrief,CSFoverFracSbrief:sre.MathspeakUtil.overFractionSbrief,CSFvulgarFraction:sre.NumbersUtil.vulgarFraction,CQFvulgarFractionSmall:sre.MathspeakUtil.isSmallVulgarFraction,CSFopenRadicalVerbose:sre.MathspeakUtil.openingRadicalVerbose,CSFcloseRadicalVerbose:sre.MathspeakUtil.closingRadicalVerbose,CSFindexRadicalVerbose:sre.MathspeakUtil.indexRadicalVerbose,CSFopenRadicalBrief:sre.MathspeakUtil.openingRadicalBrief,CSFcloseRadicalBrief:sre.MathspeakUtil.closingRadicalBrief,CSFindexRadicalBrief:sre.MathspeakUtil.indexRadicalBrief,CSFopenRadicalSbrief:sre.MathspeakUtil.openingRadicalSbrief,CSFindexRadicalSbrief:sre.MathspeakUtil.indexRadicalSbrief,CSFsuperscriptVerbose:sre.MathspeakUtil.superscriptVerbose,CSFsuperscriptBrief:sre.MathspeakUtil.superscriptBrief,CSFsubscriptVerbose:sre.MathspeakUtil.subscriptVerbose,CSFsubscriptBrief:sre.MathspeakUtil.subscriptBrief,CSFbaselineVerbose:sre.MathspeakUtil.baselineVerbose,CSFbaselineBrief:sre.MathspeakUtil.baselineBrief,CSFleftsuperscriptVerbose:sre.MathspeakUtil.superscriptVerbose,CSFleftsubscriptVerbose:sre.MathspeakUtil.subscriptVerbose,CSFrightsuperscriptVerbose:sre.MathspeakUtil.superscriptVerbose,CSFrightsubscriptVerbose:sre.MathspeakUtil.subscriptVerbose,CSFleftsuperscriptBrief:sre.MathspeakUtil.superscriptBrief,CSFleftsubscriptBrief:sre.MathspeakUtil.subscriptBrief,CSFrightsuperscriptBrief:sre.MathspeakUtil.superscriptBrief,CSFrightsubscriptBrief:sre.MathspeakUtil.subscriptBrief,CSFunderscript:sre.MathspeakUtil.nestedUnderscore,CSFoverscript:sre.MathspeakUtil.nestedOverscore,CTFordinalCounter:sre.NumbersUtil.ordinalCounter,CTFcontentIterator:sre.StoreUtil.contentIterator,CQFdetIsSimple:sre.MathspeakUtil.determinantIsSimple,CSFRemoveParens:sre.MathspeakUtil.removeParens,CQFresetNesting:sre.MathspeakUtil.resetNestingDepth,CGFbaselineConstraint:sre.MathspeakUtil.generateBaselineConstraint,CGFtensorRules:sre.MathspeakUtil.generateTensorRules}),sre.SpeechRules.getInstance().addStore("es.speech.mathspeak","en.speech.mathspeak",{CQFisSmallRoot:sre.MathspeakSpanishUtil.smallRoot,CTFordinalCounter:sre.MathspeakSpanishUtil.ordinalCounter,CTFunitMultipliers:sre.UnitUtil.unitMultipliers,CQFoneLeft:sre.UnitUtil.oneLeft}),sre.SpeechRules.getInstance().addStore("fr.speech.mathspeak","en.speech.mathspeak",{CQFisSmallRoot:sre.MathspeakFrenchUtil.smallRoot,CSFbaselineVerbose:sre.MathspeakFrenchUtil.baselineVerbose,CSFbaselineBrief:sre.MathspeakFrenchUtil.baselineBrief,CSFleftsuperscriptVerbose:sre.MathspeakFrenchUtil.leftSuperscriptVerbose,CSFleftsubscriptVerbose:sre.MathspeakFrenchUtil.leftSubscriptVerbose,CSFleftsuperscriptBrief:sre.MathspeakFrenchUtil.leftSuperscriptBrief,CSFleftsubscriptBrief:sre.MathspeakFrenchUtil.leftSubscriptBrief,CQFisLogarithm:sre.ClearspeakUtil.isLogarithmWithBase})},sre.SpeechRuleStores={},sre.SpeechRuleStores.INIT_=!1,sre.SpeechRuleStores.init=function(){sre.SpeechRuleStores.INIT_||(sre.MathspeakRules(),sre.ClearspeakRules(),sre.PrefixRules(),sre.OtherRules(),sre.BrailleRules(),sre.SpeechRuleStores.INIT_=!0)},sre.SpeechRuleEngine=function(){this.activeStore_=new sre.MathStore,this.ready_=!0,this.evaluators_={},this.prune=!0,sre.Engine.registerTest(goog.bind(function(a){return this.ready_},this))},goog.addSingletonGetter(sre.SpeechRuleEngine),sre.SpeechRuleEngine.prototype.storeFactory_=function(a){return new({braille:sre.BrailleStore,speech:sre.MathStore}[a]||sre.MathStore)},sre.SpeechRuleEngine.updateEvaluator=function(a){for(;a&&!a.evaluate;)a=a.parentNode;a.evaluate&&(sre.XpathUtil.currentDocument=a)},sre.SpeechRuleEngine.prototype.evaluateNode=function(a){sre.Engine.getInstance().mode===sre.Engine.Mode.HTTP&&sre.SpeechRuleEngine.updateEvaluator(a);var b=(new Date).getTime(),c=(a=this.evaluateNode_(a),(new Date).getTime());return sre.Debugger.getInstance().output("Time:",c-b),a},sre.SpeechRuleEngine.prototype.evaluateNode_=function(a){return a?(this.updateConstraint_(),this.evaluateTree_(a)):[]},sre.SpeechRuleEngine.prototype.evaluateTree_=function(a){var b=sre.Engine.getInstance(),c=(sre.Debugger.getInstance().output(b.mode!==sre.Engine.Mode.HTTP?a.toString():a),sre.Grammar.getInstance().setAttribute(a),this.activeStore_.lookupRule(a,b.dynamicCstr));if(!c)return b.strict?[]:(d=this.getEvaluator(b.locale,b.modality)(a),a.attributes&&this.addPersonality_(d,{},!1,a),d);sre.Debugger.getInstance().generateOutput(goog.bind(function(){return["Apply Rule:",c.name,c.dynamicCstr.toString(),b.mode!==sre.Engine.Mode.HTTP?a.toString():a]},this));for(var h,e=c.context||this.activeStore_.context,f=c.action.components,d=[],g=0;h=f[g];g++){var k=[],l=h.content||"",m=h.attributes||{},n=!1,p=(h.grammar&&this.processGrammar(e,a,h.grammar),null);switch(m.engine&&(p=sre.Engine.getInstance().dynamicCstr.getComponents(),r=sre.Grammar.parseInput(m.engine),sre.Engine.getInstance().setDynamicCstr(r)),h.type){case sre.SpeechRule.Type.NODE:(l=e.applyQuery(a,l))&&(k=this.evaluateTree_(l));break;case sre.SpeechRule.Type.MULTI:n=!0,0<(l=e.applySelector(a,l)).length&&(k=this.evaluateNodeList_(e,l,m.sepFunc,e.constructString(a,m.separator),m.ctxtFunc,e.constructString(a,m.context)));break;case sre.SpeechRule.Type.TEXT:var q=m.span,r={};q&&(q=sre.XpathUtil.evalXPath(q,a)).length&&(r.extid=q[0].getAttribute("extid")),(l=e.constructString(a,l))&&(k=Array.isArray(l)?l.map(function(t){return sre.AuditoryDescription.create({text:t.string,attributes:t.attributes},{adjust:!0})}):[sre.AuditoryDescription.create({text:l,attributes:r},{adjust:!0})]);break;default:k=[sre.AuditoryDescription.create({text:l})]}k[0]&&!n&&(m.context&&(k[0].context=e.constructString(a,m.context)+(k[0].context||"")),m.annotation)&&(k[0].annotation=m.annotation),h.grammar&&sre.Grammar.getInstance().popState(),d=d.concat(this.addPersonality_(k,m,n,a)),p&&sre.Engine.getInstance().setDynamicCstr(p)}return d},sre.SpeechRuleEngine.prototype.evaluateNodeList_=function(a,b,c,d,e,f){if(b==[])return[];var g=d||"",h=f||"";for(d=(d=a.contextFunctions.lookup(e))?d(b,h):function(){return h},a=(a=a.contextFunctions.lookup(c))?a(b,g):function(){return sre.AuditoryDescription.create({text:g},{translate:!0})},c=[],e=0;f=b[e];e++)0<(f=this.evaluateTree_(f)).length&&(f[0].context=d()+(f[0].context||""),c=c.concat(f),e<b.length-1)&&(f=a(),c=c.concat(f));return c},sre.SpeechRuleEngine.prototype.addPersonality_=function(a,b,c,d){var g,e={},f=null;for(g in sre.Engine.personalityProps){var k,h=b[sre.Engine.personalityProps[g]];void 0!==h&&(k=parseFloat(h),h=isNaN(k)?'"'==h.charAt(0)?h.slice(1,-1):h:k,sre.Engine.personalityProps[g]===sre.Engine.personalityProps.PAUSE?f=h:e[sre.Engine.personalityProps[g]]=h)}for(b=0;g=a[b];b++)this.addRelativePersonality_(g,e),this.addExternalAttributes_(g,d);return c&&a.length&&delete a[a.length-1].personality[sre.Engine.personalityProps.JOIN],f&&a.length&&((c=a[a.length-1]).text||Object.keys(c.personality).length?a.push(sre.AuditoryDescription.create({text:"",personality:{pause:f}})):c.personality[sre.Engine.personalityProps.PAUSE]=f),a},sre.SpeechRuleEngine.prototype.addExternalAttributes_=function(a,b){if(b.hasAttributes())for(var c=(b=b.attributes).length-1;0<=c;c--){var d=b[c].name;!a.attributes[d]&&d.match(/^ext/)&&(a.attributes[d]=b[c].value)}},sre.SpeechRuleEngine.prototype.addRelativePersonality_=function(a,b){if(a.personality){var d,c=a.personality;for(d in b)c[d]=c[d]&&"number"==typeof c[d]&&"number"==typeof b[d]?c[d]+b[d]:b[d]}else a.personality=b;return a},sre.SpeechRuleEngine.prototype.toString=function(){return this.activeStore_.findAllRules(function(a){return!0}).map(function(a){return a.toString()}).join("\n")},sre.SpeechRuleEngine.debugSpeechRule=function(a,b){var c=sre.SpeechRuleEngine.getInstance().activeStore_;c&&c.debugSpeechRule(a,b)},sre.SpeechRuleEngine.debugNamedSpeechRule=function(a,b){var c=sre.SpeechRuleEngine.getInstance().activeStore_;if(c)for(var f,d=c.findAllRules(function(g){return g.name==a}),e=0;f=d[e];e++)sre.Debugger.getInstance().output("Rule",a,"DynamicCstr:",f.dynamicCstr.toString(),"number",e),c.debugSpeechRule(f,b)},sre.SpeechRuleEngine.prototype.runInSetting=function(a,b){var e,c=sre.Engine.getInstance(),d={};for(e in a)d[e]=c[e],c[e]=a[e];for(e in c.setDynamicCstr(),a=b(),d)c[e]=d[e];return c.setDynamicCstr(),a},sre.SpeechRuleEngine.prototype.addStore=function(a){sre.SpeechRuleStores.init(),a&&!a.functions&&(a.functions=sre.SpeechRules.getInstance().getStore(a.locale,a.modality,a.domain));var b=this.storeFactory_(a.modality);b.parse(a),b.initialize(),b.getSpeechRules().forEach(goog.bind(function(c){this.activeStore_.trie.addRule(c)},this)),this.addEvaluator(b),this.activeStore_.setSpeechRules(this.activeStore_.trie.collectRules())},sre.SpeechRuleEngine.prototype.updateEngine=function(){this.ready_=!0;var a=sre.MathMap.getInstance();sre.Engine.isReady()?(this.prune&&(this.prune=!1,this.adjustEngine()),sre.Engine.getInstance().evaluator=goog.bind(a.store.lookupString,a.store)):(this.ready_=!1,setTimeout(goog.bind(this.updateEngine,this),250))},sre.SpeechRuleEngine.prototype.adjustEngine=function(){var b,a=sre.Engine.getInstance();a.prune&&(b=a.prune.split("."),this.activeStore_.prune(b)),a.rules&&(b=sre.SystemExternal.jsonPath.replace("/lib/mathmaps","/src/mathmaps"),sre.MathMap.getInstance().retrieveFiles(b+a.rules,function(c){return sre.MathMap.getInstance().parseMaps('{"'+a.rules+'":'+c+"}")})),setTimeout(goog.bind(this.updateEngine,this),100)},sre.SpeechRuleEngine.prototype.processGrammar=function(a,b,c){var e,d={};for(e in c){var f=c[e];d[e]="string"==typeof f?a.constructString(b,f):f}sre.Grammar.getInstance().pushState(d)},sre.SpeechRuleEngine.prototype.updateConstraint_=function(){var h,k,a=sre.Engine.getInstance().dynamicCstr,b=sre.Engine.getInstance().strict,c=this.activeStore_.trie,d={},e=a.getValue(sre.DynamicCstr.Axis.LOCALE),f=a.getValue(sre.DynamicCstr.Axis.MODALITY),g=a.getValue(sre.DynamicCstr.Axis.DOMAIN);for(c.hasSubtrie([e,f,g])||(g=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.DOMAIN],c.hasSubtrie([e,f,g]))||(f=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.MODALITY],c.hasSubtrie([e,f,g]))||(e=sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.LOCALE]),d[sre.DynamicCstr.Axis.LOCALE]=[e],d[sre.DynamicCstr.Axis.MODALITY]=["summary"!==f?f:sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.MODALITY]],d[sre.DynamicCstr.Axis.DOMAIN]=["speech"!==f?sre.DynamicCstr.DEFAULT_VALUES[sre.DynamicCstr.Axis.DOMAIN]:g],c=a.getOrder(),e=0;f=c[e];e++)d[f]||(g=a.getValue(f),h=this.makeSet_(g,a.preference),k=sre.DynamicCstr.DEFAULT_VALUES[f],b||g===k||h.push(k),d[f]=h);a.updateProperties(d)},sre.SpeechRuleEngine.prototype.makeSet_=function(a,b){return b&&Object.keys(b).length?a.split(":"):[a]},sre.SpeechRuleEngine.prototype.addEvaluator=function(a){var b=goog.bind(a.evaluateDefault,a),c=this.evaluators_[a.locale];c?c[a.modality]=b:((c={})[a.modality]=b,this.evaluators_[a.locale]=c)},sre.SpeechRuleEngine.prototype.getEvaluator=function(a,b){return(b=(a=this.evaluators_[a])?a[b]:null)||goog.bind(this.activeStore_.evaluateDefault,this.activeStore_)},sre.SpeechRuleEngine.prototype.enumerate=function(a){return this.activeStore_.trie.enumerate(a)},sre.SpeechGeneratorUtil={},sre.SpeechGeneratorUtil.computeSpeech=function(a){return sre.SpeechRuleEngine.getInstance().evaluateNode(a)},sre.SpeechGeneratorUtil.recomputeSpeech=function(a){return a=sre.SemanticTree.fromNode(a),sre.SpeechGeneratorUtil.computeSpeech(a.xml())},sre.SpeechGeneratorUtil.computeMarkup=function(a){return a=sre.SpeechGeneratorUtil.computeSpeech(a),sre.AuralRendering.getInstance().markup(a)},sre.SpeechGeneratorUtil.recomputeMarkup=function(a){return a=sre.SpeechGeneratorUtil.recomputeSpeech(a),sre.AuralRendering.getInstance().markup(a)},sre.SpeechGeneratorUtil.addSpeech=function(a,b,c){b=(c=sre.DomUtil.querySelectorAllByAttrValue(c,"id",b.id.toString())[0])?sre.AuralRendering.getInstance().markup(sre.SpeechGeneratorUtil.computeSpeech(c)):sre.SpeechGeneratorUtil.recomputeMarkup(b),a.setAttribute(sre.EnrichMathml.Attribute.SPEECH,b)},sre.SpeechGeneratorUtil.addModality=function(a,b,c){b=sre.SpeechGeneratorUtil.recomputeMarkup(b),a.setAttribute(c,b)},sre.SpeechGeneratorUtil.addPrefix=function(a,b){(b=sre.SpeechGeneratorUtil.retrievePrefix(b))&&a.setAttribute(sre.EnrichMathml.Attribute.PREFIX,b)},sre.SpeechGeneratorUtil.retrievePrefix=function(a){return a=sre.SpeechGeneratorUtil.computePrefix_(a),sre.AuralRendering.getInstance().markup(a)},sre.SpeechGeneratorUtil.computePrefix_=function(a){var b=sre.SemanticTree.fromRoot(a),c=(b=sre.XpathUtil.evalXPath('.//*[@id="'+a.id+'"]',b.xml()))[0];return(c=1<b.length?sre.SpeechGeneratorUtil.nodeAtPosition_(a,b)||c:c)?sre.SpeechRuleEngine.getInstance().runInSetting({modality:"prefix",domain:"default",style:"default",strict:!0,speech:!0},function(){return sre.SpeechRuleEngine.getInstance().evaluateNode(c)}):[]},sre.SpeechGeneratorUtil.nodeAtPosition_=function(a,b){var c=b[0];if(a.parent){for(var e,d=[];a;)d.push(a.id),a=a.parent;for(a=0;e=b[a];a++){for(var f=e,g=d.slice();g.length&&g.shift().toString()===f.getAttribute("id")&&f.parentNode&&f.parentNode.parentNode;)f=f.parentNode.parentNode;if(!g.length)return e}}return c},sre.SpeechGeneratorUtil.connectMactions=function(a,b,c){b=sre.DomUtil.querySelectorAll(b,"maction");for(var d=0;e=b[d];d++){var g,e,h,f=e.getAttribute("id");(f=sre.DomUtil.querySelectorAllByAttrValue(a,"id",f)[0])&&(e=(g=e.childNodes[1]).getAttribute(sre.EnrichMathml.Attribute.ID),(h=sre.WalkerUtil.getBySemanticId(a,e))&&"dummy"!==h.getAttribute(sre.EnrichMathml.Attribute.TYPE)||(h=f.childNodes[0]).getAttribute("sre-highlighter-added")||((f=g.getAttribute(sre.EnrichMathml.Attribute.PARENT))&&h.setAttribute(sre.EnrichMathml.Attribute.PARENT,f),h.setAttribute(sre.EnrichMathml.Attribute.TYPE,"dummy"),h.setAttribute(sre.EnrichMathml.Attribute.ID,e),sre.DomUtil.querySelectorAllByAttrValue(c,"id",e)[0].setAttribute("alternative",e)))}},sre.SpeechGeneratorUtil.connectAllMactions=function(a,b){a=sre.DomUtil.querySelectorAll(a,"maction");for(var d,c=0;d=a[c];c++)d=d.childNodes[1].getAttribute(sre.EnrichMathml.Attribute.ID),sre.DomUtil.querySelectorAllByAttrValue(b,"id",d)[0].setAttribute("alternative",d)},sre.SpeechGeneratorUtil.retrieveSummary=function(a){return a=sre.SpeechGeneratorUtil.computeSummary_(a),sre.AuralRendering.getInstance().markup(a)},sre.SpeechGeneratorUtil.computeSummary_=function(a){return a?sre.SpeechRuleEngine.getInstance().runInSetting({modality:"summary",strict:!1,speech:!0},function(){return sre.SpeechRuleEngine.getInstance().evaluateNode(a)}):[]},sre.AbstractSpeechGenerator=function(){this.rebuilt_=null,this.options_={},this.modality=sre.EnrichMathml.addPrefix("speech")},sre.AbstractSpeechGenerator.prototype.getRebuilt=function(){return this.rebuilt_},sre.AbstractSpeechGenerator.prototype.setRebuilt=function(a){this.rebuilt_=a},sre.AbstractSpeechGenerator.prototype.setOptions=function(a){this.options_=a||{},this.modality=sre.EnrichMathml.addPrefix(this.options_.modality||"speech")},sre.AbstractSpeechGenerator.prototype.getOptions=function(){return this.options_},sre.AbstractSpeechGenerator.prototype.getSpeech=goog.abstractMethod,sre.AbstractSpeechGenerator.prototype.start=function(){},sre.AbstractSpeechGenerator.prototype.end=function(){},sre.AbstractSpeechGenerator.prototype.generateSpeech=function(a,b){return this.rebuilt_||(this.rebuilt_=new sre.RebuildStree(b)),sre.System.getInstance().setupEngine(this.options_),sre.SpeechGeneratorUtil.computeMarkup(this.getRebuilt().xml)},sre.AdhocSpeechGenerator=function(){sre.AbstractSpeechGenerator.call(this)},goog.inherits(sre.AdhocSpeechGenerator,sre.AbstractSpeechGenerator),sre.AdhocSpeechGenerator.prototype.getSpeech=function(a,b){return b=this.generateSpeech(a,b),a.setAttribute(this.modality,b),b},sre.ColorGenerator=function(){sre.AbstractSpeechGenerator.call(this),this.modality=sre.EnrichMathml.addPrefix("foreground"),this.contrast=new sre.ContrastPicker},goog.inherits(sre.ColorGenerator,sre.AbstractSpeechGenerator),sre.ColorGenerator.prototype.getSpeech=function(a,b){return sre.WalkerUtil.getAttribute(a,this.modality)},sre.ColorGenerator.prototype.generateSpeech=function(a,b){return this.getRebuilt()||this.setRebuilt(new sre.RebuildStree(a)),this.colorLeaves_(a),sre.WalkerUtil.getAttribute(a,this.modality)},sre.ColorGenerator.prototype.colorLeaves_=function(a){for(var b=this,c=[],d=(sre.ColorGenerator.visitStree_(this.getRebuilt().streeRoot,c,{}),{}),e=(c=$jscomp.makeIterator(c)).next();!e.done;d={$jscomp$loop$prop$color$12:d.$jscomp$loop$prop$color$12},e=c.next()){e=e.value,d.$jscomp$loop$prop$color$12=this.contrast.generate();(Array.isArray(e)?e.map(function(g){return function(h){return b.colorLeave_(a,h,g.$jscomp$loop$prop$color$12)}}(d)).reduce(function(g,h){return g||h},!1):this.colorLeave_(a,e,d.$jscomp$loop$prop$color$12))&&this.contrast.increment()}},sre.ColorGenerator.prototype.colorLeave_=function(a,b,c){return!!(a=sre.WalkerUtil.getBySemanticId(a,b))&&(a.setAttribute(this.modality,c),!0)},sre.ColorGenerator.visitStree_=function(a,b,c){if(a.childNodes.length){if(a.contentNodes.length&&("punctuated"===a.type&&a.contentNodes.forEach(function(h){return c[h.id]=!0}),"implicit"!==a.role)&&b.push(a.contentNodes.map(function(h){return h.id})),a.childNodes.length)if("implicit"===a.role){for(var d=[],e=[],f=(a=$jscomp.makeIterator(a.childNodes)).next();!f.done;f=a.next()){var g=[];sre.ColorGenerator.visitStree_(f.value,g,c),g.length<=2&&d.push(g.shift()),e=e.concat(g)}b.push(d),e.forEach(function(h){return b.push(h)})}else a.childNodes.forEach(function(h){return sre.ColorGenerator.visitStree_(h,b,c)})}else c[a.id]||b.push(a.id)},sre.DirectSpeechGenerator=function(){sre.AbstractSpeechGenerator.call(this)},goog.inherits(sre.DirectSpeechGenerator,sre.AbstractSpeechGenerator),sre.DirectSpeechGenerator.prototype.getSpeech=function(a,b){return sre.WalkerUtil.getAttribute(a,this.modality)},sre.DummySpeechGenerator=function(){sre.AbstractSpeechGenerator.call(this)},goog.inherits(sre.DummySpeechGenerator,sre.AbstractSpeechGenerator),sre.DummySpeechGenerator.prototype.getSpeech=function(a,b){return""},sre.TreeSpeechGenerator=function(){sre.AbstractSpeechGenerator.call(this)},goog.inherits(sre.TreeSpeechGenerator,sre.AbstractSpeechGenerator),sre.TreeSpeechGenerator.prototype.getSpeech=function(a,b){var e,c=this.generateSpeech(a,b),d=(a.setAttribute(this.modality,c),this.getRebuilt().nodeDict);for(e in d){var f=d[e],g=sre.WalkerUtil.getBySemanticId(b,e),h=sre.WalkerUtil.getBySemanticId(a,e);g&&h&&(this.modality&&this.modality!==sre.EnrichMathml.Attribute.SPEECH?sre.SpeechGeneratorUtil.addModality(h,f,this.modality):sre.SpeechGeneratorUtil.addSpeech(h,f,this.getRebuilt().xml),this.modality===sre.EnrichMathml.Attribute.SPEECH)&&sre.SpeechGeneratorUtil.addPrefix(h,f)}return c},sre.NodeSpeechGenerator=function(){sre.TreeSpeechGenerator.call(this)},goog.inherits(sre.NodeSpeechGenerator,sre.TreeSpeechGenerator),sre.NodeSpeechGenerator.prototype.getSpeech=function(a,b){var c=sre.WalkerUtil.getAttribute(a,this.modality);return c||sre.NodeSpeechGenerator.superClass_.getSpeech.call(this,a,b)},sre.SummarySpeechGenerator=function(){sre.AbstractSpeechGenerator.call(this)},goog.inherits(sre.SummarySpeechGenerator,sre.AbstractSpeechGenerator),sre.SummarySpeechGenerator.prototype.getSpeech=function(a,b){return sre.SpeechGeneratorUtil.connectAllMactions(b,this.getRebuilt().xml),this.generateSpeech(a,b)},sre.SpeechGeneratorFactory={},sre.SpeechGeneratorFactory.generator=function(a){return new(sre.SpeechGeneratorFactory.generatorMapping_[a]||sre.SpeechGeneratorFactory.generatorMapping_.Direct)},sre.SpeechGeneratorFactory.generatorMapping_={Adhoc:sre.AdhocSpeechGenerator,Color:sre.ColorGenerator,Direct:sre.DirectSpeechGenerator,Dummy:sre.DummySpeechGenerator,Node:sre.NodeSpeechGenerator,Summary:sre.SummarySpeechGenerator,Tree:sre.TreeSpeechGenerator},sre.EventUtil={},sre.EventUtil.KeyCode={ENTER:13,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,LESS:188,GREATER:190,DASH:189,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90},sre.EventUtil.Move=function(){var b,a={};for(b in sre.EventUtil.KeyCode)a[sre.EventUtil.KeyCode[b]]=b;return a}(),sre.EventUtil.EventType={CLICK:"click",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",SELECTSTART:"selectstart",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel"},sre.EventUtil.Event=function(a,b,c){this.src=a,this.type=b,this.callback=c},sre.EventUtil.Event.prototype.add=function(){this.src.addEventListener(this.type,this.callback)},sre.EventUtil.Event.prototype.remove=function(){this.src.removeEventListener(this.type,this.callback)},sre.Focus=function(a,b){this.semanticNodes_=a,this.semanticPrimary_=b,this.domNodes_=[],this.domPrimary_=null,this.allNodes_=[]},sre.Focus.prototype.getSemanticPrimary=function(){return this.semanticPrimary_},sre.Focus.prototype.getSemanticNodes=function(){return this.semanticNodes_},sre.Focus.prototype.getNodes=function(){return this.allNodes_},sre.Focus.prototype.getDomNodes=function(){return this.domNodes_},sre.Focus.prototype.getDomPrimary=function(){return this.domPrimary_},sre.Focus.prototype.toString=function(){return"Primary:"+this.domPrimary_+" Nodes:"+this.domNodes_},sre.Focus.prototype.clone=function(){var a=new sre.Focus(this.semanticNodes_,this.semanticPrimary_);return a.domNodes_=this.domNodes_,a.domPrimary_=this.domPrimary_,a.allNodes_=this.allNodes_,a},sre.Focus.factory=function(a,b,c,d){var e=function(h){return sre.WalkerUtil.getBySemanticId(d,h)},f=c.nodeDict,g=(c=e(a),e=b.map(e),b.map(function(h){return f[h]}));return(a=new sre.Focus(g,f[a])).domNodes_=e,a.domPrimary_=c,a.allNodes_=sre.Focus.generateAllVisibleNodes_(b,e,f,d),a},sre.Focus.generateAllVisibleNodes_=function(a,b,c,d){function e(m){return sre.WalkerUtil.getBySemanticId(d,m)}for(var k,l,f=[],g=0,h=a.length;g<h;g++)b[g]?f.push(b[g]):(k=c[a[g]])&&(l=(k=k.childNodes.map(function(m){return m.id.toString()})).map(e),f=f.concat(sre.Focus.generateAllVisibleNodes_(k,l,c,d)));return f},sre.Levels=function(){this.level_=[]},sre.Levels.prototype.push=function(a){this.level_.push(a)},sre.Levels.prototype.pop=function(){return this.level_.pop()},sre.Levels.prototype.peek=function(){return this.level_[this.level_.length-1]||null},sre.Levels.prototype.indexOf=function(a){var b=this.peek();return b?b.indexOf(a):null},sre.Levels.prototype.find=function(a){var b=this.peek();if(b)for(var c=0,d=b.length;c<d;c++)if(a(b[c]))return b[c];return null},sre.Levels.prototype.get=function(a){var b=this.peek();return!b||a<0||a>=b.length?null:b[a]},sre.Levels.prototype.depth=function(){return this.level_.length},sre.Levels.prototype.clone=function(){var a=new sre.Levels;return a.level_=this.level_.slice(0),a},sre.Levels.prototype.toString=function(){for(var c,a="",b=0;c=this.level_[b];b++)a+="\n"+c.map(function(d){return d.toString()});return a},sre.Walker=function(){},sre.Walker.prototype.isActive=function(){},sre.Walker.prototype.activate=function(){},sre.Walker.prototype.deactivate=function(){},sre.Walker.prototype.speech=function(){},sre.Walker.prototype.getXml=function(){},sre.Walker.prototype.getRebuilt=function(){},sre.Walker.prototype.getFocus=function(a){},sre.Walker.prototype.setFocus=function(a){},sre.Walker.prototype.getDepth=function(){},sre.Walker.prototype.move=function(a){},sre.Walker.prototype.update=function(a){};sre.Walker.move={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",REPEAT:"repeat",DEPTH:"depth",ENTER:"enter",EXPAND:"expand",HOME:"home",SUMMARY:"summary",DETAIL:"detail",ROW:"row",CELL:"cell"},sre.Walker.STATE_={},sre.Walker.resetState=function(a){delete sre.Walker.STATE_[a]},sre.Walker.setState=function(a,b){sre.Walker.STATE_[a]=b},sre.Walker.getState=function(a){return sre.Walker.STATE_[a]},sre.AbstractWalker=function(a,b,c,d){this.node=a,this.node.id?this.id=this.node.id:this.node.hasAttribute(sre.AbstractWalker.SRE_ID_ATTR)?this.id=this.node.getAttribute(sre.AbstractWalker.SRE_ID_ATTR):(this.node.setAttribute(sre.AbstractWalker.SRE_ID_ATTR,sre.AbstractWalker.ID_COUNTER),this.id=sre.AbstractWalker.ID_COUNTER++),this.generator=b,this.highlighter=c,this.rootNode=sre.WalkerUtil.getSemanticRoot(a),this.rootId=this.rootNode.getAttribute(sre.EnrichMathml.Attribute.ID),this.xmlString_=d,this.focus_=this.rebuilt_=this.xml_=null,this.keyMapping={},this.keyMapping[sre.EventUtil.KeyCode.UP]=goog.bind(this.up,this),this.keyMapping[sre.EventUtil.KeyCode.DOWN]=goog.bind(this.down,this),this.keyMapping[sre.EventUtil.KeyCode.RIGHT]=goog.bind(this.right,this),this.keyMapping[sre.EventUtil.KeyCode.LEFT]=goog.bind(this.left,this),this.keyMapping[sre.EventUtil.KeyCode.TAB]=goog.bind(this.repeat,this),this.keyMapping[sre.EventUtil.KeyCode.DASH]=goog.bind(this.expand,this),this.keyMapping[sre.EventUtil.KeyCode.SPACE]=goog.bind(this.depth,this),this.keyMapping[sre.EventUtil.KeyCode.HOME]=goog.bind(this.home,this),this.keyMapping[sre.EventUtil.KeyCode.X]=goog.bind(this.summary,this),this.keyMapping[sre.EventUtil.KeyCode.Z]=goog.bind(this.detail,this),this.keyMapping[sre.EventUtil.KeyCode.V]=goog.bind(this.virtualize,this),this.keyMapping[sre.EventUtil.KeyCode.P]=goog.bind(this.previous,this),this.keyMapping[sre.EventUtil.KeyCode.U]=goog.bind(this.undo,this),this.keyMapping[sre.EventUtil.KeyCode.LESS]=goog.bind(this.previousRules,this),this.keyMapping[sre.EventUtil.KeyCode.GREATER]=goog.bind(this.nextRules,this),this.active_=!1,this.moved=sre.Walker.move.ENTER,this.cursors=[]},sre.AbstractWalker.prototype.getXml=function(){return this.xml_||(this.xml_=sre.DomUtil.parseInput(this.xmlString_)),this.xml_},sre.AbstractWalker.prototype.getRebuilt=function(){return this.rebuilt_||(this.rebuilt_=this.rebuildStree()),this.rebuilt_},sre.AbstractWalker.ID_COUNTER=0,sre.AbstractWalker.SRE_ID_ATTR="sre-explorer-id",sre.AbstractWalker.prototype.isActive=function(){return this.active_},sre.AbstractWalker.prototype.toggleActive_=function(){this.active_=!this.active_},sre.AbstractWalker.prototype.activate=function(){this.isActive()||(this.generator.start(),this.toggleActive_())},sre.AbstractWalker.prototype.deactivate=function(){this.isActive()&&(sre.Walker.setState(this.id,this.primaryId()),this.generator.end(),this.toggleActive_())},sre.AbstractWalker.prototype.getFocus=function(a){return this.focus_||(this.focus_=sre.Focus.factory(this.rootId,[this.rootId],this.getRebuilt(),this.node)),a&&this.updateFocus(),this.focus_},sre.AbstractWalker.prototype.setFocus=function(a){this.focus_=a},sre.AbstractWalker.prototype.getDepth=function(){return this.levels.depth()-1},sre.AbstractWalker.prototype.isSpeech=function(){return this.generator.modality===sre.EnrichMathml.Attribute.SPEECH},sre.AbstractWalker.prototype.speech=function(){var a=this.getFocus().getDomNodes();if(!a.length)return"";if(null!==(b=this.specialMove()))return b;switch(this.moved){case sre.Walker.move.DEPTH:return this.depth_();case sre.Walker.move.SUMMARY:return this.summary_();case sre.Walker.move.DETAIL:return this.detail_();default:for(var b=[],c=this.getFocus().getSemanticNodes(),d=0,e=a.length;d<e;d++){var f=a[d],g=c[d];b.push(f?this.generator.getSpeech(f,this.getXml()):sre.SpeechGeneratorUtil.recomputeMarkup(g))}return this.mergePrefix_(b)}},sre.AbstractWalker.prototype.mergePrefix_=function(a,b){b=b||[];var c=this.isSpeech()?this.prefix_():"";return c&&a.unshift(c),(c=this.isSpeech()?this.postfix_():"")&&a.push(c),(c=sre.AuralRendering.getInstance()).finalize(c.merge(b.concat(a)))},sre.AbstractWalker.prototype.prefix_=function(){var a=this.getFocus().getDomNodes(),b=this.getFocus().getSemanticNodes();return a[0]?sre.WalkerUtil.getAttribute(a[0],sre.EnrichMathml.Attribute.PREFIX):sre.SpeechGeneratorUtil.retrievePrefix(b[0])},sre.AbstractWalker.prototype.postfix_=function(){var a=this.getFocus().getDomNodes();return a[0]?sre.WalkerUtil.getAttribute(a[0],sre.EnrichMathml.Attribute.POSTFIX):""},sre.AbstractWalker.prototype.move=function(a){return(a=this.keyMapping[a])?!(!(a=a())||a===this.getFocus()||(this.setFocus(a),this.moved===sre.Walker.move.HOME&&(this.levels=this.initLevels()),0)):null},sre.AbstractWalker.prototype.up=function(){return this.moved=sre.Walker.move.UP,this.getFocus()},sre.AbstractWalker.prototype.down=function(){return this.moved=sre.Walker.move.DOWN,this.getFocus()},sre.AbstractWalker.prototype.left=function(){return this.moved=sre.Walker.move.LEFT,this.getFocus()},sre.AbstractWalker.prototype.right=function(){return this.moved=sre.Walker.move.RIGHT,this.getFocus()},sre.AbstractWalker.prototype.repeat=function(){return this.moved=sre.Walker.move.REPEAT,this.getFocus().clone()},sre.AbstractWalker.prototype.depth=function(){return this.moved=this.isSpeech()?sre.Walker.move.DEPTH:sre.Walker.move.REPEAT,this.getFocus().clone()},sre.AbstractWalker.prototype.depth_=function(){var a=sre.Grammar.getInstance().getParameter("depth"),b=(sre.Grammar.getInstance().setParameter("depth",!0),this.getFocus().getDomPrimary()),b=(this.expandable(b)?[sre.Messages.NAVIGATE.EXPANDABLE]:this.collapsible(b)&&[sre.Messages.NAVIGATE.COLLAPSIBLE])||[],c=[sre.AuralRendering.getInstance().markup([new sre.AuditoryDescription({text:sre.Messages.NAVIGATE.LEVEL+" "+this.getDepth(),personality:{}})])],d=this.getFocus().getSemanticNodes(),d=sre.SpeechGeneratorUtil.retrievePrefix(d[0]),e=sre.AuralRendering.getInstance();return d&&c.push(d),sre.Grammar.getInstance().setParameter("depth",a),e.finalize(e.merge(c.concat(b)))},sre.AbstractWalker.prototype.home=function(){return this.moved=sre.Walker.move.HOME,sre.Focus.factory(this.rootId,[this.rootId],this.getRebuilt(),this.node)},sre.AbstractWalker.prototype.getBySemanticId=function(a){return sre.WalkerUtil.getBySemanticId(this.node,a)},sre.AbstractWalker.prototype.primaryId=function(){return this.getFocus().getSemanticPrimary().id.toString()},sre.AbstractWalker.prototype.expand=function(){var a=this.getFocus().getDomPrimary();return(a=this.actionable_(a))?(this.moved=sre.Walker.move.EXPAND,a.dispatchEvent(new Event("click")),this.getFocus().clone()):this.getFocus()},sre.AbstractWalker.prototype.actionable_=function(a){return a&&a.parentNode&&this.highlighter.isMactionNode(a.parentNode)?a.parentNode:null},sre.AbstractWalker.prototype.expandable=function(a){return!!this.actionable_(a)&&0===a.childNodes.length},sre.AbstractWalker.prototype.collapsible=function(a){return!!this.actionable_(a)&&0<a.childNodes.length},sre.AbstractWalker.prototype.restoreState=function(){if(this.highlighter&&(a=sre.Walker.getState(this.id))){for(var b=this.getRebuilt().nodeDict[a],a=[];b;)a.push(b.id),b=b.parent;for(a.pop();0<a.length&&(this.down(),b=a.pop(),b=this.findFocusOnLevel(b));)this.setFocus(b);this.moved=sre.Walker.move.ENTER}},sre.AbstractWalker.prototype.updateFocus=function(){this.setFocus(sre.Focus.factory(this.getFocus().getSemanticPrimary().id.toString(),this.getFocus().getSemanticNodes().map(function(a){return a.id}),this.getRebuilt(),this.node))},sre.AbstractWalker.prototype.findFocusOnLevel=goog.abstractMethod,sre.AbstractWalker.prototype.initLevels=goog.abstractMethod,sre.AbstractWalker.prototype.rebuildStree=function(){var a=new sre.RebuildStree(this.getXml());return this.rootId=a.stree.root.id.toString(),this.generator.setRebuilt(a),this.focus_=sre.Focus.factory(this.rootId,[this.rootId],a,this.node),this.levels=this.initLevels(),sre.SpeechGeneratorUtil.connectMactions(this.node,this.getXml(),a.xml),a},sre.AbstractWalker.prototype.previousLevel=function(){var a=this.getFocus().getDomPrimary();return a?sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.PARENT):this.getFocus().getSemanticPrimary().parent.id.toString()},sre.AbstractWalker.prototype.nextLevel=function(){var b,c,d,a=this.getFocus().getDomPrimary();return a?(b=sre.WalkerUtil.splitAttribute(sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.CHILDREN)),c=sre.WalkerUtil.splitAttribute(sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.CONTENT)),d=sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.TYPE),a=sre.WalkerUtil.getAttribute(a,sre.EnrichMathml.Attribute.ROLE),this.combineContentChildren(d,a,c,b)):(c=function(e){return e.id.toString()},b=(d=this.getRebuilt().nodeDict[this.primaryId()]).childNodes.map(c),c=d.contentNodes.map(c),0===b.length?[]:this.combineContentChildren(d.type,d.role,c,b))},sre.AbstractWalker.prototype.combineContentChildren=goog.abstractMethod,sre.AbstractWalker.prototype.singletonFocus=function(a){return this.focusFromId(a,[a])},sre.AbstractWalker.prototype.focusFromId=function(a,b){return sre.Focus.factory(a,b,this.getRebuilt(),this.node)},sre.AbstractWalker.prototype.summary=function(){return this.moved=this.isSpeech()?sre.Walker.move.SUMMARY:sre.Walker.move.REPEAT,this.getFocus().clone()},sre.AbstractWalker.prototype.summary_=function(){var a=this.getFocus().getSemanticPrimary().id.toString(),a=this.getRebuilt().xml.getAttribute("id")===a?this.getRebuilt().xml:sre.DomUtil.querySelectorAllByAttrValue(this.getRebuilt().xml,"id",a)[0];return a=sre.SpeechGeneratorUtil.retrieveSummary(a),this.mergePrefix_([a])},sre.AbstractWalker.prototype.detail=function(){return this.moved=this.isSpeech()?sre.Walker.move.DETAIL:sre.Walker.move.REPEAT,this.getFocus().clone()},sre.AbstractWalker.prototype.detail_=function(){var a=this.getFocus().getSemanticPrimary().id.toString(),b=(a=this.getRebuilt().xml.getAttribute("id")===a?this.getRebuilt().xml:sre.DomUtil.querySelectorAllByAttrValue(this.getRebuilt().xml,"id",a)[0]).getAttribute("alternative"),c=(a.removeAttribute("alternative"),sre.SpeechGeneratorUtil.computeMarkup(a)),c=this.mergePrefix_([c]);return a.setAttribute("alternative",b),c},sre.AbstractWalker.prototype.specialMove=function(){return null},sre.AbstractWalker.prototype.virtualize=function(a){return this.cursors.push({focus:this.getFocus(),levels:this.levels,undo:a||!this.cursors.length}),this.levels=this.levels.clone(),this.getFocus().clone()},sre.AbstractWalker.prototype.previous=function(){var a=this.cursors.pop();return a?(this.levels=a.levels,a.focus):this.getFocus()},sre.AbstractWalker.prototype.undo=function(){do{var a=this.cursors.pop()}while(a&&!a.undo);return a?(this.levels=a.levels,a.focus):this.getFocus()},sre.AbstractWalker.prototype.update=function(a){this.generator.setOptions(a),sre.System.getInstance().setupEngine(a),sre.SpeechGeneratorFactory.generator("Tree").getSpeech(this.node,this.getXml())},sre.AbstractWalker.prototype.nextRules=function(){var a=this.generator.getOptions();return"speech"!==a.modality?this.getFocus():(sre.Engine.DOMAIN_TO_STYLES[a.domain]=a.style,a.domain="mathspeak"===a.domain?"clearspeak":"mathspeak",a.style=sre.Engine.DOMAIN_TO_STYLES[a.domain],this.update(a),this.moved=sre.Walker.move.REPEAT,this.getFocus().clone())},sre.AbstractWalker.prototype.nextStyle=function(a,b){var c,d;return"mathspeak"===a?-1===(c=(a=["default","brief","sbrief"]).indexOf(b))?b:c>=a.length-1?a[0]:a[c+1]:"clearspeak"===a?(d=sre.ClearspeakPreferences.getLocalePreferences().en)?(a=sre.ClearspeakPreferences.relevantPreferences(this.getFocus().getSemanticPrimary()),c=sre.ClearspeakPreferences.findPreference(b,a),-1===(c=(d=d[a].map(function(e){return e.split("_")[1]})).indexOf(c))?b:sre.ClearspeakPreferences.addPreference(b,a,c>=d.length-1?d[0]:d[c+1])):"default":b},sre.AbstractWalker.prototype.previousRules=function(){var a=this.generator.getOptions();return"speech"!==a.modality?this.getFocus():(a.style=this.nextStyle(a.domain,a.style),this.update(a),this.moved=sre.Walker.move.REPEAT,this.getFocus().clone())},sre.AbstractWalker.prototype.refocus=function(){for(var a=this.getFocus();!a.getNodes().length;){var b=this.levels.peek(),c=this.up();if(!c)break;this.setFocus(c),a=this.getFocus(!0)}this.levels.push(b),this.setFocus(a)},sre.DummyWalker=function(a,b,c,d){sre.AbstractWalker.call(this,a,b,c,d)},goog.inherits(sre.DummyWalker,sre.AbstractWalker),sre.DummyWalker.prototype.up=function(){},sre.DummyWalker.prototype.down=function(){},sre.DummyWalker.prototype.left=function(){},sre.DummyWalker.prototype.right=function(){},sre.DummyWalker.prototype.repeat=function(){},sre.DummyWalker.prototype.depth=function(){},sre.DummyWalker.prototype.home=function(){},sre.DummyWalker.prototype.getDepth=function(){return 0},sre.DummyWalker.prototype.initLevels=function(){},sre.SemanticWalker=function(a,b,c,d){sre.AbstractWalker.call(this,a,b,c,d),this.levels=null,this.restoreState()},goog.inherits(sre.SemanticWalker,sre.AbstractWalker),sre.SemanticWalker.prototype.initLevels=function(){var a=new sre.Levels;return a.push([this.getFocus()]),a},sre.SemanticWalker.prototype.up=function(){sre.SemanticWalker.superClass_.up.call(this);var a=this.previousLevel();return a?(this.levels.pop(),this.levels.find(function(b){return b.getSemanticNodes().some(function(c){return c.id.toString()===a})})):null},sre.SemanticWalker.prototype.down=function(){sre.SemanticWalker.superClass_.down.call(this);var a=this.nextLevel();return 0===a.length?null:(this.levels.push(a),a[0])},sre.SemanticWalker.prototype.combineContentChildren=function(a,b,c,d){switch(a){case sre.SemanticAttr.Type.RELSEQ:case sre.SemanticAttr.Type.INFIXOP:case sre.SemanticAttr.Type.MULTIREL:return this.makePairList(d,c);case sre.SemanticAttr.Type.PREFIXOP:return[this.focusFromId(d[0],c.concat(d))];case sre.SemanticAttr.Type.POSTFIXOP:return[this.focusFromId(d[0],d.concat(c))];case sre.SemanticAttr.Type.MATRIX:case sre.SemanticAttr.Type.VECTOR:case sre.SemanticAttr.Type.FENCED:return[this.focusFromId(d[0],[c[0],d[0],c[1]])];case sre.SemanticAttr.Type.CASES:return[this.focusFromId(d[0],[c[0],d[0]])];case sre.SemanticAttr.Type.PUNCTUATED:return b===sre.SemanticAttr.Role.TEXT?d.map(goog.bind(this.singletonFocus,this)):d.length===c.length?c.map(goog.bind(this.singletonFocus,this)):this.combinePunctuations(d,c,[],[]);case sre.SemanticAttr.Type.APPL:return[this.focusFromId(d[0],[d[0],c[0]]),this.singletonFocus(d[1])];case sre.SemanticAttr.Type.ROOT:return[this.singletonFocus(d[1]),this.singletonFocus(d[0])];default:return d.map(goog.bind(this.singletonFocus,this))}},sre.SemanticWalker.prototype.combinePunctuations=function(a,b,c,d){var e,f;return 0===a.length?d:(e=a.shift())===(f=b.shift())?(c.push(f),this.combinePunctuations(a,b,c,d)):(b.unshift(f),c.push(e),a.length===b.length?(d.push(this.focusFromId(e,c.concat(b))),d):(d.push(this.focusFromId(e,c)),this.combinePunctuations(a,b,[],d)))},sre.SemanticWalker.prototype.makePairList=function(a,b){if(0===a.length)return[];if(1===a.length)return[this.singletonFocus(a[0])];for(var c=[this.singletonFocus(a.shift())],d=0,e=a.length;d<e;d++)c.push(this.focusFromId(a[d],[b[d],a[d]]));return c},sre.SemanticWalker.prototype.left=function(){sre.SemanticWalker.superClass_.left.call(this);var a=this.levels.indexOf(this.getFocus());return null!==a&&this.levels.get(a-1)||null},sre.SemanticWalker.prototype.right=function(){sre.SemanticWalker.superClass_.right.call(this);var a=this.levels.indexOf(this.getFocus());return null!==a&&this.levels.get(a+1)||null},sre.SemanticWalker.prototype.findFocusOnLevel=function(a){return this.levels.find(function(b){return b.getSemanticPrimary().id===a})},sre.SyntaxWalker=function(a,b,c,d){sre.AbstractWalker.call(this,a,b,c,d),this.levels=null,this.restoreState()},goog.inherits(sre.SyntaxWalker,sre.AbstractWalker),sre.SyntaxWalker.prototype.initLevels=function(){var a=new sre.Levels;return a.push([this.primaryId()]),a},sre.SyntaxWalker.prototype.up=function(){sre.SyntaxWalker.superClass_.up.call(this);var a=this.previousLevel();return a?(this.levels.pop(),this.singletonFocus(a)):null},sre.SyntaxWalker.prototype.down=function(){sre.SyntaxWalker.superClass_.down.call(this);var b,a=this.nextLevel();return 0===a.length?null:((b=this.singletonFocus(a[0]))&&this.levels.push(a),b)},sre.SyntaxWalker.prototype.combineContentChildren=function(a,b,c,d){switch(a){case sre.SemanticAttr.Type.RELSEQ:case sre.SemanticAttr.Type.INFIXOP:case sre.SemanticAttr.Type.MULTIREL:return sre.BaseUtil.interleaveLists(d,c);case sre.SemanticAttr.Type.PREFIXOP:return c.concat(d);case sre.SemanticAttr.Type.POSTFIXOP:return d.concat(c);case sre.SemanticAttr.Type.MATRIX:case sre.SemanticAttr.Type.VECTOR:case sre.SemanticAttr.Type.FENCED:return d.unshift(c[0]),d.push(c[1]),d;case sre.SemanticAttr.Type.CASES:return d.unshift(c[0]),d;case sre.SemanticAttr.Type.PUNCTUATED:return b===sre.SemanticAttr.Role.TEXT?sre.BaseUtil.interleaveLists(d,c):d;case sre.SemanticAttr.Type.APPL:return[d[0],c[0],d[1]];case sre.SemanticAttr.Type.ROOT:return[d[1],d[0]];default:return d}},sre.SyntaxWalker.prototype.left=function(){sre.SyntaxWalker.superClass_.left.call(this);var a=this.levels.indexOf(this.primaryId());return null!==a&&(a=this.levels.get(a-1))?this.singletonFocus(a):null},sre.SyntaxWalker.prototype.right=function(){sre.SyntaxWalker.superClass_.right.call(this);var a=this.levels.indexOf(this.primaryId());return null!==a&&(a=this.levels.get(a+1))?this.singletonFocus(a):null},sre.SyntaxWalker.prototype.findFocusOnLevel=function(a){return this.singletonFocus(a.toString())},sre.TableWalker=function(a,b,c,d){sre.SyntaxWalker.call(this,a,b,c,d),this.modifier=!1,this.keyMapping[sre.EventUtil.KeyCode[0]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[1]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[2]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[3]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[4]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[5]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[6]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[7]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[8]]=goog.bind(this.jumpCell,this),this.keyMapping[sre.EventUtil.KeyCode[9]]=goog.bind(this.jumpCell,this),this.key_=null,this.row_=0,this.firstJump=this.currentTable_=null},goog.inherits(sre.TableWalker,sre.SyntaxWalker),sre.TableWalker.prototype.move=function(a){return this.key_=a,a=sre.TableWalker.superClass_.move.call(this,a),this.modifier=!1,a},sre.TableWalker.prototype.up=function(){return this.moved=sre.Walker.move.UP,this.eligibleCell_()?this.verticalMove_(!1):sre.TableWalker.superClass_.up.call(this)},sre.TableWalker.prototype.down=function(){return this.moved=sre.Walker.move.DOWN,this.eligibleCell_()?this.verticalMove_(!0):sre.TableWalker.superClass_.down.call(this)},sre.TableWalker.ELIGIBLE_CELL_ROLES=[sre.SemanticAttr.Role.DETERMINANT,sre.SemanticAttr.Role.ROWVECTOR,sre.SemanticAttr.Role.BINOMIAL,sre.SemanticAttr.Role.SQUAREMATRIX,sre.SemanticAttr.Role.MULTILINE,sre.SemanticAttr.Role.MATRIX,sre.SemanticAttr.Role.VECTOR,sre.SemanticAttr.Role.CASES,sre.SemanticAttr.Role.TABLE],sre.TableWalker.ELIGIBLE_TABLE_TYPES=[sre.SemanticAttr.Type.MULTILINE,sre.SemanticAttr.Type.MATRIX,sre.SemanticAttr.Type.VECTOR,sre.SemanticAttr.Type.CASES,sre.SemanticAttr.Type.TABLE],sre.TableWalker.prototype.eligibleCell_=function(){var a=this.getFocus().getSemanticPrimary();return this.modifier&&a.type===sre.SemanticAttr.Type.CELL&&-1!==sre.TableWalker.ELIGIBLE_CELL_ROLES.indexOf(a.role)},sre.TableWalker.prototype.verticalMove_=function(a){var c,d,e,b;return(b=this.previousLevel())?(c=this.getFocus(),d=this.levels.indexOf(this.primaryId()),e=this.levels.pop(),b=this.levels.indexOf(b),(a=this.levels.get(a?b+1:b-1))?(this.setFocus(this.singletonFocus(a)),(a=this.nextLevel())[d]?(this.levels.push(a),this.singletonFocus(a[d])):(this.setFocus(c),this.levels.push(e),null)):(this.levels.push(e),null)):null},sre.TableWalker.prototype.jumpCell=function(){var a;return this.isInTable_()&&null!==this.key_?this.moved===sre.Walker.move.ROW?(this.moved=sre.Walker.move.CELL,a=this.key_-sre.EventUtil.KeyCode[0],this.isLegalJump_(this.row_,a)?this.jumpCell_(this.row_,a):this.getFocus()):(a=this.key_-sre.EventUtil.KeyCode[0])>this.currentTable_.childNodes.length?this.getFocus():(this.row_=a,this.moved=sre.Walker.move.ROW,this.getFocus().clone()):this.getFocus()},sre.TableWalker.prototype.jumpCell_=function(a,b){this.firstJump?this.virtualize(!1):(this.firstJump=this.getFocus(),this.virtualize(!0));var c=this.currentTable_.id.toString();do{var d=this.levels.pop()}while(-1===d.indexOf(c));return this.levels.push(d),this.setFocus(this.singletonFocus(c)),this.levels.push(this.nextLevel()),a=this.currentTable_.childNodes[a-1],this.setFocus(this.singletonFocus(a.id.toString())),this.levels.push(this.nextLevel()),this.singletonFocus(a.childNodes[b-1].id.toString())},sre.TableWalker.prototype.isLegalJump_=function(a,b){var c=sre.DomUtil.querySelectorAllByAttrValue(this.getRebuilt().xml,"id",this.currentTable_.id.toString())[0];return!(!c||c.hasAttribute("alternative")||!(a=this.currentTable_.childNodes[a-1])||!(c=sre.DomUtil.querySelectorAllByAttrValue(c,"id",a.id.toString())[0])||c.hasAttribute("alternative")||!a||!a.childNodes[b-1])},sre.TableWalker.prototype.isInTable_=function(){for(var a=this.getFocus().getSemanticPrimary();a;){if(-1!==sre.TableWalker.ELIGIBLE_TABLE_TYPES.indexOf(a.type))return this.currentTable_=a,!0;a=a.parent}return!1},sre.TableWalker.prototype.undo=function(){var a=sre.TableWalker.superClass_.undo.call(this);return a===this.firstJump&&(this.firstJump=null),a},sre.WalkerFactory={},sre.WalkerFactory.walker=function(a,b,c,d,e){return new(sre.WalkerFactory.walkerMapping_[a.toLowerCase()]||sre.WalkerFactory.walkerMapping_.dummy)(b,c,d,e)},sre.WalkerFactory.walkerMapping_={dummy:sre.DummyWalker,semantic:sre.SemanticWalker,syntax:sre.SyntaxWalker,table:sre.TableWalker},sre.ProcessorFactory={},sre.ProcessorFactory.PROCESSORS_={},sre.ProcessorFactory.get_=function(a){var b=sre.ProcessorFactory.PROCESSORS_[a.toLowerCase()];if(b)return b;throw new sre.Engine.Error("Unknown processor "+a)},sre.ProcessorFactory.process=function(a,b){return sre.ProcessorFactory.get_(a).processor(b)},sre.ProcessorFactory.processOnly=function(a,b){return sre.ProcessorFactory.get_(a).process(b)},sre.ProcessorFactory.print=function(a,b){return a=sre.ProcessorFactory.get_(a),sre.Engine.getInstance().pprint?a.pprint(b):a.print(b)},sre.ProcessorFactory.output=function(a,b){return b=(a=sre.ProcessorFactory.get_(a)).processor(b),sre.Engine.getInstance().pprint?a.pprint(b):a.print(b)},sre.ProcessorFactory.keypress=function(a,b){return b=(a=sre.ProcessorFactory.get_(a)).key?a.key(b):b,b=a.processor(b),sre.Engine.getInstance().pprint?a.pprint(b):a.print(b)},sre.Processor=function(a,b){this.name=a,this.process=b.processor,this.processor=(this.postprocess=b.postprocessor||function(c,d){return c},function(c){return this.postprocess(this.process(c),c)}),this.print=b.print||sre.Processor.stringify_,this.pprint=b.pprint||this.print,sre.ProcessorFactory.PROCESSORS_[this.name]=this},sre.KeyProcessor=function(a,b){sre.Processor.call(this,a,b),this.key=b.key||sre.KeyProcessor.getKey_},goog.inherits(sre.KeyProcessor,sre.Processor),sre.KeyProcessor.getKey_=function(a){return"string"==typeof a?sre.EventUtil.KeyCode[a.toUpperCase()]:a},sre.Processor.LocalState_={walker:null,speechGenerator:null,highlighter:null},sre.Processor.stringify_=function(a){return a&&a.toString()},new sre.Processor("semantic",{processor:function(a){return a=sre.DomUtil.parseInput(a),sre.Semantic.xmlTree(a)},postprocessor:function(a,b){var c=sre.Engine.getInstance().speech;if(c!==sre.Engine.Speech.NONE){var d=a.cloneNode(!0),e=sre.SpeechGeneratorUtil.computeMarkup(d);if(b=sre.AuralRendering.getInstance(),c===sre.Engine.Speech.SHALLOW)a.setAttribute("speech",b.finalize(e));else for(var g,c=sre.XpathUtil.evalXPath(".//*[@id]",a),d=sre.XpathUtil.evalXPath(".//*[@id]",d),f=0;g=c[f],e=d[f];f++)e=sre.SpeechGeneratorUtil.computeMarkup(e),g.setAttribute("speech",b.finalize(e))}return a},pprint:function(a){return sre.DomUtil.formatXml(a.toString())}}),new sre.Processor("speech",{processor:function(a){a=sre.DomUtil.parseInput(a),a=sre.Semantic.xmlTree(a),a=sre.SpeechGeneratorUtil.computeSpeech(a);var b=sre.AuralRendering.getInstance();return b.finalize(b.markup(a))},pprint:function(a){return a=a.toString(),sre.AuralRendering.ofType(sre.XmlRenderer)?sre.DomUtil.formatXml(a):a}}),new sre.Processor("json",{processor:function(a){return a=sre.DomUtil.parseInput(a,sre.Engine.Error),sre.Semantic.getTree(a).toJson()},postprocessor:function(a,b){var d,e,f,c=sre.Engine.getInstance().speech;return c!==sre.Engine.Speech.NONE&&(b=sre.DomUtil.parseInput(b),d=sre.Semantic.xmlTree(b),b=sre.SpeechGeneratorUtil.computeMarkup(d),e=sre.AuralRendering.getInstance(),c===sre.Engine.Speech.SHALLOW?a.stree.speech=e.finalize(b):(f=function(g){var h=sre.XpathUtil.evalXPath(".//*[@id="+g.id+"]",d)[0],h=sre.SpeechGeneratorUtil.computeMarkup(h);g.speech=e.finalize(h),g.children&&g.children.forEach(f)})(a.stree)),a},print:function(a){return JSON.stringify(a)},pprint:function(a){return JSON.stringify(a,null,2)}}),new sre.Processor("description",{processor:function(a){return a=sre.DomUtil.parseInput(a),a=sre.Semantic.xmlTree(a),sre.SpeechGeneratorUtil.computeSpeech(a)},print:function(a){return JSON.stringify(a)},pprint:function(a){return JSON.stringify(a,null,2)}}),new sre.Processor("enriched",{processor:function(a){return sre.Enrich.semanticMathmlSync(a)},postprocessor:function(a,b){switch(b=sre.WalkerUtil.getSemanticRoot(a),sre.Engine.getInstance().speech){case sre.Engine.Speech.SHALLOW:var c=sre.SpeechGeneratorFactory.generator("Adhoc");c.getSpeech(b,a);break;case sre.Engine.Speech.DEEP:(c=sre.SpeechGeneratorFactory.generator("Tree")).getSpeech(b,a)}return a},pprint:function(a){return sre.DomUtil.formatXml(a.toString())}}),new sre.Processor("walker",{processor:function(a){var b=sre.SpeechGeneratorFactory.generator("Node"),c=(sre.Processor.LocalState_.speechGenerator=b,sre.Processor.LocalState_.highlighter=sre.HighlighterFactory.highlighter({color:"black"},{color:"white"},{renderer:"NativeMML"}),a=sre.ProcessorFactory.process("enriched",a),sre.ProcessorFactory.print("enriched",a));return sre.Processor.LocalState_.walker=sre.WalkerFactory.walker(sre.Engine.getInstance().walker,a,b,sre.Processor.LocalState_.highlighter,c),sre.Processor.LocalState_.walker},print:function(a){return sre.Processor.LocalState_.walker.speech()}}),new sre.KeyProcessor("move",{processor:function(a){return sre.Processor.LocalState_.walker?!1===sre.Processor.LocalState_.walker.move(a)?sre.AuralRendering.getInstance().error(a):sre.Processor.LocalState_.walker.speech():null}}),sre.System=function(){this.version=sre.Variables.VERSION,this.files_=0,sre.Engine.registerTest(function(){return!sre.System.getInstance().files_})},goog.addSingletonGetter(sre.System),sre.System.prototype.setupEngine=function(a){function c(d){b[d]=a[d]||b[d]}var b=sre.Engine.getInstance();"default"!==a.domain||"speech"!==a.modality&&a.modality&&"speech"!==b.modality||(a.domain="mathspeak");c("mode"),sre.System.prototype.configBlocks_(a),sre.Engine.BINARY_FEATURES.forEach(function(d){void 0!==a[d]&&(b[d]=!!a[d])}),sre.Engine.STRING_FEATURES.forEach(c),a.json&&(sre.SystemExternal.jsonPath=sre.BaseUtil.makePath(a.json)),a.xpath&&(sre.SystemExternal.WGXpath=a.xpath),b.setupBrowsers(),b.setDynamicCstr(),sre.L10n.setLocale(),sre.SpeechRuleEngine.getInstance().updateEngine()},sre.System.prototype.configBlocks_=function(a){if(!sre.Engine.getInstance().config&&sre.Engine.getInstance().mode===sre.Engine.Mode.HTTP){sre.Engine.getInstance().config=!0;for(var b=document.documentElement.querySelectorAll('script[type="text/x-sre-config"]'),c=0,d=b.length;c<d;c++)try{var g,e=b[c].innerHTML,f=JSON.parse(e);for(g in f)a[g]=f[g]}catch(h){sre.Debugger.getInstance().output("Illegal configuration ",e)}}},sre.System.setAsync=function(){sre.Engine.isReady()||setTimeout(sre.System.setAsync,500),sre.System.getInstance().setupEngine({mode:sre.Engine.Mode.ASYNC})},sre.System.prototype.engineSetup=function(){var a=["mode"].concat(sre.Engine.STRING_FEATURES,sre.Engine.BINARY_FEATURES),b=sre.Engine.getInstance(),c={};return a.forEach(function(d){c[d]=b[d]}),c.json=sre.SystemExternal.jsonPath,c.xpath=sre.SystemExternal.WGXpath,c.rules=b.ruleSets.slice(),c},sre.System.prototype.engineReady=function(){return sre.Engine.isReady()},sre.System.prototype.toSpeech=function(a){return sre.System.getInstance().processString("speech",a)},sre.System.prototype.toSemantic=function(a){return sre.System.getInstance().processString("semantic",a)},sre.System.prototype.toJson=function(a){return sre.System.getInstance().processString("json",a)},sre.System.prototype.toDescription=function(a){return sre.System.getInstance().processString("description",a)},sre.System.prototype.toEnriched=function(a){return sre.System.getInstance().processString("enriched",a)},sre.System.prototype.processString=function(a,b){return sre.ProcessorFactory.process(a,b)},sre.System.prototype.fileToSpeech=function(a,b){sre.System.getInstance().processFile("speech",a,b)},sre.System.prototype.fileToSemantic=function(a,b){sre.System.getInstance().processFile("semantic",a,b)},sre.System.prototype.fileToJson=function(a,b){sre.System.getInstance().processFile("json",a,b)},sre.System.prototype.fileToDescription=function(a,b){sre.System.getInstance().processFile("description",a,b)},sre.System.prototype.fileToEnriched=function(a,b){sre.System.getInstance().processFile("enriched",a,b)},sre.System.prototype.processFile=function(a,b,c){sre.Engine.isReady()?sre.Engine.getInstance().mode===sre.Engine.Mode.SYNC?this.processFileSync_(a,b,c):this.processFileAsync_(a,b,c):setTimeout(goog.bind(function(){this.processFile(a,b,c)},this),100)},sre.System.prototype.inputFileSync_=function(a){try{var b=sre.SystemExternal.fs.readFileSync(a,{encoding:"utf8"})}catch(c){throw new sre.Engine.Error("Can not open file: "+a)}return b},sre.System.prototype.processFileSync_=function(a,b,c){if(b=sre.System.getInstance().inputFileSync_(b),a=sre.ProcessorFactory.output(a,b),c)try{sre.SystemExternal.fs.writeFileSync(c,a)}catch(d){throw new sre.Engine.Error("Can not write to file: "+c)}else console.info(a)},sre.System.prototype.inputFileAsync_=function(a,b){sre.SystemExternal.fs.readFile(a,{encoding:"utf8"},goog.bind(function(c,d){if(c)throw new sre.Engine.Error("Can not open file: "+a);b(d)},this))},sre.System.prototype.processFileAsync_=function(a,b,c){this.files_++,sre.System.getInstance().inputFileAsync_(b,goog.bind(function(d){d=sre.ProcessorFactory.output(a,d),c?sre.SystemExternal.fs.writeFile(c,d,function(e){if(e)throw this.files_--,new sre.Engine.Error("Can not write to file: "+c)}):console.info(d),this.files_--},this))},sre.System.prototype.walk=function(a){return sre.ProcessorFactory.output("walker",a)},sre.System.prototype.move=function(a){return sre.ProcessorFactory.keypress("move",a)},sre.System.prototype.exit=function(a){var b=a||0;b||sre.Engine.isReady()?sre.SystemExternal.process.exit(b):setTimeout(goog.bind(function(){this.exit(b)},this),100)},sre.Browser={},sre.System.getInstance().setupEngine({mode:sre.Engine.Mode.HTTP,domain:"mathspeak",style:"default"});var SRE=sre.System.getInstance();