<!DOCTYPE html>
<html lang="pl" prefix="og: http://ogp.me/ns#">
<head>
<meta content="#FF0000" name="theme-color">
<meta charset="utf-8">
<meta content="Dekoratory w Pythonie. Co daj i jak je implementowa." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Dekoratory w Pythonie | testerembyc.pl</title>
<link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/latolatinfonts.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/blog.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/all.min.css" rel="stylesheet" type="text/css">
<link href="../../rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://testerembyc.pl/posts/dekoratory-w-pythonie/" rel="canonical">
<link href="../../images/icons/icon_16x16.png" rel="icon" sizes="16x16">
<link href="../../images/icons/icon_32x32.png" rel="icon" sizes="32x32">
<link href="../../images/icons/icon_64x64.png" rel="icon" sizes="64x64">
<link href="../../images/icons/icon_128x128.png" rel="icon" sizes="128x128">
<link href="../../images/icons/icon_256x256.png" rel="icon" sizes="256x256">
<link href="../../images/icons/icon_512x512.png" rel="icon" sizes="512x512"><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]-->
<meta content="Dekoratory w Pythonie. Co daj i jak je implementowa." itemprop="description" name="description">
<meta content="Maciej Kusz" name="author">
<link href="../dlaczego-nie-bedziesz-testerem-i-co-mozesz-z-tym-fantem-zrobic-jesli-bardzo-chcesz/" rel="prev" title="Dlaczego nie bdziesz testerem i co mo偶esz z tym fantem zrobi jeli bardzo chcesz?" type="text/html">
<link href="../jak-dorobic-do-etatu-czyli-tester-tworzy-rpa/" rel="next" title="Jak dorobi do etatu, czyli tester tworzy RPA" type="text/html">
<meta content="testerembyc.pl" property="og:site_name">
<meta content="Dekoratory w Pythonie" property="og:title">
<meta content="https://testerembyc.pl/posts/dekoratory-w-pythonie/" property="og:url">
<meta content="Dekoratory w Pythonie. Co daj i jak je implementowa." property="og:description">
<meta content="https://testerembyc.pl/images/posts/dekoratory-w-pythonie_social.jpg" property="og:image">
<meta content="article" property="og:type">
<meta content="2020-01-09T14:26:38+01:00" property="article:published_time">
<meta content="dekorator" property="article:tag">
<meta content="funkcje" property="article:tag">
<meta content="summary" name="twitter:card">
<meta content="@website" name="twitter:site">
<meta content="@username" name="twitter:creator">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Przejd藕 do treci</a> <!-- Menubar -->
<div class="blog-masthead">
<div class="container"><!-- This keeps the margins nice -->
<div class="blog-header">
<h1 class="blog-title"><a href="https://testerembyc.pl/"><img alt="testerembyc.pl" id="logo" src="../../images/testerembyc_logo.svg"><span id="blog-title">testerembyc.pl</span></a></h1>
<!-- <p class="lead blog-description">Czyli blog o tym, jak to jest by nie tylko testerem</p> # Original one -->
<p class="lead blog-description">Czyli blog o tym, jak to jest by nie tylko <span>testerem</span></p>
</div>
<nav class="blog-nav" role="navigation"><a class="blog-nav-item" href="../../"><img height="16" src="../../images/icons/icon.svg" title="Strona g贸wna" width="16"><span>Strona&nbsp;g贸wna</span></a> <a class="blog-nav-item" href="../../pages/python-kompendium"><i class="fab fa-python" title="Python"></i><span>Python</span></a> <a class="blog-nav-item" href="../../categories/youtube"><i class="fab fa-youtube" title="YouTube"></i><span>YouTube</span></a> <a class="blog-nav-item" href="../../categories/"><i class="fas fa-tags" title="Tagi i kategorie"></i><span>Tagi&nbsp;i&nbsp;kategorie</span></a> <a class="blog-nav-item" href="../../archive.html"><i class="fas fa-archive" title="Archiwum"></i><span>Archiwum</span></a> <a class="blog-nav-item" href="../../pages/o-mnie/"><i class="fas fa-user" title="O mnie"></i><span>O&nbsp;mnie</span></a> <a class="blog-nav-item" href="../../rss.xml"><i class="fas fa-rss" title="RSS"></i><span>RSS</span></a></nav>
<!-- START Bootstrap-Cookie-Alert -->
<div class="alert text-center cookiealert" role="alert">
<p><b>Lubisz ciasteczka?</b> </p>
<p>U偶ywam ich, aby dostarczy Ci lepszych treci. Chcesz wiedzie wicej? <a href="../../pages/polityka-prywatnosci/" target="_blank">Kliknij tu.</a></p>
<p><button class="btn btn-danger btn-sm acceptcookies" type="button">Lubi i akceptuj ciasteczka</button></p>
</div>
<!-- END Bootstrap-Cookie-Alert -->
<div class="body-content"><!--Body content-->
<div class="row">
<div class="col-sm-9 blog-main">
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h2 class="p-name entry-title blog-post-title" itemprop="headline name"><a class="u-url" href=".">Dekoratory w Pythonie</a></h2>
<div class="metadata blog-post-meta">
<p class="byline author vcard"><span class="byline-name fn">Maciej Kusz</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2020-01-09T14:26:38+01:00" itemprop="datePublished" title="2020-01-09 14:26">2020-01-09 14:26</time></a></p>
<p class="commentline"><a data-disqus-identifier="cache/posts/dekoratory-w-pythonie.html" href="#disqus_thread">Komentarze</a></p>
<meta content="Dekoratory w Pythonie. Co daj i jak je implementowa." itemprop="description" name="description">
<p></p></div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div>
<p class="caption"><a href="../dekoratory-w-pythonie"><img alt="Witaj wiecie" src="../../images/posts/dekoratory-w-pythonie.jpg"></a> Wykorzystano zdjcie autorstwa <a href="https://www.pexels.com/pl-pl/@yankrukov">Yan Krukov</a> z <a href="https://www.pexels.com/">Pexels</a></p>
<p>Ostatnich kilka artyku贸w na tym blogu, byo zwizane z og贸lnikami dotyczcymi <a href="../cala-prawda-o-testach-oprogramowania-i-czym-one-sa">test贸w</a> i <a href="../dlaczego-nie-bedziesz-testerem-i-co-mozesz-z-tym-fantem-zrobic-jesli-bardzo-chcesz">zawodu testera</a>. Tym razem wpis typowo techniczny zwizany z moim ulubionym jzykiem programowania, czyli Pythonem. Jzyk ten ma pewne <em>magiczne</em> metody i elementy niespotykane w innych jzykach (lub spos贸b ich u偶ycia i implementacji jest du偶o bardziej zo偶ony). Jednym z takich element贸w jest tzw. <strong>dekorator</strong>.</p>
<!-- more -->
<div class="toc">
<ul>
<li><a href="#czym-jest-dekorator">Czym jest dekorator?</a></li>
<li><a href="#funkcja-jest-obiektem">Funkcja jest obiektem</a></li>
<li><a href="#czy-obiekt-moze-byc-funkcja">Czy obiekt mo偶e by funkcj?</a></li>
<li><a href="#pierwszy-dekorator">Pierwszy dekorator</a></li>
<li><a href="#args-i-kwargs">args i kwargs</a></li>
<li><a href="#wraps">wraps</a></li>
<li><a href="#dekorator-z-parametrami">Dekorator z parametrami</a></li>
<li><a href="#partial">partial</a></li>
<li><a href="#klasa-jako-dekorator">Klasa jako dekorator</a></li>
<li><a href="#podsumowanie">Podsumowanie</a></li>
</ul>
</div>
<h2 id="czym-jest-dekorator">Czym jest dekorator?</h2>
<p>W skr贸cie <a href="https://pl.wikipedia.org/wiki/Dekorator_(wzorzec_projektowy)">dekorator</a> to jeden ze strukturalnych wzorc贸w projektowych. Pozwala on na dynamiczne dodanie nowej funkcji do istniejcej klasy podczas dziaania programu.</p>
<p>W Pythonie, implementacja dekorator贸w dla metod po raz pierwszy zostaa dodana w wersji <strong>2.4</strong> jzyka, a dokument, kt贸ry to opisywa to <a href="https://www.python.org/dev/peps/pep-0318/">PEP 318 - Decorators for Functions and Methods</a> (<strong>PEP</strong> to skr贸t od <a href="https://www.python.org/dev/peps/">Python Enhancement Proposals</a>). W Pythonie <strong>3.0</strong>, wprowadzono natomiast mo偶liwo tworzenia dekorator贸w dla klas (opis w <a href="https://www.python.org/dev/peps/pep-3129/">PEP 3129 - Class Decorators</a>.</p>
<p>Zasada dziaania dekorator贸w polega na <strong>opakowaniu</strong> (tzw. <a href="https://pl.wikipedia.org/wiki/Enkapsulacja">enkapsulacji</a>) oryginalnej klasy, now klas, tzw. klas <strong>dekorujc</strong>.</p>
<p>Na czym polega opakowywanie? Najprociej por贸wna to do starej rosyjskiej zabawki, <a href="https://pl.wikipedia.org/wiki/Matrioszka">matrioszki</a>.</p>
<p><img alt="Matrioszka" src="../../images/posts/dekoratory-w-pythonie_matrioszka.jpg"></p>
<p>Jeli nie wiesz czym jest ta zabawka, to polecam zapozna si z poni偶szym filmikiem, bo zasada dziaania idealnie odzwierciedla mechanizm opakowywania (a jeli znasz t zabawk, tzn. 偶e zapewne jeste co najmniej tak stary jak ja |wink|).</p>
<div class="youtube-video"><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen frameborder="0" height="392" src="https://www.youtube.com/embed/lz6Olxb29qA" title="YouTube video player" width="696"></iframe></div>
<p>Jak wida Matrioszka, to zabawka, w kt贸rej mniejsze Matrioszki, umieszczane s w rodku wikszej. Mniejsza Matrioszka jest wtedy <em>enkapsulowana</em> w wikszej. Ta mniejsza Matrioszka to nasza klasa <strong>dekorowana</strong>, a wiksza to klasa <strong>dekorujca</strong>. Tak jak i w przypadku Matrioszek, tak i dekorator贸w mo偶e by wicej ni偶 jeden. Jedyna r贸偶nica pomidzy Matrioszk, a dekoratorem jest taka, 偶e Matrioszka to w zasadzie taka sama lalka jak jej mniejsza wersja (r贸偶ni si g贸wnie rozmiarem). Dekorator natomiast to zupenie inna klasa, kt贸ra dodaje nowe mo偶liwoci do ju偶 istniejcej klasy (Matrioszka tego nie potrafi).</p>
<p>Zauwa偶 jedn, bardzo istotn rzecz: wszdzie powy偶ej wspominam, 偶e dekorator jest klas <strong>opakowujc</strong> inn klas, a wspomniany PEP 318 m贸wi o dekorowaniu funkcji i metod. Czy przypadkiem nie ma tu gdzie bdu?</p>
<h2 id="funkcja-jest-obiektem">Funkcja jest obiektem</h2>
<p>Zanim przejdziemy do sedna, to zapoznajmy si z definicj <a href="https://pl.wikipedia.org/wiki/Obiekt_(programowanie_obiektowe)">obiektu</a>. Mocno streszczajc, obiekt to struktura zawierajca dane i metody/funkcje su偶ce do wykonania jakich operacji na tych danych. Bardzo szybko zauwa偶ymy, 偶e ten opis idealnie pasuje do <a href="https://pl.wikipedia.org/wiki/Klasa_(programowanie_obiektowe)">klasy</a>. Obiekt stworzony na podstawie definicji klasy, jest <em>instancj</em> danej klasy.</p>
<p>Dlaczego wic, w Pythonie m贸wimy o dekorowaniu funkcji lub metod danej klasy (kt贸re te偶 s funkcjami)? Ot贸偶 przyczyna jest bardzo prosta: funkcje w Pythonie s obiektami/klasami (nie zdziw si, bo od teraz bd u偶ywa tych nazw zamiennie). Jak ka偶dy obiekt w Pythonie, tak i funkcja ma sw贸j typ:</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">example_function</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Example"</span><span class="p">)</span>

<span class="nb">type</span><span class="p">(</span><span class="n">example_function</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">function</span>
</pre>
<p>Poniewa偶 funkcja jest obiektem, mo偶emy j przechowywa w zmiennej:</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">example_function</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Example"</span><span class="p">)</span>

<span class="n">var</span> <span class="o">=</span> <span class="n">example_function</span>

<span class="n">var</span><span class="p">()</span>
</pre>
<pre class="code literal-block"><span class="go">Example</span>
</pre>
<pre class="code literal-block"><span class="n">example_function</span><span class="p">()</span>
</pre>
<pre class="code literal-block"><span class="go">Example</span>
</pre>
<p>Zauwa偶, 偶e podczas przypisywania funkcji do zmiennej pominem nawiasy <code>()</code>. Pominicie nawias贸w powoduje, 偶e do zmiennej <code>var</code> przypisany jest adres w pamici, gdzie przechowywane jest kod funkcji. Dopiero wywoanie <code>var()</code> powoduje taki sam efekt jak bezporednie wywoanie funkcji <code>example_function()</code>.</p>
<p>Dodatkowo w ciele funkcji, mo偶na zdefiniowa inn funkcj. Funkcja wewntrzna nie bdzie jednak moga by wywoana spoza funkcji, w kt贸rej jest umieszczona:</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">external_function</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">internal_function</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Internal"</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">"External"</span><span class="p">)</span>
    <span class="n">internal_function</span><span class="p">()</span>

<span class="n">external_function</span><span class="p">()</span>
</pre>
<pre class="code literal-block"><span class="go">External</span>
<span class="go">Internal</span>
</pre>
<pre class="code literal-block"><span class="n">internal_function</span><span class="p">()</span>
</pre>
<pre class="code literal-block"><span class="go">Traceback (most recent call last):</span>
<span class="go">  File "/.../interactiveshell.py", line 3326, in run_code</span>
<span class="go">    exec(code_obj, self.user_global_ns, self.user_ns)</span>
<span class="go">  File "&lt;ipython-input-17-6f1c04ea4501&gt;", line 1, in &lt;module&gt;</span>
<span class="go">    internal_function()</span>
<span class="go">NameError: name 'internal_function' is not defined</span>
</pre>
<p>Widzimy, 偶e interpreter Pythona nie zna definicji funkcji <code>internal_function</code>.</p>
<p>Skoro ju偶 wiemy, 偶e funkcja jest obiektem, to ciekawe czy obiekt mo偶e by funkcj?</p>
<h2 id="czy-obiekt-moze-byc-funkcja">Czy obiekt mo偶e by funkcj?</h2>
<p>W Pythonie klasy posiadaj pewne <a href="https://docs.python.org/3/reference/datamodel.html#basic-customization">metody magiczne</a>. Jedn z nich jest metoda <code>__call__</code>. W przypadku klasy funkcja ta umo偶liwia uruchomienie instancji klasy, tak jak by bya funkcj:</p>
<pre class="code literal-block"><span class="k">class</span> <span class="nc">FuncClass</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
</pre>
<p>Powy偶ej widzisz klas, kt贸ra ma zaimplementowane 2 <em>metody magiczne</em>:</p>
<ul>
<li><code>__init__</code>, kt贸ra definiuje zmienn <code>var</code> jako pust list i wywoywana jest podczas inicjalizacji instancji klasy (<strong>uwaga</strong>, to nie jest konstruktor, cho wiele os贸b t metod tak okrela),</li>
<li><code>__call__</code>, kt贸ra przyjmuje jako argument wywoania dowolny <code>element</code> i dodanie go do listy w zmiennej <code>var</code>.</li>
</ul>
<p>Powy偶sza implementacja to nic skomplikowanego. Sprawd藕my zatem jak zachowuje si taka klasa.</p>
<pre class="code literal-block"><span class="n">f</span> <span class="o">=</span> <span class="n">FuncClass</span><span class="p">()</span>  <span class="c1"># Utworzenie instancji klasy</span>
<span class="n">f</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Wywoujemy bezporednio metod __call__ instancji f</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">var</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">[1]</span>
</pre>
<pre class="code literal-block"><span class="c1"># Tym razem odnosimy si do instancji f z pominiciem metody __call__</span>
<span class="c1"># (zostanie ona automatycznie wywoana przez interpreter)</span>

<span class="n">f</span><span class="p">(</span><span class="s2">"Drugi"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">var</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">[1, 'Drugi']</span>
</pre>
<p>Wida powy偶ej, 偶e klasa, mo偶e zachowywa si jak funkcja. Ka偶dy obiekt w jzyku Python, mo偶e (nie musi) mie zaimplementowan metod <code>__call__</code>. Skoro tak jest, to sprawd藕my czy normalna funkcja te偶 j ma. Wr贸my wic do naszej bardzo prostej funkcji:</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">example_function</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Example"</span><span class="p">)</span>
</pre>
<p>Wiemy ju偶, 偶e mo偶emy j wywoa poprzez <code>example_function()</code> co w wyniku spowoduje wywietlenie napisu <code>Example</code>. A co z metod <code>__call__</code>? Sprawd藕my:</p>
<pre class="code literal-block"><span class="n">example_function</span><span class="o">.</span><span class="fm">__call__</span><span class="p">()</span>
</pre>
<pre class="code literal-block"><span class="go">Example</span>
</pre>
<p>Udowodnilimy wanie, 偶e klasa mo偶e zachowywa si jak funkcja oraz, 偶e funkcja jest obiektem. Co prawda obiekt ten jest w pewien spos贸b ograniczony (nie da si do niego np. dynamicznie doda zmiennej lub odczyta zmiennych z ciaa funkcji), ale jednak jest obiektem.</p>
<p>Wr贸my jednak do dekorator贸w.</p>
<h2 id="pierwszy-dekorator">Pierwszy dekorator</h2>
<p>Na pocztku pisaem, 偶e dekorator to klasa, kt贸ra opakowuje inn klas dodajc do opakowywanej klasy now funkcjonalno. Skoro ju偶 wiemy, 偶e funkcja jest klas/obiektem to w Pythonie dekoratorem mo偶e by zar贸wno funkcja jak i klasa. Aby sobie nie utrudnia na pocztku, zacznijmy od implementacji dekoratora w postaci funkcji. Jednak, aby m贸c zaimplementowa dekorator, musimy mie co udekorowa. Rozpatrzmy zatem tak prost funkcj:</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">second</span><span class="p">)</span>
</pre>
<p>Powy偶sza funkcja ma za zadanie doda do siebie 2 elementy. Sprawd藕my wic jak dziaa:</p>
<pre class="code literal-block"><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">3</span>
</pre>
<p>Wszystko super. Wynik taki jak si spodziewalimy. Sprawd藕my zatem inny zestaw argument贸w:</p>
<pre class="code literal-block"><span class="n">add</span><span class="p">(</span><span class="s2">"1"</span><span class="p">,</span> <span class="s2">"2"</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">12</span>
</pre>
<p>Co? Jak to mo偶liwe, 偶e dostalimy <code>12</code>? Zauwa偶, 偶e jako argumenty podalimy tekst z cyframi 1 i 2, a nie liczby 1 i 2. Interpreter Pythona uzna, 偶e zamiast dodawania dw贸ch liczb, chcemy poczy dwa cigi znak贸w w jeden du偶szy cig znak贸w. Jak naprawi taki, kod nie zmieniajc ciaa funkcji <code>add</code>?</p>
<p>Wykorzystamy w tym celu dekorator. Zacznijmy jednak od kilku rzeczy, kt贸re pomog nam zrozumie jak w swoim wntrzu dziaa taki dekorator. Sprawd藕my jak dziaa poni偶szy kod:</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Decorated function name: </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">second</span><span class="p">)</span>

<span class="n">add</span> <span class="o">=</span> <span class="n">decorator</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">Decorated function name: add</span>
<span class="go">3</span>
</pre>
<p>Implementacji funkcja <code>decorator</code> jako argument przyjmuje ciao innej funkcji. Ma za zadnie wywietli jej nazw oraz po prostu j zwr贸ci.</p>
<p>Nastpnie wykorzystana zostaa waciwo, o kt贸rej pisaem powy偶ej, czyli mo偶liwoci przypisania funkcji do zmiennej (w tym przypadku funkcj <code>add</code> przypisujemy do zmiennej o tej samej nazwie, czyli r贸wnie偶 <code>add</code>). Takie przypisanie powoduje, 偶e zmienna <code>add</code> staje si funkcj, kt贸ra w pierwszej kolejnoci wywoa dekorator, kt贸rego argumentem bdzie rzeczywista funkcja <code>add</code>.</p>
<p>Niestety taki zapis jest mao czytelny i nie do koca wida (patrzc tylko na definicj funkcji <code>add</code>), 偶e zostaa ona udekorowana. W Pythonie na szczcie istnieje na to prosty spos贸b:</p>
<pre class="code literal-block"><span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">second</span><span class="p">)</span>

<span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">Decorated function name: add</span>
<span class="go">3</span>
</pre>
<p>Implementacj funkcji <code>decorator</code> pozostawiem bez zmian, natomiast funkcja <code>add</code> zostaa udekorowan. Su偶y do tego zapis <code>@decorator</code> tu偶 powy偶ej jej definicji.</p>
<p>Na kocu funkcja <code>add</code> zostaa wywoana z dwoma argumentami w taki sam spos贸b jak wczeniej.</p>
<p>W obu przypadkach wynikiem dziaania jest wywietlenie nazwy funkcji (cz za kt贸r odpowiedzialny jest dekorator) oraz wynik dodawania dw贸ch liczb (za to odpowiedzialna jest funkcja <code>add</code>, kt贸ra nie zostaa w 偶aden spos贸b zmodyfikowana).</p>
<p>Notacji z wykorzystaniem <code>@decorator</code>, jest tzw. <a href="https://pl.wikipedia.org/wiki/Lukier_sk%C5%82adniowy">syntactic sugar</a> dla poprzedniego zapisu <code>add = decorator(add)</code>.</p>
<p>Jeli u偶ywasz ju偶 Pythona od pewnego czasu, to powy偶szy zapis nie powinien by dla Ciebie zupenie obcy. Zapewne spotkae si z nim ju偶 nie raz, podczas tworzenia swoich wasnych klas, gdzie czsto wykorzystywane s m.in. nastpujce dekoratory:</p>
<ul>
<li><code>@classmethod</code></li>
<li><code>@staticmethod</code></li>
<li><code>@property</code></li>
</ul>
<h2 id="args-i-kwargs">args i kwargs</h2>
<p>Wiemy ju偶, jak stworzy prosty (jeszcze nic nie robicy) dekorator. Skoro do rodka dekoratora przekazujemy funkcj, to gdzie powinny by jeszcze widoczne wszystkie argumenty, kt贸re do danej funkcji s przekazywane w momencie jej wywoania. Rozwa偶my poni偶sz definicj dekoratora (implementacj funkcji <code>add</code> pomin, gdy偶 zao偶ylimy na pocztku, 偶e jej nie zmieniamy):</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"args (type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"kwargs (type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre>
<p>Do definicji wewntrznej funkcji <code>wrapper</code> dodaem dwa atrybuty:</p>
<ul>
<li><code>*args</code></li>
<li><code>**kwargs</code></li>
</ul>
<p>Zobaczmy teraz co si stanie jak wywoamy poni偶szy kod:</p>
<pre class="code literal-block"><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">args (type: &lt;class 'tuple'&gt;): (1, 2)</span>
<span class="go">kwargs (type: &lt;class 'dict'&gt;): {}</span>
</pre>
<p>Widzimy, 偶e argumenty przekazane do funkcji tworz zmienn <code>args</code> o typie <em>touple</em> (<em>krotka</em>), natomiast zmienn <code>kwargs</code> jest typu <em>dict</em> (<em>sownik</em>), ale jest to pusty sownik.</p>
<p>Co si stanie, jak wywoamy funkcj <code>add</code> w inny spos贸b:</p>
<pre class="code literal-block"><span class="n">add</span><span class="p">(</span><span class="n">first</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">*args (type: &lt;class 'tuple'&gt;): ()</span>
<span class="go">**kwargs (type: &lt;class 'dict'&gt;): {'first': 1, 'second': 2}</span>
</pre>
<p>Widzimy teraz, 偶e <code>args</code> jest puste, natomiast <code>kwargs</code> zostao wypenione.</p>
<p>Mo偶emy wywoa funkcj <code>add</code> r贸wnie偶 jako miks powy偶szych wywoa:</p>
<pre class="code literal-block"><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">*args (type: &lt;class 'tuple'&gt;): (1,)</span>
<span class="go">**kwargs (type: &lt;class 'dict'&gt;): {'second': 2}</span>
</pre>
<p>Teraz zar贸wno <code>args</code> jak i <code>kwargs</code> zostay wypenione.</p>
<p>Domylasz si ju偶 zapewne czym s <code>args</code> i <code>kwargs</code>, ale dla cisoci odpowiedzmy sobie na pytanie:</p>
<ul>
<li><code>*args</code> - nienazwane argumenty przekazywane do funkcji przyjmujce posta <em>krotki</em> ze wzgldu na zachowanie kolejnoci argument贸w</li>
<li><code>**kwargs</code> - nazwane argumenty przekazywane do funkcji przyjmujce posta <em>sownika</em> ze wzgldu na powizanie nazwy argumentu (<em>key</em>), z jej wartoci (<em>value</em>).</li>
</ul>
<p>Mo偶liwo przekazania argument贸w do funkcji przy u偶yciu <code>args</code> i <code>kwargs</code> niesie za sob pewne implikacje. Najwa偶niejsz implikacj jest konieczno obsu偶enia obu przypadk贸w w ciele dekoratora, jeli chcemy wykona jakie operacje na atrybutach przekazywanych do dekorowanej funkcji.</p>
<p>Wr贸my teraz do napisania dekoratora, kt贸ry ma za zadanie sprawdzi typ argument贸w przekazywanych do funkcji <code>add</code> tak, aby przeprowadzia dziaanie dodawania dw贸ch liczb.</p>
<p>Przyjmijmy najprostsze zao偶enie, 偶e aby funkcja zadziaaa poprawnie, argumenty funkcji musz by typu <em>int</em> lub <em>float</em>. W przypadku jeli dowolny z argument贸w, bdzie innym typem, funkcja nie zostanie uruchomiona i zostanie zwr贸cony wyjtek typu <em>TypeErrror</em>.</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Zmienna okrelajca czy typy argument贸w s poprawne</span>
        <span class="n">is_correct</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Utworzenie kopi listy argument贸w</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="c1"># Rozszerzenie listy argument贸w</span>
        <span class="n">arguments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
            <span class="c1"># Poni偶sze wyra偶enia zawiera w sobie dwie ciekawe</span>
            <span class="c1"># konstrukcje:</span>
            <span class="c1"># 1. tzw. short if sprawdzajcy czy podany argument jest</span>
            <span class="c1"># typu int lub float i zwracajcy odpowiedni warto</span>
            <span class="c1"># 2. operator mno偶enia z przypisaniem *= powoduje, 偶e gdy</span>
            <span class="c1"># cho jeden z atrybut贸w nie bdzie odpowiedniego typy</span>
            <span class="c1"># to zmienna is_correct przybierze warto False</span>
            <span class="n">is_correct</span> <span class="o">*=</span> <span class="kc">True</span> <span class="k">if</span> \
                <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="k">else</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">is_correct</span><span class="p">:</span>
            <span class="c1"># Przekazanie argument贸w do dekorowanej funkcji,</span>
            <span class="c1"># kt贸ra zostaje wywoana, a jej wynik zwr贸cony</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Zwr贸cenie wyjtku, gdy cho jeden atrybut przekazany do</span>
            <span class="c1"># funkcji nie jest typu int lub float</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"One of the arguments is not int or float"</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapper</span>

<span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">second</span><span class="p">)</span>
</pre>
<p>Mam nadziej, 偶e powy偶szy kod jest dla Ciebie zrozumiay (umieciem odpowiednie komentarze w samym kodzie, aby lepiej wyjani co on robi).</p>
<p>Jeli jednak masz problem ze zrozumieniem zapisu <code>is_correct *= True if any(isinstance(arg, t) for t in [int, float]) else False</code> poni偶ej umieszczam jego ekwiwalent:</p>
<pre class="code literal-block"><span class="n">is_correct_helper</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="n">is_correct_helper</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">is_correct</span> <span class="o">*=</span> <span class="n">is_correct_helper</span>
</pre>
<p>Zauwa偶 jednak, 偶e ten kawaek kodu wymaga wprowadzenia dodatkowej zmiennej pomocniczej <code>is_correct_helper</code> i nie jest tak zwizy jak wczeniejszy zapis, a kt贸rego bd u偶ywa w p贸藕niejszych przykadach.</p>
<p>Sprawd藕my teraz czy powy偶szy kod dziaa poprawnie dla argument贸w o poprawnych typach:</p>
<pre class="code literal-block"><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">3.0</span>
</pre>
<p>Wynik jest poprawny. A co jeli jeden z argument贸w bdzie cigiem znak贸w?</p>
<pre class="code literal-block"><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"2.0"</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">Traceback (most recent call last):</span>
<span class="go">  File "/.../interactiveshell.py", line 3326, in run_code</span>
<span class="go">    exec(code_obj, self.user_global_ns, self.user_ns)</span>
<span class="go">  File "&lt;ipython-input-2-fc0327af835d&gt;", line 20, in &lt;module&gt;</span>
<span class="go">    add(1, "2.0")</span>
<span class="go">  File "&lt;ipython-input-2-fc0327af835d&gt;", line 13, in wrapper</span>
<span class="go">    raise TypeError("One of the arguments is not int or float")</span>
<span class="go">TypeError: One of the arguments is not int or float</span>
</pre>
<p>Zgodnie z podejrzeniem wynikiem dziaania jest wyjtek typu <em>TypeError</em>, a wic taki jaki zakadalimy.</p>
<p>Widzimy wic, 偶e nasz dekorator dziaa tak jak tego oczekiwalimy, a nasza funkcja dekorowana (<code>add</code>) nie zostaa zmodyfikowana.</p>
<h2 id="wraps">wraps</h2>
<p>Rozwa偶my teraz inn kwesti, tzn. dokumentacj do naszego kodu. Do tej pory w naszym kodzie, nie ma ani jednej linijki opisujcej czym nasza dekorowana funkcja si zajmuje. Dodajmy najprostsz mo偶liw form dokumentacji czyli pojedyncz lini komentarza pod definicj funkcji (zauwa偶, 偶e pominem dodanie dekoratora):</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
    <span class="sd">"""Add to elements and print the result"""</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">second</span><span class="p">)</span>
</pre>
<p>Spr贸bujmy teraz wywoa jedn z metod, kt贸ra wykorzystywana jest przez narzdzia do budowania dokumentacji kodu, np. <a href="http://www.sphinx-doc.org/en/master/">Sphinx</a>.</p>
<pre class="code literal-block"><span class="nb">print</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">Add to elements and print the result</span>
</pre>
<p>Widzimy, 偶e poprzez wywoanie jednej z <em>metod magicznych</em> mo偶emy dosta si do naszego opisu funkcji. Sprawd藕my teraz co si stanie jak udekorujemy funkcj naszym dekoratorem:</p>
<pre class="code literal-block"><span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
    <span class="sd">"""Add to elements and print the result"""</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">second</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">None</span>
</pre>
<p>Dekorator wszystko nam popsu |disappointed|.</p>
<p>Dlaczego tak si dzieje? Ot贸偶 <code>add.__doc__</code> pobiera teraz opis nie z funkcji <code>add</code>, a z dekoratora.</p>
<p>Mo偶emy to rozwiza bardzo opatologicznie, ale poniewa偶 kto ju偶 o tym pomyla, to wykorzystamy gotow funkcj. Wchodzi ona w skad bibliotek standardowych i jest czci pakietu <a href="https://docs.python.org/2/library/functools.html">functools</a>. Zaimportujmy zatem funkcj <code>wraps</code> i jej u偶yjmy (funkcja <code>add</code> pozostaje bez zmian).</p>
<pre class="code literal-block"><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nd">@wraps</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">is_correct</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">arguments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
            <span class="n">is_correct</span> <span class="o">*=</span> <span class="kc">True</span> <span class="k">if</span> \
                <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="k">else</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">is_correct</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"One of the arguments is not int or float"</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapper</span>

<span class="nb">print</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre>
<pre class="code literal-block">Add to elements and print the result
</pre>
<p>Zauwa偶, 偶e funkcja ta zostaa wykorzystana do udekorowania funkcji wewntrznej naszego dekoratora i 偶e dokumentacja zostaa poprawnie wywietlona. Funkcja ta poprawia wywietlanie r贸wnie偶 innych wartoci, kt贸re nadpisywane s przez u偶ycie dekoratora, ale po wicej szczeg贸贸w odsyam do <a href="https://docs.python.org/3/library/functools.html#functools.wraps">dokumentacji</a>.</p>
<h2 id="dekorator-z-parametrami">Dekorator z parametrami</h2>
<p>A co gdybymy chcieli np. wymusi, aby dekorator (poza ju偶 istniejc implementacj) sprawdza, czy oba parametry byy tego samego typu? Musielibymy by w stanie przekaza do dekoratora jakie dodatkowy parametr. Skoro wiemy, 偶e dekorator jest funkcj, to by mo偶e dao by si do takiego dekoratora przekaza ten parametr jako argument funkcji? Sprawd藕my wic.</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">args_type_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># Dekorator z argumentem</span>
    <span class="k">def</span> <span class="nf">inner_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>  <span class="c1"># Wczeniejszy dekorator</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">is_correct</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="n">arguments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="c1"># Zmienna pomocnicza u偶yta podczas sprawdzania typ贸w,</span>
            <span class="c1"># kt贸ra przyjmuje przyjmuje list typ贸w przekazan do</span>
            <span class="c1"># dekoratora lub domyln list typ贸w</span>
            <span class="n">types_list</span> <span class="o">=</span> <span class="n">args_type_list</span> <span class="k">if</span> \
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">args_type_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
                <span class="c1"># Lista typ贸w zamieniona na zmienn pomocnicz</span>
                <span class="n">is_correct</span> <span class="o">*=</span> <span class="kc">True</span> <span class="k">if</span> \
                    <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">types_list</span><span class="p">)</span> \
                    <span class="k">else</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">is_correct</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Drobna modyfikacja</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"One of the arguments is not one type of: "</span>
                                <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">types_list</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapper</span>
    <span class="k">return</span> <span class="n">inner_decorator</span>
</pre>
<p>Wprowadzilimy tutaj dodatkowy poziom zagnie偶d偶enia oraz dokonalimy drobnej modyfikacji podczas sprawdzenia typ贸w (wszystkie zmiany opatrzone zostay komentarzem w kodzie).</p>
<p>Sprawd藕my teraz jak udekorowa nasz funkcj i jakie wyniki zostan wywietlone jak spr贸bujemy jej u偶y.</p>
<pre class="code literal-block"><span class="nd">@decorator</span><span class="p">([</span><span class="nb">int</span><span class="p">])</span>  <span class="c1"># Wywoanie dekoratora z parametrem</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
    <span class="sd">"""Add to elements and print the result"""</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">second</span><span class="p">)</span>

<span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">3</span>
</pre>
<p>Nic wielkiego, wszystko jest ok. A jak zmienimy typ jednego z argument贸w wywoania funkcji <code>add</code>?</p>
<pre class="code literal-block"><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">Traceback (most recent call last):</span>
<span class="go">  File "/.../interactiveshell.py", line 3326, in run_code</span>
<span class="go">    exec(code_obj, self.user_global_ns, self.user_ns)</span>
<span class="go">  File "&lt;ipython-input-2-7a51c39f1784&gt;", line 38, in &lt;module&gt;</span>
<span class="go">    add(1, 2.0)</span>
<span class="go">  File "&lt;ipython-input-2-7a51c39f1784&gt;", line 21, in wrapper</span>
<span class="go">    raise TypeError(f"One of the arguments is not one type of: "</span>
<span class="go">TypeError: One of the arguments is not one type of: [&lt;class 'int'&gt;]</span>
</pre>
<p>Super. Wynik spodziewany, poniewa偶 jeden z argument贸w jest typu <em>float</em>.</p>
<p>Niestety jeli spr贸bujemy teraz u偶y dekoratora bez parametr贸w czyli zamiast zapisu <code>decorator(...)</code> u偶yjemy <code>decorator</code> tak jak wczeniej, otrzymamy nastpujcy komunikat bdu:</p>
<pre class="code literal-block"><span class="go">Traceback (most recent call last):</span>
<span class="go">  File "/.../interactiveshell.py", line 3326, in run_code</span>
<span class="go">    exec(code_obj, self.user_global_ns, self.user_ns)</span>
<span class="go">  File "&lt;ipython-input-3-50502c662126&gt;", line 38, in &lt;module&gt;</span>
<span class="go">    add(1, 2.0)</span>
<span class="go">TypeError: inner_decorator() takes 1 positional argument but 2 were given</span>
</pre>
<p>Czy mo偶emy sobie z tym problemem jako poradzi?</p>
<p><img alt="This is Python !!!" src="../../images/posts/dekoratory-w-pythonie_this_is_python.jpg"></p>
<p>Oczywicie. Co ciekawe, taka modyfikacja wcale nie jest taka trudna do zrobienia. Wystarczy zmieni jedn linijk kodu w dekoratorze.</p>
<p>Przeprowad藕my wic wymagan modyfikacj oraz sprawd藕my stary zapis dekoratora wraz z wywoaniem udekorowanej funkcji:</p>
<pre class="code literal-block"><span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">args_type_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">inner_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">is_correct</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="n">arguments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="n">types_list</span> <span class="o">=</span> <span class="n">args_type_list</span> <span class="k">if</span> \
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">args_type_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
                <span class="n">is_correct</span> <span class="o">*=</span> <span class="kc">True</span> <span class="k">if</span> \
                    <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">types_list</span><span class="p">)</span> \
                    <span class="k">else</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">is_correct</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"One of the arguments is not one type of: "</span>
                                <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">types_list</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="c1"># Tutaj nastpuje zmiana tego, co przez dekorator jest zwracane</span>
    <span class="c1"># w zale偶noci od tego czy przeka偶emy argumenty do dekoratora czy nie</span>
    <span class="k">return</span> <span class="n">inner_decorator</span><span class="p">(</span><span class="n">args_type_list</span><span class="p">)</span> <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">args_type_list</span><span class="p">)</span> \
        <span class="k">else</span> <span class="n">inner_decorator</span>

<span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
    <span class="sd">"""Add to elements and print the result"""</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">second</span><span class="p">)</span>

<span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
</pre>
<pre class="code literal-block"><span class="go">3.0</span>
</pre>
<p>We wasnym zakresie sprawd藕 jeszcze czy przekazanie argument贸w do dekoratora r贸wnie偶 dziaa |wink|.</p>
<p>Dlaczego w og贸le taka modyfikacja bya potrzebna? Zauwa偶 czym r贸偶ni si oba zapisy dekoratora:</p>
<ol>
<li><code>decorator</code> - przekazanie adresu pamici do funkcji (pisaem o tym wczeniej)</li>
<li><code>decorator(...)</code> - wywoanie funkcji z parametrami</li>
</ol>
<p>Powy偶sze zapisy powoduj, 偶e do zmiennej <code>args_type_list</code> przypisane s zupenie inne wartoci:</p>
<ol>
<li><code>args_type_list</code> jest adresem dekorowanej funkcji (w naszym przypadku bdzie to <code>add</code></li>
<li><code>args_type_list</code> jest argumentem przekazanym do dekoratora (w naszym przypadku bdzie to lista typ贸w do przeprowadzenia weryfikacji)</li>
</ol>
<p>Dlatego te偶 musimy sprawdzi czy przekazywany argument jest funkcj czy nie. Do tego su偶y funkcja <code>callable()</code>.</p>
<p>A mo偶e dao by si to ciut prociej zrobi? Poza tym co z kwesti dokumentacji, itp.</p>
<h2 id="partial">partial</h2>
<p>Po raz kolejny z pomoc przychodzi nam biblioteka <code>functools</code>. Tym razem jednak skorzystamy jednoczenie z poznanej wczeniej funkcji <code>wraps</code> oraz nowej <a href="https://docs.python.org/3/library/functools.html#functools.partial">partial</a>. Sp贸jrzmy na poni偶szy kod (ponownie dekorowana funkcja <code>add</code> pozostaje bez zmian).</p>
<pre class="code literal-block"><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span><span class="p">,</span> <span class="n">partial</span>

<span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args_type_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># Poni偶szy if sprawdza czy argument func jest wywoaniem funkcji</span>
    <span class="c1"># czy zwykym argumentem (rozwinicie tego tematu w tekcie poni偶ej)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="n">decorator</span><span class="p">,</span>
                       <span class="n">args_type_list</span><span class="o">=</span><span class="n">args_type_list</span> <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">func</span><span class="p">)</span>

    <span class="c1"># Implementacja funkcji 'wrapper' pozostaje bez zmian</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">is_correct</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">arguments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="n">types_list</span> <span class="o">=</span> <span class="n">args_type_list</span> <span class="k">if</span> \
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">args_type_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
            <span class="n">is_correct</span> <span class="o">*=</span> <span class="kc">True</span> <span class="k">if</span> \
                <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">types_list</span><span class="p">)</span> \
                <span class="k">else</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">is_correct</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"One of the arguments is not one type of: "</span>
                            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">types_list</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre>
<p>Zauwa偶, 偶e przy u偶yciu funkcji <code>partial</code> kod uleg uproszczeniu, a funkcjonalno pozostaa bez zmian. Dodatkowo dziki wykorzystaniu dekoratora <code>wraps</code> dziaa dokumentacja, itp.</p>
<p>Uzupenijmy jeszcze jak dziaa funkcja <code>partial</code>. Jest to funkcja, kt贸ra jeli zostanie wywoana, zachowuje si jak funkcja, kt贸ra zostaa jej przekazana jako argument wywoania. Dodatkowo, nale偶y zwr贸ci uwag na to jakie parametry jej przekazujemy. Zwr贸 uwag, 偶e <code>args_type_list</code> mo偶e przyj jedn z 2 wartoci:</p>
<ul>
<li><code>func</code> - przekazujemy jeli wywoamy pusty dekorator (<code>@dekorator</code>) lub z parametrami jako <em>args</em> (<code>@dekorator([int])</code>)</li>
<li><code>args_type_list</code> - przekazujemy jeli wywoamy dekorator z parametrami jako <em>kwargs</em> (<code>@dekorator(args_type_list=[int])</code>)</li>
</ul>
<p>Dziaanie funkcji <code>partial</code> jest bardzo zbli偶one do dziaania dekoratora <code>@wraps</code>. Co ciekawsze, to dekorator ten jest w zasadzie inn form wywoania funkcji <code>partial</code> (w ramach wiczenia polecam przejrze we wasnym zakresie jak wyglda implementacja funkcji <code>wraps</code>).</p>
<h2 id="klasa-jako-dekorator">Klasa jako dekorator</h2>
<p>Skoro wczeniej udowodnilimy, 偶e funkcja jest obiektem oraz 偶e dekorator to funkcja, to mo偶e dao by si zmusi obiekt, aby sta si dekoratorem?</p>
<p>Jak ju偶 wczeniej ustalilimy <strong>THIS IS PYTHON !!!</strong> wic odpowied藕 powinna by oczywista |wink|.</p>
<p>Wczeniej pisaem, 偶e jeli w klasie zaimplementujemy funkcj <code>__call__</code> to obiekt, bdzie zachowywa si jak funkcja, a wic mo偶emy wykorzysta ten fakt do stworzenia dekoratora. Sprawd藕my jak wyglda by nasz dekorator, gdybymy zaimplementowali go przy u偶yciu klasy.</p>
<pre class="code literal-block"><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">update_wrapper</span>

<span class="k">class</span> <span class="nc">decorator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type_list</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="n">is_correct</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">arguments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
            <span class="n">is_correct</span> <span class="o">*=</span> <span class="kc">True</span> <span class="k">if</span> \
                <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type_list</span><span class="p">)</span> \
                <span class="k">else</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">is_correct</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"One of the arguments is not one type of: "</span>
                            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_type_list</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">"""Fill some internal variables and update wrapper so it will</span>
<span class="sd">        return decorated function properties (like __doc__, etc.)"""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_func</span> <span class="o">=</span> <span class="n">func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
        <span class="n">update_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_func</span><span class="p">)</span>
</pre>
<p>Powy偶szy kod jest odpowiednikiem dekoratora opisane we wczeniejszym punkcie. Na pierwszy rzut oka, taka implementacja wydaje si du偶o bardziej zagmatwana, ale umo偶liwia ona zastosowanie kilku innych ciekawych mechanizm贸w. Przykadem mo偶e by zastosowanie wzorca projektowego podobnego do Singletona (cho popularnie okrelany jest jako antywzorzec), czyli tzw. Borg (to materia&nbsp;na oddzielny wpis, kt贸ry ju偶 wkr贸tce bdzie dostpny na tym blogu), a wic mo偶e dziaa jak cache lub mie inne ciekawe waciwoci.</p>
<p>Analiz powy偶szego kodu oraz sprawdzenie poprawnoci jego dziaania zostawi w Twojej gestii.</p>
<h2 id="podsumowanie">Podsumowanie</h2>
<p>Jak wic widzisz, dekoratory to bardzo ciekawa konstrukcja w Pythonie. Umo偶liwiaj bardzo du偶o i pomimo, 偶e powy偶sze przykady byy stosunkowo proste, to miay za zadanie umo偶liwi Ci zrozumienie mechanizm贸w ich dziaania, a nie powodowa ataku paniki. Mam nadziej, 偶e udao mi si cho troch je odczarowa oraz, 偶e zaczniesz ich u偶ywa podczas pisania swojego kodu.</p>
</div>
<div class="col-md-6"><img src="../../images/page_lm/jak_zaczac_automatyzowac.jpg"></div>
<div class="col-md-6">
<form action="https://maciejkusz.activehosted.com/proc.php" id="_form_5_" method="post" name="_form_5_" novalidate=""><input name="u" type="hidden" value="5"><input name="f" type="hidden" value="5"><input name="s" type="hidden"><input name="c" type="hidden" value="0"><input name="m" type="hidden" value="0"><input name="act" type="hidden" value="sub"><input name="v" type="hidden" value="2">
<h3>Zapraszam do newslettera</h3>
<div class="_form-content">
<p>Jeli powy偶szy artyku uznajesz za wartociowy oraz masz ochot by informowany o nowociach na moim blogu, to zachcam Ci do zapisania si do mojego newslettera. Obiecuj, 偶e nie bd Ci spamowa, a tylko czasu do czasu wyl Ci powiadomienie o nowym artykule lub przel kr贸tkiego maila z ciekawymi informacjami.<br>
<strong>BONUS:</strong> Dodatkowo otrzymasz m贸j mini poradnik: <em>Jak zacz automatyzowa testy? Czyli 12 pyta i odpowiedzi, kt贸re w tym pomog</em></p>
<div class="input-group" id="basic-fullname-group"><span class="input-group-addon" id="basic-fullname">Imi</span> <input aria-describedby="basic-fullname" class="form-control" name="fullname" placeholder="Wpisz swoje imi" type="text"></div>
<div class="input-group" id="basic-lastname-group"><span class="input-group-addon" id="basic-lastname">Nazwisko</span> <input aria-describedby="basic-fullname" class="form-control" name="lastname" placeholder="Wpisz swoje nazwisko" type="text"></div>
<div class="input-group" id="basic-email-group"><span class="input-group-addon" id="basic-email">E-mail</span> <input aria-describedby="basic-email" class="form-control" name="email" placeholder="Wpisz sw贸j e-mail" required="" type="text"></div>
<button class="_submit btn btn-danger" id="_form_5_submit" style="margin-left: auto; margin-right: auto; display: block;" type="submit">Zapisz si</button>
<div class="_clear-element"></div>
</div>
<div class="_form-thank-you" style="display:none;"></div>
<p style="font-size: 10px; margin-top: 5px;">Wszystkie podane przez Ciebie dane, bd przetwarzane zgodnie z <a href="../../pages/polityka-prywatnosci">polityk prywatnoci</a>.</p>
</form>
<script type="text/javascript">
        window.cfields = [];
        window._show_thank_you = function(id, message, trackcmp_url) {
          var form = document.getElementById('_form_' + id + '_'), thank_you = form.querySelector('._form-thank-you');
          form.querySelector('._form-content').style.display = 'none';
          thank_you.innerHTML = message;
          thank_you.style.display = 'block';
          if (typeof(trackcmp_url) != 'undefined' && trackcmp_url) {
            // Site tracking URL to use after inline form submission.
            _load_script(trackcmp_url);
          }
          if (typeof window._form_callback !== 'undefined') window._form_callback(id);
        };
        window._show_error = function(id, message, html) {
          var form = document.getElementById('_form_' + id + '_'), err = document.createElement('div'), button = form.querySelector('button'), old_error = form.querySelector('._form_error');
          if (old_error) old_error.parentNode.removeChild(old_error);
          err.innerHTML = message;
          err.className = '_error-inner _form_error _no_arrow';
          var wrapper = document.createElement('div');
          wrapper.className = '_form-inner';
          wrapper.appendChild(err);
          button.parentNode.insertBefore(wrapper, button);
          document.querySelector('[id^="_form"][id$="_submit"]').disabled = false;
          if (html) {
            var div = document.createElement('div');
            div.className = '_error-html';
            div.innerHTML = html;
            err.appendChild(div);
          }
        };
        window._load_script = function(url, callback) {
            var head = document.querySelector('head'), script = document.createElement('script'), r = false;
            script.type = 'text/javascript';
            script.charset = 'utf-8';
            script.src = url;
            if (callback) {
              script.onload = script.onreadystatechange = function() {
              if (!r && (!this.readyState || this.readyState == 'complete')) {
                r = true;
                callback();
                }
              };
            }
            head.appendChild(script);
        };
        (function() {
          if (window.location.search.search("excludeform") !== -1) return false;
          var getCookie = function(name) {
            var match = document.cookie.match(new RegExp('(^|; )' + name + '=([^;]+)'));
            return match ? match[2] : null;
          }
          var setCookie = function(name, value) {
            var now = new Date();
            var time = now.getTime();
            var expireTime = time + 1000 * 60 * 60 * 24 * 365;
            now.setTime(expireTime);
            document.cookie = name + '=' + value + '; expires=' + now + ';path=/';
          }
              var addEvent = function(element, event, func) {
            if (element.addEventListener) {
              element.addEventListener(event, func);
            } else {
              var oldFunc = element['on' + event];
              element['on' + event] = function() {
                oldFunc.apply(this, arguments);
                func.apply(this, arguments);
              };
            }
          }
          var _removed = false;
          var form_to_submit = document.getElementById('_form_5_');
          var allInputs = form_to_submit.querySelectorAll('input, select, textarea'), tooltips = [], submitted = false;

          var getUrlParam = function(name) {
            var regexStr = '[\?&]' + name + '=([^&#]*)';
            var results = new RegExp(regexStr, 'i').exec(window.location.href);
            return results != undefined ? decodeURIComponent(results[1]) : false;
          };

          for (var i = 0; i < allInputs.length; i++) {
            var regexStr = "field\\[(\\d+)\\]";
            var results = new RegExp(regexStr).exec(allInputs[i].name);
            if (results != undefined) {
              allInputs[i].dataset.name = window.cfields[results[1]];
            } else {
              allInputs[i].dataset.name = allInputs[i].name;
            }
            var fieldVal = getUrlParam(allInputs[i].dataset.name);

            if (fieldVal) {
                    if (allInputs[i].dataset.autofill === "false") {
                        continue;
                    }
              if (allInputs[i].type == "radio" || allInputs[i].type == "checkbox") {
                if (allInputs[i].value == fieldVal) {
                  allInputs[i].checked = true;
                }
              } else {
                allInputs[i].value = fieldVal;
              }
            }
          }

          var remove_tooltips = function() {
            for (var i = 0; i < tooltips.length; i++) {
              tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
            }
              tooltips = [];
          };
          var remove_tooltip = function(elem) {
            for (var i = 0; i < tooltips.length; i++) {
              if (tooltips[i].elem === elem) {
                tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
                tooltips.splice(i, 1);
                return;
              }
            }
          };
          var create_tooltip = function(elem, text) {
            var tooltip = document.createElement('div'), arrow = document.createElement('div'), inner = document.createElement('div'), new_tooltip = {};
            if (elem.type != 'radio' && elem.type != 'checkbox') {
              tooltip.className = 'label label-danger';
              tooltip.innerHTML = text;
              elem.parentNode.parentNode.insertBefore(tooltip, elem.parentNode);
            } else {
              tooltip.className = '_error-inner _no_arrow';
              tooltip.innerHTML = text;
              elem.parentNode.insertBefore(tooltip, elem);
              new_tooltip.no_arrow = true;
            }
            new_tooltip.tip = tooltip;
            new_tooltip.elem = elem;
            tooltips.push(new_tooltip);
            return new_tooltip;
          };
          var resize_tooltip = function(tooltip) {
            var rect = tooltip.elem.getBoundingClientRect();
            var doc = document.documentElement, scrollPosition = rect.top - ((window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0));
            if (scrollPosition < 40) {
              tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/g, '') + ' _below';
            } else {
              tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/g, '') + ' _above';
            }
          };
          var resize_tooltips = function() {
            if (_removed) return;
            for (var i = 0; i < tooltips.length; i++) {
              if (!tooltips[i].no_arrow) resize_tooltip(tooltips[i]);
            }
          };
          var validate_field = function(elem, remove) {
            var tooltip = null, value = elem.value, no_error = true;
            remove ? remove_tooltip(elem) : false;
            if (elem.type != 'checkbox') elem.className = elem.className.replace(/ ?_has_error ?/g, '');
            if (elem.getAttribute('required') !== null) {
              if (elem.type == 'radio' || (elem.type == 'checkbox' && /any/.test(elem.className))) {
                var elems = form_to_submit.elements[elem.name];
                if (!(elems instanceof NodeList || elems instanceof HTMLCollection) || elems.length <= 1) {
                  no_error = elem.checked;
                }
                else {
                  no_error = false;
                  for (var i = 0; i < elems.length; i++) {
                    if (elems[i].checked) no_error = true;
                  }
                }
                if (!no_error) {
                  tooltip = create_tooltip(elem, "Wybierz opcj.");
                }
              } else if (elem.type =='checkbox') {
                var elems = form_to_submit.elements[elem.name], found = false, err = [];
                no_error = true;
                for (var i = 0; i < elems.length; i++) {
                  if (elems[i].getAttribute('required') === null) continue;
                  if (!found && elems[i] !== elem) return true;
                  found = true;
                  elems[i].className = elems[i].className.replace(/ ?_has_error ?/g, '');
                  if (!elems[i].checked) {
                    no_error = false;
                    elems[i].className = elems[i].className + ' _has_error';
                    err.push("Zaznaczenie %s jest wymagane".replace("%s", elems[i].value));
                  }
                }
                if (!no_error) {
                  tooltip = create_tooltip(elem, err.join('<br/>'));
                }
              } else if (elem.tagName == 'SELECT') {
                var selected = true;
                if (elem.multiple) {
                  selected = false;
                  for (var i = 0; i < elem.options.length; i++) {
                    if (elem.options[i].selected) {
                      selected = true;
                      break;
                    }
                  }
                } else {
                  for (var i = 0; i < elem.options.length; i++) {
                    if (elem.options[i].selected && !elem.options[i].value) {
                      selected = false;
                    }
                  }
                }
                if (!selected) {
                  elem.className = elem.className + ' _has_error';
                  no_error = false;
                  tooltip = create_tooltip(elem, "Wybierz opcj.");
                }
              } else if (value === undefined || value === null || value === '') {
                elem.className = elem.className + ' _has_error';
                no_error = false;
                tooltip = create_tooltip(elem, "To pole jest wymagane.");
              }
            }
            if (no_error && elem.name == 'email') {
              if (!value.match(/^[\+_a-z0-9-'&=]+(\.[\+_a-z0-9-']+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/i)) {
                elem.className = elem.className + ' _has_error';
                no_error = false;
                tooltip = create_tooltip(elem, "Wpisz poprawny adres e-mail.");
              }
            }
            if (no_error && /date_field/.test(elem.className)) {
              if (!value.match(/^\d\d\d\d-\d\d-\d\d$/)) {
                elem.className = elem.className + ' _has_error';
                no_error = false;
                tooltip = create_tooltip(elem, "Wpisz poprawn dat.");
              }
            }
            tooltip ? resize_tooltip(tooltip) : false;
            return no_error;
          };
          var needs_validate = function(el) {
            return el.name == 'email' || el.getAttribute('required') !== null;
          };
          var validate_form = function(e) {
            var err = form_to_submit.querySelector('._form_error'), no_error = true;
            if (!submitted) {
              submitted = true;
              for (var i = 0, len = allInputs.length; i < len; i++) {
                var input = allInputs[i];
                if (needs_validate(input)) {
                  if (input.type == 'text') {
                    addEvent(input, 'blur', function() {
                      this.value = this.value.trim();
                      validate_field(this, true);
                    });
                    addEvent(input, 'input', function() {
                      validate_field(this, true);
                    });
                  } else if (input.type == 'radio' || input.type == 'checkbox') {
                    (function(el) {
                      var radios = form_to_submit.elements[el.name];
                      for (var i = 0; i < radios.length; i++) {
                        addEvent(radios[i], 'click', function() {
                          validate_field(el, true);
                        });
                      }
                    })(input);
                  } else if (input.tagName == 'SELECT') {
                    addEvent(input, 'change', function() {
                      validate_field(this, true);
                    });
                  } else if (input.type == 'textarea'){
                    addEvent(input, 'input', function() {
                      validate_field(this, true);
                    });
                  }
                }
              }
            }
            remove_tooltips();
            for (var i = 0, len = allInputs.length; i < len; i++) {
              var elem = allInputs[i];
              if (needs_validate(elem)) {
                if (elem.tagName.toLowerCase() !== "select") {
                  elem.value = elem.value.trim();
                }
                validate_field(elem) ? true : no_error = false;
              }
            }
            if (!no_error && e) {
              e.preventDefault();
            }
            resize_tooltips();
            return no_error;
          };
          addEvent(window, 'resize', resize_tooltips);
          addEvent(window, 'scroll', resize_tooltips);
          window._old_serialize = null;
          if (typeof serialize !== 'undefined') window._old_serialize = window.serialize;
          _load_script("//d3rxaij56vjege.cloudfront.net/form-serialize/0.3/serialize.min.js", function() {
            window._form_serialize = window.serialize;
            if (window._old_serialize) window.serialize = window._old_serialize;
          });
          var form_submit = function(e) {
            e.preventDefault();
            if (validate_form()) {
              // use this trick to get the submit button & disable it using plain javascript
              document.querySelector('#_form_5_submit').disabled = true;
                    var serialized = _form_serialize(document.getElementById('_form_5_'));
              var err = form_to_submit.querySelector('._form_error');
              err ? err.parentNode.removeChild(err) : false;
              _load_script('https://maciejkusz.activehosted.com/proc.php?' + serialized + '&jsonp=true');
            }
            return false;
          };
          addEvent(form_to_submit, 'submit', form_submit);
        })();

</script></div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../categories/dekorator/" rel="tag">dekorator</a></li>
<li><a class="tag p-category" href="../../categories/funkcje/" rel="tag">funkcje</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../dlaczego-nie-bedziesz-testerem-i-co-mozesz-z-tym-fantem-zrobic-jesli-bardzo-chcesz/" rel="prev" title="Dlaczego nie bdziesz testerem i co mo偶esz z tym fantem zrobi jeli bardzo chcesz?">Poprzedni post</a></li>
<li class="next"><a href="../jak-dorobic-do-etatu-czyli-tester-tworzy-rpa/" rel="next" title="Jak dorobi do etatu, czyli tester tworzy RPA">Nastpny post</a></li>
</ul>
</nav>
</aside>
<section class="comments hidden-print">
<h2>Komentarze</h2>
<div id="disqus_thread"></div>
<script>
        var disqus_shortname ="testerembyc",
            disqus_url="https://testerembyc.pl/posts/dekoratory-w-pythonie/",
        disqus_title="Dekoratory w Pythonie",
        disqus_identifier="cache/posts/dekoratory-w-pythonie.html",
        disqus_config = function () {
            this.language = "pl";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> <a class="dsq-brlink" href="https://disqus.com" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a></section>
</article>
<script>
var disqus_shortname="testerembyc";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());
</script></div>
<div class="col-sm-3 blog-sidebar">
<div class="sidebar-module sidebar-module-inset">
<form action="https://www.google.com/search" method="get" role="search"><input name="cx" type="hidden" value="013548426528546093847:kxj9yxvrzlu"><input name="ie" type="hidden" value="utf-8"><input name="hl" type="hidden" value="pl">
<div class="input-group"><input aria-describedby="basic-search" class="form-control" name="q" placeholder="Szukaj" type="text">
<div class="input-group-btn"><button class="btn btn-danger" type="submit"><span class="glyphicon glyphicon-search" id="basic-search"></span></button></div>
</div>
<input name="sitesearch" type="hidden" value="testerembyc"></form>
</div>
<div class="sidebar-module sidebar-module-inset">
<h3>Darmowy poradnik</h3>
<a href="../../pages/jak-zaczac-automatyzowac-testy/"><img src="../../images/page_lm/jak_zaczac_automatyzowac_small.jpg"></a>
<p><strong>Jak zacz automatyzowa testy?</strong></p>
<p>Poznaj 12 pyta, kt贸re pomog Ci rozpocz proces automatyzacji test贸w. W zupenym oderwaniu od jzyka programowania, framework贸w do test贸w oraz technologi w jakiej napisana zostaa aplikacja, kt贸r bdziesz testowa. Cao opisana prostym i zrozumiaym jzykiem.</p>
<p style="text-align: center"><a class="_submit btn btn-danger" href="../../pages/jak-zaczac-automatyzowac-testy/">Pobieram poradnik</a></p>
</div>
<div class="sidebar-module sidebar-module-inset">
<h3>O mnie</h3>
<a href="../../pages/o-mnie/"><img src="../../images/me_bw_small.jpg"></a>
<p>Nazywam si <strong>Maciej Kusz</strong> i od 2008 roku zajmuj si testowaniem oprogramowania. Na pocztku byy to testy manualne, od 2011 pocztki test贸w automatycznych, a od 2013 automatyzacj test贸w z wykorzystaniem <strong>Pythona</strong>. Przez te kilka lat, zdarzyo mi si ju偶 by w kilku firmach i w kilku r贸偶nych projektach. Na stronie <a href="../../pages/o-mnie/">o mnie</a>, znajdujdziesz ciut wicej informacji na ten temat.</p>
</div>
<div class="sidebar-module sidebar-module-inset">
<form action="https://maciejkusz.activehosted.com/proc.php" id="_form_3_" method="post" name="_form_3_" novalidate=""><input name="u" type="hidden" value="3"><input name="f" type="hidden" value="3"><input name="s" type="hidden"><input name="c" type="hidden" value="0"><input name="m" type="hidden" value="0"><input name="act" type="hidden" value="sub"><input name="v" type="hidden" value="2">
<h3>Newsletter</h3>
<div class="_form-content">
<p>Chcesz by powiadamiany o nowociach na tej stronie oraz innych moich projektach?</p>
<p>Jeli tak, to zapisz si poni偶ej do newsletter'a.</p>
<div class="input-group" id="basic-fullname-group"><span class="input-group-addon" id="basic-fullname">Imi</span> <input aria-describedby="basic-fullname" class="form-control" name="fullname" placeholder="Wpisz swoje imi" type="text"></div>
<div class="input-group" id="basic-lastname-group"><span class="input-group-addon" id="basic-lastname">Nazwisko</span> <input aria-describedby="basic-fullname" class="form-control" name="lastname" placeholder="Wpisz swoje nazwisko" type="text"></div>
<div class="input-group" id="basic-email-group"><span class="input-group-addon" id="basic-email">E-mail</span> <input aria-describedby="basic-email" class="form-control" name="email" placeholder="Wpisz sw贸j e-mail" required="" type="text"></div>
<button class="_submit btn btn-danger" id="_form_3_submit" style="margin-left: auto; margin-right: auto; display: block;" type="submit">Zapisz si</button>
<div class="_clear-element"></div>
</div>
<div class="_form-thank-you" style="display:none;"></div>
<p style="font-size: 10px; margin-top: 5px;">Wszystkie podane przez Ciebie dane, bd przetwarzane zgodnie z <a href="../../pages/polityka-prywatnosci">polityk prywatnoci</a>.</p>
</form>
<script type="text/javascript">
window.cfields = [];
window._show_thank_you = function(id, message, trackcmp_url) {
  var form = document.getElementById('_form_' + id + '_'), thank_you = form.querySelector('._form-thank-you');
  form.querySelector('._form-content').style.display = 'none';
  thank_you.innerHTML = message;
  thank_you.style.display = 'block';
  if (typeof(trackcmp_url) != 'undefined' && trackcmp_url) {
    // Site tracking URL to use after inline form submission.
    _load_script(trackcmp_url);
  }
  if (typeof window._form_callback !== 'undefined') window._form_callback(id);
};
window._show_error = function(id, message, html) {
  var form = document.getElementById('_form_' + id + '_'), err = document.createElement('div'), button = form.querySelector('button'), old_error = form.querySelector('._form_error');
  if (old_error) old_error.parentNode.removeChild(old_error);
  err.innerHTML = message;
  err.className = '_error-inner _form_error _no_arrow';
  var wrapper = document.createElement('div');
  wrapper.className = '_form-inner';
  wrapper.appendChild(err);
  button.parentNode.insertBefore(wrapper, button);
  document.querySelector('[id^="_form"][id$="_submit"]').disabled = false;
  if (html) {
    var div = document.createElement('div');
    div.className = '_error-html';
    div.innerHTML = html;
    err.appendChild(div);
  }
};
window._load_script = function(url, callback) {
    var head = document.querySelector('head'), script = document.createElement('script'), r = false;
    script.type = 'text/javascript';
    script.charset = 'utf-8';
    script.src = url;
    if (callback) {
      script.onload = script.onreadystatechange = function() {
      if (!r && (!this.readyState || this.readyState == 'complete')) {
        r = true;
        callback();
        }
      };
    }
    head.appendChild(script);
};
(function() {
  if (window.location.search.search("excludeform") !== -1) return false;
  var getCookie = function(name) {
    var match = document.cookie.match(new RegExp('(^|; )' + name + '=([^;]+)'));
    return match ? match[2] : null;
  }
  var setCookie = function(name, value) {
    var now = new Date();
    var time = now.getTime();
    var expireTime = time + 1000 * 60 * 60 * 24 * 365;
    now.setTime(expireTime);
    document.cookie = name + '=' + value + '; expires=' + now + ';path=/';
  }
      var addEvent = function(element, event, func) {
    if (element.addEventListener) {
      element.addEventListener(event, func);
    } else {
      var oldFunc = element['on' + event];
      element['on' + event] = function() {
        oldFunc.apply(this, arguments);
        func.apply(this, arguments);
      };
    }
  }
  var _removed = false;
  var form_to_submit = document.getElementById('_form_3_');
  var allInputs = form_to_submit.querySelectorAll('input, select, textarea'), tooltips = [], submitted = false;

  var getUrlParam = function(name) {
    var regexStr = '[\?&]' + name + '=([^&#]*)';
    var results = new RegExp(regexStr, 'i').exec(window.location.href);
    return results != undefined ? decodeURIComponent(results[1]) : false;
  };

  for (var i = 0; i < allInputs.length; i++) {
    var regexStr = "field\[(\d+)\]";
    var results = new RegExp(regexStr).exec(allInputs[i].name);
    if (results != undefined) {
      allInputs[i].dataset.name = window.cfields[results[1]];
    } else {
      allInputs[i].dataset.name = allInputs[i].name;
    }
    var fieldVal = getUrlParam(allInputs[i].dataset.name);

    if (fieldVal) {
      if (allInputs[i].type == "radio" || allInputs[i].type == "checkbox") {
        if (allInputs[i].value == fieldVal) {
          allInputs[i].checked = true;
        }
      } else {
        allInputs[i].value = fieldVal;
      }
    }
  }

  var remove_tooltips = function() {
    for (var i = 0; i < tooltips.length; i++) {
      tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
    }
      tooltips = [];
  };
  var remove_tooltip = function(elem) {
    for (var i = 0; i < tooltips.length; i++) {
      if (tooltips[i].elem === elem) {
        tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
        tooltips.splice(i, 1);
        return;
      }
    }
  };
  var create_tooltip = function(elem, text) {
    var tooltip = document.createElement('label'), arrow = document.createElement('div'), inner = document.createElement('div'), new_tooltip = {};
    if (elem.type != 'radio' && elem.type != 'checkbox') {
      tooltip.className = 'label label-danger';
      tooltip.innerHTML = text;
      elem.parentNode.parentNode.insertBefore(tooltip, elem.parentNode);
    } else {
      tooltip.className = '_error-inner _no_arrow';
      tooltip.innerHTML = text;
      elem.parentNode.insertBefore(tooltip, elem);
      new_tooltip.no_arrow = true;
    }
    new_tooltip.tip = tooltip;
    new_tooltip.elem = elem;
    tooltips.push(new_tooltip);
    return new_tooltip;
  };
  var resize_tooltip = function(tooltip) {
    var rect = tooltip.elem.getBoundingClientRect();
    var doc = document.documentElement, scrollPosition = rect.top - ((window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0));
    if (scrollPosition < 40) {
      tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/g, '') + ' _below';
    } else {
      tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/g, '') + ' _above';
    }
  };
  var resize_tooltips = function() {
    if (_removed) return;
    for (var i = 0; i < tooltips.length; i++) {
      if (!tooltips[i].no_arrow) resize_tooltip(tooltips[i]);
    }
  };
  var validate_field = function(elem, remove) {
    var tooltip = null, value = elem.value, no_error = true;
    remove ? remove_tooltip(elem) : false;
    if (elem.type != 'checkbox') elem.className = elem.className.replace(/ ?_has_error ?/g, '');
    if (elem.getAttribute('required') !== null) {
      if (elem.type == 'radio' || (elem.type == 'checkbox' && /any/.test(elem.className))) {
        var elems = form_to_submit.elements[elem.name];
        if (!(elems instanceof NodeList || elems instanceof HTMLCollection) || elems.length <= 1) {
          no_error = elem.checked;
        }
        else {
          no_error = false;
          for (var i = 0; i < elems.length; i++) {
            if (elems[i].checked) no_error = true;
          }
        }
        if (!no_error) {
          tooltip = create_tooltip(elem, "Wybierz opcj.");
        }
      } else if (elem.type =='checkbox') {
        var elems = form_to_submit.elements[elem.name], found = false, err = [];
        no_error = true;
        for (var i = 0; i < elems.length; i++) {
          if (elems[i].getAttribute('required') === null) continue;
          if (!found && elems[i] !== elem) return true;
          found = true;
          elems[i].className = elems[i].className.replace(/ ?_has_error ?/g, '');
          if (!elems[i].checked) {
            no_error = false;
            elems[i].className = elems[i].className + ' _has_error';
            err.push("Zaznaczenie %s jest wymagane".replace("%s", elems[i].value));
          }
        }
        if (!no_error) {
          tooltip = create_tooltip(elem, err.join('<br/>'));
        }
      } else if (elem.tagName == 'SELECT') {
        var selected = true;
        if (elem.multiple) {
          selected = false;
          for (var i = 0; i < elem.options.length; i++) {
            if (elem.options[i].selected) {
              selected = true;
              break;
            }
          }
        } else {
          for (var i = 0; i < elem.options.length; i++) {
            if (elem.options[i].selected && !elem.options[i].value) {
              selected = false;
            }
          }
        }
        if (!selected) {
          elem.className = elem.className + ' _has_error';
          no_error = false;
          tooltip = create_tooltip(elem, "Wybierz opcj.");
        }
      } else if (value === undefined || value === null || value === '') {
        elem.className = elem.className + ' _has_error';
        no_error = false;
        tooltip = create_tooltip(elem, "To pole jest wymagane.");
      }
    }
    if (no_error && elem.name == 'email') {
      if (!value.match(/^[\+_a-z0-9-'&=]+(\.[\+_a-z0-9-']+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/i)) {
        elem.className = elem.className + ' _has_error';
        no_error = false;
        tooltip = create_tooltip(elem, "Wpisz poprawny adres e-mail.");
      }
    }
    if (no_error && /date_field/.test(elem.className)) {
      if (!value.match(/^\d\d\d\d-\d\d-\d\d$/)) {
        elem.className = elem.className + ' _has_error';
        no_error = false;
        tooltip = create_tooltip(elem, "Wpisz poprawn dat.");
      }
    }
    tooltip ? resize_tooltip(tooltip) : false;
    return no_error;
  };
  var needs_validate = function(el) {
    return el.name == 'email' || el.getAttribute('required') !== null;
  };
  var validate_form = function(e) {
    var err = form_to_submit.querySelector('._form_error'), no_error = true;
    if (!submitted) {
      submitted = true;
      for (var i = 0, len = allInputs.length; i < len; i++) {
        var input = allInputs[i];
        if (needs_validate(input)) {
          if (input.type == 'text') {
            addEvent(input, 'blur', function() {
              this.value = this.value.trim();
              validate_field(this, true);
            });
            addEvent(input, 'input', function() {
              validate_field(this, true);
            });
          } else if (input.type == 'radio' || input.type == 'checkbox') {
            (function(el) {
              var radios = form_to_submit.elements[el.name];
              for (var i = 0; i < radios.length; i++) {
                addEvent(radios[i], 'click', function() {
                  validate_field(el, true);
                });
              }
            })(input);
          } else if (input.tagName == 'SELECT') {
            addEvent(input, 'change', function() {
              validate_field(this, true);
            });
          } else if (input.type == 'textarea'){
            addEvent(input, 'input', function() {
              validate_field(this, true);
            });
          }
        }
      }
    }
    remove_tooltips();
    for (var i = 0, len = allInputs.length; i < len; i++) {
      var elem = allInputs[i];
      if (needs_validate(elem)) {
        if (elem.tagName.toLowerCase() !== "select") {
          elem.value = elem.value.trim();
        }
        validate_field(elem) ? true : no_error = false;
      }
    }
    if (!no_error && e) {
      e.preventDefault();
    }
    resize_tooltips();
    return no_error;
  };
  addEvent(window, 'resize', resize_tooltips);
  addEvent(window, 'scroll', resize_tooltips);
  window._old_serialize = null;
  if (typeof serialize !== 'undefined') window._old_serialize = window.serialize;
  _load_script("//d3rxaij56vjege.cloudfront.net/form-serialize/0.3/serialize.min.js", function() {
    window._form_serialize = window.serialize;
    if (window._old_serialize) window.serialize = window._old_serialize;
  });
  var form_submit = function(e) {
    e.preventDefault();
    if (validate_form()) {
      // use this trick to get the submit button & disable it using plain javascript
      document.querySelector('#_form_3_submit').disabled = true;
            var serialized = _form_serialize(document.getElementById('_form_3_'));
      var err = form_to_submit.querySelector('._form_error');
      err ? err.parentNode.removeChild(err) : false;
      _load_script('https://maciejkusz.activehosted.com/proc.php?' + serialized + '&jsonp=true');
    }
    return false;
  };aw
  addEvent(form_to_submit, 'submit', form_submit);
})();

</script></div>
<div class="sidebar-module sidebar-module-inset">
<h3>Linki</h3>
<ol class="list-unstyled">
<li><a href="../../pages/polityka-prywatnosci/">Polityka prywatnoci</a></li>
<li><a href="../../pages/regulamin/">Regulamin</a></li>
</ol>
<ol class="list-unstyled icons">
<li><a class="fas fa-at" href="mailto:maciej@testerembyc.pl" target="_bland"></a></li>
<li><a class="fab fa-facebook" href="https://www.facebook.com/testerembyc/" target="_blank"></a></li>
<li><a class="fab fa-instagram" href="https://www.instagram.com/testerembyc/" target="_blank"></a></li>
<li><a class="fab fa-linkedin" href="https://www.linkedin.com/in/maciej-kusz/" target="_blank"></a></li>
<li><a class="fab fa-youtube" href="https://www.youtube.com/channel/UCm3xa7IkyYBFSZrisCBx53A" target="_blank"></a></li>
</ol>
</div>
</div>
<!--End of body content--></div>
</div>
<footer class="blog-footer" id="footer">漏 2021 <span style="font-weight: bold; color: #ffffff;">Maciej Kusz</span> w oparciu o silnik <a href="https://getnikola.com/" rel="nofollow" target="_blank"><img src="../../images/nikola_logo.svg" style="max-height: 20px; max-width: 50px"></a> z wykorzystaniem <a href="https://pages.github.com/" rel="nofollow" target="_blank"><img src="../../images/githubpages_logo.svg" style="max-height: 15px; max-width: 80px;"></a></footer>
</div>
</div>
<script type="text/javascript">
/*
 * Bootstrap Cookie Alert by Wruczek
 * https://github.com/Wruczek/Bootstrap-Cookie-Alert
 * Released under MIT license
 */
(function () {
    "use strict";

    var cookieAlert = document.querySelector(".cookiealert");
    var acceptCookies = document.querySelector(".acceptcookies");

    if (!cookieAlert) {
       return;
    }


    // Show the alert if we cant find the "acceptCookies" cookie
    if (!getCookie("acceptCookies")) {
        cookieAlert.classList.add("show");
    } else {
        cookieAlert.classList.remove("show")
    }

    // When clicking on the agree button, create a 1 year
    // cookie to remember user's choice and close the banner
    acceptCookies.addEventListener("click", function () {
        setCookie("acceptCookies", true, 365);
        cookieAlert.classList.remove("show");
    });

    // Cookie functions from w3schools
    function setCookie(cname, cvalue, exdays) {
        var d = new Date();
        d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
        var expires = "expires=" + d.toUTCString();
        document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }

    function getCookie(cname) {
        var name = cname + "=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var ca = decodedCookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) === ' ') {
                c = c.substring(1);
            }
            if (c.indexOf(name) === 0) {
                return c.substring(name.length, c.length);
            }
        }
        return "";
    }
})();
</script>
<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/bootstrap.min.js"></script>
<script src="../../assets/js/baguetteBox.min.js"></script>
<script src="../../assets/js/fancydates.min.js"></script><!-- fancy dates -->
<script>

    moment.locale("pl");
    fancydates(0, "YYYY-MM-DD HH:mm");
</script><!-- end fancy dates -->
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-143859058-1"></script>
<script>

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-143859058-1');
</script><!-- Load Facebook SDK for JavaScript -->
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      xfbml            : true,
      version          : 'v3.3'
    });
  };

  (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = 'https://connect.facebook.net/pl_PL/sdk/xfbml.customerchat.js';
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script><!-- Your customer chat code -->
<div attribution="setup_tool" class="fb-customerchat" logged_in_greeting="Witaj! Jeli chcesz dowiedzie si czego wicej, to zapraszam do rozmowy ;)" logged_out_greeting="Witaj! Jeli chcesz dowiedzie si czego wicej, to zapraszam do rozmowy ;)" page_id="391052181505294" theme_color="#337ab7"></div>
<!-- Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '444619046317574');
  fbq('track', 'PageView');
</script><noscript><img alt="Facebook Pixel" height="1" src="https://www.facebook.com/tr?id=444619046317574&amp;ev=PageView&amp;noscript=1" style="display:none" width="1"></noscript> <!-- End Facebook Pixel Code -->
</body>
</html>
