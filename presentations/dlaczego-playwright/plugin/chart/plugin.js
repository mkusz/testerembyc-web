window.RevealChart=window.RevealChart||{id:"RevealChart",init:function(deck){initChart(deck)},update:function(canvas,idx,data){update(canvas,idx,data)}};let initChart=function(Reveal){function mergeRecursive(obj1,obj2){for(var p in obj2)try{null!==obj1[p]&&"object"==typeof obj1[p]&&"object"==typeof obj2[p]?obj1[p]=mergeRecursive(obj1[p],obj2[p]):obj1[p]=obj2[p]}catch(e){obj1[p]=obj2[p]}return obj1}function createChart(canvas,CSV,comments){canvas.chart=null;var ctx=canvas.getContext("2d"),chartOptions={responsive:!0,maintainAspectRatio:!1},chartData={labels:null,datasets:[]};if(null!==comments)for(var j=0;j<comments.length;j++)comments[j]=comments[j].replace(/<!--/,""),comments[j]=comments[j].replace(/-->/,""),(config=(str=>{var json;try{json=JSON.parse(str)}catch(e){return null}return json})(comments[j]))&&(config.data&&mergeRecursive(chartData,config.data),config.options)&&mergeRecursive(chartOptions,config.options);var lines=CSV.split("\n").filter(function(v){return""!==v});null===chartData.labels&&0<lines.length&&(chartData.labels=lines[0].split(","),chartData.labels.shift(),lines.shift());for(var config,j=0;j<lines.length;j++){chartData.datasets.length<=j&&(chartData.datasets[j]={}),chartData.datasets[j].data=lines[j].split(","),chartData.datasets[j].label=chartData.datasets[j].data[0],chartData.datasets[j].data.shift();for(var k=0;k<chartData.datasets[j].data.length;k++)chartData.datasets[j].data[k]=Number(chartData.datasets[j].data[k])}if(config=chartConfig[canvas.getAttribute("data-chart")])for(j=0;j<chartData.datasets.length;j++)for(var attrname in config)chartData.datasets[j][attrname]||(chartData.datasets[j][attrname]=config[attrname][j%config[attrname].length]);canvas.chart=new Chart(ctx,{type:canvas.getAttribute("data-chart"),data:chartData,options:chartOptions})}function recreateChart(canvas){var data=canvas.chart.data.datasets;canvas.chart.data.datasets=[],canvas.chart.update(),canvas.style.visibility="hidden",setTimeout(function(canvas,data){canvas.chart.data.datasets=data,canvas.style.visibility="visible",canvas.chart.update()},500,canvas,data)}var chartConfig=Reveal.getConfig().chart||{},config=chartConfig.defaults;return config&&mergeRecursive(Chart.defaults,config),Reveal.addEventListener("ready",function(){for(var canvases=document.querySelectorAll("canvas"),i=0;i<canvases.length;i++)if(canvases[i].hasAttribute("data-chart")){var comments=(CSV=canvases[i].innerHTML.trim()).match(/<!--[\s\S]*?-->/g),CSV=CSV.replace(/<!--[\s\S]*?-->/g,"").replace(/^\s*\n/gm,"");if(canvases[i].hasAttribute("data-chart-src")){var canvas=canvases[i],xhr=new XMLHttpRequest;xhr.onload=function(){4===xhr.readyState?createChart(canvas,xhr.responseText,comments):console.warn("Failed to get file "+canvas.getAttribute("data-chart-src")+". ReadyState: "+xhr.readyState+", Status: "+xhr.status)},xhr.open("GET",canvas.getAttribute("data-chart-src"),!1);try{xhr.send()}catch(error){console.warn("Failed to get file "+canvas.getAttribute("data-chart-src")+". Make sure that the presentation and the file are served by a HTTP server and the file can be found there. "+error)}}else createChart(canvases[i],CSV,comments)}Reveal.addEventListener("slidechanged",function(){for(var canvases=Reveal.getCurrentSlide().querySelectorAll("canvas[data-chart]"),i=0;i<canvases.length;i++)canvases[i].chart&&!1!==canvases[i].chart.config.options.animation&&recreateChart(canvases[i])})}),this.update=function(canvas,idx,data){canvas.chart.data.datasets[idx].data=data,recreateChart(canvas)},this};